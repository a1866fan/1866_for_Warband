# -*- coding: UTF-8 -*-
####################################################################################################################
# Generated by Warband Module Decompiler
# All rights of the module belong to their respective owners
####################################################################################################################

from header_common import *
from header_dialogs import *
from header_operations import *
from header_parties import *
from header_item_modifiers import *
from header_skills import *
from header_triggers import *
from ID_troops import *
from ID_party_templates import *
from header_troops import *

from module_constants import *


####################################################################################################################
# During a dialog, the dialog lines are scanned from top to bottom.
# If the dialog-line is spoken by the player, all the matching lines are displayed for the player to pick from.
# If the dialog-line is spoken by another, the first (top-most) matching line is selected.
#
#  Each dialog line contains the following fields:
# 1) Dialogue partner: This should match the person player is talking to.
#    Usually this is a troop-id.
#    You can also use a party-template-id by appending '|party_tpl' to this field.
#    Use the constant 'anyone' if you'd like the line to match anybody.
#    Appending '|plyr' to this field means that the actual line is spoken by the player
#    Appending '|other(troop_id)' means that this line is spoken by a third person on the scene.
#       (You must make sure that this third person is present on the scene)
#
# 2) Starting dialog-state:
#    During a dialog there's always an active Dialog-state.
#    A dialog-line's starting dialog state must be the same as the active dialog state, for the line to be a possible candidate.
#    If the dialog is started by meeting a party on the map, initially, the active dialog state is "start"
#    If the dialog is started by speaking to an NPC in a town, initially, the active dialog state is "start"
#    If the dialog is started by helping a party defeat another party, initially, the active dialog state is "party_relieved"
#    If the dialog is started by liberating a prisoner, initially, the active dialog state is "prisoner_liberated"
#    If the dialog is started by defeating a party led by a hero, initially, the active dialog state is "enemy_defeated"
#    If the dialog is started by a trigger, initially, the active dialog state is "event_triggered"
# 3) Conditions block (list): This must be a valid operation block. See header_operations.py for reference.  
# 4) Dialog Text (string):
# 5) Ending dialog-state:
#    If a dialog line is picked, the active dialog-state will become the picked line's ending dialog-state.
# 6) Consequences block (list): This must be a valid operation block. See header_operations.py for reference.
# 7) Voice-over (string): sound filename for the voice over. Leave here empty for no voice over
####################################################################################################################

dialogs = [
  [anyone, "start",
    [
      (store_conversation_troop, "$g_talk_troop"),
      (store_conversation_agent, "$g_talk_agent"),
      (store_troop_faction, "$g_talk_troop_faction", "$g_talk_troop"),
      (call_script, "script_troop_get_player_relation", "$g_talk_troop"),
      (assign, "$g_talk_troop_relation", reg0),
      (try_begin),
        (this_or_next|is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
        (is_between, "$g_talk_troop", "trp_town_1_mayor", "trp_village_1_elder"),
        (party_get_slot, "$g_talk_troop_relation", "$current_town", 26),
      (try_end),
      (store_relation, "$g_talk_troop_faction_relation", "$g_talk_troop_faction", "fac_player_faction"),
      (store_relation, "$g_talk_party_faction_relation", "fac_player_faction", "$g_encountered_party_faction"),
      (assign, "$g_talk_troop_party", "$g_encountered_party"),
      (try_begin),
        (troop_slot_ge, "$g_talk_troop", 10, 1),
        (troop_get_slot, "$g_talk_troop_party", "$g_talk_troop", 10),
      (try_end),
      (store_current_hours, "$g_current_hours"),
      (troop_get_slot, "$g_talk_troop_last_talk_time", "$g_talk_troop", 4),
      (troop_set_slot, "$g_talk_troop", 4, "$g_current_hours"),
      (store_sub, "$g_time_since_last_talk", "$g_current_hours", "$g_talk_troop_last_talk_time"),
      (troop_get_slot, "$g_talk_troop_met", "$g_talk_troop", 5),
      (troop_set_slot, "$g_talk_troop", 5, 1),
      (try_begin),
        (call_script, "script_party_calculate_strength", "p_collective_enemy", 0),
        (assign, "$g_enemy_strength", reg0),
        (call_script, "script_party_calculate_strength", "p_main_party", 0),
        (assign, "$g_ally_strength", reg0),
        (store_mul, "$g_strength_ratio", "$g_ally_strength", 100),
        (val_div, "$g_strength_ratio", "$g_enemy_strength"),
      (try_end),
      (assign, "$g_comment_found", 0),
      (try_begin),
        (troop_is_hero, "$g_talk_troop"),
        (talk_info_show, 1),
        (call_script, "script_setup_talk_info"),
      (try_end),
      (try_begin),
        (is_between, "$g_talk_troop", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (call_script, "script_get_relevant_comment_to_s42"),
        (assign, "$g_comment_found", reg0),
      (try_end),
      (troop_get_type, reg65, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
      (try_begin),
        (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
        (str_store_string, s64, "@{reg18?my Lady:my good Sir}"),
        (str_store_string, s65, "@{reg18?my Lady:my good Sir}"),
        (str_store_string, s66, "@{reg18?My Lady:My good Sir}"),
        (str_store_string, s67, "@{reg18?My Lady:My good Sir}"),
      (else_try),
        (str_store_string, s64, "@{reg18?ma'am:sir}"),
        (str_store_string, s65, "@{reg18?ma'am:sir}"),
        (str_store_string, s66, "@{reg18?Ma'am:Sir}"),
        (str_store_string, s67, "@{reg18?Ma'am:Sir}"),
      (try_end),
      (eq, 1, 0),
    ],
    "Warning: This line is never displayed. It is just for storing conversation variables.",
    "close_window",
    []],

  [anyone, "member_chat",
    [
      (store_conversation_troop, "$g_talk_troop"),
      (try_begin),
        (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
        (talk_info_show, 1),
        (call_script, "script_setup_talk_info_companions"),
      (try_end),
      (troop_get_type, reg65, "$g_talk_troop"),
      (troop_get_type, reg65, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
      (try_begin),
        (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
        (str_store_string, s64, "@{reg18?my Lady:my good Sir}"),
        (str_store_string, s65, "@{reg18?my Lady:my good Sir}"),
        (str_store_string, s66, "@{reg18?My Lady:My good Sir}"),
      (else_try),
        (str_store_string, s64, "@{reg18?ma'am:sir}"),
        (str_store_string, s65, "@{reg18?ma'am:sir}"),
        (str_store_string, s66, "@{reg18?ma'am:Sir}"),
      (try_end),
      (eq, 1, 0),
    ],
    "Warning: This line is never displayed. It is just for storing conversation variables.",
    "close_window",
    []],

  [anyone, "event_triggered",
    [
      (store_conversation_troop, "$g_talk_troop"),
      (try_begin),
        (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
        (talk_info_show, 1),
        (call_script, "script_setup_talk_info_companions"),
      (try_end),
      (troop_get_type, reg65, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
      (try_begin),
        (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
        (str_store_string, s64, "@{reg18?my Lady:good Sir}"),
        (str_store_string, s65, "@{reg18?my Lady:good Sir}"),
        (str_store_string, s66, "@{reg18?My Lady:My good Sir}"),
      (else_try),
        (str_store_string, s64, "@{reg18?ma'am:sir}"),
        (str_store_string, s65, "@{reg18?ma'am:sir}"),
        (str_store_string, s66, "@{reg18?Ma'am:Sir}"),
        (str_store_string, s67, "@{reg18?Ma'am:Sir}"),
      (try_end),
      (eq, 1, 0),
    ],
    "Warning: This line is never displayed. It is just for storing conversation variables.",
    "close_window",
    []],

  [auto_proceed|anyone, "start",
    [
      (eq, "$weapon_switch_conversation", 1),
    ],
    "Warning: This line is never displayed.",
    "close_window",
    [
      (assign, "$weapon_switch_conversation", 0),
    ]],

  [anyone, "start",
    [
      (eq, "$warn_player", 1),
      (assign, "$warn_player", 0),
      (call_script, "script_cancel_town_panic", "$current_town"),
      (val_sub, "$g_player_warnings_left", 1),
    ],
    "We don't take kindly to strangers hasslin' people...now put that gun back in its holster or I'll be obliged to shoot.",
    "close_window",
    []],

  [auto_proceed|anyone, "start",
    [
      (agent_slot_eq, "$g_talk_agent", 22, 1),
      (agent_slot_eq, "$g_talk_agent", 30, 0),
    ],
    "Warning: This line should never be displayed",
    "already_robbed",
    []],

  [auto_proceed|anyone, "start",
    [
      (agent_slot_eq, "$g_talk_agent", 22, 1),
      (this_or_next|is_between, "$g_talk_troop", "trp_town_walker_1", "trp_village_walker_1"),
      (is_between, "$g_talk_troop", "trp_saloon_walker_1", "trp_tournament_master"),
    ],
    "Warning: This line should never be displayed.",
    "robbery_conversation_start",
    []],

  [anyone, "start",
    [
      (agent_slot_eq, "$g_talk_agent", 22, 1),
    ],
    "I don't do business with outlaws.",
    "close_window",
    []],

  [plyr|anyone, "robbery_conversation_1",
    [
      (try_begin),
        (call_script, "script_cf_town_walker_persuasion_check", "$g_talk_troop"),
      (try_end),
    ],
    "(Persuasion: {reg0}%) This is a stick up! Gimme all your money!",
    "robbery_persuasion_check_1",
    []],

  [plyr|anyone, "robbery_conversation_1",
    [],
    "Sorry, I must have mistaken you for someone else.",
    "close_window",
    []],

  [auto_proceed|anyone, "robbery_persuasion_check_1",
    [
      (call_script, "script_cf_town_walker_persuasion_check", "$g_talk_troop"),
    ],
    "This line should never be displayed.",
    "robbery_response_success",
    []],

  [auto_proceed|anyone, "robbery_persuasion_check_1",
    [],
    "This line should never be displayed.",
    "robbery_response_failure_1",
    []],

  [plyr|anyone, "robbery_conversation_2",
    [
      (try_begin),
        (call_script, "script_cf_town_walker_persuasion_check", "$g_talk_troop"),
      (try_end),
      (str_store_string, s1, "@Don't play dumb with me. My trigger finger's getting itchy."),
      (str_store_string, s2, "@We can do this the easy way or the hard way. I don't mind searching your corpse."),
      (str_store_string, s3, "@These bullets only cost me a couple of coppers, so killing you won't set me back none."),
      (str_store_string, s4, "@Have it your way. *click*"),
      (call_script, "script_store_random_string_to_s0", 4),
    ],
    "(Persuasion: {reg0}%) {s0}",
    "robbery_persuasion_check_2",
    []],

  [plyr|anyone, "robbery_conversation_2",
    [],
    "Whatever. Get lost before I change my mind.",
    "close_window",
    []],

  [auto_proceed|anyone, "robbery_persuasion_check_2",
    [
      (call_script, "script_cf_town_walker_persuasion_check", "$g_talk_troop"),
    ],
    "This line should never be displayed.",
    "robbery_response_success",
    []],

  [auto_proceed|anyone, "robbery_persuasion_check_2",
    [],
    "This line should never be displayed.",
    "robbery_response_failure_2",
    []],

  [anyone, "already_robbed",
    [
      (try_begin),
        (this_or_next|eq, "$g_talk_troop", 158),
        (this_or_next|eq, "$g_talk_troop", 159),
        (eq, "$g_talk_troop", 144),
        (str_store_string, s0, "@You've already robbed me! Whaddayah want, a medal?"),
      (else_try),
        (eq, "$g_talk_troop", 145),
        (str_store_string, s0, "@What'd you come back for? My boots?"),
      (else_try),
        (eq, "$g_talk_troop", 146),
        (str_store_string, s0, "@You already got my money. You best quit while you're ahead."),
      (else_try),
        (eq, "$g_talk_troop", 147),
        (str_store_string, s0, "@Please, I've given you the money, what else do you want?"),
      (else_try),
        (this_or_next|eq, "$g_talk_troop", 160),
        (eq, "$g_talk_troop", 148),
        (str_store_string, s0, "@Ain't no more money. Don't make me cut you."),
      (else_try),
        (eq, "$g_talk_troop", 149),
        (str_store_string, s0, "@Take your blood money and go."),
      (else_try),
        (str_store_string, s0, "@You've already robbed me."),
      (try_end),
    ],
    "{s0}",
    "close_window",
    []],

  [anyone, "robbery_conversation_start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (try_begin),
        (this_or_next|eq, "$g_talk_troop", 158),
        (this_or_next|eq, "$g_talk_troop", 159),
        (eq, "$g_talk_troop", 144),
        (str_store_string, s1, "@Don't hurt me, {reg18?ma'am:sir}! I got a wife and kids!"),
        (str_store_string, s2, "@No need to do anything hasty, can't we talk about this like gentlemen?"),
        (str_store_string, s3, "@Don't shoot! Don't shoot!"),
        (str_store_string, s4, "@Please don't kill me! I got too much to live for!"),
      (else_try),
        (eq, "$g_talk_troop", 145),
        (str_store_string, s1, "@Easy there, pardner. Nobody here's looking for trouble."),
        (str_store_string, s2, "@Whoa there, we're all pals here, right?"),
        (str_store_string, s3, "@Don't let me get in your way, buster. I don't wanna get mixed up in this."),
        (str_store_string, s4, "@Hey, ease up, buckaroo. If I done told my wife I got shot, she'd kill me."),
      (else_try),
        (eq, "$g_talk_troop", 146),
        (str_store_string, s1, "@Nice shooter."),
        (str_store_string, s2, "@You best not point that thing at me unless you intend to use it."),
        (str_store_string, s3, "@Am I supposed to be impressed?"),
        (str_store_string, s4, "@You got something to prove, son?"),
      (else_try),
        (eq, "$g_talk_troop", 147),
        (str_store_string, s1, "@Is that any way to treat a lady? Whatever happened to manners?"),
        (str_store_string, s2, "@Eek! Don't hurt me!"),
        (str_store_string, s3, "@I got a baby at home! His daddy's already passed, you don't want to make her an orphan, do you?"),
        (str_store_string, s4, "@Lordy! I'm innocent!"),
      (else_try),
        (this_or_next|eq, "$g_talk_troop", 160),
        (eq, "$g_talk_troop", 148),
        (str_store_string, s1, "@That a gun? You {reg18?girls:boys} and your toys."),
        (str_store_string, s2, "@No need to get rough, handsome."),
        (str_store_string, s3, "@You think you're the first {reg18?woman:man} who's waved a gun at me?"),
        (str_store_string, s4, "@Watch it, buddy, I got more than teats in this birdcage."),
      (else_try),
        (eq, "$g_talk_troop", 149),
        (str_store_string, s1, "@I am a citizen. I have my papers."),
        (str_store_string, s2, "@You know, I've had it just about up to here with crazy white {reg18?women:men}."),
        (str_store_string, s3, "@(says nothing)"),
        (str_store_string, s4, "@I'm just passing through. Please, leave me alone."),
      (try_end),
      (call_script, "script_store_random_string_to_s0", 4),
    ],
    "{s0}",
    "robbery_conversation_1",
    []],

  [auto_proceed|anyone, "robbery_response_success",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (try_begin),
        (this_or_next|eq, "$g_talk_troop", 158),
        (this_or_next|eq, "$g_talk_troop", 159),
        (eq, "$g_talk_troop", 144),
        (str_store_string, s1, "@OK, OK, let me just check my pocket..."),
        (str_store_string, s2, "@Keep your hat on, I've got the money right here..."),
        (str_store_string, s3, "@Whoa! Take the money, I don't want to be pushing up daisies."),
        (str_store_string, s4, "@I have to say, you and that gun of yours make a really good point."),
      (else_try),
        (eq, "$g_talk_troop", 145),
        (str_store_string, s1, "@Whoa there, hold your horses, okay, I'm getting it."),
        (str_store_string, s2, "@Don't get your dander up, I'll give you what I've got."),
        (str_store_string, s3, "@Won't buy you happiness, feller."),
        (str_store_string, s4, "@Why you gotta pick on the working man?"),
      (else_try),
        (eq, "$g_talk_troop", 146),
        (str_store_string, s1, "@You'll regret this, you crazy {reg18?bitch:sonofabitch}."),
        (str_store_string, s2, "@You don't know who you're messin' with, {reg18?lassie:feller}."),
        (str_store_string, s3, "@Fine, have it your way, today's too damn hot for a duel anyhow."),
        (str_store_string, s4, "@Dammit, maybe I just ain't cut out for this shit."),
      (else_try),
        (eq, "$g_talk_troop", 147),
        (str_store_string, s1, "@I didn't want it to come down to this..."),
        (str_store_string, s2, "@Lord protect me!"),
        (str_store_string, s3, "@Here it is! Everything! *sob*"),
        (str_store_string, s4, "@Fine, just take it! But let me go unharmed, please!"),
      (else_try),
        (this_or_next|eq, "$g_talk_troop", 160),
        (eq, "$g_talk_troop", 148),
        (str_store_string, s1, "@You're my toughest customer all week."),
        (str_store_string, s2, "@{reg18?Women:Men} like you are always compensating for something."),
        (str_store_string, s3, "@Can't cut a working girl a break, can you?"),
        (str_store_string, s4, "@You know, you want to rob me, you could at least have the courtesy to kiss me first."),
      (else_try),
        (eq, "$g_talk_troop", 149),
        (str_store_string, s1, "@(says nothing)"),
        (str_store_string, s2, "@Disgraceful."),
        (str_store_string, s3, "@Take it. Your people have taken everything else from me."),
        (str_store_string, s4, "@The Great Spirit will punish you in the end."),
      (try_end),
      (call_script, "script_store_random_string_to_s0", 4),
    ],
    "This line should never be displayed.",
    "robbery_success",
    []],

  [anyone, "robbery_response_failure_1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (try_begin),
        (this_or_next|eq, "$g_talk_troop", 158),
        (this_or_next|eq, "$g_talk_troop", 159),
        (eq, "$g_talk_troop", 144),
        (str_store_string, s1, "@Sorry boss, I'm flat broke."),
        (str_store_string, s2, "@I don't carry cash around! It's all stowed away in the bank!"),
        (str_store_string, s3, "@Sorry, {reg18?ma'am:sir}, I'm afraid I left all my chink at the card table."),
        (str_store_string, s4, "@Whoa, easy there! I'm a little hard up right now, can't you cut a man a break?"),
      (else_try),
        (eq, "$g_talk_troop", 145),
        (str_store_string, s1, "@I ain't got nothin' on me."),
        (str_store_string, s2, "@Afraid I'm just a poor cowherd. I ain't got no cash."),
        (str_store_string, s3, "@Too bad for you I invest all my wealth in whisky, and it's all drank up."),
        (str_store_string, s4, "@Money? Do I look like I got money to you?"),
      (else_try),
        (eq, "$g_talk_troop", 146),
        (str_store_string, s1, "@Go boil your shirt."),
        (str_store_string, s2, "@You gonna keep walkin', or am I gonna have to introduce you to black-eyed Susan?"),
        (str_store_string, s3, "@Heh. Tell me another one."),
        (str_store_string, s4, "@I've got a counter-proposal: you shut yer big damn mouth, and I won't ventilate your chest cavity."),
      (else_try),
        (eq, "$g_talk_troop", 147),
        (str_store_string, s1, "@I can't afford that! I have a family to feed!."),
        (str_store_string, s2, "@Please, have a heart, {reg18?ma'am:sir}. I'm a poor widow."),
        (str_store_string, s3, "@I can't give you any money. My husband would beat me."),
        (str_store_string, s4, "@You sure you can't just let me go? I won't tell anyone, I promise!"),
      (else_try),
        (this_or_next|eq, "$g_talk_troop", 160),
        (eq, "$g_talk_troop", 148),
        (str_store_string, s1, "@You wanna rephrase that more politely, sugar?"),
        (str_store_string, s2, "@You want some tail, {reg18?cowgirl:cowboy}, you pay cash like every other john."),
        (str_store_string, s3, "@You call that a gun? I seen a Chinaman pack more in his trousers."),
        (str_store_string, s4, "@Don't you take one step closer. This kitten's got claws."),
      (else_try),
        (eq, "$g_talk_troop", 149),
        (str_store_string, s1, "@(says nothing)"),
        (str_store_string, s2, "@I am just a poor farm worker. I have no money."),
        (str_store_string, s3, "@I just spent the last of it on firewater."),
        (str_store_string, s4, "@I warn you, do not push me further."),
      (try_end),
      (call_script, "script_store_random_string_to_s0", 4),
    ],
    "{s0}",
    "robbery_conversation_2",
    []],

  [auto_proceed|anyone, "robbery_response_failure_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (try_begin),
        (this_or_next|eq, "$g_talk_troop", 158),
        (this_or_next|eq, "$g_talk_troop", 159),
        (eq, "$g_talk_troop", 144),
        (str_store_string, s1, "@OK, OK, let me just check my pocket..."),
        (str_store_string, s2, "@Keep your hat on, I've got the money right here..."),
        (str_store_string, s3, "@How about I pay you in lead?"),
        (str_store_string, s4, "@Look behind you! It's Secretary of State William H. Seward!"),
      (else_try),
        (eq, "$g_talk_troop", 145),
        (str_store_string, s1, "@Whoa there, hold your horses, okay, I'm getting it."),
        (str_store_string, s2, "@Fine, don't get your dander up, I'll give you what I've got."),
        (str_store_string, s3, "@You want it, you can pry it from my cold, dead hands."),
        (str_store_string, s4, "@Hope you shoot faster than you talk!"),
      (else_try),
        (eq, "$g_talk_troop", 146),
        (str_store_string, s1, "@You'll regret this, you crazy {reg18?bitch:sonofabitch}."),
        (str_store_string, s2, "@You don't know who you're messin' with, feller."),
        (str_store_string, s3, "@Fine, have it your way, today's too damn hot for a duel anyhow."),
        (str_store_string, s4, "@Dammit, maybe I just ain't cut out for this shit."),
      (else_try),
        (eq, "$g_talk_troop", 147),
        (str_store_string, s1, "@I didn't want it to come down to this..."),
        (str_store_string, s2, "@Lord protect me!"),
        (str_store_string, s3, "@You've left me no choice, you bloody scoundrel!"),
        (str_store_string, s4, "@This'll teach you some manners!"),
      (else_try),
        (this_or_next|eq, "$g_talk_troop", 160),
        (eq, "$g_talk_troop", 148),
        (str_store_string, s1, "@You're my toughest customer all week."),
        (str_store_string, s2, "@{reg18?Women:Men} like you are always compensating for something."),
        (str_store_string, s3, "@Too close!"),
        (str_store_string, s4, "@Would you really shoot a girl, {reg18?sweety:cowboy}?"),
      (else_try),
        (eq, "$g_talk_troop", 149),
        (str_store_string, s1, "@(says nothing)"),
        (str_store_string, s2, "@Disgraceful."),
        (str_store_string, s3, "@This time you have pushed me too far."),
        (str_store_string, s4, "@Not this time, washichu."),
      (try_end),
      (call_script, "script_store_random_string_to_s0", 4),
    ],
    "This line should never be displayed.",
    "robbery_failure",
    []],

  [anyone, "robbery_failure",
    [
      (val_sub, "$g_player_warnings_left", 1),
      (agent_set_slot, "$g_talk_agent", 15, 0),
      (call_script, "script_cf_set_town_agent_behavior", "$g_talk_agent", 1),
      (agent_set_slot, "$g_talk_agent", 22, 1),
      (call_script, "script_crime_committed", "$g_talk_agent", "$current_town", 4),
    ],
    "{s0}",
    "close_window",
    []],

  [anyone, "robbery_success",
    [
      (val_sub, "$g_player_warnings_left", 1),
      (agent_get_slot, ":var0", "$g_talk_agent", 17),
      (agent_set_slot, "$g_talk_agent", 15, ":var0"),
      (call_script, "script_rob_agent", "$g_talk_agent"),
      (agent_set_slot, "$g_talk_agent", 22, 1),
      (call_script, "script_crime_committed", "$g_talk_agent", "$current_town", 3),
    ],
    "{s0}",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$pre_duel_conversation", 1),
      (store_random_in_range, ":var0", 0, 100),
      (gt, ":var0", 66),
      (agent_set_animation, "$g_talk_agent", "anim_cheer"),
    ],
    "Hey, gringo. I've never lost a duel.",
    "pre_duel_1",
    []],

  [plyr|anyone, "pre_duel_1",
    [],
    "I'd be surprised to see you standing here right now if you'd ever lost a duel.",
    "close_window",
    [
      (assign, "$pre_duel_conversation", 0),
      (assign, "$duel", 3),
      (assign, "$countdown_to_duel", 10),
    ]],

  [anyone, "start",
    [
      (eq, "$pre_duel_conversation", 1),
      (store_random_in_range, ":var0", 0, 100),
      (gt, ":var0", 50),
      (agent_set_animation, "$g_talk_agent", "anim_cheer"),
    ],
    "Ugly man... At least you've got the courage to face me.",
    "close_window",
    [
      (assign, "$pre_duel_conversation", 0),
      (assign, "$duel", 3),
      (assign, "$countdown_to_duel", 10),
    ]],

  [anyone, "start",
    [
      (eq, "$pre_duel_conversation", 1),
      (agent_set_animation, "$g_talk_agent", "anim_cheer"),
    ],
    "There's a reward for my head in twelve states. You must be itchin' to die.",
    "pre_duel_2",
    []],

  [plyr|anyone, "pre_duel_2",
    [],
    "I bet you couldn't even name three states, saphead.",
    "close_window",
    [
      (assign, "$pre_duel_conversation", 0),
      (assign, "$duel", 3),
      (assign, "$countdown_to_duel", 10),
    ]],

  [trp_gy_duel_master, "start",
    [
      (eq, "$g_talk_troop_met", 0),
    ],
    "I've been watchin' you, and I've seen what kind of a man you are. You're the kind of man who never leaves the house without his gun, who carries it when he's takin' a bath, and even keeps it on when he's getting to know a woman. I just happen to be lookin' for a man like that.  You interested?",
    "gy_duel_intro_0",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_intro_0",
    [],
    "You're wrong about that.  Go get someone else to do your dirty work.",
    "gy_duel_intro_1",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_intro_0",
    [],
    "Why don't you just stop blathering and tell me what you want?",
    "gy_duel_intro_1",
    []],

  [trp_gy_duel_master, "gy_duel_intro_1",
    [],
    "I assure you that it's nothin' dirty. If you are as fast as I think, then you ain't got nothin' to fear.  From time to time I organize a contest, a great duel.  If you win, you'll be the most famous gun fighter in these parts.  And did I mention the rather generous prize?",
    "gy_duel_intro_2",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_intro_2",
    [],
    "And what do you get out of all of this?",
    "gy_duel_intro_3",
    []],

  [trp_gy_duel_master, "gy_duel_intro_3",
    [],
    "You know, there was a time when people wouldn't pay to see a man gunned down in the street.  But people are tired of betting on pitfights and cockfighting.  People want entertainment, and duels are what they want to see nowadays.   I'm just the man willin' to show it to 'em.",
    "gy_duel_intro_4",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_intro_4",
    [],
    "I'm up for a challenge.",
    "gy_duel_intro_5",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_intro_4",
    [],
    "You got the wrong guy, mister.",
    "close_window",
    []],

  [trp_gy_duel_master, "gy_duel_intro_5",
    [],
    "Meet me at the graveyard north of the city.  It sits on a ridge overlooking the Rio Grande.  You can't miss it.  The tournament starts in 5 hours.  Now go to the bar and buy yourself a tequila.  When a man says no to tequila, he says no to life.",
    "close_window",
    [
      (troop_add_gold, "trp_player", 100),
      (quest_set_slot, "qst_graveyard_duel", 24, 20),
      (quest_set_slot, "qst_graveyard_duel", 23, 5),
      (quest_set_slot, "qst_graveyard_duel", 11, 0),
      (str_store_string, s2, "@Go to the graveyard for the duel."),
      (call_script, "script_start_quest", "qst_graveyard_duel", "trp_gy_duel_master"),
      (troop_set_slot, "trp_gy_duel_master", 142, 0),
      (troop_set_slot, "trp_gy_duel_master", 143, 0),
    ]],

  [trp_gy_duel_master, "start",
    [
      (store_current_scene, ":var0"),
      (eq, ":var0", "scn_graveyard_1"),
      (quest_slot_eq, "qst_graveyard_duel", 11, 1),
    ],
    "Hey, you alive? I pulled you into my little house over there after you were shot. Unfortunately, I couldn't keep those Mexican rats from taking your purse. Those poor spectators ran to your body right after you hit the dirt.",
    "close_window",
    [
      (quest_set_slot, "qst_graveyard_duel", 11, 5),
      (fail_quest, "qst_graveyard_duel"),
      (call_script, "script_end_quest", "qst_graveyard_duel"),
    ]],

  [trp_gy_duel_master, "start",
    [
      (store_current_scene, ":var0"),
      (eq, ":var0", "scn_graveyard_1"),
      (quest_slot_eq, "qst_graveyard_duel", 11, 2),
    ],
    "Nice shooting. You earned this.",
    "close_window",
    [
      (call_script, "script_change_troop_renown", "trp_player", 10),
      (troop_add_gold, "trp_player", 200),
      (troop_add_gold, "trp_player", "$gy_duel_bet"),
      (quest_set_slot, "qst_graveyard_duel", 11, 5),
      (succeed_quest, "qst_graveyard_duel"),
      (call_script, "script_end_quest", "qst_graveyard_duel"),
    ]],

  [trp_gy_duel_master, "start",
    [
      (store_current_scene, ":var0"),
      (eq, ":var0", "scn_graveyard_1"),
      (quest_slot_eq, "qst_graveyard_duel", 11, 4),
    ],
    "That was really cowardly. I guess your nerves were weak.",
    "close_window",
    [
      (quest_set_slot, "qst_graveyard_duel", 11, 5),
      (fail_quest, "qst_graveyard_duel"),
      (call_script, "script_end_quest", "qst_graveyard_duel"),
    ]],

  [trp_gy_duel_master, "start",
    [
      (store_current_scene, ":var0"),
      (eq, ":var0", "scn_graveyard_1"),
      (quest_slot_eq, "qst_graveyard_duel", 11, 5),
    ],
    "There are no more duels today.  I've got to go and find some more gunfighters.  When I do, you'll find me back in San Casteabro",
    "close_window",
    []],

  [trp_gy_duel_master, "start",
    [
      (quest_slot_eq, "qst_graveyard_duel", 11, 0),
      (check_quest_active, "qst_graveyard_duel"),
      (store_current_scene, ":var0"),
      (eq, ":var0", "scn_graveyard_1"),
    ],
    "Hey Stranger.  You feelin' lucky today?",
    "gy_duel",
    []],

  [trp_gy_duel_master, "gy_duel",
    [],
    "These are the rules:  You and two enemies face each other in this circle in front of you, the bell rings, one man remains.  You can bet on yourself. If you're still standing when the smoke clears, you win double your bet.  The rest is my fee for the event.  Don't worry though, your enemies are mostly poor Mexican farmers.  Feel free to wager generously.",
    "gy_duel_1",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_1",
    [],
    "I bet nothing.",
    "gy_duel_2",
    [
      (assign, "$gy_duel_bet", 0),
    ]],

  [plyr|trp_gy_duel_master, "gy_duel_1",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (gt, ":var0", 50),
    ],
    "I bet 50 cents.",
    "gy_duel_2",
    [
      (assign, "$gy_duel_bet", 100),
      (troop_remove_gold, "trp_player", 50),
    ]],

  [plyr|trp_gy_duel_master, "gy_duel_1",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (gt, ":var0", 300),
    ],
    "I bet 1 dollar.",
    "gy_duel_2",
    [
      (assign, "$gy_duel_bet", 200),
      (troop_remove_gold, "trp_player", 100),
    ]],

  [plyr|trp_gy_duel_master, "gy_duel_1",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (gt, ":var0", 500),
    ],
    "I bet 5 dollars.",
    "gy_duel_2",
    [
      (assign, "$gy_duel_bet", 1000),
      (troop_remove_gold, "trp_player", 500),
    ]],

  [plyr|trp_gy_duel_master, "gy_duel_1",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (gt, ":var0", 1000),
    ],
    "I bet 10 dollars.",
    "gy_duel_2",
    [
      (assign, "$gy_duel_bet", 2000),
      (troop_remove_gold, "trp_player", 1000),
    ]],

  [plyr|trp_gy_duel_master, "gy_duel_1",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (gt, ":var0", 1500),
    ],
    "I bet 15 dollars.",
    "gy_duel_2",
    [
      (assign, "$gy_duel_bet", 3000),
      (troop_remove_gold, "trp_player", 1500),
    ]],

  [trp_gy_duel_master, "gy_duel_2",
    [],
    "I wish you a long life, friend.",
    "close_window",
    [
      (modify_visitors_at_site, "scn_graveyard_1"),
      (set_visitor, 19, "trp_gy_duel_master"),
      (try_for_range, ":var0", 20, 35),
        (set_visitor, ":var0", "trp_vagabond"),
      (try_end),
      (set_visitor, 16, "trp_player"),
      (set_visitor, 17, "trp_cut_throat"),
      (set_visitor, 18, "trp_pistolero"),
      (assign, "$duel_partner", "trp_cut_throat"),
      (assign, "$duel_partner_b", "trp_pistolero"),
      (set_jump_mission, "mt_graveyard_duel"),
      (jump_to_scene, "scn_graveyard_1"),
      (change_screen_mission),
    ]],

  [trp_gy_duel_master, "start",
    [
      (eq, "$g_talk_troop_met", 1),
      (check_quest_active, "qst_graveyard_duel"),
      (store_current_scene, ":var0"),
      (neq, ":var0", "scn_graveyard_1"),
    ],
    "A graveyard. It's the ideal place to die.",
    "close_window",
    []],

  [trp_gy_duel_master, "start",
    [
      (eq, "$g_talk_troop_met", 1),
      (neg|check_quest_active, "qst_graveyard_duel"),
    ],
    "I remember you, gunman. One of my famous duels is about to be held at the graveyard if you're interested.",
    "gy_duel_intro_b_0",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_intro_b_0",
    [],
    "Tell me again about these duels.",
    "gy_duel_b_intro_1a",
    []],

  [trp_gy_duel_master, "gy_duel_b_intro_1a",
    [],
    "From time to time I organize a contest, a great duel.  If you win, you'll be the most famous gun fighter in these parts.  And did I mention the rather generous prize?",
    "gy_duel_b_intro_1a1",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_b_intro_1a1",
    [],
    "And what do you get out of all of this?",
    "gy_duel_b_intro_1a2",
    []],

  [trp_gy_duel_master, "gy_duel_b_intro_1a2",
    [],
    "You know, there was a time when people wouldn't pay to see a man gunned down in the street.  But people are tired of betting on pitfights and cockfighting.  People want entertainment, and duels are what they want to see nowadays.   I'm just the man willin' to show it to 'em.",
    "gy_duel_intro_b_0",
    []],

  [plyr|trp_gy_duel_master, "gy_duel_intro_b_0",
    [],
    "I'm up for the challenge.",
    "gy_duel_b_intro_1b",
    []],

  [trp_gy_duel_master, "gy_duel_b_intro_1b",
    [],
    "Meet me at the graveyard north of the city.  It sits on a ridge overlooking the Rio Grande.  You can't miss it.  The tournament begins in 5 hours.",
    "close_window",
    [
      (quest_set_slot, "qst_graveyard_duel", 24, 20),
      (quest_set_slot, "qst_graveyard_duel", 23, 5),
      (quest_set_slot, "qst_graveyard_duel", 11, 0),
      (str_store_string, s2, "@Go to the graveyard for the duel."),
      (call_script, "script_start_quest", "qst_graveyard_duel", "trp_gy_duel_master"),
      (troop_set_slot, "trp_gy_duel_master", 142, 0),
      (troop_set_slot, "trp_gy_duel_master", 143, 0),
    ]],

  [plyr|trp_gy_duel_master, "gy_duel_intro_b_0",
    [],
    "You got the wrong guy, mister.",
    "close_window",
    []],

  [trp_cw_saloon_keeper, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "Welcome, stranger, to my saloon. If you're searching for a drink or some gambling, this is the right place. If you want to make trouble, go somewhere else.",
    "tavernkeeper_talk",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [trp_cw_saloon_keeper, "start",
    [],
    "A drink for you, cowboy?",
    "tavernkeeper_talk",
    []],

  [plyr|trp_cw_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of whisky.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_cw_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of gin.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_cw_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of tequila.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_cw_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of brandy.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_cw_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of wine.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_cw_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a beer.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_cw_saloon_keeper, "tavernkeeper_talk",
    [],
    "Good bye.",
    "close_window",
    []],

  [plyr|trp_cw_saloon_keeper, "cw_saloon_keeper_2",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 100),
      (troop_remove_gold, "trp_player", 100),
      (heal_party, "trp_player"),
    ],
    "Here you go.",
    "tavernkeeper_talk",
    []],

  [plyr|trp_cw_saloon_keeper, "cw_saloon_keeper_2",
    [],
    "Get some money first.",
    "tavernkeeper_talk",
    []],

  [trp_cw_drunkard_a, "start",
    [],
    "Hey.",
    "close_window",
    []],

  [trp_ep_saloon_keeper, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "Welcome to the El Paso saloon. I'm the owner. Don't do any screwing around, now. If you want a drink or you'd like to gamble away all your money, this is the spot.",
    "tavernkeeper_talk",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [trp_ep_saloon_keeper, "start",
    [],
    "Something to drink?",
    "tavernkeeper_talk",
    []],

  [plyr|trp_ep_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of whisky.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_ep_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of gin.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_ep_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of tequila.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_ep_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of brandy.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_ep_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of wine.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_ep_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a beer.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_ep_saloon_keeper, "tavernkeeper_talk",
    [],
    "Good bye.",
    "close_window",
    []],

  [plyr|trp_ep_saloon_keeper, "cw_saloon_keeper_2",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 100),
      (troop_remove_gold, "trp_player", 100),
      (heal_party, "trp_player"),
    ],
    "Here you go.",
    "tavernkeeper_talk",
    []],

  [plyr|trp_ep_saloon_keeper, "cw_saloon_keeper_2",
    [
      (store_troop_gold, reg1, "trp_player"),
      (lt, reg1, 100),
    ],
    "Get some money first.",
    "tavernkeeper_talk",
    []],

  [trp_ep_drunkard_a, "start",
    [],
    "...(belch)...",
    "close_window",
    []],

  [trp_bl_saloon_keeper, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "Welcome, stranger, to my saloon. If you'd like to do some gambling or have a drink, this is the right place. If you want to make trouble, go somewhere else.",
    "tavernkeeper_talk",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [trp_bl_saloon_keeper, "start",
    [],
    "Would you like a drink?",
    "tavernkeeper_talk",
    []],

  [plyr|trp_bl_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of whisky.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_bl_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of gin.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_bl_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of tequila.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_bl_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of brandy.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_bl_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a bottle of wine.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_bl_saloon_keeper, "tavernkeeper_talk",
    [],
    "I'd like a beer.",
    "cw_saloon_keeper_2",
    []],

  [plyr|trp_bl_saloon_keeper, "tavernkeeper_talk",
    [],
    "Good bye.",
    "close_window",
    []],

  [plyr|trp_bl_saloon_keeper, "cw_saloon_keeper_2",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 100),
      (troop_remove_gold, "trp_player", 100),
      (troop_set_health, "trp_player", 100),
    ],
    "Here you go.",
    "tavernkeeper_talk",
    []],

  [plyr|trp_bl_saloon_keeper, "cw_saloon_keeper_2",
    [],
    "Get some money first.",
    "tavernkeeper_talk",
    []],

  [trp_cw_drunkard_b, "start",
    [],
    "I'm not interested in playing blackjack today.",
    "close_window",
    []],

  [plyr|trp_cw_drunkard_b, "gambler_talk_1",
    [],
    "Give me some cards, then.",
    "gambler_talk_start",
    []],

  [plyr|trp_cw_drunkard_b, "gambler_talk_1",
    [],
    "Forget it.",
    "close_window",
    []],

  [trp_cw_drunkard_b, "gambler_talk_start",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 1),
    ],
    "Ok.",
    "close_window",
    [
      (assign, "$black_jack", 1),
      (assign, reg50, 0),
      (start_presentation, "prsnt_blackjack"),
    ]],

  [trp_cw_drunkard_b, "gambler_talk_start",
    [],
    "You don't have enough money.",
    "close_window",
    []],

  [trp_ep_drunkard_b, "start",
    [],
    "I'm not interested in playing blackjack today.",
    "close_window",
    []],

  [plyr|trp_ep_drunkard_b, "gambler_talk_1",
    [],
    "Give me some cards, then.",
    "gambler_talk_start",
    []],

  [plyr|trp_ep_drunkard_b, "gambler_talk_1",
    [],
    "Forget it.",
    "close_window",
    []],

  [trp_ep_drunkard_b, "gambler_talk_start",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 1),
    ],
    "Ok.",
    "close_window",
    [
      (assign, "$black_jack", 1),
      (assign, reg50, 0),
      (start_presentation, "prsnt_blackjack"),
    ]],

  [trp_ep_drunkard_b, "gambler_talk_start",
    [],
    "You don't have enough money.",
    "close_window",
    []],

  [trp_tavern_visitor_1, "start",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 2000),
    ],
    "From the ol' states, eh?",
    "gambler_intro_1",
    []],

  [plyr|trp_tavern_visitor_1, "gambler_intro_1",
    [],
    "You got it! What's the matter?",
    "gambler_intro_2",
    []],

  [plyr|trp_tavern_visitor_1, "gambler_intro_1",
    [],
    "I lived all my life in the west, my friend.",
    "gambler_intro_2",
    []],

  [trp_tavern_visitor_1, "gambler_intro_2",
    [],
    "Oh, it's just that you look like you might be interested in making even more money.",
    "gambler_intro_3",
    []],

  [trp_tavern_visitor_1, "start",
    [
      (store_troop_gold, reg1, "trp_player"),
      (lt, reg1, 2000),
    ],
    "You look like you need some more dinero, amigo.",
    "gambler_intro_3",
    []],

  [trp_tavern_visitor_1, "gambler_intro_3",
    [],
    "Interested in playing some blackjack?  I'm having very bad luck today. You can't lose!",
    "gambler_talk_1",
    []],

  [plyr|trp_tavern_visitor_1, "gambler_talk_1",
    [],
    "Give me some cards, then.",
    "gambler_talk_start",
    []],

  [plyr|trp_tavern_visitor_1, "gambler_talk_1",
    [],
    "Forget it.",
    "close_window",
    []],

  [trp_tavern_visitor_1, "gambler_talk_start",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 1),
    ],
    "Okay.",
    "close_window",
    [
      (assign, "$black_jack", 1),
      (assign, reg50, 0),
      (start_presentation, "prsnt_blackjack"),
    ]],

  [trp_tavern_visitor_1, "gambler_talk_start",
    [],
    "You don't have enough money.",
    "close_window",
    []],

  [trp_linda, "start",
    [],
    "Hello. I'm Linda Snorklin. Hostess of Bishop's Lodge Saloon. How may I help you today?",
    "linda_talk",
    []],

  [plyr|trp_linda, "linda_talk",
    [],
    "What can you tell me about this place?",
    "saloon_story",
    []],

  [plyr|trp_linda, "linda_talk",
    [],
    "I am looking for one of my companions...",
    "tavern_traveler_companion_location",
    []],

  [plyr|trp_linda, "linda_talk",
    [],
    "I'd like to improve my standing with this town.",
    "charity_dialog",
    []],

  [plyr|trp_linda, "linda_talk",
    [],
    "Give me one of your girls. My men need entertainment...",
    "hire_dialog",
    []],

  [plyr|trp_linda, "linda_talk",
    [],
    "What is the latest rumor around here?",
    "rumor_dialog",
    []],

  [plyr|trp_linda, "linda_talk",
    [],
    "Is there anything I can do for you?",
    "job_dialog",
    []],

  [plyr|trp_linda, "linda_talk",
    [],
    "Good bye.",
    "close_window",
    []],

  [anyone, "saloon_story",
    [],
    "This saloon belongs to the mayor of Bishop's Lodge. I'm just a hostess here and help 'im run this place. A lot of rifraffs have been takin' refuge in this town lately. As a result, there's seldom any respectable customers here anymore. Well, at least this must be a good place to be for an adventurer such as yourself. With some luck and skill, you can make a name for yourself here, amass a fortune perhaps, or gain great power. Opportunities are endless and so are the rewards, if you are willing to risk your life for them.",
    "close_window",
    []],

  [anyone, "rumor_dialog",
    [],
    "This town is known for its rail road and oil. We also used to produce coal but the mine has been depleted and abandoned since. As a result, there's a lot of criminals taking refuge in that area. Stagecoach business is brisk and we have cattle/horses for settlers. The train station is a busy place if look for work. Though you won't be offered any unless the sheriff trusts you. With some luck and skill, you can make a name for yourself here, amass a fortune perhaps, or gain great power. Opportunities are endless and so are the rewards, if you are willing to risk your life for them.",
    "close_window",
    []],

  [trp_linda, "job_dialog",
    [],
    "No. But local Sheriff has his hands full lately and just may have a job that suits you.",
    "close_window",
    []],

  [trp_linda, "hire_dialog",
    [],
    "Talk to one of my girls on the streets.",
    "close_window",
    []],

  [trp_linda, "charity_dialog",
    [],
    "The town could always use a donation.",
    "donate_town",
    []],

  [plyr|trp_linda, "donate_town",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 1000),
    ],
    "I'd like to donate $10.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 1000),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
    ]],

  [plyr|trp_linda, "donate_town",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 2000),
    ],
    "I'd like to donate $20",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 2000),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
    ]],

  [plyr|trp_linda, "donate_town",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 3000),
    ],
    "I'd like to donate $30",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 3000),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
    ]],

  [plyr|trp_linda, "donate_town",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 4000),
    ],
    "I'd like to donate $40",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 4000),
      (call_script, "script_change_player_relation_with_center", "$current_town", 4),
    ]],

  [plyr|trp_linda, "donate_town",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 5000),
    ],
    "I'd like to donate $50",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 5000),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
    ]],

  [plyr|trp_linda, "donate_town",
    [],
    "I changed my mind.",
    "close_window",
    []],

  [plyr|trp_tavern_visitor_2, "gambler_intro_1",
    [],
    "What is that ya want?",
    "gambler_intro_3",
    []],

  [trp_tavern_visitor_2, "start",
    [],
    "You look like you need some more drink, amigo.",
    "gambler_intro_3",
    []],

  [trp_tavern_visitor_2, "gambler_intro_3",
    [],
    "Interested in playing some blackjack?  I'm having very bad luck today. You can't lose!",
    "gambler_talk_1",
    []],

  [plyr|trp_tavern_visitor_2, "gambler_talk_1",
    [],
    "Give me some cards then.",
    "gambler_talk_start",
    []],

  [plyr|trp_tavern_visitor_2, "gambler_talk_1",
    [],
    "Forget it.",
    "close_window",
    []],

  [trp_tavern_visitor_2, "gambler_talk_start",
    [
      (store_troop_gold, reg1, "trp_player"),
      (ge, reg1, 1),
    ],
    "Okay.",
    "close_window",
    [
      (assign, "$black_jack", 1),
      (assign, reg50, 0),
      (start_presentation, "prsnt_blackjack"),
    ]],

  [trp_tavern_visitor_2, "gambler_talk_start",
    [],
    "You don't have enough money.",
    "close_window",
    []],

  [anyone, "start",
    [
      (store_current_scene, ":var0"),
      (is_between, ":var0", "scn_town_1_center", "scn_castle_1_exterior"),
      (store_conversation_agent, ":var1"),
      (agent_get_entry_no, ":var2", ":var1"),
      (this_or_next|eq, ":var2", 60),
      (this_or_next|eq, ":var2", 61),
      (eq, ":var2", 62),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Right behind you, {reg18?ma'am:sir}!",
    "close_window",
    []],

  [plyr|trp_town_1_mayor, "mayor_talk",
    [
      (eq, "$elpaso_house_offered", 0),
    ],
    "Anything special going on in El Paso?",
    "elpaso_house_1",
    []],

  [plyr|trp_town_1_mayor, "mayor_talk",
    [
      (eq, "$elpaso_house_offered", 1),
      (eq, "$elpaso_house_bought", 0),
    ],
    "About the house you offered me...",
    "elpaso_house_1_1",
    []],

  [trp_town_1_mayor, "elpaso_house_1_1",
    [],
    "Very beautiful. Only $300.",
    "elpaso_house_6",
    []],

  [trp_town_1_mayor, "elpaso_house_1",
    [],
    "Probably nothing that you haven't heard of...",
    "elpaso_house_2",
    []],

  [trp_town_1_mayor, "elpaso_house_2",
    [],
    "We always had these two rivaling general stores here in El Paso. Well, one of them just went bankrupt...",
    "elpaso_house_3",
    []],

  [trp_town_1_mayor, "elpaso_house_3",
    [],
    "Oh, by the way, his house is for sale. A beautiful one. It's in a great spot and for a very reasonable price.",
    "elpaso_house_4",
    [
      (assign, "$elpaso_house_offered", 1),
    ]],

  [plyr|trp_town_1_mayor, "elpaso_house_4",
    [],
    "Very reasonable price, you say?",
    "elpaso_house_5",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_4",
    [],
    "I'm not interested, thanks.",
    "close_window",
    []],

  [trp_town_1_mayor, "elpaso_house_5",
    [],
    "Yes! Only 300$.",
    "elpaso_house_6",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_6",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 30000),
    ],
    "You, my friend, just sold a house!",
    "elpaso_house_7a",
    [
      (troop_remove_gold, "trp_player", 30000),
      (assign, "$elpaso_house_bought", 1),
      (scene_prop_get_instance, ":var0", "spr_el_paso_door", 0),
      (prop_instance_get_position, pos1, ":var0"),
      (position_move_z, pos1, -1000),
      (prop_instance_animate_to_position, ":var0", pos1, 1),
    ]],

  [trp_town_1_mayor, "elpaso_house_7a",
    [],
    "Congratulations! You won't regret it. It's the empty General Store, on the left of the bank.",
    "close_window",
    [
      (assign, "$elpaso_house_bought", 1),
    ]],

  [plyr|trp_town_1_mayor, "elpaso_house_6",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 30000),
    ],
    "Shouldn't I take a look at it, before I buy it?",
    "elpaso_house_7b",
    []],

  [trp_town_1_mayor, "elpaso_house_7b",
    [],
    "It's beautiful, don't worry. You can trust me.",
    "elpaso_house_6",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_6",
    [],
    "I'm afraid I can't afford that.",
    "close_window",
    []],

  [plyr|trp_town_1_mayor, "mayor_talk",
    [
      (eq, "$elpaso_house_bought", 1),
    ],
    "About the house you sold me...",
    "elpaso_house_2_1",
    []],

  [trp_town_1_mayor, "elpaso_house_2_1",
    [],
    "It's beautiful, isn't it?",
    "elpaso_house_2_2",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_2_2",
    [],
    "I didn't find it, where is it?",
    "elpaso_house_2_3",
    []],

  [trp_town_1_mayor, "elpaso_house_2_3",
    [],
    "It's the empty General Store, on the left of the bank. You can't miss it.",
    "close_window",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_2_2",
    [],
    "It's beautiful, indeed! I always dreamt of a house like this.",
    "elpaso_house_2_3b",
    []],

  [trp_town_1_mayor, "elpaso_house_2_3b",
    [],
    "I'm very glad you like it.",
    "close_window",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_2_2",
    [],
    "It's a piece of shit, you son of a bitch.",
    "elpaso_house_2_3c",
    []],

  [trp_town_1_mayor, "elpaso_house_2_3c",
    [],
    "You don't like it?",
    "elpaso_house_2_4c",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_2_4c",
    [],
    "It doesn't have any doors.",
    "elpaso_house_2_5ca",
    []],

  [trp_town_1_mayor, "elpaso_house_2_5ca",
    [],
    "What do you need doors for? Do you think anyone would search for valuable things in a house like this?",
    "elpaso_house_2_4c",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_2_4c",
    [],
    "The wood is full of worms.",
    "elpaso_house_2_5cb",
    []],

  [trp_town_1_mayor, "elpaso_house_2_5cb",
    [],
    "Buy some chickens. They'll eat them. By the way, I'm also selling chickens.",
    "elpaso_house_2_4c",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_2_4c",
    [],
    "The model is really crappy. Lots of useless polygons, poor UV mapping and the texture is even worse.",
    "elpaso_house_2_5cc",
    []],

  [trp_town_1_mayor, "elpaso_house_2_5cc",
    [],
    "Polygons? UV map? Texture? What are you talking about?",
    "elpaso_house_2_4c",
    []],

  [plyr|trp_town_1_mayor, "elpaso_house_2_4c",
    [],
    "Good bye.",
    "close_window",
    []],

  [trp_john_marvin, "start",
    [
      (eq, "$elpaso_merch_house_given", 0),
      (eq, "$g_talk_troop_met", 0),
    ],
    "Howdy, cowboy.",
    "epm_1",
    [
      (assign, "$john_marvin_turned_down", 0),
    ]],

  [trp_john_marvin, "start",
    [
      (eq, "$elpaso_merch_house_given", 0),
      (eq, "$g_talk_troop_met", 1),
    ],
    "Howdy, {playername}.",
    "epm_a1",
    []],

  [plyr|trp_john_marvin, "epm_a1",
    [],
    "Hey, John. What was your story again?",
    "epm_a2",
    []],

  [trp_john_marvin, "epm_a2",
    [],
    "I'm a man from the country, you know. Came to El Paso a few months ago.",
    "epm_3",
    []],

  [plyr|trp_john_marvin, "epm_1",
    [],
    "Good day, sir. Do I know you?",
    "epm_2",
    []],

  [trp_john_marvin, "epm_2",
    [],
    "I don't think so. I'm a man from the country, you know. Came to El Paso a few months ago.",
    "epm_3",
    []],

  [plyr|trp_john_marvin, "epm_3",
    [],
    "Why did you leave your house there?",
    "epm_4",
    []],

  [trp_john_marvin, "epm_4",
    [],
    "Poor harvest, Comanche raiders... The city was very attractive.",
    "epm_5",
    []],

  [plyr|trp_john_marvin, "epm_5",
    [],
    "I see. So what's your profession?",
    "epm_6",
    []],

  [trp_john_marvin, "epm_6",
    [],
    "Well, I came here to open a store. Unfortunately the purchase prices of the empty houses are just too high.",
    "epm_7",
    []],

  [trp_john_marvin, "epm_7",
    [],
    "A few more months and my money reserves will all be gone.",
    "epm_8",
    []],

  [plyr|trp_john_marvin, "epm_8",
    [
      (eq, "$elpaso_house_bought", 1),
    ],
    "Actually, I have that rotten house here in El Paso. It's pretty old, but I won't ask for much money.",
    "epm_9",
    []],

  [plyr|trp_john_marvin, "epm_8",
    [],
    "I feel sorry for that. If only I could do anything about it",
    "close_window",
    []],

  [plyr|trp_john_marvin, "epm_9",
    [],
    "Are you interested in...",
    "epm_10",
    []],

  [trp_john_marvin, "epm_10",
    [
      (eq, "$john_marvin_turned_down", 2),
    ],
    "I don't think we'll find a deal. Your prices are too high",
    "close_window",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Renting it for $10 a month?",
    "epm_11a",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Renting it for $20 a month?",
    "epm_11b",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Renting it for $30 a month?",
    "epm_11c",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Renting it for $40 a month?",
    "epm_11d",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Buying it for $100?",
    "epm_11e",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Buying it for $200?",
    "epm_11f",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Buying it for $300?",
    "epm_11g",
    []],

  [plyr|trp_john_marvin, "epm_10",
    [],
    "Buying it for $400?",
    "epm_11h",
    []],

  [trp_john_marvin, "epm_11a",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You have saved my life, {reg18?ma'am:sir}.",
    "epm_sold",
    [
      (assign, "$elpaso_house_rent", 1000),
    ]],

  [trp_john_marvin, "epm_11b",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Well, that price is fair. I thank you, {reg18?ma'am:sir}.",
    "epm_sold",
    [
      (assign, "$elpaso_house_rent", 2000),
    ]],

  [trp_john_marvin, "epm_11c",
    [],
    "I can't afford that, I'm afraid.",
    "epm_9_again",
    [
      (val_add, "$john_marvin_turned_down", 1),
    ]],

  [trp_john_marvin, "epm_11d",
    [],
    "I can't afford that, I'm afraid.",
    "epm_9_again",
    [
      (val_add, "$john_marvin_turned_down", 1),
    ]],

  [trp_john_marvin, "epm_11e",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You have saved my life, {reg18?ma'am:sir}.",
    "epm_sold",
    [
      (assign, "$elpaso_house_sold", 10000),
    ]],

  [trp_john_marvin, "epm_11f",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Well, that price is fair. I thank you, {reg18?ma'am:sir}.",
    "epm_sold",
    [
      (assign, "$elpaso_house_sold", 20000),
    ]],

  [trp_john_marvin, "epm_11g",
    [],
    "I can't afford that, I'm afraid.",
    "epm_9_again",
    [
      (val_add, "$john_marvin_turned_down", 1),
    ]],

  [trp_john_marvin, "epm_11h",
    [],
    "I can't afford that, I'm afraid.",
    "epm_9_again",
    [
      (val_add, "$john_marvin_turned_down", 1),
    ]],

  [plyr|trp_john_marvin, "epm_9_again",
    [],
    "Okay, how about this...",
    "epm_10",
    []],

  [trp_john_marvin, "epm_sold",
    [
      (gt, "$elpaso_house_rent", 0),
    ],
    "Here's the first rent payment. I can only say thanks again and again.",
    "close_window",
    [
      (troop_add_gold, "trp_player", "$elpaso_house_rent"),
      (assign, "$elpaso_merch_house_given", 1),
      (troop_set_slot, "trp_john_marvin", 143, 7),
    ]],

  [trp_john_marvin, "epm_sold",
    [
      (gt, "$elpaso_house_sold", 0),
    ],
    "Here's the payment. I wish I could give you more. I can only say thanks again and again.",
    "close_window",
    [
      (troop_add_gold, "trp_player", "$elpaso_house_sold"),
      (assign, "$elpaso_merch_house_given", 1),
      (troop_set_slot, "trp_john_marvin", 143, 7),
    ]],

  [trp_john_marvin, "start",
    [],
    "Howdy, {playername}.^^Just so you know, it's alright with me if you want to store your items in my upstairs chest.^^Well, I suppose should get back to just standin' here.",
    "close_window",
    []],

  [trp_bishop_beggar, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "Hey, I ain't seen you before. Would you be s'kind as to drop a few coins?",
    "bishop_beggar_introduce_1",
    []],

  [plyr|trp_bishop_beggar, "bishop_beggar_introduce_1",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ],
    "I would, but you don't have anything to put it in. Where'd your hat go?",
    "bishop_beggar_introduce_2",
    []],

  [trp_bishop_beggar, "bishop_beggar_introduce_2",
    [],
    "Somebody must've nabbed it while I was sleepin', with all m'coins in it.",
    "bishop_beggar_introduce_3",
    []],

  [plyr|trp_bishop_beggar, "bishop_beggar_introduce_3",
    [],
    "That's a shame. I hope your luck turns back soon.",
    "bishop_beggar_introduce_4",
    []],

  [trp_bishop_beggar, "bishop_beggar_introduce_4",
    [],
    "Thanks... Anyways, my name's Jack Murphy.",
    "bishop_beggar_introduce_5",
    []],

  [plyr|trp_bishop_beggar, "bishop_beggar_introduce_5",
    [],
    "{playername}. What are you planning to do now?",
    "bishop_beggar_introduce_6",
    []],

  [trp_bishop_beggar, "bishop_beggar_introduce_6",
    [],
    "Welp, I ain't got no money left and no friends or relatives to ask for help. The only way left for me is to play my banjo in the streets and hope a passerby likes my music enough to spare a few cents... And now I ain't even got a hat for nobody to put them coins in.",
    "bishop_beggar_introduce_7",
    []],

  [plyr|trp_bishop_beggar, "bishop_beggar_introduce_7",
    [],
    "Would you gimme your banjo if I got you a brand new hat?",
    "bishop_beggar_introduce_8",
    []],

  [trp_bishop_beggar, "bishop_beggar_introduce_8",
    [],
    "Sounds like we got a deal. Make sure it's a bowler!",
    "close_window",
    []],

  [trp_bishop_beggar, "start",
    [
      (troop_has_item_equipped, "trp_bishop_beggar", "itm_bowler"),
    ],
    "Hey mister! Look at me! A brand new hat! Life is good again.",
    "bishop_beggar_donation",
    []],

  [plyr|trp_bishop_beggar, "bishop_beggar_donation",
    [
      (store_random_in_range, ":var0", 50, 150),
      (assign, reg0, ":var0"),
      (store_troop_gold, ":var1", "trp_player"),
      (ge, ":var1", reg0),
    ],
    "Good to hear, Jack. Here's {reg0} cents. Buy yourselve a drink, pal.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", reg0),
      (agent_set_animation, "$g_talk_agent", "anim_cheer"),
      (ge, reg0, 100),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
    ]],

  [plyr|trp_bishop_beggar, "bishop_beggar_donation",
    [],
    "Good for ya, Jack.",
    "close_window",
    []],

  [trp_bishop_beggar, "start",
    [],
    "Hello, {playername}. You find me a hat?",
    "bishop_beggar_bowler_2",
    []],

  [plyr|trp_bishop_beggar, "bishop_beggar_bowler_2",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 100),
    ],
    "Not yet, sorry. Would you play your banjo for me and my men for a dollar?",
    "close_window",
    [
      (agent_play_sound, "$g_talk_agent", "snd_banjo_01"),
      (troop_remove_gold, "trp_player", 100),
      (call_script, "script_change_player_party_morale", 10),
    ]],

  [plyr|trp_bishop_beggar, "bishop_beggar_bowler_2",
    [
      (player_has_item, "itm_bowler"),
    ],
    "Yeah, here it is. It was on sale... So how about that banjo?",
    "bishop_beggar_bowler_3",
    []],

  [plyr|trp_bishop_beggar, "bishop_beggar_bowler_2",
    [],
    "I'm still shopping...",
    "close_window",
    []],

  [trp_bishop_beggar, "bishop_beggar_bowler_3",
    [],
    "Thank'ye so much. Here's the banjo, like I said I was gonna. Maybe now I can buy m'self some dinner. Been a week since I last seen my hat.",
    "close_window",
    [
      (troop_remove_item, trp_player, "itm_bowler"),
      (troop_add_item, "trp_bishop_beggar", "itm_bowler"),
      (troop_add_item, "trp_player", "itm_banjo"),
      (troop_equip_items, "trp_bishop_beggar"),
      (troop_remove_item, "trp_bishop_beggar", "itm_banjo"),
    ]],

  [trp_buckskin_bill, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
    ],
    "Baaah!  What in tarnation!?!  What the hell are you doin' sneaking up a feller like that?  And what in the hell are you doin' at my cabin!?!",
    "old_cabin_welcome",
    []],

  [trp_buckskin_bill, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 118, 0),
    ],
    "Well what'dya say!  Welcome back to my humble cabin.  What can I do ya for this time?",
    "old_cabin_welcome",
    []],

  [trp_buckskin_bill, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 118, 1),
    ],
    "You got five seconds to leave my homestead 'fore I gut you out and string ya up for the vultures.  'less yer here to 'pologize, that is.",
    "old_cabin_welcome",
    []],

  [trp_buckskin_bill, "old_cabin_apology",
    [],
    "Well I spose...It wun be ver' christian of me to hol' a grudge an' all.  I just ask you don' make no fun on accoun' of this here beauty no more.  She's my best frien' in the whole worl', ya see.  Now wha's on yer mind?",
    "old_cabin_apology",
    []],

  [trp_buckskin_bill, "old_cabin_insult_1",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  You get outta her 'fore I slice yer damn eyes out!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_insult_2",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  I'll tie you up to a pole and let the coyotes yam on yer pecker!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_insult_3",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  I owe you a whuppin' for that, you whomper-jawed chucklehead!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_insult_4",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  You get outta her 'fore I string yer 'testines up fer decoration!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_insult_5",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  I'm so puckered up I could spit! Leave 'fore you get biffed!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_insult_6",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  I knew you wasn't no good, no how, you blatherin' bushwacker!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_insult_7",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  You done gone went and made me have a conniption fit! I ain't been this mad in a coon's age!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_insult_8",
    [
      (agent_set_animation, "$g_talk_agent", "anim_jump"),
      (agent_play_sound, "$g_talk_agent", "snd_man_yell"),
      (troop_set_slot, "$g_talk_troop", 118, 1),
    ],
    "Baaah!  You get outta here, you clitchy clodhopper!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_main",
    [],
    "So what is it you need from me anyhow?",
    "old_cabin_main",
    []],

  [trp_buckskin_bill, "old_cabin_introduce",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "Well slap my hat, my name's Bill!  Traders and Injuns that come thru these parts like ta call me Buckskin, but I don' rightly see why.  Mostly rabbits, lizards, and snakes 'round here these days.  See, I was the best hunter this side of the app'lachans fore I went an got old.  I bul't this here cabin wit my own two han's, an' I intend to die out here, but I didn't inen' for the game to up and dis'peer.  So I S'pose I culd use sum help.",
    "old_cabin_introduce",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [trp_buckskin_bill, "old_cabin_introduce",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
    ],
    "Like I said last time, the name's Bill.  Traders and Injuns that come thru these parts like ta call me Buckskin, but I don' rightly see why.  Mostly rabbits, lizards, and snakes 'round here these days.  See, I was the best hunter this side of the app'lachans fore I went an got old.  I bul't this here cabin wit my own two han's, an' I intend to die out here, but I didn't inen' for the game to up and dis'peer.  So I S'pose I culd use sum help.",
    "old_cabin_introduce",
    []],

  [trp_buckskin_bill, "old_cabin_introduce_2",
    [],
    "Haaawwhaahaww!  That's a good one!  I think I'm startin' ta like you afterall.  Say, how would you like to learn somethin from Ol' Buckskin?",
    "old_cabin_introduce_2",
    []],

  [trp_buckskin_bill, "old_cabin_welcome_2",
    [],
    "Haaawwhaahaww!  You know it!  Don' be a strang'r now!",
    "close_window",
    []],

  [trp_buckskin_bill, "old_cabin_cabin",
    [],
    "Well this beauty right here was made with my own two han's!  Yessir, my pa was a carpen'tr 'fore he died, an' he said I'd nev'r cut it in the profeshun, but I don show'd 'im! Yeehaaah! I recon I buil' a nice 'nuff cabin to live out the rest a my days.  I'm still workin' ta get it ready for the col' winters we get out in these parts though.",
    "old_cabin_cabin",
    []],

  [trp_buckskin_bill, "old_cabin_training",
    [],
    "Well ain't that nice ta see?  A young feller like you takin' int'rst in sumpin' useful!  Now I don' know iffun I mentioned it, but I'm the best hunter west o' the app'lachans!  Now that I think of it, I reckon I'm the best homesteader too.  An' very likely the best overall outdoorsman to boot.  Not only that, but also...the most handsome, intell'gint, beliked, and modest pardner yer likely ta meet.",
    "old_cabin_training",
    []],

  [trp_buckskin_bill, "old_cabin_training_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 22, 10),
    ],
    "Hardly!  But I better get to the point... I don't reckun I like you 'nuff to pass on all my useful knowledge quite yet.  I don' know what it is, but there's jus' som'pin 'bout you that I don' like.  Maybe it's that crazy eye a yers.  But we can still be nay'berly anyhow.",
    "old_cabin_main",
    []],

  [trp_buckskin_bill, "old_cabin_training_2",
    [
      (troop_slot_ge, "$g_talk_troop", 22, 10),
    ],
    "Hardly!  But I better get to the point... You an' I get along all right.  I'm an expert in all matter of survival skils, but I speshalize in Trail Blazin', Spottin', and Trackin'.  Now I can only teach ya so much, an I sure ain't tellin' ya all of it at once!  Now whadda ya wanna learn, young whippersnapper?",
    "old_cabin_training_3",
    []],

  [trp_buckskin_bill, "old_cabin_training_spotting",
    [
      (store_skill_level, ":var0", "skl_spotting", "trp_player"),
      (eq, 10, ":var0"),
    ],
    "You an' I both know you don' need no more help learnin' spottin'!  Now ask me somethin' else.",
    "old_cabin_training_3",
    []],

  [trp_buckskin_bill, "old_cabin_training_spotting",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (assign, ":var0", 0),
      (store_mul, ":var0", 10, "$g_talk_troop_debt"),
      (store_add, ":var0", ":var0", 10),
      (ge, "$g_talk_troop_relation", ":var0"),
    ],
    "Oh yeah, spottin'!  Always knew you had the eye for it! Heh Heh Heeeeeeh!  Anyways, the thing you needs to know 'bout spottin' is that it's all 'bout knowin' where ta look.  Ya know, this one time.....",
    "old_cabin_training_spotting_2",
    []],

  [trp_buckskin_bill, "old_cabin_training_spotting",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (assign, ":var0", 0),
      (store_mul, ":var0", 10, "$g_talk_troop_debt"),
      (store_add, ":var0", ":var0", 10),
      (lt, "$g_talk_troop_relation", ":var0"),
    ],
    "Well come ta think of it, I don' think I outta teach you no more until you do some more work fer me.  Now ask me somethin' else.",
    "old_cabin_training_3",
    []],

  [trp_buckskin_bill, "old_cabin_training_spotting_3",
    [],
    "...an' then the little bastard I caught, he starts talkin' Apache ta me an' Charlie, but we couldn' understand him on account a the di'lect.  See, Charlie only speaks Western Apache, and I tried ta tell 'im.......",
    "old_cabin_training_spotting_4",
    []],

  [trp_buckskin_bill, "old_cabin_training_spotting_5",
    [],
    "...and if'n yer mighty careful, you can snatch one a them slippery buggers after dark, but it takes a patient man ta do it.  Say, that reminds me of the time I pulled down an eagle with my lasso.  So back in the forties....",
    "old_cabin_training_spotting_6",
    []],

  [trp_buckskin_bill, "old_cabin_training_spotting_7",
    [],
    "...but just remember to always check yer seat fer cactii for ya go sittin' down.  Well, I reckon that's all I have ta teach ya about spottin' fer now.  ",
    "old_cabin_training_finished",
    [
      (troop_raise_skill, "trp_player", skl_spotting, 1),
      (display_message, "@Your spotting skill has improved."),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (store_add, "$g_talk_troop_debt", "$g_talk_troop_debt", 1),
      (troop_set_slot, "$g_talk_troop", 21, "$g_talk_troop_debt"),
    ]],

  [trp_buckskin_bill, "old_cabin_training_trail",
    [
      (store_skill_level, ":var0", "skl_pathfinding", "trp_player"),
      (eq, 10, ":var0"),
    ],
    "You an' I both know you don' need no more help learnin' trail blazin'!  Now ask me somethin' else.",
    "old_cabin_training_3",
    []],

  [trp_buckskin_bill, "old_cabin_training_trail",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (assign, ":var0", 0),
      (store_mul, ":var0", 10, "$g_talk_troop_debt"),
      (store_add, ":var0", ":var0", 10),
      (ge, "$g_talk_troop_relation", ":var0"),
    ],
    "Oh yeah, trail blazin'!  Always knew you had too many beans in yer ass! Heh Heh Heeeeeeh!  Anyways, the thing you needs to know 'bout trail blazin' is that it's all 'bout findin' the shortest route.  Ya know, this one time.....",
    "old_cabin_training_trail_2",
    []],

  [trp_buckskin_bill, "old_cabin_training_trail",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (assign, ":var0", 0),
      (store_mul, ":var0", 10, "$g_talk_troop_debt"),
      (store_add, ":var0", ":var0", 10),
      (lt, "$g_talk_troop_relation", ":var0"),
    ],
    "Well come ta think of it, I don' think I outta teach you no more until you do some more work fer me.  Now ask me somethin' else.",
    "old_cabin_training_3",
    []],

  [trp_buckskin_bill, "old_cabin_training_trail_3",
    [],
    "...an' then I saw him hidin' round the corner, but I had no way a shootin' him.  So I aimed carefully at his horses' ass, and squeezed off a round.  BAM!  That donkey kicked him so hard that he.......",
    "old_cabin_training_trail_4",
    []],

  [trp_buckskin_bill, "old_cabin_training_trail_5",
    [],
    "...which really makes fer some tasty eatin' when you ain't got time fer a proper sit down camp meal, or if yer cook got made into a pin cushin by them damn Comanches.  You know, it wouldn't be the first time that I....",
    "old_cabin_training_trail_6",
    []],

  [trp_buckskin_bill, "old_cabin_training_trail_7",
    [],
    "...cause yer either gonna get sick, or yer gonna get dead.  Well, I reckon that's all I have ta teach ya about trail blazin' fer now.  ",
    "old_cabin_training_finished",
    [
      (troop_raise_skill, "trp_player", skl_pathfinding, 1),
      (display_message, "@Your trail blazing skill has improved."),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (store_add, "$g_talk_troop_debt", "$g_talk_troop_debt", 1),
      (troop_set_slot, "$g_talk_troop", 21, "$g_talk_troop_debt"),
    ]],

  [trp_buckskin_bill, "old_cabin_training_tracking",
    [
      (store_skill_level, ":var0", "skl_tracking", "trp_player"),
      (eq, 10, ":var0"),
    ],
    "You an' I both know you don' need no more help learnin' trackin'!  Now ask me somethin' else.",
    "old_cabin_training_3",
    []],

  [trp_buckskin_bill, "old_cabin_training_tracking",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (assign, ":var0", 0),
      (store_mul, ":var0", 10, "$g_talk_troop_debt"),
      (store_add, ":var0", ":var0", 10),
      (ge, "$g_talk_troop_relation", ":var0"),
    ],
    "Oh yeah, tracking'!  Always knew you wanted ta have yer head in the sand! Heh Heh Heeeeeeh!  Anyways, the thing you needs to know 'bout trackin' is that it's all 'bout knowin' yer land, an' knowin' yer prey.  Ya know, this one time.....",
    "old_cabin_training_tracking_2",
    []],

  [trp_buckskin_bill, "old_cabin_training_tracking",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (assign, ":var0", 0),
      (store_mul, ":var0", 10, "$g_talk_troop_debt"),
      (store_add, ":var0", ":var0", 10),
      (lt, "$g_talk_troop_relation", ":var0"),
    ],
    "Well come ta think of it, I don' think I outta teach you no more until you do some more work fer me.  Now ask me somethin' else.",
    "old_cabin_training_3",
    []],

  [trp_buckskin_bill, "old_cabin_training_tracking_3",
    [],
    "...so he says 'Are ya gonna skin that smoke wagon or whistle dixie?'  So as he wen't fer his gun,  I quick grabbed my axe and clanked 'im over the head.  But I hit 'im so hard that his gun goes off and blasts a hole right through his boot.......",
    "old_cabin_training_tracking_4",
    []],

  [trp_buckskin_bill, "old_cabin_training_tracking_5",
    [],
    "...an' sally was always such a purty lady, but I jus' couldn' father no more children by her seein that she was my first cousin an' all.  And that she was already raisin' my brother's kids too.  So I started payin' more 'tention to the phases of the moon....",
    "old_cabin_training_tracking_6",
    []],

  [trp_buckskin_bill, "old_cabin_training_tracking_7",
    [],
    "....and the worst part is, I never even learned ta read.  Well, I reckon that's all I have ta teach ya about trackin' fer now.  ",
    "old_cabin_training_finished",
    [
      (troop_raise_skill, "trp_player", skl_tracking, 1),
      (display_message, "@Your tracking skill has improved."),
      (troop_get_slot, "$g_talk_troop_debt", "$g_talk_troop", 21),
      (store_add, "$g_talk_troop_debt", "$g_talk_troop_debt", 1),
      (troop_set_slot, "$g_talk_troop", 21, "$g_talk_troop_debt"),
    ]],

  [trp_buckskin_bill, "old_cabin_jobs",
    [
      (neg|check_quest_succeeded, "qst_buckskin_booze"),
    ],
    "Eureka!  Well I got lots for ya to do 'round here.  Now right now I need deer hides and booze.  The hides I trade to the indians for maize, and the booze...well, I use that when I work on my cabin.  I hope you need firewood, cause that's all I got to trade with.  Maybe if I get to like ya 'nuff, I'll teach ya a thing or two someday.  Now how's about you go an' shake up some of this stuff for me?",
    "old_cabin_jobs_2",
    []],

  [trp_buckskin_bill, "old_cabin_jobs",
    [
      (check_quest_succeeded, "qst_buckskin_booze"),
    ],
    "What are you talkin' about buddy?  Your days of workin' for ol' Buckskin are over!  You got me ever'thing I ever needed! Now whaddaya need?",
    "old_cabin_main",
    []],

  [trp_buckskin_bill, "old_cabin_job_complete_2",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (lt, "$g_talk_troop_relation", 100),
    ],
    "Don' mention it.  Now whaddaya need?",
    "old_cabin_main",
    []],

  [trp_buckskin_bill, "old_cabin_job_complete_2",
    [
      (troop_get_slot, "$g_talk_troop_relation", "$g_talk_troop", 22),
      (ge, "$g_talk_troop_relation", 100),
    ],
    "Don' mention it.  Now look at this! You got me ever'thing I need and made me one happy fella! You are justa 'bout the best frien' I ev'r had! I'll still train ya, but you ain't workin for me no more, ol' buddy! Put 'er there Pal!",
    "old_cabin_main",
    [
      (call_script, "script_succeed_quest", "qst_buckskin_deerhides", 100),
      (call_script, "script_finish_quest", "qst_buckskin_deerhides", 100),
      (call_script, "script_succeed_quest", "qst_buckskin_booze", 100),
      (call_script, "script_finish_quest", "qst_buckskin_booze", 100),
    ]],

  [trp_buckskin_bill, "old_cabin_job_deerhides",
    [],
    "Well lets see now...I need deer hides fer tradin', and I don' care iffun you kill 'em or buy 'em.  Fer eve'ry five deer hides ya bring me, I'll give you a stack of firewood.  Whadda ya say?",
    "old_cabin_job_deerhides_2",
    []],

  [trp_buckskin_bill, "old_cabin_job_deerhides_3",
    [],
    "Pay Dirt!  Now bring me the deer hides when ya gets at least five of 'em!  Now what else are ya needin'?",
    "old_cabin_main",
    [
      (quest_set_slot, "qst_buckskin_deerhides", 23, 0),
      (setup_quest_text, "qst_buckskin_deerhides"),
      (str_store_string, s2, "@Buckskin Bill needs deer hides to trade to passing indians.  For every five deer hides you bring him, you will recieve a pile of firewood.  Probably not the smartest deal you've ever made.  "),
      (call_script, "script_start_quest", "qst_buckskin_deerhides", "trp_buckskin_bill"),
    ]],

  [trp_buckskin_bill, "old_cabin_job_deerhides_cancel",
    [
      (call_script, "script_cancel_quest", "qst_buckskin_deerhides"),
    ],
    "Damn. I really need ta find a way to get those hides.  I can't get 'em myself anymore on account of my age.  Now what else do ya need?",
    "old_cabin_main",
    []],

  [trp_buckskin_bill, "old_cabin_job_deerhides_complete",
    [
      (call_script, "script_change_player_honor", 1),
      (call_script, "script_change_player_relation_with_troop", "trp_buckskin_bill", 5),
      (complete_quest, "qst_buckskin_deerhides"),
    ],
    "Alright!  Pretty soon I'll have enough ta buy myself a squaw!  And five deer hides buys ya a pile of your own firewood!  Enjoy!",
    "old_cabin_job_complete",
    [
      (agent_set_animation, "$g_talk_agent", "anim_cheer"),
      (agent_play_sound, "$g_talk_agent", "snd_man_victory"),
      (troop_remove_items, "trp_player", "itm_deer_hide", 5),
      (troop_add_items, "trp_player", "itm_fire_wood", 1),
      (add_xp_as_reward, 300),
    ]],

  [trp_buckskin_bill, "old_cabin_job_booze",
    [],
    "Booze!  Now that's the ticket!  I can't repair my cabin without it!  Now, I only drink whiskey, an' don' bring me none a that cheap shit.  Fer eve'ry five bottles of whiskey ya bring me, I'll give you a stack of firewood.  Whadda ya say?",
    "old_cabin_job_booze_2",
    []],

  [trp_buckskin_bill, "old_cabin_job_booze_3",
    [],
    "Hot Diggity!  Now bring me the booze when ya gets at least five of 'em!  Now what else are ya needin'?",
    "old_cabin_main",
    [
      (quest_set_slot, "qst_buckskin_booze", 23, 0),
      (setup_quest_text, "qst_buckskin_booze"),
      (str_store_string, s2, "@Buckskin Bill needs whiskey to keep working on his cabin.  For every five bottles of whiskey you bring him, you will recieve a for a pile of firewood.  Looking back on this, you think this deal may have been a mistake."),
      (call_script, "script_start_quest", "qst_buckskin_booze", "trp_buckskin_bill"),
    ]],

  [trp_buckskin_bill, "old_cabin_job_booze_cancel",
    [
      (call_script, "script_cancel_quest", "qst_buckskin_booze"),
    ],
    "Damn. I was lookin' forward to fixin' up ma cabin.  Well, at least you didn't make fun of it this time.  Now what else do ya need?",
    "old_cabin_main",
    []],

  [trp_buckskin_bill, "old_cabin_job_booze_complete",
    [
      (call_script, "script_change_player_honor", 1),
      (call_script, "script_change_player_relation_with_troop", "trp_buckskin_bill", 5),
      (complete_quest, "qst_buckskin_booze"),
    ],
    "Alright!  Pretty soon I'll have enough ta build myself a porch!  And five whiskeys buys ya a pile of your own firewood!  Don' spend it all in one place now!",
    "old_cabin_job_complete",
    [
      (agent_set_animation, "$g_talk_agent", "anim_cheer"),
      (agent_play_sound, "$g_talk_agent", "snd_man_victory"),
      (troop_remove_items, "trp_player", "itm_wine", 5),
      (troop_add_items, "trp_player", "itm_fire_wood", 1),
      (add_xp_as_reward, 300),
    ]],

  [plyr|trp_buckskin_bill, "old_cabin_welcome",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "I meant no harm...just passing by and saw your cabin.  Nice little place you got here.  I didn't catch your name though.",
    "old_cabin_introduce",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_welcome",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "You call this a cabin?  I've seen sturdier stacks of cow piles.  I'm leaving before it falls and kills us all!",
    "old_cabin_insult_1",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [plyr|trp_buckskin_bill, "old_cabin_welcome",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 118, 0),
    ],
    "Aw, shucks Bill.  Now let's talk buisness.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_welcome",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 118, 0),
    ],
    "Aw, shucks Bill.  Did I mention that your cabin is a rickety pile of rotten sticks?",
    "old_cabin_insult_2",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_welcome",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 118, 0),
    ],
    "Aw, shucks Bill.  I'd hug you, but I'm afraid I'd die from the smell and end up on your wall.  Later!",
    "old_cabin_welcome_2",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_welcome",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 118, 1),
    ],
    "Well Bill, you're right.  What I said was wrong and I apologize.",
    "old_cabin_apology",
    [
      (troop_set_slot, "$g_talk_troop", 118, 0),
    ]],

  [plyr|trp_buckskin_bill, "old_cabin_welcome",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 118, 1),
    ],
    "Apologize?!  I mean what I said you wiley-eyed coot.  Now I'm out of here.",
    "close_window",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_apology",
    [],
    "Well Bill, I was just wondering how you kept something built worse than a beaver dam from falling over for so long?  Did you use glue?",
    "old_cabin_insult_3",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_apology",
    [],
    "That's very kind of you Bill.  I'm glad we could sort that out.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_main",
    [],
    "I need to know about you, Bill",
    "old_cabin_introduce",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_main",
    [],
    "I need to know about your cabin, Bill",
    "old_cabin_cabin",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_main",
    [],
    "I need to know about a job, Bill",
    "old_cabin_jobs",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_main",
    [],
    "I need to know what you can teach me, Bill",
    "old_cabin_training",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_main",
    [],
    "I need to know how you did such a bad job on this cabin with adequate materials and a lifetime of knowledge.  Did you only use one arm?",
    "old_cabin_insult_4",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_main",
    [],
    "I need to go, Bill.  Bye.",
    "close_window",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_introduce",
    [],
    "Downright fascinating stuff, Bill.  Where'd you dig up that worm-ridden log pile behind you?",
    "old_cabin_insult_5",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_introduce",
    [],
    "Damn Bill.  Your beard's so thick that it sounds like your head is wrapped in fur.  Maybe that's why they call you Buckskin.",
    "old_cabin_introduce_2",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_introduce",
    [],
    "Downright fascinating stuff, Bill.  Let's talk about business.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_introduce_2",
    [],
    "Sure, as long as it's got nothing to do with beards.  What can you teach me?",
    "old_cabin_training",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_introduce_2",
    [],
    "Thanks, but no thanks.  Let's talk about business.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_introduce_2",
    [],
    "Naw, I'm a busy person.  Places to see, people to kill... Bye Bill.",
    "close_window",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_cabin",
    [],
    "I'm sure if your father was still alive and he saw this travesty, you'd end up having to bury him next to it anyway.",
    "old_cabin_insult_6",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_cabin",
    [],
    "Err..yep..quite a beauty, she is.  Let's talk more about business.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training",
    [],
    "Wow Buckskin....Is that all?",
    "old_cabin_training_2",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_3",
    [],
    "Teach me about Spotting.",
    "old_cabin_training_spotting",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_3",
    [],
    "Teach me about Trail Blazing.",
    "old_cabin_training_trail",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_3",
    [],
    "Teach me about Tracking.",
    "old_cabin_training_tracking",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_3",
    [],
    "Gee Bill, I'd really rather learn about carpentry.  Teach me how NOT to build a cabin.",
    "old_cabin_insult_7",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_3",
    [],
    "Let me ask you about something else, Bill.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_3",
    [],
    "Actually, you've been jawin' on for so much time that I gotta get some shuteye.  Later, Buckskin.",
    "close_window",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_spotting_2",
    [],
    "..............",
    "old_cabin_training_spotting_3",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_spotting_4",
    [],
    "..............",
    "old_cabin_training_spotting_5",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_spotting_6",
    [],
    "..............",
    "old_cabin_training_spotting_7",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_trail_2",
    [],
    "..............",
    "old_cabin_training_trail_3",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_trail_4",
    [],
    "..............",
    "old_cabin_training_trail_5",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_trail_6",
    [],
    "..............",
    "old_cabin_training_trail_7",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_tracking_2",
    [],
    "..............",
    "old_cabin_training_tracking_3",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_tracking_4",
    [],
    "..............",
    "old_cabin_training_tracking_5",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_tracking_6",
    [],
    "..............",
    "old_cabin_training_tracking_7",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_finished",
    [],
    "Whoa, I blacked out for a while there.  Let me ask you about something else.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_finished",
    [],
    "Great story Buckskin!  Let me ask you more about training.",
    "old_cabin_training",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_training_finished",
    [],
    "Excuse me, but I have to go stop the bleeding in my ears now.  With a bullet.  Goodbye.",
    "close_window",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_job_complete",
    [],
    "Uh, yeah.. more firewood.  Um, thanks?",
    "old_cabin_job_complete_2",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [
      (neg|check_quest_active, "qst_buckskin_deerhides"),
    ],
    "Tell me about the deer hides.",
    "old_cabin_job_deerhides",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [
      (check_quest_active, "qst_buckskin_deerhides"),
      (call_script, "script_get_troop_item_amount", "trp_player", "itm_deer_hide"),
      (ge, reg0, 5),
    ],
    "Here you go, Bill.  Five deer hides as promised.",
    "old_cabin_job_deerhides_complete",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [
      (check_quest_active, "qst_buckskin_deerhides"),
    ],
    "Yeah, about those deer hides...The deal's off.",
    "old_cabin_job_deerhides_cancel",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [
      (neg|check_quest_active, "qst_buckskin_booze"),
    ],
    "Tell me about the booze.",
    "old_cabin_job_booze",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [
      (check_quest_active, "qst_buckskin_booze"),
      (call_script, "script_get_troop_item_amount", "trp_player", "itm_wine"),
      (ge, reg0, 5),
    ],
    "Here you go, Bill.  Five whiskeys as promised.",
    "old_cabin_job_booze_complete",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [
      (check_quest_active, "qst_buckskin_booze"),
    ],
    "Yeah, about that booze...The deal's off.",
    "old_cabin_job_booze_cancel",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [],
    "Wait...Did I just hear you say you need to be drunk to work on your cabin?  This explains so much, Bill.",
    "old_cabin_insult_8",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_jobs_2",
    [],
    "On second thought, tell me about something else.",
    "old_cabin_main",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_job_deerhides_2",
    [],
    "You got yourself a deal, Bill.",
    "old_cabin_job_deerhides_3",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_job_deerhides_2",
    [],
    "Not a chance, Bill.  What other jobs have you got?",
    "old_cabin_jobs",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_job_deerhides_2",
    [],
    "Not a chance, Bill.  I'm leavin.",
    "close_window",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_job_booze_2",
    [],
    "You got yourself a deal, Bill.",
    "old_cabin_job_booze_3",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_job_booze_2",
    [],
    "Not a chance, Bill.  What other jobs have you got?",
    "old_cabin_jobs",
    []],

  [plyr|trp_buckskin_bill, "old_cabin_job_booze_2",
    [],
    "Not a chance, Bill.  I'm leavin.",
    "close_window",
    []],

  [trp_cottonwood_undertaker, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Well good day {reg18?ma'am:sir}. You're quite a {reg18?cute thing:big fellow} aren't ya. May I take your measurements?",
    "cottonwood_undertaker_introduce_1",
    []],

  [trp_cottonwood_undertaker, "start",
    [
      (neg|check_quest_concluded, "qst_billy_barrett"),
      (check_quest_active, "qst_billy_barrett"),
      (troop_slot_eq, "$g_talk_troop", 80, 1),
    ],
    "Good to see you back here, boy. What have you got for me?",
    "cottonwood_undertaker_back_1",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_back_1",
    [
      (quest_slot_eq, "qst_billy_barrett", 11, 5),
      (neg|check_quest_concluded, "qst_billy_barrett"),
      (quest_get_slot, reg1, "qst_billy_barrett", 22),
      (call_script, "script_game_get_money_text", reg1),
    ],
    "Mr. Barrett paid me {s1}. Here's half of it.",
    "cottonwood_undertaker_back_2",
    [
      (quest_get_slot, ":var0", "qst_billy_barrett", 22),
      (val_div, ":var0", 2),
      (troop_remove_gold, "trp_player", ":var0"),
    ]],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_back_2",
    [],
    "Thanks boy. I'll make sure to get you one of my best coffins if you run into Death soon.",
    "cottonwood_undertaker_back_3",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_back_3",
    [],
    "Yeah sure. Not soon, not likely.",
    "close_window",
    [
      (str_store_string, s2, "@Quest successfully completed."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 7, s2, 0),
      (succeed_quest, "qst_billy_barrett"),
      (call_script, "script_end_quest", "qst_billy_barrett"),
    ]],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_back_1",
    [],
    "Nothing, yet.",
    "close_window",
    []],

  [trp_cottonwood_undertaker, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (check_quest_concluded, "qst_billy_barrett"),
    ],
    "You are still alive? Tell me in case you plan to die any time soon. I've got a lot to do currently.",
    "close_window",
    []],

  [trp_cottonwood_undertaker, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (neg|check_quest_concluded, "qst_billy_barrett"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "What's the matter, {reg18?ma'am:sir}? Are you interested in a job now?",
    "cottonwood_undertaker_introduce_3",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_1",
    [],
    "What the! Get your hands off me you little maggot. Before I drop you in one of your own coffins!",
    "cottonwood_undertaker_introduce_2a",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_1",
    [],
    "Well, I'm not really sure... Why? I mean... Do you think I'll be dead soon?",
    "cottonwood_undertaker_introduce_2b",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_1",
    [],
    "Sure, go ahead. You'll probably see me a bit stiffer than I am now soon enough...",
    "cottonwood_undertaker_introduce_2c",
    []],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_2a",
    [],
    "Alright, alright. I'm sorry. You may be a bit tougher than I thought after all. In that case, I have a job for you.",
    "cottonwood_undertaker_introduce_3",
    []],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_2b",
    [],
    "We all die sooner or later. You might as well make a little money before you do. Would you be interested in some honest labor?",
    "cottonwood_undertaker_introduce_3",
    []],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_2c",
    [],
    "You don't sound too cheery. Seems I'll be having work on you soon. Would you like to help me out before you pass away in return for one of my top line coffins?",
    "cottonwood_undertaker_introduce_3",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_3",
    [],
    "Tell me, what is it?",
    "cottonwood_undertaker_introduce_4",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_3",
    [],
    "Nah, thanks. I'm not interested you creep.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_4",
    [],
    "Did you see young Billy Barrett when you entered town? He walked into some flying lead after he had tried to walk away without paying for his Whisky in the saloon. It's always nice to have some extra business of those you didn't expect yet. Anyway, I made him that fine casket, but his old man won't pay for it. Says he won't pay until his son has had a decent burial. Can't have that now, can I? I want my money, but the Sheriff wants to use Billy's body as an example to others.",
    "cottonwood_undertaker_introduce_5",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_5",
    [],
    "What do you want me to do?",
    "cottonwood_undertaker_introduce_6a",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_5",
    [],
    "And you want me to 'convince' the poor man to pay up?",
    "cottonwood_undertaker_introduce_6b",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_5",
    [],
    "The man's got some guts. Raising his son to become no-good scum and expecting him to be treated right too.",
    "cottonwood_undertaker_introduce_6c",
    []],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_6a",
    [],
    "Well perhaps you and your friend Colt there could talk the old man into paying. I've got a business to run here, you see. I'll give you half of what you can get as a reward. You can find the man in town. What do you say?",
    "cottonwood_undertaker_introduce_7a",
    []],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_6b",
    [],
    "Your wits will take you far, son. That's exactly what I'd like you to do. You can find the old man in town. I'll give you half of what you can get from him as a reward. What do you say?",
    "cottonwood_undertaker_introduce_7a",
    []],

  [trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_6c",
    [],
    "That's what I say. But unfortunately the Sheriff don't agree. Or I would have had my money already. But now you can get me the money. Find the old man in town and try to get as much as you can from him. You can keep half of it in return.",
    "cottonwood_undertaker_introduce_3",
    []],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_7a",
    [],
    "Looks like you've got yourself a deal, good man. I'll be back in no time.",
    "close_window",
    [
      (setup_quest_text, "qst_billy_barrett"),
      (str_store_string, s2, "@Mr. Barrett in Cottonwood owes the undertaker money. Talk to him and solve this issue."),
      (call_script, "script_start_quest", "qst_billy_barrett", "trp_cottonwood_undertaker"),
    ]],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_7a",
    [],
    "I will have nothing to do with that. In fact, I think you're half rotten yourself. Go to hell!",
    "close_window",
    [
      (setup_quest_text, "qst_billy_barrett"),
      (str_store_string, s2, "@Mr. Barrett in Cottonwood owes the undertaker money. Talk to him and solve this issue."),
      (call_script, "script_start_quest", "qst_billy_barrett", "trp_cottonwood_undertaker"),
    ]],

  [plyr|trp_cottonwood_undertaker, "cottonwood_undertaker_introduce_7a",
    [],
    "On second thought, I think the poor man's been punished enough. You can take care of your own business",
    "close_window",
    [
      (setup_quest_text, "qst_billy_barrett"),
      (str_store_string, s2, "@Mr. Barrett in Cottonwood owes the undertaker money. Talk to him and solve this issue."),
      (call_script, "script_start_quest", "qst_billy_barrett", "trp_cottonwood_undertaker"),
    ]],

  [trp_barrett, "start",
    [
      (neg|check_quest_concluded, "qst_billy_barrett"),
      (check_quest_active, "qst_billy_barrett"),
      (quest_slot_ge, "qst_billy_barrett", 11, 1),
    ],
    "Good to see you back here, son. Any news?",
    "barrett_introduce_b_1",
    []],

  [trp_barrett, "start",
    [
      (neg|check_quest_failed, "qst_billy_barrett"),
      (neg|quest_slot_eq, "qst_billy_barrett", 11, 1),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "What do you want young {reg18?lady:man}?",
    "barrett_introduce_1",
    []],

  [plyr|trp_barrett, "barrett_introduce_1",
    [
      (neg|check_quest_concluded, "qst_billy_barrett"),
      (check_quest_active, "qst_billy_barrett"),
      (neg|quest_slot_eq, "qst_billy_barrett", 11, 1),
    ],
    "I'm here on behalf of the town's undertaker. He says you owe him money.",
    "barrett_introduce_2",
    []],

  [plyr|trp_barrett, "barrett_introduce_1",
    [
      (neg|check_quest_concluded, "qst_billy_barrett"),
      (check_quest_active, "qst_billy_barrett"),
      (neg|quest_slot_eq, "qst_billy_barrett", 11, 1),
    ],
    "Hello, sir. Are you Mr. Barrett? I hear your son's body is at the edge of town. The undertaker says you owe him money and asked me to get it for him. But I refused. Is there anything I can do to help you?.",
    "barrett_introduce_1b",
    []],

  [plyr|trp_barrett, "barrett_introduce_1",
    [],
    "Nothing.",
    "barrett_introduce_1c",
    []],

  [trp_barrett, "barrett_introduce_1c",
    [],
    "Then leave me alone. I'm in mourning.",
    "close_window",
    []],

  [trp_barrett, "barrett_introduce_1b",
    [],
    "You're a good kid, you know that. There is something you can do. My son may have tried to not pay for his Whisky, but he was not a bad boy and he was my son. It's beyond words what it does to a man to know his son is dead and his body is used, without any dignity or respect. Could you speak to the Sheriff about getting my son a decent burial?",
    "barrett_introduce_1b2",
    []],

  [plyr|trp_barrett, "barrett_introduce_1b2",
    [],
    "Alright, sir. I'll do that. I'll be back soon with the Sheriff's permission.",
    "close_window",
    [
      (setup_quest_text, "qst_billy_barrett"),
      (str_store_string, s2, "@You offered Mr. Barrett to speak to the sheriff about Billy's corpse."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 3, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 1),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_barrett, "start",
    [
      (check_quest_failed, "qst_billy_barrett"),
    ],
    "Get out of my face, you son of a bitch.",
    "barrett_introduce_1",
    []],

  [plyr|trp_barrett, "barrett_introduce_b_1",
    [
      (quest_slot_eq, "qst_billy_barrett", 11, 4),
    ],
    "Yes, sir! Good news even. The Sheriff will let you take Billy's body and bury it. I hope it'll get you some closure.",
    "barrett_introduce_b_2",
    []],

  [plyr|trp_barrett, "barrett_introduce_b_1",
    [],
    "Not, yet, sorry.",
    "close_window",
    []],

  [trp_barrett, "barrett_introduce_b_2",
    [],
    "That's great! Thank you my boy. Now, here's 8 dollars for that undertaker. And another 8 for yourself. It's nearly all I have, but it's worth it to me. You did me a darn good favor!",
    "barrett_introduce_b_3",
    [
      (assign, "$billy_barretts_body_replaced", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (troop_add_gold, "trp_player", 1600),
      (quest_set_slot, "qst_billy_barrett", 22, 1600),
      (str_store_string, s2, "@Return to the undertaker."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 6, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 5),
      (display_message, "str_quest_log_updated"),
    ]],

  [plyr|trp_barrett, "barrett_introduce_b_3",
    [],
    "Happy to have helped you, Mr. Barrett. So long.",
    "close_window",
    []],

  [trp_barrett, "barrett_introduce_2",
    [],
    "That filthy maggot. Always preying on the dead. He will have none of my money I'll tell you!",
    "barrett_introduce_3",
    []],

  [plyr|trp_barrett, "barrett_introduce_3",
    [],
    "Now c'mon mister. I wouldn't want to ask my friend Colt to convince you. You see, Colt can get real angry. And when he gets angry, he starts spitting. And then, people die.",
    "barrett_introduce_4a",
    []],

  [plyr|trp_barrett, "barrett_introduce_3",
    [],
    "Now, hold on a second Mr. Barrett. If you pay me now, I will see what I can do to get your son a decent burial. I will speak to the Sheriff for you I will.",
    "barrett_introduce_4b",
    []],

  [plyr|trp_barrett, "barrett_introduce_3",
    [],
    "I'm sorry Mr. Barrett. You are right. I feel quite ashamed for having taken that snake's work. Is there anything I can do to help you?",
    "barrett_introduce_4c",
    []],

  [trp_barrett, "barrett_introduce_4a",
    [
      (store_proficiency_level, ":var0", "trp_player", wpt_firearm),
      (gt, ":var0", 150),
    ],
    "Alright, alright. I'll pay. Here's 8 dollars. It's all I have left.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_center", "$current_town", -2),
      (troop_add_gold, "trp_player", 800),
      (quest_set_slot, "qst_billy_barrett", 22, 800),
      (str_store_string, s2, "@Return to the undertaker."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 6, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 5),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_barrett, "barrett_introduce_4a",
    [
      (store_proficiency_level, ":var0", "trp_player", wpt_firearm),
      (le, ":var0", 150),
    ],
    "Hah, you look like you couldn't even hit your own feet. Have that Colt guy do his worst!",
    "close_window",
    [
      (assign, "$duel", 2),
      (assign, "$duel_partner", "trp_barrett"),
      (assign, "$duel_quest", "qst_billy_barrett"),
      (assign, "$duel_reward", 8),
    ]],

  [trp_barrett, "barrett_introduce_4b",
    [
      (store_attribute_level, ":var0", "trp_player", ca_charisma),
      (gt, ":var0", 9),
    ],
    "Alright, you may be right. All my stubbornness is not getting my son back or his body treated with respect. Here is 10 dollars. That should cover it.",
    "close_window",
    [
      (troop_add_gold, "trp_player", 1000),
      (quest_set_slot, "qst_billy_barrett", 22, 1000),
      (str_store_string, s2, "@You offered Mr. Barrett to speak to the sheriff about Billy's corpse."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 3, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 1),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_barrett, "barrett_introduce_4b",
    [
      (store_attribute_level, ":var0", "trp_player", ca_charisma),
      (le, ":var0", 9),
    ],
    "You're just a lowlife you know that. I'm not going to give you shit.",
    "barrett_introduce_3",
    []],

  [trp_barrett, "barrett_introduce_4c",
    [],
    "There is, actually. Could you speak to the Sheriff about getting my son a decent burial? He may have tried to not pay for his Whisky, but he was not a bad boy and he was my son. It's beyond words what it does to a man to know his son is dead and his body is used, without any dignity or respect. After that I'll be glad to pay the undertaker.",
    "barrett_introduce_5",
    []],

  [trp_barrett, "barrett_introduce_5",
    [],
    "Alright, Mr. Barrett. I will get it done. Just hold on for a bit longer. I'll be back.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (str_store_string, s2, "@You offered Mr. Barrett to speak to the sheriff about Billy's corpse."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 3, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 1),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_town_2_mayor, "start",
    [
      (store_character_level, ":var0", "trp_player"),
      (gt, ":var0", 10),
      (gt, "$g_talk_troop_relation", 5),
      (store_current_hours, ":var1"),
      (store_random_in_range, ":var2", 24, 49),
      (val_sub, ":var1", ":var2"),
      (gt, ":var1", "$train_job_time"),
    ],
    "Hello again. Seems like you're starting to become a regular here. Would you be interested in a train job?",
    "train_job",
    []],

  [plyr|anyone, "train_job",
    [],
    "Maybe. Whatchya got?",
    "train_job_offer",
    []],

  [anyone, "train_job_offer",
    [],
    "Of course. I need a reliable man to protect a train delivering goods to the next station from here. If you make it with the goods intact I have a man waiting there who will pay you 5 dollars.",
    "train_job_reply",
    []],

  [plyr|anyone, "train_job_reply",
    [],
    "Sounds easy enough. Money is something I could use these days.",
    "train_job_agree",
    []],

  [plyr|anyone, "train_job_reply",
    [
      (store_current_hours, ":var0"),
      (assign, "$train_job_time", ":var0"),
    ],
    "Actually, I have other plans...",
    "mayor_begin",
    []],

  [anyone, "train_job_agree",
    [],
    "Excellent! We have to go now. The train's leaving in a few minutes. I'll explain the details on the way there...",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (store_current_hours, ":var0"),
      (assign, "$train_job_time", ":var0"),
      (set_jump_mission, "mt_train_heist"),
      (modify_visitors_at_site, "scn_train_heist"),
      (reset_visitors),
      (store_random_in_range, ":var1", 2, 5),
      (set_visitors, 3, "trp_hired_sharpshooter", 1),
      (set_visitors, 7, "trp_train_robber", 2),
      (set_visitors, 6, "trp_horse_thief", ":var1"),
      (set_visitors, 4, "trp_burglar", 1),
      (set_visitors, 5, "trp_thief", 1),
      (set_visitors, 1, "trp_trainstation_guard", 1),
      (jump_to_scene, "scn_train_heist"),
      (change_screen_mission),
    ]],

  [trp_town_3_mayor, "start",
    [
      (eq, "$g_talk_troop_met", 0),
    ],
    "Howdy, son! Others may think you're a do-gooder. But I've got my eye on you. Cross the line and we'll put you at the other edge of town..",
    "mayor_begin",
    []],

  [trp_town_3_mayor, "start",
    [
      (quest_slot_eq, "qst_billy_barrett", 11, 3),
    ],
    "Read about a gunfight in the papers. I take it you got a body for me?",
    "town_3_mayor_got_body",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_got_body",
    [],
    "Yep, he's pushing up the daisies. Will you let Mr. Barrett bury his son now?",
    "town_3_mayor_got_body_2",
    []],

  [trp_town_3_mayor, "town_3_mayor_got_body_2",
    [],
    "A deal is a deal. Tell Mr. Barrett to pick up and bury his son. Oh and here's a little extra. Those outlaws have long been the sore in my eye. Happy to be rid of them",
    "close_window",
    [
      (troop_add_gold, "trp_player", 2000),
      (str_store_string, s2, "@Tell Mr. Barrett that he can pick up his son."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 5, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 4),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_town_3_mayor, "start",
    [
      (eq, "$g_talk_troop_met", 1),
    ],
    "{playername}, I've got my eye on you. Cross the line and we'll put you at the other edge of town..",
    "mayor_begin",
    []],

  [plyr|trp_town_3_mayor, "mayor_talk",
    [
      (quest_slot_eq, "qst_billy_barrett", 11, 2),
    ],
    "I'm still searching for an outlaw. You know, as an exchange for this poor Billy.",
    "town_3_mayor_introduce_8",
    []],

  [plyr|trp_town_3_mayor, "mayor_talk",
    [
      (quest_slot_eq, "qst_billy_barrett", 11, 1),
    ],
    "[...] I wanna ask you to treat Billy's body with respect. [...]",
    "town_3_mayor_introduce_2",
    []],

  [plyr|trp_town_3_mayor, "mayor_talk",
    [
      (quest_slot_eq, "qst_Cottonwood_outlaws", 11, 2),
    ],
    "I'm here on behalf of Deputy Saunders. He and I have agreed to hunt for Remington Robert's gang together. But we need your permission to set out.",
    "town_3_mayor_co_1",
    []],

  [plyr|trp_town_3_mayor, "mayor_talk",
    [
      (quest_slot_eq, "qst_Cottonwood_outlaws", 11, 4),
    ],
    "Sheriff, I'm ready to take on the next set of outlaws. Remington Robert's on my list and I plan to get to him as soon as possible.",
    "town_3_mayor_co_1_1_1",
    []],

  [trp_town_3_mayor, "town_3_mayor_co_1",
    [],
    "Well I can't say I'd mind to see that Robert dead. But the truth is, I can't miss the Deputy here. There's too many other outlaw groups threatening this town. If you can get rid of them for me, the two of you can ride out to meet Remington Robert. Do we have a deal?",
    "town_3_mayor_co_1_1",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_co_1_1",
    [],
    "Tell me who's on your list first. I'd like to know who I'll have to fight before I say 'yes'.",
    "town_3_mayor_co_1_1_1",
    [
      (quest_set_slot, "qst_Cottonwood_outlaws", 11, 3),
    ]],

  [plyr|trp_town_3_mayor, "town_3_mayor_co_1_1",
    [],
    "Not yet, Sheriff. I have other stuff to take care of first.",
    "close_window",
    []],

  [trp_town_3_mayor, "town_3_mayor_co_1_1_1",
    [],
    "ATTENTION: This quest ends here. It will be continued in later versions of 1866.",
    "close_window",
    [
      (troop_add_gold, "trp_player", 1000),
    ]],

  [trp_town_3_mayor, "town_3_mayor_co_1_1_1",
    [
      (assign, ":var0", 0),
      (try_begin),
        (eq, "$hamilton_beaten", 0),
        (store_character_level, ":var1", "trp_player"),
        (gt, ":var1", 6),
        (store_party_size, ":var2", "p_main_party"),
        (gt, ":var2", 6),
        (assign, ":var0", 1),
      (else_try),
        (eq, "$hamilton_beaten", 0),
        (store_character_level, ":var1", "trp_player"),
        (gt, ":var1", 6),
        (store_party_size, ":var2", "p_main_party"),
        (gt, ":var2", 6),
        (assign, ":var0", 1),
      (try_end),
      (eq, ":var0", 1),
      (quest_set_slot, "qst_Cottonwood_outlaws", 11, 4),
    ],
    "Well, unfortunately, I don't think you're strong enough to take on such a challenge. Hire more gunslingers, get better at shooting, and come back to me then.",
    "close_window",
    []],

  [trp_town_3_mayor, "town_3_mayor_co_1_1_1",
    [
      (eq, "$hamilton_beaten", 0),
      (assign, ":var0", 1),
      (try_begin),
        (troop_slot_ge, "trp_hamilton", 8, 0),
        (assign, ":var0", 0),
      (try_end),
      (try_begin),
        (troop_get_slot, ":var1", "trp_hamilton", 10),
        (ge, ":var1", 0),
        (party_get_attached_to, ":var2", ":var1"),
        (is_between, ":var2", "p_town_1", "p_salt_mine"),
        (assign, ":var0", 0),
      (try_end),
      (eq, ":var0", 1),
    ],
    "Very well. I'll think out some plans for our mission and inform you when I am ready.",
    "close_window",
    []],

  [trp_town_3_mayor, "town_3_mayor_co_1_1_1",
    [
      (eq, "$hamilton_beaten", 0),
    ],
    "There's all types of outlaws trying to take the life of us. But the good Cottonwood people don't go down without a fight. One of the worst gangs around, Hamilton's Riders, is probably coming to our town in the next few days to try busting out their captured leader. Goes by the name of Bill Hamilton, spent the last two days in hoosegow at the back of my office, awaiting transport to El Paso, where he'll be trialed and hanged. We could use your help defending the town. The town will pay you $10 and I'll personally reward you with one Volcanic rifle. Whattayasay?",
    "town_3_mayor_co_1_1_1_1",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_co_1_1_1_1",
    [],
    "Alright, fine by me. I'll have that weapon now, sir. I'll be able to use it.",
    "close_window",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_co_1_1_1_1",
    [],
    "I can't help you yet, Sheriff. I'm not well enough equipped to fight Hamilton's Riders. I'll be back to help you when I've got my stuff sorted out.",
    "close_window",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_introduce_2",
    [],
    "No need to worry, Sheriff. I'll behave. Say, Sheriff, I wanted to talk to you about that actually. I wanna ask you to treat Billy's body with respect and let his father give him a decent burial. He may have walked out the saloon without paying, but that don't mean he's all bad. Besides, it's killing the old man and he didn't do nothing wrong.",
    "town_3_mayor_introduce_3",
    []],

  [trp_town_3_mayor, "town_3_mayor_introduce_3",
    [],
    "Well, why would I wanna do that? Since that body's up there, I haven't had any trouble at all anymore. That quite suits me, young man. What do you suggest?",
    "town_3_mayor_introduce_4",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_introduce_4",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 200),
    ],
    "I'll have to ask my friend Mr. Jefferson here. ... Ah, Mr. Jefferson says he'll join you for a while. Would that work for you?",
    "town_3_mayor_introduce_5a",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_introduce_4",
    [],
    "I see your point. What about I get you a replacement body? A real outlaw. Would that suit you?",
    "town_3_mayor_introduce_5b",
    []],

  [trp_town_3_mayor, "town_3_mayor_introduce_5a",
    [],
    "Oh well, if Mr. Jefferson says so. Tell Mr. Barrett to pick up and bury his son.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 200),
      (str_store_string, s2, "@Tell Mr. Barrett that he can pick up his son."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 5, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 4),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_town_3_mayor, "town_3_mayor_introduce_5b",
    [],
    "Sure thing, son. I'll tell you what. Kill an outlaw and his scum for me and you've got yourself a deal.",
    "town_3_mayor_introduce_6",
    [
      (troop_remove_gold, "trp_player", 50),
      (str_store_string, s2, "@Find and kill a Cottonwood outlaw."),
      (add_quest_note_from_sreg, "qst_billy_barrett", 4, s2, 0),
      (quest_set_slot, "qst_billy_barrett", 11, 2),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_town_3_mayor, "town_3_mayor_introduce_6",
    [],
    "Anything else?",
    "town_3_mayor_introduce_7",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_introduce_7",
    [],
    "Could you tell me where I might find a suitable outlaw?",
    "town_3_mayor_introduce_8",
    []],

  [plyr|trp_town_3_mayor, "town_3_mayor_introduce_7",
    [],
    "Nothing.",
    "close_window",
    []],

  [trp_town_3_mayor, "town_3_mayor_introduce_8",
    [],
    "There's a wanted poster at the edge of town. The poor guy on it probably ain't any more guilty than Billy. But if you don't kill him, another bounty hunter will, so it doesn't matter.",
    "town_3_mayor_introduce_9",
    []],

  [trp_town_3_mayor, "town_3_mayor_introduce_9",
    [],
    "Or have you heard of... er... Remington Robert?... Ah, forget it. Too many young men already died by his revolver. A Remington revolver, you know. Oh, nevermind.",
    "close_window",
    []],

  [plyr|trp_alice_saunders, "town_dweller_talk",
    [
      (quest_slot_ge, "qst_Cottonwood_outlaws", 11, 2),
      (eq, "$alice_saunders_reward_received", 0),
      (quest_slot_eq, "qst_Cottonwood_outlaws", 6, "trp_alice_saunders"),
    ],
    "I've spoken to your husband. He will not give up his quest for revenge. But he has agreed to take me along when he rides out to meet Remington Robert.",
    "alice_saunders_husband_spoken",
    []],

  [trp_alice_saunders, "alice_saunders_husband_spoken",
    [],
    "Alright, so be it. I'm sure you're a capable gunman, so I will try not to worry too much. Here's the reward I promised you, an undertaker's hat and $3. That hat should look just fine on you, should really give you an edge.",
    "close_window",
    [
      (assign, "$alice_saunders_reward_received", 1),
      (troop_add_item, "trp_player", "itm_undertaker_hat"),
      (troop_add_gold, "trp_player", 300),
    ]],

  [plyr|trp_alice_saunders, "town_dweller_talk",
    [
      (neg|check_quest_concluded, "qst_Cottonwood_outlaws"),
      (neg|check_quest_active, "qst_Cottonwood_outlaws"),
    ],
    "Who is your husband?",
    "alice_saunders_husband",
    []],

  [plyr|trp_alice_saunders, "town_dweller_talk",
    [],
    "What do you do in town?",
    "alice_saunders_what_do",
    []],

  [plyr|trp_alice_saunders, "town_dweller_talk",
    [],
    "Had any problems with outlaws here lately?",
    "alice_saunders_outlaws",
    []],

  [plyr|trp_alice_saunders, "town_dweller_talk",
    [],
    "What can you tell me about Cottonwood?",
    "alice_saunders_about_cottonwood",
    []],

  [plyr|trp_alice_saunders, "town_dweller_talk",
    [],
    "Why is there a dead body in an open coffin outside of town?",
    "alice_saunders_coffin",
    []],

  [plyr|trp_alice_saunders, "town_dweller_talk",
    [],
    "What can you tell me about the nearby Jansen-Williamson ranch?",
    "alice_saunders_ranch",
    []],

  [trp_alice_saunders, "alice_saunders_husband",
    [],
    "My husband is Deputy Saunders. His first name is Jebediah, but hardly anyone knows and that's how he likes to keep it.",
    "alice_saunders_husband2",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_husband2",
    [],
    "I know I'm not supposed to ask, but what's with him?",
    "alice_saunders_husband3",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_husband2",
    [],
    "Alright, I won't ask any further. Let me ask you something else.",
    "alice_saunders_what",
    []],

  [trp_alice_saunders, "alice_saunders_husband3",
    [],
    "Oh well, I told you this much already. It's just that he's so young and reckless and inexperienced. The other day he just shot Billy Barrett over a glass of unpaid Whisky. But I fear he's going to get himself in some serious trouble soon. I just don't want to think about it. You look like you have some experience. Maybe you could speak to him?",
    "alice_saunders_husband4",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_husband4",
    [],
    "I always help out a lady. I'll speak to your husband.",
    "close_window",
    [
      (setup_quest_text, "qst_Cottonwood_outlaws"),
      (str_store_string, s2, "@Talk to Alice Saunders' husband. She thinks he is in danger."),
      (quest_set_slot, "qst_Cottonwood_outlaws", 11, 1),
      (call_script, "script_start_quest", "qst_Cottonwood_outlaws", "trp_alice_saunders"),
      (quest_set_slot, "qst_Cottonwood_outlaws", 6, "trp_alice_saunders"),
    ]],

  [plyr|trp_alice_saunders, "alice_saunders_husband4",
    [],
    "Nah, I don't have time for such things.",
    "alice_saunders_what",
    []],

  [trp_alice_saunders, "alice_saunders_what_do",
    [],
    "Oh, I don't do much really. My husband is a Deputy in this town and I keep myself busy with reading and going to church, praying my husband won't get shot by some outlaw. It controls my every thought you see. Even if I don't want to speak about him, I still do.",
    "alice_saunders_what_do2",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_what_do2",
    [],
    "Alright, let me ask you something else.",
    "alice_saunders_what",
    []],

  [trp_alice_saunders, "alice_saunders_outlaws",
    [],
    "Oh, yes! Those bastards have been plaguing our town for years now. The worst ones are those led by Remington Robert. My husband's brother was killed by them a couple of years ago. That's why he became a Deputy, to take revenge. But I fear he might now be up to it, yet.",
    "alice_saunders_outlaws2",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_outlaws2",
    [],
    "I see. Let me ask you something else.",
    "alice_saunders_what",
    []],

  [trp_alice_saunders, "alice_saunders_about_cottonwood",
    [],
    "It's a shithole really, but I was born here. And my husband doesn't want to leave it. Speak to Benjamin Cooper if you want to know some more. That old man has lived here nearly all his life.",
    "alice_saunders_about_cottonwood2",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_about_cottonwood2",
    [],
    "Alright, I might ask him. Let me ask you something else.",
    "alice_saunders_what",
    []],

  [trp_alice_saunders, "alice_saunders_coffin",
    [],
    "That's poor Billy Barrett. My husband shot him dead when he left the saloon without paying for his drink. He says he's real sorry and just overreacted, but poor Billy is dead anyway. I tried telling him it's not his fault and Billy had it coming. But of course I know better. And so does he...",
    "alice_saunders_coffin2",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_coffin2",
    [],
    "Well, shit happens. That Billy's partly to blame himself too. Although he may not have walked away on purpose, it's still stupid. Tell that to your husband. Let me ask you something else.",
    "alice_saunders_what",
    []],

  [trp_alice_saunders, "alice_saunders_ranch",
    [],
    "The ranch is owned by Mr. Jansen. It used to belong to some Mr. Williamson before that, hence the name. Jansen bought it about thirty years ago, after he arrived from Holland. At first he grew cotton there, but after slavery got abolished he switched to cattle. He now runs it with his son, Derrick, who is a really nice boy. I heard Remington Robert's gang is pecking on them lately. I'm sure they would appreciate your help if you offered it.",
    "alice_saunders_ranch2",
    []],

  [plyr|trp_alice_saunders, "alice_saunders_ranch2",
    [],
    "Alright, I'll go and have a talk with them. Thanks for the tip. Let me ask you something else.",
    "alice_saunders_what",
    []],

  [trp_alice_saunders, "alice_saunders_what",
    [],
    "What is it?",
    "town_dweller_talk",
    []],

  [plyr|trp_benjamin_cooper, "town_dweller_talk",
    [],
    "What can you tell me about Cottonwood?",
    "benjamin_cooper_about_cottonwood",
    []],

  [plyr|trp_benjamin_cooper, "town_dweller_talk",
    [],
    "What's up with that stiff put up outside of town?",
    "benjamin_cooper_coffin",
    []],

  [plyr|trp_benjamin_cooper, "town_dweller_talk",
    [],
    "Had any trouble with outlaws lately?",
    "benjamin_cooper_outlaws",
    []],

  [plyr|trp_benjamin_cooper, "town_dweller_talk",
    [],
    "What can you tell me about the nearby Jansen-Williamson Ranch?",
    "benjamin_cooper_ranch",
    []],

  [plyr|trp_benjamin_cooper, "town_dweller_talk",
    [],
    "What do you do in town?",
    "benjamin_cooper_what_do",
    []],

  [trp_benjamin_cooper, "benjamin_cooper_about_cottonwood",
    [],
    "All you need to know, son. Biggest town in the area. Led by Mayor Ford. Sheriff Jacobson is trying his best to uphold the law, but the town attracts outlaws like shit does flies. Occasionally he calls for our help as well and so far we've managed to keep our heads above the water. Not much else to say, excepting that the saloon is home to the best flock of whores in the whole of Texas. If you and your guys need a poke, that's the place to go.",
    "benjamin_cooper_about_cottonwood2",
    []],

  [plyr|trp_benjamin_cooper, "benjamin_cooper_about_cottonwood2",
    [],
    "Alright, that'll do. Let me ask you something else.",
    "benjamin_cooper_what",
    []],

  [trp_benjamin_cooper, "benjamin_cooper_coffin",
    [
      (neq, "$billy_barretts_body_replaced", 1),
    ],
    "That stiff is the late Billy Barrett. Forgot to pay for his Whisky when he left the saloon. Deputy Saunders shot him down without a warning. Not nice, but the Sheriff put him up as a warning just outside of town. Billy's father's been trying to get his son a decent burial for a while now, but the Sheriff says it's quieter than before in town. At least the small troublemakers keep quiet, but I doubt it will scare off the real gangs.",
    "benjamin_cooper_coffin2",
    []],

  [trp_benjamin_cooper, "benjamin_cooper_coffin",
    [
      (eq, "$billy_barretts_body_replaced", 1),
    ],
    "That stiff is some random troublemaker, who Sheriff Saunders had killed by some fella who helped Mr. Barrett getting his son buried. Sheriff wanted a replacement stiff, 'cause he says it's been quieter than before in town. At least the small troublemakers keep quiet, but it doesn't scare off the real gangs.",
    "benjamin_cooper_coffin2",
    []],

  [plyr|trp_benjamin_cooper, "benjamin_cooper_coffin2",
    [],
    "A bit morbid, but if it works... Let me ask you something else.",
    "benjamin_cooper_what",
    []],

  [trp_benjamin_cooper, "benjamin_cooper_outlaws",
    [],
    "Well, ever since the Sheriff put up Billy Barrett's body outside of town, the small troublemakers have kept quiet mostly. But there's quite a few more serious gangs terrorizing our town on occasion. I doubt one dead Billy will keep them away. But it has been a while since we last seen any. Couple of weeks ago Remington Robert's gang shot a deputy right in the streets at broad daylight. Sheriff Jacobson sent some lead after them as they rode out of town, but I doubt he hit one. You should speak to the Sheriff if you want to know more.",
    "benjamin_cooper_outlaws2",
    []],

  [plyr|trp_benjamin_cooper, "benjamin_cooper_outlaws2",
    [],
    "I'll speak to the Sheriff. Let me ask you something else.",
    "benjamin_cooper_what",
    []],

  [trp_benjamin_cooper, "benjamin_cooper_ranch",
    [],
    "Oh, the ranch. It's been there for nearly a century now and it gave name to this town, although I'm not sure where the 'Wood' part of our town's name comes from. Anyway, they used to grow cotton there, but after the civil war, the owner, Mr. Jansen and his son Derrick changed cotton for cattle. For a couple of years they flourished, but recently they've had problems with outlaws. Apparently Remington Robert's gang is killing or stealing their cattle. But you should ask Mr. Jansen or his son if you want to know more.",
    "benjamin_cooper_ranch2",
    []],

  [plyr|trp_benjamin_cooper, "benjamin_cooper_ranch2",
    [],
    "I might pay the ranch a visit. Let me ask you something else.",
    "benjamin_cooper_what",
    []],

  [trp_benjamin_cooper, "benjamin_cooper_what_do",
    [],
    "I'm not doing anything anymore, son. I used to be a gunsmith in this town, but now I'm just living out my last days.",
    "benjamin_cooper_what_do2",
    []],

  [plyr|trp_benjamin_cooper, "benjamin_cooper_what_do2",
    [],
    "Let me ask you something else.",
    "benjamin_cooper_what",
    []],

  [trp_benjamin_cooper, "benjamin_cooper_what",
    [],
    "What is it?",
    "town_dweller_talk",
    []],

  [trp_deputy_saunders, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}. I'm Deputy Saunders. How can I help you?",
    "deputy_saunders_1",
    []],

  [plyr|trp_deputy_saunders, "deputy_saunders_1",
    [
      (quest_slot_eq, "qst_Cottonwood_outlaws", 11, 1),
      (quest_slot_eq, "qst_Cottonwood_outlaws", 6, "trp_alice_saunders"),
    ],
    "Howdy, Saunders. I'm here on behalf of your wife, Alice. She's really worried about your wellbeing. Perhaps you should give up your quest for revenge?",
    "deputy_saunders_1_1",
    []],

  [plyr|trp_deputy_saunders, "deputy_saunders_1",
    [],
    "Good day, Saunders. What can you tell me about the outlaw gangs around this town?",
    "deputy_saunders_1_2",
    []],

  [plyr|trp_deputy_saunders, "deputy_saunders_1",
    [],
    "[Leave]",
    "close_window",
    []],

  [trp_deputy_saunders, "deputy_saunders_1_1",
    [],
    "I know she is. But those bastards murdered my brother, Samuel, in cold blood and I can't let them get away with that. My position as a Deputy gives me the authority to do something about them. I'm not giving up now.",
    "deputy_saunders_1_1_1",
    []],

  [trp_deputy_saunders, "deputy_saunders_1_2",
    [],
    "There's a couple of groups, apart from the not-so-bad lone troublemakers. There is Hamilton's Riders, the Duvalle Gang and some bastards led by some Mexican they call 'El Puerco'. But the worst group is led by Remington Robert, which are the ones who shot my brother a couple of years ago. He's the one I want to get my hands on.",
    "close_window",
    []],

  [plyr|trp_deputy_saunders, "deputy_saunders_1_1_1",
    [],
    "Alright, how about a deal? I help you get to Remington Robert and once he's dead you quit your job as a Deputy and live a quiet life with your wife. Would that work for ya?",
    "deputy_saunders_1_1_1_1",
    []],

  [trp_deputy_saunders, "deputy_saunders_1_1_1_1",
    [],
    "I think you've got yourself a deal. But you will need to speak to the Sheriff before we can make a move. Please go speak to my wife as well. Let me know when you're ready to move on Robert's gang.",
    "close_window",
    [
      (str_store_string, s2, "@Speak to Alice Saunders and the Sheriff."),
      (add_quest_note_from_sreg, "qst_Cottonwood_outlaws", 4, s2, 0),
      (quest_set_slot, "qst_Cottonwood_outlaws", 11, 2),
      (display_message, "str_quest_log_updated"),
    ]],

  [plyr|trp_deputy_saunders, "deputy_saunders_1",
    [
      (quest_slot_eq, "qst_Cottonwood_outlaws", 11, 1),
      (quest_slot_eq, "qst_Cottonwood_outlaws", 6, "trp_jansen"),
    ],
    "Howdy, Saunders. I'm here on behalf of the farmer Jansen. He has problems with the outlaw Robert. I heard you are out for revenge as well?",
    "deputy_saunders_1_1b",
    []],

  [trp_deputy_saunders, "deputy_saunders_1_1b",
    [],
    "Those bastards murdered my brother, Samuel, in cold blood and I can't let them get away with that. My position as a Deputy gives me the authority to do something about them. I will not give up until Robert is dead.",
    "deputy_saunders_1_1_1b",
    []],

  [plyr|trp_deputy_saunders, "deputy_saunders_1_1_1b",
    [],
    "Alright, how about some cooperation? I help you get to Remington Robert. Would that work for ya?",
    "deputy_saunders_1_1_1_1b",
    []],

  [trp_deputy_saunders, "deputy_saunders_1_1_1_1b",
    [],
    "I think you've got yourself a deal. But you will need to speak to the Sheriff before we can make a move. Let me know when you're ready to move on Robert's gang.",
    "close_window",
    [
      (str_store_string, s2, "@Speak to the Sheriff."),
      (add_quest_note_from_sreg, "qst_Cottonwood_outlaws", 4, s2, 0),
      (quest_set_slot, "qst_Cottonwood_outlaws", 11, 2),
      (display_message, "str_quest_log_updated"),
    ]],

  [trp_jansen_junior, "start",
    [],
    "Please speak to my vader. Mine English niet good.",
    "close_window",
    []],

  [trp_jansen, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Hello, {reg18?ma'am:sir}. Welcome to my ranch. What's the reason for your visit?",
    "jansen_1",
    []],

  [plyr|trp_jansen, "jansen_1",
    [
      (quest_slot_eq, "qst_Cottonwood_outlaws", 11, 0),
    ],
    "How's the cattle business going?",
    "jansen_2",
    []],

  [plyr|trp_jansen, "jansen_1",
    [],
    "Nothing.",
    "close_window",
    []],

  [trp_jansen, "jansen_2",
    [],
    "Not good at all. An outlaw called Remington Robert and his men have been raiding our ranch for a couple of weeks now.",
    "jansen_3",
    []],

  [plyr|trp_jansen, "jansen_3",
    [],
    "Is there any way I can help you?.",
    "jansen_4",
    []],

  [plyr|trp_jansen, "jansen_3",
    [],
    "Too bad I'm only a merchant with shaky hands. If I knew how to use a revolver, I'd surely help you.",
    "close_window",
    []],

  [trp_jansen, "jansen_4",
    [],
    "There is actually. Deputy Saunders of Cottonwood is out for revenge. Remington has done something to him, I'm not sure what. Ask him for help and we can attack Remington all together.",
    "jansen_5",
    []],

  [plyr|trp_jansen, "jansen_5",
    [],
    "I might just do that.",
    "close_window",
    [
      (setup_quest_text, "qst_Cottonwood_outlaws"),
      (str_store_string, s2, "@Talk to Deputy Saunders. Mr. Jansen hopes he'll help him fighting the outlaw Remington Robert."),
      (quest_set_slot, "qst_Cottonwood_outlaws", 11, 1),
      (call_script, "script_start_quest", "qst_Cottonwood_outlaws", "trp_jansen"),
      (quest_set_slot, "qst_Cottonwood_outlaws", 6, "trp_jansen"),
    ]],

  [trp_jack_twist, "start",
    [],
    "I wish I knew how to quit you.",
    "jack_twist_1",
    []],

  [plyr|trp_jack_twist, "jack_twist_1",
    [],
    "Well, why don't you? Why don't you just let me be?",
    "close_window",
    []],

  [plyr|trp_jack_twist, "jack_twist_1",
    [],
    "You shut your purdy mouth and I'll ride you like a bronco.",
    "close_window",
    []],

  [trp_ramun_the_slave_trader, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 80, 0),
    ],
    "Maruawe, stranger.",
    "ramun_introduce_1",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_introduce_1",
    [],
    "Maruawe?  That sounds like Comanche to me.",
    "ramun_introduce_2",
    [
      (troop_set_slot, "$g_talk_troop", 80, 1),
    ]],

  [plyr|trp_ramun_the_slave_trader, "ramun_introduce_1",
    [],
    "Never mind.",
    "close_window",
    []],

  [trp_ramun_the_slave_trader, "ramun_introduce_2",
    [],
    "Well, you seem to have an ear for native tongues. Lucky for you, I have an eye for opportunity, and I think I'm going to be your new business pardner.",
    "ramun_introduce_3",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_introduce_3",
    [],
    "I'm not interested in any snake oil, if that's what your getting at.",
    "ramun_introduce_4",
    []],

  [trp_ramun_the_slave_trader, "ramun_introduce_4",
    [],
    "Hhmph..I'm not that kind of salesman.  I'm more of a smuggler, if anything. There's lots of people 'round here who need things, and I specialize in hard to find items.",
    "ramun_introduce_5",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_introduce_5",
    [],
    "You're a comanchero.",
    "ramun_introduce_6",
    []],

  [trp_ramun_the_slave_trader, "ramun_introduce_6",
    [],
    "Well, give me some damn credit here.  I'm the LEADER of the comancheros. But I ain't sellin' you guns, I can tell you can find those on your own.  Naw, what I need from you are bodies.",
    "ramun_introduce_7",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_introduce_7",
    [],
    "Funny you should mention it.  I come across lots of bodies.",
    "ramun_introduce_8",
    []],

  [trp_ramun_the_slave_trader, "ramun_introduce_8",
    [],
    "Ha, very funny.  LIVE bodies, smart ass. Ya see, the slave trade is pickin' up again.  Seems like that silly civil war ended the most reliable source of good slaves there was. Now folks is scramblin' to get whoever they can, and I've got enough customers that I'm not even picky about color anymore: black, red, brown, white: it don't matter, just as long as they're breathin' and walkin'.  I'll send 'em where they need to go.",
    "ramun_introduce_9",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_introduce_9",
    [],
    "Not real worried about the new laws are ya? ",
    "ramun_introduce_10",
    []],

  [trp_ramun_the_slave_trader, "ramun_introduce_10",
    [],
    "Heh.  There's no law in this town that's gonna stop me.  I know the system here, and everybody is  so busy killin' and dyin' that a few missing persons ain't gonna raise suspicion. Now listen, why don't you start bringing me a fresh supply of able..err, breathin' bodies.  I'll pay you a dollar for each head. Don't much care who they are or where they come from.",
    "ramun_introduce_11",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_introduce_11",
    [],
    "Hmm. I'll think about it.",
    "ramun_introduce_12",
    []],

  [trp_ramun_the_slave_trader, "ramun_introduce_12",
    [],
    "Like I said, this is an opportunity.  And it ain't gonna last forever!",
    "close_window",
    []],

  [trp_ramun_the_slave_trader, "start",
    [],
    "Howdy, {playername}.",
    "ramun_talk",
    []],

  [trp_ramun_the_slave_trader, "ramun_pre_talk",
    [],
    "Anything else?",
    "ramun_talk",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_talk",
    [
      (store_num_regular_prisoners, reg0),
      (ge, reg0, 1),
    ],
    "I've brought you some bodies, Graile. These gonna work for ya?",
    "ramun_sell_prisoners",
    []],

  [trp_ramun_the_slave_trader, "ramun_sell_prisoners",
    [],
    "Let me how busted up they are...",
    "ramun_sell_prisoners_2",
    [
      (change_screen_trade_prisoners),
    ]],

  [trp_ramun_the_slave_trader, "ramun_sell_prisoners_2",
    [],
    "Now make sure you don't spend all that on whores and booze.",
    "close_window",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_talk",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 80, 1),
    ],
    "So how do I take prisoners anyhow?",
    "ramun_ask_about_capturing",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_talk",
    [
      (troop_slot_ge, "$g_talk_troop", 80, 1),
    ],
    "Tell me again about taking prisoners?",
    "ramun_ask_about_capturing",
    [
      (troop_set_slot, "$g_talk_troop", 80, 2),
    ]],

  [trp_ramun_the_slave_trader, "ramun_ask_about_capturing",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 80, 1),
    ],
    "You're either real stupid or a real good shot. The basic rule of keepin' em alive is by not fillin' em with so many holes!  And keep your knives put away too.  Just knock the poor bastards with a club, or a horse, or even a close black powder charge...but not too close.  Like I said, they gotta be breathin'. I'm assuming you something to knock 'em out with, don't you?",
    "ramun_have_blunt_weapon",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_have_blunt_weapon",
    [],
    "I'm just fine, thanks.",
    "ramun_have_blunt_weapon_yes",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_have_blunt_weapon",
    [],
    "You may want to trade for some spectacles.  It's pretty clear that I don't.",
    "ramun_have_blunt_weapon_no",
    []],

  [trp_ramun_the_slave_trader, "ramun_have_blunt_weapon_yes",
    [],
    "Good. Then beat the bastard about the face until he gives up, or do whatever you gotta do. Keep 'em behaved until you get back to me, and that's the end of the story for you.  And your payday too.",
    "ramun_ask_about_capturing_2",
    []],

  [trp_ramun_the_slave_trader, "ramun_have_blunt_weapon_no",
    [],
    "No? Heh, well, this must be your lucky day. I've got this shitty old club that I just used to beat some two-bit cheat into a pulp. It still has some skull bits on it, but it's good enough for you.  Just don't swing it as hard as I did..heh heh. Here you go.",
    "ramun_have_blunt_weapon_no_2",
    [
      (troop_add_item, "trp_player", "itm_club", imod_cracked),
    ]],

  [plyr|trp_ramun_the_slave_trader, "ramun_have_blunt_weapon_no_2",
    [],
    "Thanks, Graile. Oh yeah, you weren't kiddin' about the skull bits.",
    "ramun_have_blunt_weapon_yes",
    []],

  [trp_ramun_the_slave_trader, "ramun_ask_about_capturing",
    [],
    "Alright, I'll try and expain it again, and speak slowly so you actually understand. The basic rule of keepin' em alive is by not fillin' em with so many holes!  And keep your knives put away too.  Just knock the poor bastards with a club, or a horse, or even a close black powder charge...but not too close.  Like I said, they gotta be  breathin'.",
    "ramun_ask_about_capturing_2",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_ask_about_capturing_2",
    [],
    "Alright, I got it. Anything else?",
    "ramun_ask_about_capturing_3",
    []],

  [trp_ramun_the_slave_trader, "ramun_ask_about_capturing_3",
    [],
    "Well, it sounds easier than it really is.  Ya see, you may not have noticed, but your enemies have these things called BULLETS that they like to send your way. Good luck gettin' anywhere close while those are flying past your ugly face.  Anyway, I know the risk and that's why I pay so generously. Oh yeah, and dragging those sorry bastards back here is gonna slow you way down, so make sure you're well away from Indian country or real damn fast. Trust me on this one.",
    "ramun_ask_about_capturing_4",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_ask_about_capturing_4",
    [],
    "Is that everything?",
    "ramun_ask_about_capturing_5",
    []],

  [trp_ramun_the_slave_trader, "ramun_ask_about_capturing_5",
    [],
    "Just one last thing. Managing these sniveling shitheads is not an easy thing to do. If you want to capture a lot of bodies at once, you're gonna have to learn the tricks of it yourself, or they'll be escapin' on you during the night, and maybe even slitting your throat while ya sleep.",
    "ramun_ask_about_capturing_7",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_ask_about_capturing_7",
    [],
    "Great. I'll keep that in mind.",
    "ramun_pre_talk",
    []],

  [plyr|trp_ramun_the_slave_trader, "ramun_talk",
    [],
    "Well I've wasted enough time here.  See you around.",
    "ramun_leave",
    []],

  [trp_ramun_the_slave_trader, "ramun_leave",
    [],
    "Remember, I need them alive, and you need the dollar you'll get for each one.",
    "close_window",
    []],

  [party_tpl|anyone, "common_recruitment_1",
    [
      (call_script, "script_party_recruitment_breakdown", "$g_talk_party_faction_relation", "$g_encountered_party"),
    ],
    "{s4}",
    "common_recruitment_2",
    []],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg30, 0),
      (str_store_troop_name_plural, s4, reg10),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg10),
      (assign, "$g_ym_recruit_troop_cost", reg20),
      (assign, "$g_ym_recruit_troop_quantity", reg30),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg31, 0),
      (str_store_troop_name_plural, s4, reg11),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg11),
      (assign, "$g_ym_recruit_troop_cost", reg21),
      (assign, "$g_ym_recruit_troop_quantity", reg31),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg32, 0),
      (str_store_troop_name_plural, s4, reg12),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg12),
      (assign, "$g_ym_recruit_troop_cost", reg22),
      (assign, "$g_ym_recruit_troop_quantity", reg32),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg33, 0),
      (str_store_troop_name_plural, s4, reg13),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg13),
      (assign, "$g_ym_recruit_troop_cost", reg23),
      (assign, "$g_ym_recruit_troop_quantity", reg33),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg34, 0),
      (str_store_troop_name_plural, s4, reg14),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg14),
      (assign, "$g_ym_recruit_troop_cost", reg24),
      (assign, "$g_ym_recruit_troop_quantity", reg34),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg35, 0),
      (str_store_troop_name_plural, s4, reg15),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg15),
      (assign, "$g_ym_recruit_troop_cost", reg25),
      (assign, "$g_ym_recruit_troop_quantity", reg35),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg36, 0),
      (str_store_troop_name_plural, s4, reg16),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg16),
      (assign, "$g_ym_recruit_troop_cost", reg26),
      (assign, "$g_ym_recruit_troop_quantity", reg36),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg37, 0),
      (str_store_troop_name_plural, s4, reg17),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg17),
      (assign, "$g_ym_recruit_troop_cost", reg27),
      (assign, "$g_ym_recruit_troop_quantity", reg37),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg38, 0),
      (str_store_troop_name_plural, s4, reg18),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg18),
      (assign, "$g_ym_recruit_troop_cost", reg28),
      (assign, "$g_ym_recruit_troop_quantity", reg38),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [
      (gt, reg39, 0),
      (str_store_troop_name_plural, s4, reg19),
    ],
    "I want to hire {s4}.",
    "common_recruitment_3",
    [
      (assign, "$g_ym_recruit_troop_id", reg19),
      (assign, "$g_ym_recruit_troop_cost", reg29),
      (assign, "$g_ym_recruit_troop_quantity", reg39),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_2",
    [],
    "I want to talk about something else.",
    "common_recruitment_back",
    []],

  [party_tpl|anyone, "common_recruitment_3",
    [
      (call_script, "script_game_get_money_text_alt", "$g_ym_recruit_troop_cost"),
    ],
    "{s4} cost {s1} each. How many do you want?",
    "common_recruitment_4",
    []],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [
      (store_troop_gold, "$g_ym_player_gold", "trp_player"),
      (assign, reg1, "$g_ym_recruit_troop_cost"),
      (assign, reg2, 1),
      (val_mul, reg1, reg2),
      (call_script, "script_game_get_money_text_alt", reg1),
      (ge, "$g_ym_recruit_troop_quantity", reg2),
      (ge, "$g_ym_player_gold", reg1),
      (troops_can_join, reg2),
    ],
    "One. ({s1})",
    "common_recruitment_5",
    [
      (assign, reg2, 1),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [
      (store_troop_gold, "$g_ym_player_gold", "trp_player"),
      (assign, reg1, "$g_ym_recruit_troop_cost"),
      (assign, reg2, 5),
      (val_mul, reg1, reg2),
      (call_script, "script_game_get_money_text_alt", reg1),
      (gt, "$g_ym_recruit_troop_quantity", reg2),
      (ge, "$g_ym_player_gold", reg1),
      (troops_can_join, reg2),
    ],
    "Five. ({s1})",
    "common_recruitment_5",
    [
      (assign, reg2, 5),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [
      (store_troop_gold, "$g_ym_player_gold", "trp_player"),
      (assign, reg1, "$g_ym_recruit_troop_cost"),
      (assign, reg2, 10),
      (val_mul, reg1, reg2),
      (call_script, "script_game_get_money_text_alt", reg1),
      (gt, "$g_ym_recruit_troop_quantity", reg2),
      (ge, "$g_ym_player_gold", reg1),
      (troops_can_join, reg2),
    ],
    "Ten. ({s1})",
    "common_recruitment_5",
    [
      (assign, reg2, 10),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [
      (store_troop_gold, "$g_ym_player_gold", "trp_player"),
      (assign, reg1, "$g_ym_recruit_troop_cost"),
      (assign, reg2, "$g_ym_recruit_troop_quantity"),
      (val_sub, reg2, 1),
      (val_mul, reg1, reg2),
      (call_script, "script_game_get_money_text_alt", reg1),
      (party_get_num_prisoners, ":var0", "$g_encountered_party"),
      (ge, ":var0", 1),
      (gt, "$g_ym_recruit_troop_quantity", 2),
      (neq, "$g_ym_recruit_troop_quantity", 6),
      (neq, "$g_ym_recruit_troop_quantity", 11),
      (ge, "$g_ym_player_gold", reg1),
      (troops_can_join, reg2),
    ],
    "{reg2} of them. ({s1})",
    "common_recruitment_5",
    [
      (assign, reg2, "$g_ym_recruit_troop_quantity"),
      (val_sub, reg2, 1),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [
      (store_troop_gold, "$g_ym_player_gold", "trp_player"),
      (assign, reg1, "$g_ym_recruit_troop_cost"),
      (assign, reg2, "$g_ym_recruit_troop_quantity"),
      (val_mul, reg1, reg2),
      (call_script, "script_game_get_money_text_alt", reg1),
      (gt, "$g_ym_recruit_troop_quantity", 1),
      (ge, "$g_ym_player_gold", reg1),
      (troops_can_join, reg2),
    ],
    "All {reg2} of them. ({s1})",
    "common_recruitment_5",
    [
      (assign, reg2, "$g_ym_recruit_troop_quantity"),
    ]],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [
      (store_troop_gold, "$g_ym_player_gold", "trp_player"),
      (lt, "$g_ym_player_gold", "$g_ym_recruit_troop_cost"),
    ],
    "I don't have enough money for any more {s4}.",
    "common_recruitment_7",
    []],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [],
    "What other troops do you have?",
    "common_recruitment_1",
    []],

  [plyr|party_tpl|anyone, "common_recruitment_4",
    [],
    "I don't need anymore troops.",
    "common_recruitment_back",
    []],

  [party_tpl|anyone, "common_recruitment_5",
    [
      (store_party_size_wo_prisoners, ":var0", "$g_encountered_party"),
      (party_get_num_prisoners, ":var1", "$g_encountered_party"),
      (eq, ":var0", reg2),
      (ge, ":var1", 1),
    ],
    "Sorry, but we won't leave prisoners behind. At least one of us needs to be responsible for any prisoners.",
    "common_recruitment_6",
    []],

  [party_tpl|anyone, "common_recruitment_5",
    [
      (store_party_size_wo_prisoners, ":var0", "$g_encountered_party"),
      (party_get_num_prisoners, ":var1", "$g_encountered_party"),
      (this_or_next|neq, ":var0", reg2),
      (eq, ":var1", 0),
    ],
    "It's a deal. These troops will expect to get paid wages every week too.",
    "common_recruitment_6",
    [
      (assign, reg1, "$g_ym_recruit_troop_cost"),
      (val_mul, reg1, reg2),
      (party_add_members, "p_main_party", "$g_ym_recruit_troop_id", reg2),
      (party_remove_members, "$g_encountered_party", "$g_ym_recruit_troop_id", reg2),
      (troop_remove_gold, "trp_player", reg1),
    ]],

  [party_tpl|anyone, "common_recruitment_6",
    [
      (store_party_size_wo_prisoners, ":var0", "$g_encountered_party"),
      (gt, ":var0", 0),
      (call_script, "script_party_recruitment_breakdown", "$g_talk_party_faction_relation", "$g_encountered_party"),
    ],
    "{s4}",
    "common_recruitment_2",
    []],

  [party_tpl|anyone, "common_recruitment_6",
    [
      (store_party_size_wo_prisoners, ":var0", "$g_encountered_party"),
      (eq, ":var0", 0),
    ],
    "Well, all of us have joined you now. Lead the way.",
    "close_window",
    [
      (assign, "$g_party_was_recruited", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|anyone, "common_recruitment_7",
    [],
    "Well, that's too bad then.",
    "common_recruitment_1",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_manhunters"),
    ],
    "Alright then. So have you seen them outlaws 'round these parts?",
    "manhunters_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (this_or_next|eq, "$g_encountered_party_template", "pt_looters"),
      (this_or_next|eq, "$g_encountered_party_template", "pt_mountain_bandits"),
      (eq, "$g_encountered_party_template", "pt_forest_bandits"),
    ],
    "Alright then. What's on your mind?",
    "generic_bandits_f3",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_outlaws_american"),
    ],
    "Well alright. So watcha want then?",
    "outlaws_american_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_outlaws_mexican"),
    ],
    "Si, amigo. Que pasa?",
    "outlaws_mexican_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_imperialists"),
    ],
    "Bien, amigo. What do you need?",
    "imperialists_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_confederate_renegades"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "What can we do for you now, {reg18?ma'am:sir}?",
    "confederate_renegades_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_indian_raiders"),
    ],
    "Do you have more words for us?",
    "indian_raiders_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_scalphunters"),
    ],
    "What do you need? We have bodies to scalp!",
    "scalphunters_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_trappers"),
    ],
    "What do you need? This game ain't gonna hunt itself!",
    "trappers_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_miners"),
    ],
    "Well spit it out already! Thar's gold in them hills, and we gotta find it first!",
    "miners_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_homesteaders"),
    ],
    "Whatcha be needin'? We gotta be headin' on to find some place safe to settle.",
    "homesteaders_f2",
    []],

  [party_tpl|anyone, "common_recruitment_back",
    [
      (eq, "$g_encountered_party_template", "pt_deserters"),
    ],
    "Well looks like some of us are back to desertin' afterall. What do you need now?",
    "deserters_f2",
    []],

  [party_tpl|auto_proceed|pt_manhunters, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "manhunters_f1",
    [
      (play_sound, "snd_encounter_manhunters_neutral"),
    ]],

  [party_tpl|pt_manhunters, "manhunters_f1",
    [],
    "Hey! Seen any outlaws around here?",
    "manhunters_f2",
    []],

  [plyr|party_tpl|pt_manhunters, "manhunters_f2",
    [],
    "I'm the outlaw. Now what are you gonna do about it?",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_manhunters, "manhunters_f2",
    [],
    "I need some more men in my company. Any of you interested?",
    "manhunters_f5",
    []],

  [plyr|party_tpl|pt_manhunters, "manhunters_f2",
    [],
    "Yep, seen some go by this way about an hour ago.",
    "manhunters_f3",
    []],

  [plyr|party_tpl|pt_manhunters, "manhunters_f2",
    [],
    "No, haven't seen any outlaws lately.",
    "manhunters_f4",
    []],

  [party_tpl|pt_manhunters, "manhunters_f3",
    [],
    "Come on, boys, let's get 'em! Thanks, stranger.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_manhunters, "manhunters_f4",
    [],
    "Those fuckers just keep poppin' up, but we'll get 'em all soon.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_manhunters, "manhunters_f5",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "We'll we're mighty busy chasin' down outlaws, and all. Plus we just don't like you that much. So how about them outlaws? You seen 'em?",
    "manhunters_f2",
    []],

  [party_tpl|pt_manhunters, "manhunters_f5",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Well alright. I reckon that could be a good way to serve up some justice. What did you have in mind?",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_manhunters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "manhunters_e1",
    [
      (str_store_string, s11, "@You've been on the wrong side of the law for long enough."),
      (str_store_string, s12, "@It's time for your crime spree to end. Right here, right now."),
      (str_store_string, s13, "@You're coming with us to face the judge, and then you're gonna hang."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_bandits"),
    ]],

  [party_tpl|pt_manhunters, "manhunters_e1",
    [],
    "{s4}",
    "manhunters_e2",
    []],

  [plyr|party_tpl|pt_manhunters, "manhunters_e2",
    [],
    "You'll have a hard time takin' me in when you're dead!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_manhunters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "manhunters_n1",
    [
      (play_sound, "snd_encounter_manhunters_neutral"),
    ]],

  [party_tpl|pt_manhunters, "manhunters_n1",
    [],
    "You lookin' for someone in particular?",
    "manhunters_n2",
    []],

  [plyr|party_tpl|pt_manhunters, "manhunters_n2",
    [],
    " Why yes! I'm looking for vigilantes to kill!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_manhunters, "manhunters_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_looters, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_f1",
    []],

  [party_tpl|auto_proceed|pt_mountain_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_f1",
    []],

  [party_tpl|auto_proceed|pt_forest_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_f1",
    []],

  [party_tpl|auto_proceed|anyone, "generic_bandits_f1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_f2",
    [
      (str_store_string, s11, "@Hey there {reg18?miss:mister}. Seen any rich lookin' stagecoaches lately?"),
      (str_store_string, s12, "@Aw, hell! Relax! We ain't gonna rob ya. Unless you want us to, that is!"),
      (str_store_string, s13, "@This might be as good a time as any to take a rest, lest we all turn into buzzard bait. Wanna swap some stories?"),
      (str_store_string, s14, "@Dangerous parts round here, friend. You be sure to watch yourself."),
      (str_store_string, s15, "@Howdy friend. Shoot anyone interesting lately?"),
      (str_store_string, s16, "@We've been out here for ages! It's about time we get ourselves to town for some drinkin'!"),
      (str_store_string, s17, "@Howdy pard. Our raids ain't been too bad lately. How's buisness?"),
      (str_store_string, s18, "@Well, what is it you need, {playername}?"),
      (str_store_string, s19, "@Watch yourself round here. Them Indians are just everywhere. Make sure ya'll keep yer fires lit at night."),
      (store_random_in_range, ":var0", 11, 19),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|anyone, "generic_bandits_f2",
    [],
    "{s4}",
    "generic_bandits_f3",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_f3",
    [],
    "Looks like we aint' friends no more. I'm gonna let the buzzards pick your bones clean.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|anyone, "generic_bandits_f3",
    [],
    "I need some more men in my company. Any of you interested?",
    "generic_bandits_f4",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_f3",
    [],
    "I've got no time to chat. Happy trails.",
    "generic_bandits_f5",
    []],

  [party_tpl|anyone, "generic_bandits_f5",
    [],
    "Alright then. See ya around.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|anyone, "generic_bandits_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "We just don't trust you enough for that yet. Go help some outlaws out and we'll reconsider. What else is on your mind?",
    "generic_bandits_f3",
    []],

  [party_tpl|anyone, "generic_bandits_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Alright, I reckon some of us might be willing to join up with you.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_looters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (party_get_slot, ":var0", "$g_encountered_party", 3),
      (store_current_hours, ":var1"),
      (store_sub, ":var2", ":var0", ":var1"),
      (gt, ":var2", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_ep1",
    []],

  [party_tpl|auto_proceed|pt_mountain_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (party_get_slot, ":var0", "$g_encountered_party", 3),
      (store_current_hours, ":var1"),
      (store_sub, ":var2", ":var0", ":var1"),
      (gt, ":var2", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_ep1",
    []],

  [party_tpl|auto_proceed|pt_forest_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (party_get_slot, ":var0", "$g_encountered_party", 3),
      (store_current_hours, ":var1"),
      (store_sub, ":var2", ":var0", ":var1"),
      (gt, ":var2", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_ep1",
    []],

  [party_tpl|auto_proceed|anyone, "generic_bandits_ep1",
    [],
    "Warning: This line should never be displayed.",
    "generic_bandits_ep2",
    [
      (str_store_string, s11, "@What are you still doin' here?"),
      (str_store_string, s12, "@Get lost dammit. We got nothin' to say to you."),
      (str_store_string, s13, "@Don't test our patience. We got no time for the likes of you."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|anyone, "generic_bandits_ep2",
    [],
    "{s4}",
    "generic_bandits_ep3",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_ep3",
    [],
    "My mistake. It won't happen again.",
    "generic_bandits_ep4",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_ep3",
    [],
    "I thought about it, and I want you to empty your pockets.",
    "generic_bandits_ep5",
    []],

  [party_tpl|anyone, "generic_bandits_ep4",
    [],
    "Quit wastin' our time, would ya? We ain't got all week to dote on ya!",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|anyone, "generic_bandits_ep5",
    [],
    "You're going to regret sayin' that mighty quick.",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 3, 0),
      (party_ignore_player, "$g_encountered_party", 0),
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_looters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_e1",
    []],

  [party_tpl|auto_proceed|pt_mountain_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_e1",
    []],

  [party_tpl|auto_proceed|pt_forest_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_e1",
    []],

  [party_tpl|auto_proceed|anyone, "generic_bandits_e1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_e2",
    [
      (str_store_string, s11, "@Hey there {reg18?miss:mister}, Now I'ma gut you like a lil' pig."),
      (str_store_string, s12, "@I jus' loaded up ma gun, on account'a I'ma gon' shoot you right clear 'nless you gimme alla y'all money."),
      (str_store_string, s13, "@How 'bout y'all gimme all y'all got and we don't gonna have no trouble, hear? Else we gonna shot you up real bad."),
      (str_store_string, s14, "@You look pretty rich. Looks like you've got more money than me. That's not right. We all have guns. See where I'm going?"),
      (str_store_string, s15, "@This is a real dangerous part here you've just wandered into. Now we wouldn't want anyone to get hurt, would we? Hows about you just gimme some o' your nice shiny coins and nobody'll hurt nobody, hear?"),
      (str_store_string, s16, "@I'm gettin' tired of lettin' assholes like you slip through my fingers. Gimme some money and we won't have any trouble again. Got it?"),
      (str_store_string, s17, "@There's a toll for passin' through here, payable to us, so if you don't mind we'll just be collectin' our due from you."),
      (store_random_in_range, ":var0", 11, 17),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_bandits"),
    ]],

  [party_tpl|anyone, "generic_bandits_e2",
    [],
    "{s4}",
    "generic_bandits_e3",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_e3",
    [],
    "The only thing you're gonna get is hot lead from the barrel of my gun!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|anyone, "generic_bandits_e3",
    [],
    "Whoa, I've got money. There's no need to get violent.",
    "generic_bandits_eb1",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_e3",
    [
      (store_skill_level, reg1, "skl_persuasion", "trp_player"),
    ],
    "You should know that I'm under the protection of the Cottonwood Gang. (Persuasion)",
    "generic_bandits_e4",
    [
      (call_script, "script_persuasion_attempt", reg1),
    ]],

  [party_tpl|anyone, "generic_bandits_e4",
    [
      (eq, reg0, 0),
    ],
    "That's a goddamned lie and you know it! I'll have your head for that!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|anyone, "generic_bandits_e4",
    [
      (eq, reg0, 1),
    ],
    "Hmm, well them boys is expanded, I s'pose. If I find out you're lying to me, you're gonna regret it. Now get outta here.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|anyone, "generic_bandits_eb1",
    [
      (call_script, "script_party_store_robbery_amount_to_reg5", "$g_talk_party_faction_relation", "p_main_party", "$g_encountered_party"),
      (call_script, "script_game_get_money_text", reg5),
    ],
    "It sure is nice to find someone cooperative. If you pay us {s1}, we'll let you be on your way.",
    "generic_bandits_eb2",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_eb2",
    [],
    "Alright, here, take it.",
    "generic_bandits_eb3",
    [
      (troop_remove_gold, "trp_player", reg5),
    ]],

  [plyr|party_tpl|anyone, "generic_bandits_eb2",
    [],
    "I can't pay that much, you son of a bitch!",
    "generic_bandits_eb4",
    []],

  [party_tpl|anyone, "generic_bandits_eb4",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Well that's too bad now, inn'it? I guess we'll just have to sell you into slavery. Take {reg18?her:him}!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|anyone, "generic_bandits_eb3",
    [],
    "Was that so hard? Alright, we'll let you go now.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_looters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_n1",
    []],

  [party_tpl|auto_proceed|pt_mountain_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_n1",
    []],

  [party_tpl|auto_proceed|pt_forest_bandits, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "generic_bandits_n1",
    []],

  [party_tpl|auto_proceed|anyone, "generic_bandits_n1",
    [],
    "Warning: This line should never be displayed.",
    "generic_bandits_n2",
    []],

  [party_tpl|anyone, "generic_bandits_n2",
    [],
    "Huh? What the hell do you want?",
    "generic_bandits_n3",
    []],

  [plyr|party_tpl|anyone, "generic_bandits_n3",
    [],
    "Everything you're carrying and some target practice.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|anyone, "generic_bandits_n3",
    [],
    "[Leave]",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 3, 0),
      (party_ignore_player, "$g_encountered_party", 0),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_outlaws_american, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "outlaws_american_f1",
    [
      (str_store_string, s11, "@Hey there {reg18?miss:mister}. Know anywhere we can scare up some grub?"),
      (str_store_string, s12, "@Lucky you ain't on our list of people to rob!"),
      (str_store_string, s13, "@Bein' on the run from the law sure ain't easy. Sure is one hell of a fix we got ourselves into."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_outlaws_american, "outlaws_american_f1",
    [],
    "{s4}",
    "outlaws_american_f2",
    []],

  [plyr|party_tpl|pt_outlaws_american, "outlaws_american_f2",
    [],
    "You're mighty nice an' all, but I think it's time someone fetched you a bullet in the head.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_outlaws_american, "outlaws_american_f2",
    [],
    "I need some more outlaws to raise a ruckus. Any of you interested?",
    "outlaws_american_f4",
    []],

  [plyr|party_tpl|pt_outlaws_american, "outlaws_american_f2",
    [],
    "I've got no time to chat. Try to stay clear of the gallows.",
    "outlaws_american_f3",
    []],

  [party_tpl|pt_outlaws_american, "outlaws_american_f3",
    [],
    "Alright, then. Until next we meet.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_outlaws_american, "outlaws_american_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "You gotta be crazy to think that we'd join up with you. You ain't done us enough favors yet. What else ya want?",
    "outlaws_american_f2",
    []],

  [party_tpl|pt_outlaws_american, "outlaws_american_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Alright, I reckon you've done right by us so far. Some of us may consider joinin' up.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_outlaws_american, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "outlaws_american_e1",
    [
      (str_store_string, s11, "@It's yer money or yer life, {reg18?miss:mister}. No sudden moves or me and ma men'll kill ya."),
      (str_store_string, s12, "@Lucky fer you, ya caught me in a good mood. Hand over alls'a yer cash and I migh' jus' let you live."),
      (str_store_string, s13, "@Hey, looks like ya got nowhere to run. Hand over everything ya have or there'll be troubles."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_bandits"),
    ]],

  [party_tpl|pt_outlaws_american, "outlaws_american_e1",
    [],
    "{s4}",
    "outlaws_american_e2",
    []],

  [plyr|party_tpl|pt_outlaws_american, "outlaws_american_e2",
    [],
    "The only thing you're gonna get is hot lead from the barrel of my gun!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_outlaws_american, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "outlaws_american_n1",
    []],

  [party_tpl|pt_outlaws_american, "outlaws_american_n1",
    [],
    "Huh? What the hell do you want?",
    "outlaws_american_n2",
    []],

  [plyr|party_tpl|pt_outlaws_american, "outlaws_american_n2",
    [],
    "Your weapons, your clothes, and everything else you got.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_outlaws_american, "outlaws_american_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_outlaws_mexican, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "outlaws_mexican_f1",
    [
      (str_store_string, s11, "@Hey there {reg18?miss:mister}. Got any tequila?"),
      (str_store_string, s12, "@Amigo, it is good to see you. The men feel safer when you are around."),
      (str_store_string, s13, "@Fortune has not been kind to us, but we are glad that you have been."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_outlaws_mexican, "outlaws_mexican_f1",
    [],
    "{s4}",
    "outlaws_mexican_f2",
    []],

  [plyr|party_tpl|pt_outlaws_mexican, "outlaws_mexican_f2",
    [],
    "We ain't amigos no more. Get ready to die.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_outlaws_mexican, "outlaws_mexican_f2",
    [],
    "Necesito mas compadres. Any of you interested?",
    "outlaws_mexican_f4",
    []],

  [plyr|party_tpl|pt_outlaws_mexican, "outlaws_mexican_f2",
    [],
    "I've got no time to chat. Good luck.",
    "outlaws_mexican_f3",
    []],

  [party_tpl|pt_outlaws_mexican, "outlaws_mexican_f3",
    [],
    "Hasta luego.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_outlaws_mexican, "outlaws_mexican_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "No se ofenda, amigo. We don't trust you yet.",
    "outlaws_mexican_f2",
    []],

  [party_tpl|pt_outlaws_mexican, "outlaws_mexican_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Si, es possible. We could be very strong together.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_outlaws_mexican, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "outlaws_mexican_e1",
    [
      (str_store_string, s11, "@It's yer dinero or yer life, {reg18?senorita:senor}. Your choice."),
      (str_store_string, s12, "@You are lucky that I just had a good siesta. Hand over your money and I migh' jus' let you live."),
      (str_store_string, s13, "@Yo quierro tu dinero!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_scalphunters_enemy"),
    ]],

  [party_tpl|pt_outlaws_mexican, "outlaws_mexican_e1",
    [],
    "{s4}",
    "outlaws_mexican_e2",
    []],

  [plyr|party_tpl|pt_outlaws_mexican, "outlaws_mexican_e2",
    [],
    "The only thing you're gonna get is hot lead from the barrel of my gun!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_outlaws_mexican, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "outlaws_mexican_n1",
    []],

  [party_tpl|pt_outlaws_mexican, "outlaws_mexican_n1",
    [],
    "Que Pasa?",
    "outlaws_mexican_n2",
    []],

  [plyr|party_tpl|pt_outlaws_mexican, "outlaws_mexican_n2",
    [],
    "This is the part where I make you bleed.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_outlaws_mexican, "outlaws_mexican_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_imperialists, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "imperialists_f1",
    [
      (str_store_string, s11, "@These republican rebels be damned!  Hail Maximiliano!"),
      (str_store_string, s12, "@The glory of Mexico will be restored under our Maximiliano, not under Benito Juarez!"),
      (str_store_string, s13, "@The Mexican republican army has been giving us trouble up here in the north. We need to get back to our power base in Mexico city."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_imperialists, "imperialists_f1",
    [],
    "{s4}",
    "imperialists_f2",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_f2",
    [],
    "An Austrian Archduke has no right to rule Mexico. You will pay for his audacity!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_imperialists, "imperialists_f2",
    [],
    "I need more soldiers. Any of you interested?",
    "imperialists_f4",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_f2",
    [],
    "For the Empire! Adios, muchacho.",
    "imperialists_f3",
    []],

  [party_tpl|pt_imperialists, "imperialists_f3",
    [],
    "We salute you, compadre. Mexico is an empire, and it will stay as one!",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_imperialists, "imperialists_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "We must continue to fight for the Empire on our own. Maybe if you prove yourself we wil reconsider. What else do you need?",
    "imperialists_f2",
    []],

  [party_tpl|pt_imperialists, "imperialists_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Si. We can fight for you and we can fight for Maximiliano.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_imperialists, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
      (call_script, "script_disguise_attempt", 18),
      (eq, reg0, 1),
    ],
    "Warning: This line should never be displayed.",
    "imperialists_d1",
    [
      (str_store_string, s11, "@What's this?! We thought you were an enemy! Our mistake."),
      (str_store_string, s12, "@Ah, I see that you are not a threat to the empire. Carry on."),
      (str_store_string, s13, "@We thought you were a damned republican soldier! Leave quickly, and don't confuse us again!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_imperialists, "imperialists_d1",
    [],
    "{s4}",
    "imperialists_d2",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_d2",
    [],
    "I'm someone you should be worried about. Let me show you.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_imperialists, "imperialists_d2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes, {reg18?ma'am:sir}. Thank you. Viva la Maximiliano!",
    "imperialists_d3",
    []],

  [party_tpl|pt_imperialists, "imperialists_d3",
    [],
    "Viva Mexico!",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_imperialists, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "imperialists_e1",
    [
      (str_store_string, s11, "@You don't fight for Emperor Maximiliano! Pay us or die!"),
      (str_store_string, s12, "@By order of Emperor Maximiliano, you are hereby ordered to pay the imperial war tax!"),
      (str_store_string, s13, "@You are trespassing on lands claimed by the Mexican Empire. The punishment is death by firing squad. Of course, this can be avoided by making a donation to the imperial treasury."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_imperialists"),
    ]],

  [party_tpl|pt_imperialists, "imperialists_e1",
    [],
    "{s4}",
    "imperialists_e2",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_e2",
    [],
    "Is that a threat? Me and my boys don't take kindly to threats, amigo.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_imperialists, "imperialists_e2",
    [],
    "I have no interest in a fight. How much do we have to pay to avoid this?",
    "imperialists_e4",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_e2",
    [
      (store_skill_level, reg1, "skl_persuasion", "trp_player"),
      (ge, reg1, 1),
    ],
    "You're mistaken. I fight as a foreign legionaire for the Emperor! (Persuasion)",
    "imperialists_e3",
    [
      (call_script, "script_persuasion_attempt", reg1),
    ]],

  [party_tpl|pt_imperialists, "imperialists_e3",
    [
      (eq, reg0, 0),
    ],
    "Legionaires this far north? You must think I am a fool! Prepare to face the wrath of the emperor!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_imperialists, "imperialists_e3",
    [
      (eq, reg0, 1),
    ],
    "Hmm..there are more legionaires around these days, and you all look the same to me. Very well, begone.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_imperialists, "imperialists_e4",
    [
      (call_script, "script_party_store_robbery_amount_to_reg5", "$g_talk_party_faction_relation", "p_main_party", "$g_encountered_party"),
      (call_script, "script_game_get_money_text", reg5),
    ],
    "Your contribution to the imperial tresury will be {s1}. Pay Immediately or die.",
    "imperialists_e5",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_e5",
    [
      (store_troop_gold, reg2),
      (ge, reg2, reg5),
    ],
    "I suppose I can pay that.",
    "imperialists_e6",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_e5",
    [
      (store_troop_gold, reg2),
      (lt, reg2, reg5),
    ],
    "Sorry, but I don't have that much.",
    "imperialists_e7",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_e5",
    [],
    "I'll die before I let you take even a peso from me!",
    "imperialists_e7",
    []],

  [party_tpl|pt_imperialists, "imperialists_e6",
    [],
    "The empire thanks you for your generosity.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", reg5),
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_imperialists, "imperialists_e7",
    [],
    "Then we'll make an example out of you!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_imperialists, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "imperialists_n1",
    []],

  [party_tpl|pt_imperialists, "imperialists_n1",
    [],
    "Who are you to disturb an officer of the empire of Mexico?",
    "imperialists_n2",
    []],

  [plyr|party_tpl|pt_imperialists, "imperialists_n2",
    [],
    "The unjust reign of Maximiliano will soon come to an end! It begins here and now!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_imperialists, "imperialists_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_confederate_renegades, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "confederate_renegades_f1",
    [
      (str_store_string, s11, "@We ain't sure how to fight the war now. Maybe we should break President Davis outta that prison back in Virginia."),
      (str_store_string, s12, "@The only thing worse than a yankee is a galvanized yankee! We'll kill those traitors right where they stand!"),
      (str_store_string, s13, "@It makes me sick what these yankee boys are doing to our country. We might not be able to win, but we won't stop fighting it!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_confederate_renegades_ally"),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_f1",
    [],
    "{s4}",
    "confederate_renegades_f2",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_f2",
    [],
    "I got your states rights right here, you saphead! Come and get 'em!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_f2",
    [],
    "I need brave soldiers. Any of you interested?",
    "confederate_renegades_f4",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_f2",
    [],
    "The south will rise again!",
    "confederate_renegades_f3",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_f2",
    [],
    "I have to be off. Be seein' you.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_f3",
    [],
    "Ah, someone after my own heart! Good journeys, friend.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "We may be acquaintences, but we ain't exactly friends yet. No offense, but we prefer to wait until we like you more. Now what's on your mind?",
    "confederate_renegades_f2",
    []],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Frankly {reg18?ma'am:sir}, it would be an honor to fight along your side.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_confederate_renegades, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
      (call_script, "script_disguise_attempt", 21),
      (eq, reg0, 1),
    ],
    "Warning: This line should never be displayed.",
    "confederate_renegades_d1",
    [
      (str_store_string, s11, "@By Jiminy! Nice seein' a fine southerner such as yourself round these god forsaken parts!"),
      (str_store_string, s12, "@Well look at this! A fellow confederate renegade!"),
      (str_store_string, s13, "@My mistake, friend. From a distance I thought you might have been a yankee. Criminy!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_confederate_renegades_neutral"),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_d1",
    [],
    "{s4}",
    "confederate_renegades_d2",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_d2",
    [],
    "I'm about as much southern as you are good lookin'. Get ready for a fight.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_d2",
    [],
    "A proud confederate, at your service. However, I regret that I must be own my way.",
    "confederate_renegades_d3",
    []],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_d3",
    [],
    "Good to see you out here anyhow. We best be makin' tracks as well. C'mon boys!",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_confederate_renegades, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "confederate_renegades_e1",
    [
      (str_store_string, s11, "@Welcome to our confederacy fund raiser. You are required to make a rather sizeable donation."),
      (str_store_string, s12, "@We've got more ammunition than money, and we intend to use it if'n you don't pay us to go away!"),
      (str_store_string, s13, "@We need money to fight the yankees and we have guns. So you will donate to our cause and then you can be on your way."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_confederate_renegades_enemy"),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_e1",
    [],
    "{s4}",
    "confederate_renegades_e2",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_e2",
    [],
    "I think I'll just reacquisition any assets you may have already siezed.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_e2",
    [],
    "There's no need for violence.  I will pay. ",
    "confederate_renegades_e4",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_e2",
    [
      (store_skill_level, reg1, "skl_persuasion", "trp_player"),
      (ge, reg1, 1),
    ],
    "You're mistaken. I fight for the glory of the south! (Persuasion)",
    "confederate_renegades_e3",
    [
      (call_script, "script_persuasion_attempt", reg1),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_e3",
    [
      (eq, reg0, 0),
    ],
    "You must think I'm a damn idiot. You smell like yankee through and through. Kill this bastard!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_e3",
    [
      (eq, reg0, 1),
    ],
    "Hmm..well I believe you, though I don't rightly know why. Get lost 'fore I change my mind.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_e4",
    [
      (call_script, "script_party_store_robbery_amount_to_reg5", "$g_talk_party_faction_relation", "p_main_party", "$g_encountered_party"),
      (call_script, "script_game_get_money_text", reg5),
    ],
    "Your mandatory donation to the Confederate cause will be {s1}. We expect your payment now.",
    "confederate_renegades_e5",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_e5",
    [
      (store_troop_gold, reg2),
      (ge, reg2, reg5),
    ],
    "Alright. Here is your money.",
    "confederate_renegades_e6",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_e5",
    [
      (store_troop_gold, reg2),
      (lt, reg2, reg5),
    ],
    "Sorry, but I don't have much.",
    "confederate_renegades_e7",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_e5",
    [],
    "I don't plan on paying you a damn thing.",
    "confederate_renegades_e7",
    []],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_e6",
    [],
    "The confederacy appreciates your support. Much obliged.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", reg5),
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_e7",
    [],
    "Then we'll just take what you're carrying as payment!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_confederate_renegades, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "confederate_renegades_n1",
    [
      (play_sound, "snd_encounter_confederate_renegades_neutral"),
    ]],

  [party_tpl|pt_confederate_renegades, "confederate_renegades_n1",
    [],
    "Huh? You know you're disturbin' the risin up of the south?",
    "confederate_renegades_n2",
    []],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_n2",
    [],
    "Let me show you what I think of you confederates.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_confederate_renegades, "confederate_renegades_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_indian_raiders, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "indian_raiders_f1",
    [
      (str_store_string, s11, "@The white man takes our lands and pride. He makes us live like animals on a farm. We will fight for the way of our people."),
      (str_store_string, s12, "@The white man promises us protection and peace. Our brothers trade their lands for paper signed by the white man. These treaties are nothing but lies and tricks!"),
      (str_store_string, s13, "@We have tried to make peace with the white man, but have found only suffering. Now we make war!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_indian_raiders, "indian_raiders_f1",
    [],
    "{s4}",
    "indian_raiders_f2",
    []],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_f2",
    [],
    "I'll take your horses and your guns! Get ready to meet your maker!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_f2",
    [],
    "I need brave warriors to make war. Will your warriors help me?.",
    "indian_raiders_f4",
    []],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_f2",
    [],
    "I must go. May the red man live free once more.",
    "indian_raiders_f3",
    []],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_f2",
    [],
    "Yeah, gotta go. Good luck with that. ",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_indian_raiders, "indian_raiders_f3",
    [],
    "May the great spirit watch over you and keep you safe.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_indian_raiders, "indian_raiders_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "We must protect our homelands. You are a friend to us, but for now our peoples needs come before yours.",
    "indian_raiders_f2",
    []],

  [party_tpl|pt_indian_raiders, "indian_raiders_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Yes. Let us show our enemies the ferocity of our people.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_indian_raiders, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
      (call_script, "script_disguise_attempt", 20),
      (eq, reg0, 1),
    ],
    "Warning: This line should never be displayed.",
    "indian_raiders_d1",
    [
      (str_store_string, s11, "@The great spirit watches us now. Many whites will be killed this day!"),
      (str_store_string, s12, "@I did not think you to be a fellow warrior, but I see now that you are."),
      (str_store_string, s13, "@My friend, I greet you and wish you peace in this time of death."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_indian_raiders, "indian_raiders_d1",
    [],
    "{s4}",
    "indian_raiders_d2",
    []],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_d2",
    [],
    "I kill everyone I don't like, and right now that means you.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_d2",
    [],
    "I greet you as a friend. We leave now in search of vengeance.",
    "indian_raiders_d3",
    []],

  [party_tpl|pt_indian_raiders, "indian_raiders_d3",
    [],
    "May the wind always be at your back.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_indian_raiders, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "indian_raiders_e1",
    [
      (str_store_string, s11, "@We come for your horses, but we will leave no one alive."),
      (str_store_string, s12, "@The great spirit has shown me the way to you. Now I prove my might."),
      (str_store_string, s13, "@It is a good day to die!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_indian_raiders_enemy"),
    ]],

  [party_tpl|pt_indian_raiders, "indian_raiders_e1",
    [],
    "{s4}",
    "indian_raiders_e2",
    []],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_e2",
    [],
    "If you want a fight, you'll have it!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_e2",
    [
      (store_skill_level, reg1, "skl_persuasion", "trp_player"),
      (ge, reg1, 1),
    ],
    "I mean no harm to the red man. I come here to help defend his lands. (Persuasion)",
    "indian_raiders_e3",
    [
      (call_script, "script_persuasion_attempt", reg1),
    ]],

  [party_tpl|pt_indian_raiders, "indian_raiders_e3",
    [
      (eq, reg0, 0),
    ],
    "Lies! You are an enemy to my people. You will breathe no more!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_indian_raiders, "indian_raiders_e3",
    [
      (eq, reg0, 1),
    ],
    "A vision has shown me that your words are true. Go, and do great harm to our enemies.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_indian_raiders, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "indian_raiders_n1",
    []],

  [party_tpl|pt_indian_raiders, "indian_raiders_n1",
    [],
    "What is it you wish to say?",
    "indian_raiders_n2",
    []],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_n2",
    [],
    "I hope you've raided some nice gear. I intend to add it to my collection.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_indian_raiders, "indian_raiders_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_scalphunters, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "scalphunters_f1",
    [
      (str_store_string, s11, "@Como estas? The weather is not so bad right now. It makes the scalp come off muy facilmente."),
      (str_store_string, s12, "@We've met a lot of travelers so far. Business is good!"),
      (str_store_string, s13, "@Keep your knife sharp. You never know when you need it!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_scalphunters, "scalphunters_f1",
    [],
    "{s4}",
    "scalphunters_f2",
    []],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_f2",
    [],
    "When your men are all dead, I'll take your scalp first.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_f2",
    [],
    "Necesito mas soldados. Anyone interested?",
    "scalphunters_f4",
    []],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_f2",
    [],
    "Si, muy bien. Buena suerte, Amigo.",
    "scalphunters_f3",
    []],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_f2",
    [],
    "I have to keep traveling.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_scalphunters, "scalphunters_f3",
    [],
    "Si amigo! Adios!",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_scalphunters, "scalphunters_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "No. We don't gain much by working for you, {playername}. Maybe you ask us later when we are amigos?",
    "scalphunters_f2",
    []],

  [party_tpl|pt_scalphunters, "scalphunters_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Si. We will find many more scalps when fighting in your army.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_scalphunters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
      (call_script, "script_disguise_attempt", 19),
      (eq, reg0, 1),
    ],
    "Warning: This line should never be displayed.",
    "scalphunters_d1",
    [
      (str_store_string, s11, "@Hola. It is good that you carry a scalphunter's knife. We will not harm a compadre. Adios."),
      (str_store_string, s12, "@Ah, we know by the knife on your belt that you must be a scalphunter. We will leave you be."),
      (str_store_string, s13, "@It seems you carry the scalphunter's knife. We could have sworn you were an enemy. Lo siento."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_scalphunters, "scalphunters_d1",
    [],
    "{s4}",
    "scalphunters_d2",
    []],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_d2",
    [],
    "I just wanted to get you where I wanted you. Now it's time to kill you.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_d2",
    [],
    "Happy hunting and good fortune.",
    "scalphunters_d3",
    []],

  [party_tpl|pt_scalphunters, "scalphunters_d3",
    [],
    "Gracias amigo. Hasta luego.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_scalphunters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "scalphunters_e1",
    [
      (str_store_string, s11, "@You will die like dogs!"),
      (str_store_string, s12, "@No se preocupe, Amigo. Voy a conseguir dinero para la cabeza!"),
      (str_store_string, s13, "@Yo quiero tu cabeza!"),
      (store_random_in_range, "$scalphunters_random", 11, 14),
      (str_store_string_reg, s4, "$scalphunters_random"),
      (play_sound, "snd_encounter_scalphunters_enemy"),
    ]],

  [party_tpl|pt_scalphunters, "scalphunters_e1",
    [],
    "{s4}",
    "scalphunters_e2",
    []],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_e2",
    [],
    "You picked the wrong scalp, Amigo.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_e2",
    [
      (store_skill_level, reg1, "skl_persuasion", "trp_player"),
      (ge, reg1, 1),
      (eq, "$scalphunters_random", 11),
    ],
    "No! We will fight like lions! (Persuasion)",
    "scalphunters_e3",
    [
      (call_script, "script_persuasion_attempt", reg1),
    ]],

  [party_tpl|pt_scalphunters, "scalphunters_e3",
    [
      (eq, reg0, 0),
    ],
    "Este idiota esta loco. We are doing you a favor by cutting off your scalp.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_scalphunters, "scalphunters_e3",
    [
      (eq, reg0, 1),
    ],
    "Ha! You make us laugh, Amigo! We let you live today.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_scalphunters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "scalphunters_n1",
    []],

  [party_tpl|pt_scalphunters, "scalphunters_n1",
    [],
    "Que? What do you want from us?",
    "scalphunters_n2",
    []],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_n2",
    [],
    "I want to see how many scalps I can take off your bodies.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_scalphunters, "scalphunters_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_trappers, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "trappers_f1",
    [
      (str_store_string, s11, "@We're just trappers on the way t'our next hunt. Please don't scare none of our game off, ya hear!"),
      (str_store_string, s12, "@We're just takin' our furs to town. We don't wanna cause no trouble."),
      (str_store_string, s13, "@Just finished huntin' some nice bucks with me 'n my boys. Ya just gotta get lucky, that's all."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_trappers_neutral"),
    ]],

  [party_tpl|pt_trappers, "trappers_f1",
    [],
    "{s4}",
    "trappers_f2",
    []],

  [plyr|party_tpl|pt_trappers, "trappers_f2",
    [],
    "I'm gonna tear your scruffy beards right off of your ugly faces.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_trappers, "trappers_f2",
    [],
    "Any one want to try hunting something that shoots back?",
    "trappers_f4",
    []],

  [plyr|party_tpl|pt_trappers, "trappers_f2",
    [],
    "I just wanted to say hello. I'll be on my way.",
    "trappers_f3",
    []],

  [party_tpl|pt_trappers, "trappers_f3",
    [],
    "Shoot straight and shoot often.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_trappers, "trappers_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "That sounds awfully unsafe, especially for someone we ain't all that crazy about. Maybe after you has a better reputation fer yerself.",
    "trappers_f2",
    []],

  [party_tpl|pt_trappers, "trappers_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Yeah, now that sounds like an adventure.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_trappers, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "trappers_n1",
    [
      (str_store_string, s11, "@The next hunt can wait. Looks like we got some more interesting game here."),
      (str_store_string, s12, "@I heard of someone matching your description that had it in fer us regular folk.  Now, tell me that ain't you?"),
      (str_store_string, s13, "@Interested in visitin' the great hunting ground in the sky?"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_trappers_enemy"),
    ]],

  [party_tpl|pt_trappers, "trappers_n1",
    [],
    "{s4}",
    "trappers_n2",
    []],

  [plyr|party_tpl|pt_trappers, "trappers_n2",
    [],
    "How about I kill you and take everything you've got?",
    "trappers_n3",
    []],

  [plyr|party_tpl|pt_trappers, "trappers_n2",
    [],
    "It's time to bring an end to your reckless destruction of wildlife.",
    "trappers_n4",
    []],

  [plyr|party_tpl|pt_trappers, "trappers_n2",
    [],
    "Good luck with your huntin'. Good day.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_trappers, "trappers_n3",
    [],
    "That's the last mistake you're ever gonna make. We'll outshoot you any day of the week.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_trappers, "trappers_n4",
    [],
    "Now wait right there! Me 'n my boys are just makin' an honest livin'. There ain't no reckless destruction of nothin' except fer when I shoot you square in the head!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_miners, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "miners_f1",
    [
      (str_store_string, s11, "@We're just miners lookin' fer our next bonanza. Don't ya start watchin' where we're lookin'!"),
      (str_store_string, s12, "@We're just thinkin' bout headin' back fer supplies.  We don't wanna cause no trouble."),
      (str_store_string, s13, "@Just finished minin' and pannin' half o' this here country, and we ain't found shit."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_miners_neutral"),
    ]],

  [party_tpl|pt_miners, "miners_f1",
    [],
    "{s4}",
    "miners_f2",
    []],

  [plyr|party_tpl|pt_miners, "miners_f2",
    [],
    "Let's see how much gold I can find on your corpses.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_miners, "miners_f2",
    [],
    "I'm looking for some strong men to form my frontline. Any one interested?",
    "miners_f4",
    []],

  [plyr|party_tpl|pt_miners, "miners_f2",
    [],
    "I just wanted to say hello. I'll be headed on.",
    "miners_f3",
    []],

  [party_tpl|pt_miners, "miners_f3",
    [],
    "Best of luck to you.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_miners, "miners_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "Nope, don't think that would be too smart. Maybe after you are better known to the common man 'round these parts.",
    "miners_f2",
    []],

  [party_tpl|pt_miners, "miners_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Well, we thought you'd never ask. There's gotta be more riches to find where yer goin'!",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_miners, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "miners_n1",
    [
      (str_store_string, s11, "@Eureka! Looks like we just struck it rich. I bet you got more gold in yer pockets than all of California!"),
      (str_store_string, s12, "@You look like that feller that's been doing wrong by folks. If'n you tangle with us, we'll fix that."),
      (str_store_string, s13, "@We know who you are, but we don't want no trouble. Just let us be."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_miners_enemy"),
    ]],

  [party_tpl|pt_miners, "miners_n1",
    [],
    "{s4}",
    "miners_n2",
    []],

  [plyr|party_tpl|pt_miners, "miners_n2",
    [],
    "Only thing better than a dirty miner is a dead miner.",
    "miners_n3",
    []],

  [plyr|party_tpl|pt_miners, "miners_n2",
    [],
    "I hope you dug yourself I hole before I got here.",
    "miners_n4",
    []],

  [plyr|party_tpl|pt_miners, "miners_n2",
    [],
    "Good luck with your minin'. Good day.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_miners, "miners_n3",
    [],
    "I hope you had a lucky week, cause I expect to find gold on your body.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_miners, "miners_n4",
    [],
    "I just might have, but I intend to put you in it!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_homesteaders, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "homesteaders_f1",
    [
      (str_store_string, s11, "@We're just homesteaders lookin' fer a place to call our own. Please leave us be."),
      (str_store_string, s12, "@We've seen so much death on the journey from the East. I sure hope life here is better than what we left behind."),
      (str_store_string, s13, "@We've been wandering around this country, and we still haven't seen anything like the stories we heard back east."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_farmers_neutral"),
    ]],

  [party_tpl|pt_homesteaders, "homesteaders_f1",
    [],
    "{s4}",
    "homesteaders_f2",
    []],

  [plyr|party_tpl|pt_homesteaders, "homesteaders_f2",
    [],
    "I think I'll kill you now. I need something weak to kill.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_homesteaders, "homesteaders_f2",
    [],
    "I'm looking for extra help in my army. Any one interested?",
    "homesteaders_f4",
    []],

  [plyr|party_tpl|pt_homesteaders, "homesteaders_f2",
    [],
    "I just wanted to say hello. Good day.",
    "homesteaders_f3",
    []],

  [party_tpl|pt_homesteaders, "homesteaders_f3",
    [],
    "Good fortune to ya.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_homesteaders, "homesteaders_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "We don't think that would be proper. We aren't too sure about you yet. Now if you were famous, now that'd be a different story!",
    "homesteaders_f2",
    []],

  [party_tpl|pt_homesteaders, "homesteaders_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "Well, we ain't the best fighters an' all, but we trust ya'll to do what's right.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_homesteaders, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "homesteaders_n1",
    [
      (str_store_string, s11, "@We heard stories about men like you on the way out. We don't want to fight, but we will if it comes to it."),
      (str_store_string, s12, "@We ain't got nothing worth stealin', so just let us be."),
      (str_store_string, s13, "@You goddamned bandits! Won't you just ever let us poor folk be?"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
      (play_sound, "snd_encounter_farmers_enemy"),
    ]],

  [party_tpl|pt_homesteaders, "homesteaders_n1",
    [],
    "{s4}",
    "homesteaders_n2",
    []],

  [plyr|party_tpl|pt_homesteaders, "homesteaders_n2",
    [],
    "The west ain't no place for folks like you. Time for some target practice.",
    "homesteaders_n3",
    []],

  [plyr|party_tpl|pt_homesteaders, "homesteaders_n2",
    [],
    "Give me everything you're carrying with you.",
    "homesteaders_n4",
    []],

  [plyr|party_tpl|pt_homesteaders, "homesteaders_n2",
    [],
    "Good luck findin' your new home. Good day.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_homesteaders, "homesteaders_n3",
    [],
    "Well you'll find that we're no pushovers. We fought through Indian territory, and we can fight through you!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_homesteaders, "homesteaders_n4",
    [],
    "I'm afraid we can't do that.  We'll starve without our food and goods. You'll have to fight us for them.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_bounty_hunters_honorable, "start",
    [
      (eq, "$talk_context", 2),
      (party_slot_eq, "$g_encountered_party", 4, 17),
      (eq, "$g_current_ambush_detected", 1),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_b1",
    []],

  [party_tpl|auto_proceed|pt_bounty_hunters_dishonorable, "start",
    [
      (eq, "$talk_context", 2),
      (party_slot_eq, "$g_encountered_party", 4, 17),
      (eq, "$g_current_ambush_detected", 1),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_b1",
    []],

  [party_tpl|auto_proceed|anyone, "generic_bounty_hunter_b1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_b2",
    [
      (str_store_string, s11, "@What? How in the hell did you get here so fast?! We lost the advantage, boys! Kill 'em anyway!"),
      (str_store_string, s12, "@What the hell? You're not supposed to be here yet! Kill this miserable {reg18?bitch:son of a bitch} for makin' us look bad!"),
      (str_store_string, s13, "@Where in the hell did you come from? Over here boys! Get yer guns on and fight!"),
      (str_store_string, s14, "@Shit! You worthless bastards let 'em sneak up on us! Kill 'em fast before we're overrun!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|anyone, "generic_bounty_hunter_b2",
    [],
    "{s4}",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 4, -1),
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_bounty_hunters_honorable, "start",
    [
      (eq, "$talk_context", 2),
      (party_slot_eq, "$g_encountered_party", 4, 17),
      (neq, "$g_current_ambush_detected", 1),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_a1",
    []],

  [party_tpl|auto_proceed|pt_bounty_hunters_dishonorable, "start",
    [
      (eq, "$talk_context", 2),
      (party_slot_eq, "$g_encountered_party", 4, 17),
      (neq, "$g_current_ambush_detected", 1),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_a1",
    []],

  [party_tpl|auto_proceed|anyone, "generic_bounty_hunter_a1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_a2",
    [
      (str_store_string, s11, "@Here we go, boys! Ambush {reg18?her:him} now!"),
      (str_store_string, s12, "@Ambush this miserable {reg18?bitch:son of a bitch}!"),
      (str_store_string, s13, "@Now's our chance that the troops are separated! Ambush {reg18?her:him}!"),
      (str_store_string, s14, "@We're in position! Spring the ambush now!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|anyone, "generic_bounty_hunter_a2",
    [],
    "{s4}",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 4, -1),
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_bounty_hunters_honorable, "start",
    [
      (eq, "$talk_context", 2),
      (neg|party_slot_eq, "$g_encountered_party", 4, 17),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_c1",
    []],

  [party_tpl|auto_proceed|pt_bounty_hunters_dishonorable, "start",
    [
      (eq, "$talk_context", 2),
      (neg|party_slot_eq, "$g_encountered_party", 4, 17),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_c1",
    []],

  [party_tpl|auto_proceed|anyone, "generic_bounty_hunter_c1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Warning: This line should never be displayed.",
    "generic_bounty_hunter_c2",
    [
      (str_store_string, s11, "@Here we go, boys! We finally caught up to {reg18?her:him}!"),
      (str_store_string, s12, "@Catch this miserable {reg18?bitch:son of a bitch} and make {reg18?her:him} pay for runnin' off!"),
      (str_store_string, s13, "@Sombody shoot this sneaky {reg18?whore:bastard} in the leg! {reg18?She:He} ain't runnin' no more!"),
      (str_store_string, s14, "@Let's show this {reg18?whore:bastard} what we do to miserable cowards!"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|anyone, "generic_bounty_hunter_c2",
    [],
    "{s4}",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_village_farmers, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    " {reg18?Ma'am:Sir}, we're only poor farmers from {s11}. {reg1?We are taking our products to the market at {s12}.:We are returning from the market at {s12} back to our village.}",
    "village_farmer_talk",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 5),
      (party_get_slot, ":var1", "$g_encountered_party", 123),
      (party_get_slot, ":var2", ":var1", 121),
      (str_store_party_name, s11, ":var1"),
      (str_store_party_name, s12, ":var2"),
      (assign, reg1, 1),
      (try_begin),
        (party_slot_eq, ":var0", 0, 4),
        (assign, reg1, 0),
      (try_end),
      (agent_play_sound, "$g_talk_agent", "snd_encounter_farmers_neutral"),
    ]],

  [party_tpl|pt_village_farmers, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "{reg18?Ma'am:Sir}, we know who you are. We're just poor farmers from {s11}, and we've got nothing for you to steal. {reg1?We are taking our products to the market at {s12}.:We are returning from the market at {s12} back to our village.} If you let us part wasy amicably, we'll never tell another soul that we saw you.",
    "village_farmer_talk",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 5),
      (party_get_slot, ":var1", "$g_encountered_party", 123),
      (party_get_slot, ":var2", ":var1", 121),
      (str_store_party_name, s11, ":var1"),
      (str_store_party_name, s12, ":var2"),
      (assign, reg1, 1),
      (try_begin),
        (party_slot_eq, ":var0", 0, 4),
        (assign, reg1, 0),
      (try_end),
      (agent_play_sound, "$g_talk_agent", "snd_encounter_farmers_enemy"),
    ]],

  [plyr|anyone, "village_farmer_talk",
    [
      (eq, "$talk_context", 2),
    ],
    "We'll see how poor you are after I take what you've got!",
    "close_window",
    []],

  [plyr|anyone, "village_farmer_talk",
    [],
    "Alright, then. Don't let me slow you down.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_bank_defenders, "start",
    [
      (eq, "$talk_context", 2),
    ],
    "Hand over your weapons, maggot. You and your puny gang will hang at the gallows.",
    "close_window",
    [
      (play_sound, "snd_encounter_bank_defenders_enemy"),
    ]],

  [party_tpl|pt_stagecoach, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "There's no time to listen to your yammering. We're in a hurry to get to {s11}.",
    "stagecoach_talk",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 5),
      (str_store_party_name, s11, ":var0"),
      (play_sound, "snd_encounter_stagecoach_neutral"),
    ]],

  [party_tpl|pt_stagecoach, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "We know who you are, and we don't want no trouble. We're in a hurry to get to {s11}.",
    "stagecoach_talk",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 5),
      (str_store_party_name, s11, ":var0"),
      (play_sound, "snd_encounter_stagecoach_enemy"),
    ]],

  [plyr|anyone, "stagecoach_talk",
    [],
    "I don't think so. Not if I've got anything to do with it.",
    "close_window",
    []],

  [plyr|anyone, "stagecoach_talk",
    [],
    "Alright, then. Carry on.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_american_chain_gang, "start",
    [
      (eq, "$talk_context", 2),
    ],
    "Keep walking, nothin' to see here.",
    "american_chain_gang_talk",
    []],

  [plyr|anyone, "american_chain_gang_talk",
    [],
    "No can do, boss. I'm setting these chain monkeys free.",
    "american_chain_gang_attack",
    []],

  [plyr|anyone, "american_chain_gang_talk",
    [],
    "Alright, don't let me get in your way.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_american_chain_gang, "american_chain_gang_attack",
    [],
    "Like hell you are! Get 'em, boys!",
    "close_window",
    []],

  [party_tpl|pt_mexican_chain_gang, "start",
    [
      (eq, "$talk_context", 2),
    ],
    "These men are prisoners of the Mexican Republic. Vete!",
    "mexican_chain_gang_talk",
    []],

  [plyr|anyone, "mexican_chain_gang_talk",
    [],
    "I don't think so, amigo. I'm taking these boys north of the border. Mexican law don't hold no water there.",
    "mexican_chain_gang_attack",
    []],

  [plyr|anyone, "mexican_chain_gang_talk",
    [],
    "Alright, don't let me get in your way.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_mexican_chain_gang, "mexican_chain_gang_attack",
    [],
    "Imbecile! You will hold no water too once we shoot you full of holes!",
    "close_window",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 3),
      (party_slot_eq, "$g_encountered_party", 0, 2),
      (party_get_num_companion_stacks, ":var0", "$g_encountered_party"),
      (ge, ":var0", 1),
      (party_stack_get_troop_id, ":var1", "$g_encountered_party", 0),
      (eq, ":var1", "$g_talk_troop"),
      (eq, "$talk_context", 0),
    ],
    "Yes, {playername}? What can I do for you?",
    "member_castellan_talk",
    []],

  [anyone, "member_castellan_pretalk",
    [],
    "Anything else?",
    "member_castellan_talk",
    []],

  [plyr|anyone, "member_castellan_talk",
    [],
    "I want to review the castle garrison.",
    "member_review_castle_garrison",
    []],

  [anyone, "member_review_castle_garrison",
    [],
    "Of course. Here are our lists, let me know of any changes you require...",
    "member_castellan_pretalk",
    [
      (change_screen_exchange_members, 0),
    ]],

  [plyr|anyone, "member_castellan_talk",
    [],
    "Let me see your equipment.",
    "member_review_castellan_equipment",
    []],

  [anyone, "member_review_castellan_equipment",
    [],
    "Very well, it's all here...",
    "member_castellan_pretalk",
    [
      (change_screen_equip_other),
    ]],

  [plyr|anyone, "member_castellan_talk",
    [],
    "I want you to abandon the castle and join my party.",
    "member_castellan_join",
    []],

  [anyone, "member_castellan_join",
    [
      (party_can_join_party, "$g_encountered_party", "p_main_party"),
    ],
    "I've grown quite fond of the place... But if it is your wish, {playername}, I'll come with you.",
    "close_window",
    [
      (assign, "$g_move_heroes", 1),
      (call_script, "script_party_add_party", "p_main_party", "$g_encountered_party"),
      (party_clear, "$g_encountered_party"),
    ]],

  [anyone, "member_castellan_join",
    [],
    "And where would we sleep? You're dragging a whole army with you, {playername}, there's no more room for all of us.",
    "member_castellan_pretalk",
    []],

  [plyr|anyone, "member_castellan_talk",
    [],
    "[Leave]",
    "close_window",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 3),
      (neg|main_party_has_troop, "$g_talk_troop"),
      (eq, "$talk_context", 2),
    ],
    "Do you want me to rejoin you?",
    "member_wilderness_talk",
    []],

  [anyone, "start",
    [
      (neg|main_party_has_troop, "$g_talk_troop"),
      (eq, "$g_encountered_party", "p_four_ways_inn"),
    ],
    "Do you want me to rejoin you?",
    "member_inn_talk",
    []],

  [trp_kidnapped_girl, "member_chat",
    [],
    "Are we home yet?",
    "kidnapped_girl_chat_1",
    []],

  [plyr|trp_kidnapped_girl, "kidnapped_girl_chat_1",
    [],
    "Not yet.",
    "kidnapped_girl_chat_2",
    []],

  [trp_kidnapped_girl, "kidnapped_girl_chat_2",
    [],
    "I can't wait to get back. I've missed my family so much, I'd give anything to see them again.",
    "close_window",
    []],

  [anyone, "member_chat",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
    ],
    "{playername}, when do you think we can reach our destination?",
    "member_lady_1",
    []],

  [plyr|anyone, "member_lady_1",
    [],
    "We still have a long way ahead of us.",
    "member_lady_2a",
    []],

  [plyr|anyone, "member_lady_1",
    [],
    "Very soon. We're almost there.",
    "member_lady_2b",
    []],

  [anyone, "member_lady_2a",
    [],
    "Ah, I am going to enjoy the road for a while longer then. I won't complain. I find riding out in the open so much more pleasant than sitting in the fort all day. You know, I envy you. You can live like this all the time.",
    "close_window",
    []],

  [anyone, "member_lady_2b",
    [],
    "That's good news. Not that I don't like your company, but I did miss my little luxuries. Still I am sorry that I'll leave you soon. You must promise me, you'll come visit me when you can.",
    "close_window",
    []],

  [anyone, "member_chat",
    [
      (is_between, "$g_talk_troop", 0, 0),
    ],
    "Greetings, {playername}, my first and foremost vassal. I await your counsel.",
    "supported_pretender_talk",
    []],

  [anyone, "supported_pretender_pretalk",
    [],
    "Anything else?",
    "supported_pretender_talk",
    []],

  [plyr|anyone, "supported_pretender_talk",
    [],
    "What do you think about our progress so far?",
    "pretender_progress",
    []],

  [anyone, "pretender_progress",
    [
      (assign, reg11, 0),
      (assign, reg13, 0),
      (assign, reg14, 0),
      (assign, reg15, 0),
      (assign, reg21, 0),
      (assign, reg23, 0),
      (assign, reg24, 0),
      (assign, reg25, 0),
      (try_for_range, ":var0", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (store_troop_faction, ":var1", ":var0"),
        (try_begin),
          (eq, ":var1", "fac_player_supporters_faction"),
          (neq, ":var0", "trp_player"),
          (neq, ":var0", "$supported_pretender"),
          (val_add, reg11, 1),
        (else_try),
          (eq, ":var1", "$supported_pretender_old_faction"),
          (neg|faction_slot_eq, "$supported_pretender_old_faction", 10, ":var0"),
          (val_add, reg21, 1),
        (try_end),
      (try_end),
      (try_for_range, ":var2", "p_town_1", "p_salt_mine"),
        (store_faction_of_party, ":var3", ":var2"),
        (try_begin),
          (eq, ":var3", "fac_player_supporters_faction"),
          (try_begin),
            (party_slot_eq, ":var2", 0, 3),
            (val_add, reg13, 1),
          (else_try),
            (party_slot_eq, ":var2", 0, 2),
            (val_add, reg14, 1),
          (else_try),
            (party_slot_eq, ":var2", 0, 4),
            (val_add, reg15, 1),
          (try_end),
        (else_try),
          (eq, ":var3", "$supported_pretender_old_faction"),
          (try_begin),
            (party_slot_eq, ":var2", 0, 3),
            (val_add, reg23, 1),
          (else_try),
            (party_slot_eq, ":var2", 0, 2),
            (val_add, reg24, 1),
          (else_try),
            (party_slot_eq, ":var2", 0, 4),
            (val_add, reg25, 1),
          (try_end),
        (try_end),
      (try_end),
      (store_add, reg19, reg13, reg14),
      (val_add, reg19, reg15),
      (store_add, reg29, reg23, reg24),
      (val_add, reg29, reg25),
      (store_add, ":var4", reg13, reg14),
      (val_add, ":var4", reg11),
      (store_add, ":var5", reg23, reg24),
      (val_add, ":var5", reg21),
      (store_add, ":var6", ":var4", ":var5"),
      (val_mul, ":var4", 100),
      (store_div, ":var7", ":var4", ":var6"),
      (try_begin),
        (lt, ":var7", 10),
        (str_store_string, s30, "@we have made very little progress so far"),
      (else_try),
        (lt, ":var7", 30),
        (str_store_string, s30, "@we have suceeded in gaining some ground, but we still have a long way to go"),
      (else_try),
        (lt, ":var7", 50),
        (str_store_string, s30, "@we have become a significant force, and we have an even chance of victory"),
      (else_try),
        (lt, ":var7", 75),
        (str_store_string, s30, "@we are winning the war, but our enemies are still holding on."),
      (else_try),
        (str_store_string, s30, "@we are on the verge of victory. The remaining enemies pose no threat, but we still need to hunt them down."),
      (try_end),
      (faction_get_slot, ":var8", "$supported_pretender_old_faction", 10),
      (str_store_troop_name, s9, ":var8"),
    ],
    "{reg11?We have {reg11} lords on our side:We have no lord with us yet}, whereas {reg21?{s9} still has {reg21} lords supporting him:{s9} has no loyal lords left}. {reg19?We control {reg13?{reg13} towns:} {reg14?{reg14} castles:} {reg15?and {reg15} villages:}:We don't control any settlements}, while {reg29?they have {reg23?{reg23} towns:} {reg24?{reg24} castles:} {reg25?and {reg25} villages:}:they have no remaining settlements}. Overall, {s30}.",
    "pretender_progress_2",
    []],

  [plyr|anyone, "pretender_progress_2",
    [],
    "Then, we must keep fighting and rally our supporters!",
    "supported_pretender_pretalk",
    []],

  [plyr|anyone, "pretender_progress_2",
    [],
    "It seems this rebellion is not going anywhere. We must give up.",
    "pretender_quit_rebel_confirm",
    []],

  [anyone, "pretender_quit_rebel_confirm",
    [],
    "{playername}, you can't abandon me now. Are you serious?",
    "pretender_quit_rebel_confirm_2",
    []],

  [plyr|anyone, "pretender_quit_rebel_confirm_2",
    [],
    "Indeed, I am. I can't support you any longer.",
    "pretender_quit_rebel_confirm_3",
    []],

  [plyr|anyone, "pretender_quit_rebel_confirm_2",
    [],
    "I was jesting. I will fight for you until we succeed.",
    "supported_pretender_pretalk",
    []],

  [anyone, "pretender_quit_rebel_confirm_3",
    [],
    "Are you absolutely sure? I will never forgive you if you abandon my cause.",
    "pretender_quit_rebel_confirm_4",
    []],

  [plyr|anyone, "pretender_quit_rebel_confirm_4",
    [],
    "I am sure.",
    "pretender_quit_rebel",
    []],

  [plyr|anyone, "pretender_quit_rebel_confirm_4",
    [],
    "Let me think about this some more.",
    "supported_pretender_pretalk",
    []],

  [anyone, "pretender_quit_rebel",
    [],
    "So be it. Then my cause is lost. There is only one thing to do for me now. I will go from these lands and never come back.",
    "close_window",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (try_for_range, ":var1", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (neq, "$supported_pretender", ":var1"),
        (store_troop_faction, ":var2", ":var1"),
        (eq, ":var2", "fac_player_supporters_faction"),
        (call_script, "script_change_troop_faction", ":var1", ":var0"),
      (try_end),
      (troop_set_faction, "$g_talk_troop", "fac_neutral"),
      (faction_set_slot, "fac_player_supporters_faction", 10, "trp_player"),
      (assign, ":var3", 0),
      (try_for_range, ":var4", "p_town_1", "p_salt_mine"),
        (store_faction_of_party, ":var2", ":var4"),
        (eq, ":var2", "fac_player_supporters_faction"),
        (assign, ":var3", 1),
        (neg|party_slot_eq, ":var4", 7, "trp_player"),
        (call_script, "script_give_center_to_lord", ":var4", "trp_player", 0),
      (try_end),
      (party_remove_members, "p_main_party", "$supported_pretender", 1),
      (faction_set_slot, ":var0", 60, 0),
      (assign, "$supported_pretender", 0),
      (try_begin),
        (eq, ":var3", 1),
        (faction_set_color, "fac_player_supporters_faction", 11184810),
      (else_try),
        (call_script, "script_activate_deactivate_player_faction", -1),
      (try_end),
      (call_script, "script_change_player_honor", -20),
      (call_script, "script_fail_quest", "qst_rebel_against_kingdom"),
      (call_script, "script_end_quest", "qst_rebel_against_kingdom"),
    ]],

  [plyr|anyone, "supported_pretender_talk",
    [],
    "Would you allow me to check out your equipment?",
    "supported_pretender_equip",
    []],

  [anyone, "supported_pretender_equip",
    [],
    "Very well, it's all here...",
    "supported_pretender_pretalk",
    [
      (change_screen_equip_other),
    ]],

  [plyr|anyone, "supported_pretender_talk",
    [],
    "If it would please you, can you tell me about your skills?",
    "pretneder_view_char_requested",
    []],

  [anyone, "pretneder_view_char_requested",
    [],
    "Well, alright.",
    "supported_pretender_pretalk",
    [
      (change_screen_view_character),
    ]],

  [plyr|anyone, "supported_pretender_talk",
    [],
    "Let us keep going, please.",
    "close_window",
    []],

  [anyone, "do_member_trade",
    [],
    "Anything else?",
    "member_talk",
    []],

  [anyone, "member_chat",
    [
      (store_conversation_troop, "$g_talk_troop"),
      (troop_is_hero, "$g_talk_troop"),
      (troop_get_slot, ":var0", "$g_talk_troop", 130),
      (str_store_string, s5, ":var0"),
      (troop_is_wounded, "$g_talk_troop"),
    ],
    "I am in terrible pain right now, {playername}. How about we talk later?",
    "member_talk_wounded",
    []],

  [plyr|anyone, "member_talk_wounded",
    [],
    "You hang in there!",
    "close_window",
    []],

  [anyone, "member_chat",
    [
      (store_conversation_troop, "$g_talk_troop"),
      (troop_is_hero, "$g_talk_troop"),
      (troop_get_slot, ":var0", "$g_talk_troop", 130),
      (str_store_string, s5, ":var0"),
    ],
    "Yes, {s5}?",
    "member_talk",
    []],

  [plyr|anyone, "member_talk",
    [],
    "Let me see your equipment.",
    "member_trade",
    []],

  [anyone, "member_trade",
    [],
    "Very well, it's all here...",
    "do_member_trade",
    [
      (change_screen_equip_other),
    ]],

  [anyone, "do_member_trade",
    [],
    "Anything else?",
    "member_talk",
    []],

  [plyr|anyone, "member_talk",
    [],
    "What can you tell me about your skills?",
    "view_member_char_requested",
    []],

  [anyone, "view_member_char_requested",
    [],
    "Alright, let me tell you...",
    "do_member_view_char",
    [
      (change_screen_view_character),
    ]],

  [plyr|anyone, "member_talk",
    [],
    "We need to separate for a while.",
    "member_separate",
    [
      (call_script, "script_npc_morale", "$g_talk_troop"),
      (assign, "$npc_quit_morale", reg0),
    ]],

  [anyone, "member_separate",
    [
      (gt, "$npc_quit_morale", 30),
    ],
    "Oh really? Well, I'm not just going to wait around here. I'm going to go to the towns to look for other work. Is that what you want?",
    "member_separate_confirm",
    []],

  [anyone, "member_separate",
    [],
    "Well, actually, there was something I needed to tell you.",
    "companion_quitting",
    [
      (assign, "$player_can_refuse_npc_quitting", 0),
      (assign, "$player_can_persuade_npc", 0),
    ]],

  [plyr|anyone, "member_separate_confirm",
    [],
    "That's right. We need to part ways.",
    "member_separate_yes",
    []],

  [plyr|anyone, "member_separate_confirm",
    [],
    "No, I'd rather have you at my side.",
    "do_member_trade",
    []],

  [anyone, "member_separate_yes",
    [],
    "Well. I'll be off, then. Look me up if you need me.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 2, 0),
      (troop_set_slot, "$g_talk_troop", 82, 2),
      (remove_member_from_party, "$g_talk_troop"),
    ]],

  [plyr|anyone, "member_talk",
    [],
    "I'd like to ask you something.",
    "member_question",
    []],

  [plyr|anyone, "member_talk",
    [],
    "Never mind.",
    "close_window",
    []],

  [anyone, "member_question",
    [],
    "Very well. What did you want to ask?",
    "member_question_2",
    []],

  [plyr|anyone, "member_question_2",
    [],
    "How do you feel about the way things are going in this company?",
    "member_morale",
    []],

  [plyr|anyone, "member_question_2",
    [],
    "Tell me your story again.",
    "member_background_recap",
    []],

  [anyone, "member_morale",
    [
      (call_script, "script_npc_morale", "$g_talk_troop"),
    ],
    "{s21}",
    "do_member_trade",
    []],

  [anyone, "member_background_recap",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 59),
      (str_store_party_name, s20, ":var0"),
      (troop_get_slot, ":var1", "$g_talk_troop", 60),
      (str_store_party_name, s21, ":var1"),
      (troop_get_slot, ":var2", "$g_talk_troop", 129),
      (str_store_string, s5, ":var2"),
    ],
    "{s5}",
    "member_background_recap_2",
    []],

  [anyone, "member_background_recap_2",
    [
      (str_clear, s19),
      (troop_get_slot, ":var0", "$g_talk_troop", 105),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "member_background_recap_3",
    []],

  [anyone, "member_background_recap_3",
    [],
    "Now I find myself in your company.",
    "do_member_trade",
    []],

  [anyone, "do_member_view_char",
    [],
    "Anything else?",
    "member_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (main_party_has_troop, "$g_talk_troop"),
    ],
    "Let's leave whenever you are ready.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_slot_eq, "$g_talk_troop", 81, 1),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Please do not waste any more of my time today, {reg18?ma'am:sir}. Perhaps we shall meet again in our travels.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc6"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 3),
      (eq, ":var0", 6),
      (eq, "$g_talk_troop_met", 0),
    ],
    "You goddamned red skinned piece of horse shit! Time to die!",
    "close_window",
    [
      (assign, "$duel", 2),
      (assign, "$duel_partner", "trp_npc6"),
      (store_random_in_range, ":var0", 10, 111),
      (assign, "$duel_reward", ":var0"),
    ]],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc6"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 3),
      (eq, ":var0", 6),
    ],
    "You again! Leave me alone you tricky little red piece of shit!",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc9"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 3),
      (eq, ":var0", 6),
      (eq, "$g_talk_troop_met", 0),
    ],
    "I don't like anyone redder than myself, so I don't talk to injuns. Now git.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc9"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 3),
      (eq, ":var0", 6),
    ],
    "I told you once before, you stupid injun.  I don't talk to you. Now git!",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc10"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 0),
      (this_or_next|eq, ":var0", 1),
      (this_or_next|eq, ":var0", 4),
      (this_or_next|eq, ":var0", 3),
      (eq, ":var0", 6),
    ],
    "(This man just stares at you and does not say a word. There is an intense fire burning in his eyes.)",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc11"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 0),
      (this_or_next|eq, ":var0", 1),
      (this_or_next|eq, ":var0", 4),
      (this_or_next|eq, ":var0", 2),
      (eq, ":var0", 5),
    ],
    "Please leave me be. I've had too much hurt from your kind.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc12"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 2),
      (this_or_next|eq, ":var0", 5),
      (this_or_next|eq, ":var0", 3),
      (eq, ":var0", 6),
    ],
    "Sorry, no autographs please. I can't even speak your language, how am I gonna write in it?",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc14"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 0),
      (this_or_next|eq, ":var0", 1),
      (this_or_next|eq, ":var0", 4),
      (this_or_next|eq, ":var0", 2),
      (eq, ":var0", 5),
    ],
    "I have nothing to say to those who would steal my ancestor's lands.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$g_talk_troop", "trp_npc15"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_get_type, ":var0", "trp_player"),
      (this_or_next|eq, ":var0", 0),
      (this_or_next|eq, ":var0", 1),
      (this_or_next|eq, ":var0", 4),
      (this_or_next|eq, ":var0", 2),
      (eq, ":var0", 5),
    ],
    "I cannot see your heart. I do not think it wise to talk to you.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (eq, "$g_talk_troop_met", 0),
      (troop_get_slot, ":var0", "$g_talk_troop", 101),
      (str_store_string, s5, ":var0"),
      (str_store_party_name, s20, "$g_encountered_party"),
    ],
    "{s5}",
    "companion_recruit_intro_response",
    [
      (troop_set_slot, "$g_talk_troop", 59, "$g_encountered_party"),
    ]],

  [plyr|anyone, "companion_recruit_intro_response",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 102),
      (str_store_string, s6, ":var0"),
    ],
    "{s6}",
    "companion_recruit_backstory_a",
    []],

  [plyr|anyone, "companion_recruit_intro_response",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 103),
      (str_store_string, s7, ":var0"),
    ],
    "{s7}",
    "close_window",
    []],

  [anyone, "companion_recruit_backstory_a",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 104),
      (str_store_string, s5, ":var0"),
      (str_store_string, s19, "str_here_plus_space"),
      (str_store_party_name, s20, "$g_encountered_party"),
    ],
    "{s5}",
    "companion_recruit_backstory_b",
    []],

  [anyone, "companion_recruit_backstory_b",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 105),
      (str_store_string, s5, ":var0"),
      (str_store_party_name, s20, "$g_encountered_party"),
    ],
    "{s5}",
    "companion_recruit_backstory_c",
    []],

  [anyone, "companion_recruit_backstory_c",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 106),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_recruit_backstory_response",
    []],

  [plyr|anyone, "companion_recruit_backstory_response",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 108),
      (str_store_string, s6, ":var0"),
    ],
    "{s6}",
    "companion_recruit_signup",
    []],

  [plyr|anyone, "companion_recruit_backstory_response",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 109),
      (str_store_string, s7, ":var0"),
    ],
    "{s7}",
    "close_window",
    []],

  [anyone, "companion_recruit_signup",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 110),
      (str_store_string, s5, ":var0"),
      (str_store_party_name, s20, "$g_encountered_party"),
    ],
    "{s5}",
    "companion_recruit_signup_b",
    []],

  [anyone, "companion_recruit_signup_b",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 111),
      (troop_get_slot, reg3, "$g_talk_troop", 132),
      (str_store_string, s5, ":var0"),
      (str_store_party_name, s20, "$g_encountered_party"),
    ],
    "{s5}",
    "companion_recruit_signup_response",
    []],

  [plyr|anyone, "companion_recruit_signup_response",
    [
      (neg|hero_can_join, "p_main_party"),
    ],
    "Unfortunately, I can't take on any more hands in my party right now.",
    "close_window",
    []],

  [plyr|anyone, "companion_recruit_signup_response",
    [
      (hero_can_join, "p_main_party"),
      (troop_get_slot, ":var0", "$g_talk_troop", 112),
      (str_store_string, s6, ":var0"),
    ],
    "{s6}",
    "companion_recruit_payment",
    []],

  [plyr|anyone, "companion_recruit_signup_response",
    [
      (hero_can_join, "p_main_party"),
      (troop_get_slot, ":var0", "$g_talk_troop", 113),
      (str_store_string, s7, ":var0"),
    ],
    "{s7}",
    "close_window",
    []],

  [auto_proceed|anyone, "companion_recruit_payment",
    [
      (troop_slot_eq, "$g_talk_troop", 132, 0),
    ],
    ".",
    "companion_recruit_signup_confirm",
    []],

  [anyone, "companion_recruit_payment",
    [
      (store_sub, ":var0", "$g_talk_troop", "trp_npc1"),
      (store_add, ":var1", "str_npc1_payment", ":var0"),
      (str_store_string, s5, ":var1"),
      (troop_get_slot, reg3, "$g_talk_troop", 132),
      (str_store_party_name, s20, "$g_encountered_party"),
    ],
    "{s5}",
    "companion_recruit_payment_response",
    []],

  [plyr|anyone, "companion_recruit_payment_response",
    [
      (hero_can_join, "p_main_party"),
      (troop_get_slot, ":var0", "$g_talk_troop", 132),
      (store_troop_gold, ":var1", "trp_player"),
      (ge, ":var1", ":var0"),
      (assign, reg3, ":var0"),
      (store_sub, ":var2", "$g_talk_troop", "trp_npc1"),
      (store_add, ":var3", "str_npc1_payment_response", ":var2"),
      (str_store_string, s6, ":var3"),
    ],
    "{s6}",
    "companion_recruit_signup_confirm",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 132),
      (gt, ":var0", 0),
      (troop_remove_gold, "trp_player", ":var0"),
      (troop_set_slot, "$g_talk_troop", 132, 0),
    ]],

  [plyr|anyone, "companion_recruit_payment_response",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 113),
      (str_store_string, s7, ":var0"),
    ],
    "Sorry. I can't afford that at the moment.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_slot_eq, "$g_talk_troop", 80, 1),
      (troop_slot_eq, "$g_talk_troop", 82, 0),
    ],
    "We meet again.",
    "companion_recruit_meet_again",
    [
      (troop_set_slot, "$g_talk_troop", 81, 1),
    ]],

  [plyr|anyone, "companion_recruit_meet_again",
    [],
    "So... What have you been doing since our last encounter?",
    "companion_recruit_backstory_delayed",
    []],

  [plyr|anyone, "companion_recruit_meet_again",
    [],
    "Good day to you.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_slot_eq, "$g_talk_troop", 80, 0),
      (troop_slot_eq, "$g_talk_troop", 82, 0),
    ],
    "Yes?",
    "companion_recruit_secondchance",
    [
      (troop_set_slot, "$g_talk_troop", 81, 1),
    ]],

  [plyr|anyone, "companion_recruit_secondchance",
    [],
    "My apologies if I was rude, earlier. What was your story again?",
    "companion_recruit_backstory_b",
    []],

  [plyr|anyone, "companion_recruit_secondchance",
    [],
    "Never mind.",
    "close_window",
    []],

  [anyone, "companion_recruit_backstory_delayed",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 107),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_recruit_backstory_delayed_response",
    []],

  [plyr|anyone, "companion_recruit_backstory_delayed_response",
    [],
    "I might be able to use you in my company.",
    "companion_recruit_signup_b",
    []],

  [plyr|anyone, "companion_recruit_backstory_delayed_response",
    [],
    "I'll let you know if I hear of anything.",
    "close_window",
    []],

  [anyone, "companion_recruit_signup_confirm",
    [],
    "Great!",
    "close_window",
    [
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 82, 4),
    ],
    "My offer to rejoin you still stands, if you'll have me.",
    "companion_rehire",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 82, 1),
      (assign, ":var0", "str_battle_fate_1"),
      (store_random_in_range, ":var1", 0, 5),
      (val_add, ":var0", ":var1"),
      (str_store_string, s6, ":var0"),
      (troop_get_slot, ":var2", "$g_talk_troop", 130),
      (str_store_string, s5, ":var2"),
    ],
    "It is good to see you alive, {s5}! {s6}, and I did not know whether you had been captured, or slain, or got away. I've been roaming around since then, looking for you. Shall I get my gear together and rejoin your company?",
    "companion_rehire",
    [
      (troop_set_slot, "$g_talk_troop", 82, 4),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_slot_eq, "$g_talk_troop", 81, 0),
      (troop_slot_eq, "$g_talk_troop", 82, 3),
      (troop_get_slot, ":var0", "$g_talk_troop", 125),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_rehire",
    [
      (troop_set_slot, "$g_talk_troop", 82, 4),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_eq, "$g_talk_troop", 2, 0),
      (troop_slot_eq, "$g_talk_troop", 82, 2),
      (troop_get_slot, ":var0", "$g_talk_troop", 130),
      (str_store_string, s21, ":var0"),
      (troop_get_slot, ":var1", "$g_talk_troop", 107),
      (str_store_string, s5, ":var1"),
    ],
    "It is good to see you, {s21}! To tell you the truth, I had hoped to run into you.",
    "companion_was_dismissed",
    [
      (troop_set_slot, "$g_talk_troop", 82, 4),
    ]],

  [anyone, "companion_was_dismissed",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 107),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}. Would you want me to rejoin your company?",
    "companion_rehire",
    []],

  [plyr|anyone, "companion_rehire",
    [
      (hero_can_join, "p_main_party"),
    ],
    "Welcome back, my friend!",
    "companion_recruit_signup_confirm",
    []],

  [plyr|anyone, "companion_rehire",
    [],
    "Sorry, I can't take on anyone else right now now.",
    "companion_rehire_refused",
    []],

  [anyone, "companion_rehire_refused",
    [],
    "Well... Look me up if you change your mind, eh?",
    "close_window",
    []],

  [anyone, "event_triggered",
    [
      (faction_slot_eq, "fac_player_supporters_faction", 10, "$g_talk_troop"),
      (ge, "$g_center_taken_by_player_faction", 0),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
    ],
    "{s1} is not being managed by anyone. Whom shall I put in charge?",
    "center_captured_lord_advice",
    []],

  [repeat_for_troops|plyr|anyone, "center_captured_lord_advice",
    [
      (store_repeat_object, ":var0"),
      (troop_slot_eq, ":var0", 2, 2),
      (neq, "$g_talk_troop", ":var0"),
      (neq, "trp_player", ":var0"),
      (store_troop_faction, ":var1", ":var0"),
      (eq, ":var1", "fac_player_supporters_faction"),
      (str_store_troop_name, s11, ":var0"),
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", ":var0"),
      (try_begin),
        (eq, reg0, 0),
        (str_store_string, s1, "@(no fiefs)"),
      (else_try),
        (str_store_string, s1, "@(fiefs: {s0})"),
      (try_end),
    ],
    "{s11}. {s1}",
    "center_captured_lord_advice_2",
    [
      (store_repeat_object, "$temp"),
    ]],

  [plyr|anyone, "center_captured_lord_advice",
    [
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", "trp_player"),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
    ],
    "Please {s65}, I want to have {s1} for myself. (fiefs: {s0})",
    "center_captured_lord_advice_2",
    [
      (assign, "$temp", "trp_player"),
    ]],

  [plyr|anyone, "center_captured_lord_advice",
    [
      (call_script, "script_print_troop_owned_centers_in_numbers_to_s0", "$g_talk_troop"),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
    ],
    "{s66}, you should have {s1} for yourself. (fiefs: {s0})",
    "center_captured_lord_advice_2",
    [
      (assign, "$temp", "$g_talk_troop"),
    ]],

  [anyone, "center_captured_lord_advice_2",
    [],
    "Hmmm. Alright, {playername}. I value your counsel highly. {reg6?I:{reg7?You:{s11}}} will be the new {reg18?lady:master} of {s1}.",
    "close_window",
    [
      (assign, ":var0", "$temp"),
      (call_script, "script_calculate_troop_score_for_center", ":var0", "$g_center_taken_by_player_faction"),
      (assign, ":var1", reg0),
      (assign, ":var2"),
      (try_for_range, ":var3", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (store_troop_faction, ":var4", ":var3"),
        (eq, ":var4", "fac_player_supporters_faction"),
        (neq, ":var3", ":var0"),
        (call_script, "script_calculate_troop_score_for_center", ":var3", "$g_center_taken_by_player_faction"),
        (assign, ":var5", reg0),
        (gt, ":var5", ":var1"),
        (store_sub, ":var6", ":var5", ":var1"),
        (store_random_in_range, ":var7", 0, ":var6"),
        (val_div, ":var7", 1000),
        (gt, ":var7", 0),
        (val_add, ":var2", ":var7"),
        (val_mul, ":var7", -1),
        (call_script, "script_change_player_relation_with_troop", ":var3", ":var7"),
      (try_end),
      (val_mul, ":var2", 2),
      (val_div, ":var2", 3),
      (val_add, ":var2", 5),
      (try_begin),
        (neq, ":var0", "trp_player"),
        (val_min, ":var2", 30),
        (call_script, "script_change_player_relation_with_troop", ":var0", ":var2"),
      (try_end),
      (call_script, "script_give_center_to_lord", "$g_center_taken_by_player_faction", ":var0", 0),
      (try_begin),
        (neq, ":var0", "trp_player"),
        (call_script, "script_cf_reinforce_party", "$g_center_taken_by_player_faction"),
        (call_script, "script_cf_reinforce_party", "$g_center_taken_by_player_faction"),
      (try_end),
      (assign, reg6, 0),
      (assign, reg7, 0),
      (try_begin),
        (eq, "$temp", "$g_talk_troop"),
        (assign, reg6, 1),
      (else_try),
        (eq, "$temp", "trp_player"),
        (assign, reg7, 1),
      (else_try),
        (str_store_troop_name, s11, "$temp"),
      (try_end),
      (str_store_party_name, s1, "$g_center_taken_by_player_faction"),
      (troop_get_type, reg3, "$temp"),
      (call_script, "script_troop_get_gender_to_reg18", "$temp"),
      (assign, "$g_center_taken_by_player_faction", -1),
    ]],

  [anyone, "event_triggered",
    [
      (store_conversation_troop, "$map_talk_troop"),
      (eq, "$map_talk_troop", "$npc_is_quitting"),
      (troop_get_slot, ":var0", "$map_talk_troop", 130),
      (str_store_string, s5, ":var0"),
    ],
    "{s5} -- there is something I need to tell you.",
    "companion_quitting",
    [
      (assign, "$npc_is_quitting", 0),
      (assign, "$player_can_persuade_npc", 1),
      (assign, "$player_can_refuse_npc_quitting", 1),
    ]],

  [anyone, "companion_quitting",
    [
      (store_conversation_troop, "$map_talk_troop"),
      (troop_get_slot, ":var0", "$map_talk_troop", 124),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_quitting_2",
    []],

  [anyone, "companion_quitting_2",
    [
      (call_script, "script_npc_morale", "$map_talk_troop"),
    ],
    "To tell you the truth, {s21}",
    "companion_quitting_response",
    []],

  [plyr|anyone, "companion_quitting_response",
    [],
    "Very well. You be off, then.",
    "companion_quitting_yes",
    []],

  [plyr|anyone, "companion_quitting_response",
    [
      (eq, "$player_can_persuade_npc", 1),
    ],
    "Perhaps I can persuade you to change your mind.",
    "companion_quitting_persuasion",
    [
      (assign, "$player_can_persuade_npc", 0),
    ]],

  [anyone, "companion_quitting_persuasion",
    [
      (store_random_in_range, ":var0", -2, 13),
      (store_skill_level, ":var1", "skl_persuasion", "trp_player"),
      (le, ":var0", ":var1"),
    ],
    "Hm. When you put it like that, I suppose I can stay a while longer, see if things improve.",
    "close_window",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 69),
      (val_div, ":var0", 2),
      (troop_set_slot, "$map_talk_troop", 69, ":var0"),
      (troop_get_slot, ":var1", "$map_talk_troop", 77),
      (val_div, ":var1", 2),
      (troop_set_slot, "$map_talk_troop", 77, ":var1"),
    ]],

  [anyone, "companion_quitting_persuasion",
    [],
    "I'm sorry, but I don't see your point. I am leaving whether you like it or not.",
    "companion_quitting_response",
    []],

  [plyr|anyone, "companion_quitting_response",
    [
      (eq, 1, 0),
      (eq, "$player_can_refuse_npc_quitting", 1),
    ],
    "We hang deserters in this company.",
    "companion_quitting_no",
    []],

  [anyone, "companion_quitting_no",
    [],
    "Oh... Right... Do you mean that?",
    "companion_quitting_no_confirm",
    []],

  [plyr|anyone, "companion_quitting_no_confirm",
    [],
    "Absolutely. You either leave this company by my command, or are carried out on your shield.",
    "companion_quitting_no_confirmed",
    []],

  [plyr|anyone, "companion_quitting_no_confirm",
    [],
    "No, actually I don't mean that. You are free to leave.",
    "companion_quitting_yes",
    []],

  [anyone, "companion_quitting_yes",
    [],
    "Then this is goodbye. Perhaps I'll see you around, {playername}.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 82, 3),
      (call_script, "script_retire_companion", "$map_talk_troop", 100),
    ]],

  [anyone, "companion_quitting_no_confirmed",
    [],
    "Hm. I suppose I'm staying, then.",
    "close_window",
    []],

  [anyone, "event_triggered",
    [
      (store_conversation_troop, "$map_talk_troop"),
      (eq, "$map_talk_troop", "$npc_with_grievance"),
      (eq, "$npc_map_talk_context", 61),
      (try_begin),
        (eq, "$npc_grievance_slot", 61),
        (troop_get_slot, ":var0", "$map_talk_troop", 116),
      (else_try),
        (troop_get_slot, ":var0", "$map_talk_troop", 117),
      (try_end),
      (str_store_string, s21, "$npc_grievance_string"),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_objection_response",
    [
      (assign, "$npc_with_grievance", 0),
    ]],

  [plyr|anyone, "companion_objection_response",
    [
      (eq, "$npc_praise_not_complaint", 1),
    ],
    "Thanks, I appreciate your support.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", "$npc_grievance_slot", 1),
    ]],

  [plyr|anyone, "companion_objection_response",
    [
      (eq, "$npc_praise_not_complaint", 0),
    ],
    "Hopefully it won't happen again.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", "$npc_grievance_slot", 1),
    ]],

  [plyr|anyone, "companion_objection_response",
    [
      (eq, "$npc_praise_not_complaint", 0),
    ],
    "Your objection is noted. Now fall back in line.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", "$npc_grievance_slot", 2),
      (troop_get_slot, ":var0", "$map_talk_troop", 69),
      (val_add, ":var0", 10),
      (troop_set_slot, "$map_talk_troop", 69, ":var0"),
    ]],

  [anyone, "event_triggered",
    [
      (store_conversation_troop, "$map_talk_troop"),
      (eq, "$map_talk_troop", "$npc_with_personality_clash_2"),
      (eq, "$npc_map_talk_context", 74),
      (troop_get_slot, ":var0", "$map_talk_troop", 120),
      (troop_get_slot, ":var1", "$map_talk_troop", 73),
      (str_store_troop_name, s11, ":var1"),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_personalityclash2_b",
    [
      (assign, "$npc_with_personality_clash_2", 0),
      (troop_get_slot, ":var0", "$map_talk_troop", 77),
      (val_add, ":var0", 5),
      (troop_set_slot, "$map_talk_troop", 77, ":var0"),
    ]],

  [anyone, "companion_personalityclash2_b",
    [],
    "{s5}",
    "companion_personalityclash2_response",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 121),
      (troop_get_slot, ":var1", "$map_talk_troop", 73),
      (str_store_troop_name, s11, ":var1"),
      (str_store_string, s5, ":var0"),
    ]],

  [plyr|anyone, "companion_personalityclash2_response",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 73),
      (str_store_troop_name, s11, ":var0"),
      (troop_get_type, reg11, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
    ],
    "{s11} is a valuable member of this company. I don't want you picking any more fights with {reg18?her:him}.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 74, 1),
    ]],

  [plyr|anyone, "companion_personalityclash2_response",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 73),
      (str_store_troop_name, s11, ":var0"),
      (troop_get_type, reg11, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
    ],
    "Tell {s11} you have my support in this, and {reg18?she:he} should hold {reg18?her:his} tongue.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 74, 2),
    ]],

  [plyr|anyone, "companion_personalityclash2_response",
    [],
    "I don't have time for your petty dispute. Do not bother me with this again.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 74, 3),
    ]],

  [anyone, "event_triggered",
    [
      (store_conversation_troop, "$map_talk_troop"),
      (eq, "$map_talk_troop", "$npc_with_personality_clash"),
      (eq, "$npc_map_talk_context", 72),
      (troop_get_slot, ":var0", "$map_talk_troop", 118),
      (troop_get_slot, ":var1", "$map_talk_troop", 71),
      (str_store_troop_name, s11, ":var1"),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_personalityclash_b",
    [
      (assign, "$npc_with_personality_clash", 0),
      (troop_get_slot, ":var0", "$map_talk_troop", 77),
      (val_add, ":var0", 5),
      (troop_set_slot, "$map_talk_troop", 77, ":var0"),
    ]],

  [anyone, "companion_personalityclash_b",
    [],
    "{s5}",
    "companion_personalityclash_response",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 119),
      (troop_get_slot, ":var1", "$map_talk_troop", 71),
      (str_store_troop_name, s11, ":var1"),
      (str_store_string, s5, ":var0"),
    ]],

  [plyr|anyone, "companion_personalityclash_response",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 71),
      (str_store_troop_name, s11, ":var0"),
      (troop_get_type, reg11, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
    ],
    "{s11} is a capable member of this company. I don't want you picking any more fights with {reg18?her:him}.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 72, 1),
    ]],

  [plyr|anyone, "companion_personalityclash_response",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 71),
      (str_store_troop_name, s11, ":var0"),
      (troop_get_type, reg11, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
    ],
    "Tell {s11} you have my support in this, and {reg18?she:he} should hold {reg18?her:his} tongue.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 72, 2),
    ]],

  [plyr|anyone, "companion_personalityclash_response",
    [],
    "I don't have time for your petty dispute. Do not bother me with this again.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 72, 3),
    ]],

  [anyone, "event_triggered",
    [
      (eq, "$npc_map_talk_context", 76),
      (store_conversation_troop, "$map_talk_troop"),
      (eq, "$map_talk_troop", "$npc_with_personality_match"),
      (troop_get_slot, ":var0", "$map_talk_troop", 122),
      (troop_get_slot, ":var1", "$map_talk_troop", 75),
      (str_store_troop_name, s11, ":var1"),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_personalitymatch_b",
    [
      (assign, "$npc_with_personality_match", 0),
    ]],

  [anyone, "companion_personalitymatch_b",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 123),
      (troop_get_slot, ":var1", "$map_talk_troop", 75),
      (str_store_troop_name, s11, ":var1"),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_personalitymatch_response",
    []],

  [plyr|anyone, "companion_personalitymatch_response",
    [],
    "Very good.",
    "close_window",
    [
      (troop_set_slot, "$map_talk_troop", 76, 1),
    ]],

  [anyone, "event_triggered",
    [
      (eq, "$npc_map_talk_context", 60),
      (store_conversation_troop, "$map_talk_troop"),
      (troop_get_slot, ":var0", "$map_talk_troop", 126),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_home_description",
    [
      (troop_set_slot, "$map_talk_troop", 78, 1),
    ]],

  [plyr|anyone, "companion_home_description",
    [],
    "Tell me more.",
    "companion_home_description_2",
    []],

  [plyr|anyone, "companion_home_description",
    [],
    "We don't have time to chat just now.",
    "close_window",
    []],

  [plyr|anyone, "companion_home_description",
    [],
    "I prefer my companions not to bother me with such trivialities.",
    "close_window",
    [
      (assign, "$disable_local_histories", 1),
    ]],

  [anyone, "companion_home_description_2",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 127),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "companion_home_description_3",
    []],

  [anyone, "companion_home_description_3",
    [
      (troop_get_slot, ":var0", "$map_talk_troop", 128),
      (str_store_string, s5, ":var0"),
    ],
    "{s5}",
    "close_window",
    []],

  [anyone, "event_triggered",
    [
      (eq, "$talk_context", 15),
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (str_store_faction_name, s3, ":var0"),
      (str_store_string, s6, "@{playername}, when we started our long walk, few people had the courage to support me. And fewer still would be willing to put their lives at risk for my cause. But you didn't hesitate for a moment in throwing yourself at my enemies. We have gone through a lot together, and there were times I came close to losing all hope. But with God's help, we prevailed. It is now time for me to leave your company and take what's rightfully mine. From now on, I will carry out the great responsibility of ruling {s3}. There still lie many challanges ahead and I count on your help in overcoming those. And of course, you will always remain as my foremost vassal."),
    ],
    "{s6}",
    "rebel_thanks_answer",
    [
      (call_script, "script_end_quest", "qst_rebel_against_kingdom"),
    ]],

  [plyr|anyone, "rebel_thanks_answer",
    [],
    "It was an honour to fight for your cause.",
    "rebel_thanks_answer_2",
    []],

  [plyr|anyone, "rebel_thanks_answer",
    [],
    "You will always have my loyal support.",
    "rebel_thanks_answer_2",
    []],

  [anyone, "rebel_thanks_answer_2",
    [],
    "I will miss living this life of adventure with you, but my duties await me. So... farewell for now, {playername}. I hope I'll see you again soon.",
    "close_window",
    []],

  [anyone, "event_triggered",
    [],
    "Sorry -- just talking to myself [ERROR]",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 7),
    ],
    "What do you want?",
    "player_siege_castle_commander_1",
    []],

  [plyr|anyone, "player_siege_castle_commander_1",
    [],
    "Surrender! Your situation is hopeless!",
    "player_siege_ask_surrender",
    []],

  [plyr|anyone, "player_siege_castle_commander_1",
    [],
    "Nothing. I'll leave you now.",
    "close_window",
    []],

  [anyone, "player_siege_ask_surrender",
    [
      (lt, "$g_enemy_strength", 100),
      (store_mul, ":var0", "$g_enemy_strength", 5),
      (ge, "$g_ally_strength", ":var0"),
    ],
    "Perhaps... Do you give your word of honour that we'll be treated well?",
    "player_siege_ask_surrender_treatment",
    []],

  [anyone, "player_siege_ask_surrender",
    [
      (lt, "$g_enemy_strength", 200),
      (store_mul, ":var0", "$g_enemy_strength", 3),
      (ge, "$g_ally_strength", ":var0"),
    ],
    "We are ready to leave this fort to you and march away if you give me your word of honour that you'll let us leave unmolested.",
    "player_siege_ask_leave_unmolested",
    []],

  [anyone, "player_siege_ask_surrender",
    [],
    "Surrender? Hah! We can hold these walls until we all die of old age.",
    "close_window",
    []],

  [plyr|anyone, "player_siege_ask_surrender_treatment",
    [],
    "I give you nothing. Surrender now or prepare to die!",
    "player_siege_ask_surrender_treatment_reject",
    []],

  [anyone, "player_siege_ask_surrender_treatment_reject",
    [],
    "Bastard. We will fight you to the last man!",
    "close_window",
    []],

  [plyr|anyone, "player_siege_ask_surrender_treatment",
    [],
    "You will be ransomed and your soldiers will live. I give you my word.",
    "player_siege_ask_surrender_treatment_accept",
    []],

  [anyone, "player_siege_ask_surrender_treatment_accept",
    [],
    "Very well then. Under those terms, I offer you my surrender.",
    "close_window",
    [
      (assign, "$g_enemy_surrenders", 1),
    ]],

  [plyr|anyone, "player_siege_ask_leave_unmolested",
    [],
    "You have my word. You will not come under attack if you leave the fort.",
    "player_siege_ask_leave_unmolested_accept",
    []],

  [anyone, "player_siege_ask_leave_unmolested_accept",
    [],
    "Very well. Then we leave this fort to you. You have won this day. But we'll meet again.",
    "close_window",
    [
      (assign, "$g_castle_left_to_player", 1),
    ]],

  [plyr|anyone, "player_siege_ask_leave_unmolested",
    [],
    "Unacceptable. I want prisoners.",
    "player_siege_ask_leave_unmolested_reject",
    []],

  [anyone, "player_siege_ask_leave_unmolested_reject",
    [],
    "Then we will defend this fort to the death, and this parley is done. Farewell.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 8),
      (troop_slot_eq, "$g_talk_troop", 2, 2),
    ],
    "I am in your debt for freeing me, friend.",
    "freed_lord_answer",
    [
      (call_script, "script_remove_troop_from_prison", "$g_talk_troop"),
    ]],

  [plyr|anyone, "freed_lord_answer",
    [
      (lt, "$g_talk_troop_faction_relation", 0),
    ],
    "You're not going anywhere, 'friend'. You're my prisoner now.",
    "freed_lord_answer_1",
    [
      (troop_set_slot, "$g_talk_troop", 8, "p_main_party"),
      (party_force_add_prisoners, "p_main_party", "$g_talk_troop", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -30),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -2),
      (call_script, "script_event_hero_taken_prisoner_by_player", "$g_talk_troop"),
    ]],

  [anyone, "freed_lord_answer_1",
    [],
    "I'll have your head on a pike for this, you bastard! Someday!",
    "close_window",
    []],

  [plyr|anyone, "freed_lord_answer",
    [],
    "You are free to go wherever you want.",
    "freed_lord_answer_2",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 7),
      (call_script, "script_change_player_honor", 2),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", 2),
    ]],

  [anyone, "freed_lord_answer_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thank you, good {reg18?woman:man}. I won't forget that you did me a good turn.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 9),
      (troop_slot_eq, "$g_talk_troop", 2, 2),
    ],
    "{s43}",
    "defeat_lord_answer",
    [
      (troop_set_slot, "$g_talk_troop", 10, -1),
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_surrender_offer_default"),
    ]],

  [plyr|anyone, "defeat_lord_answer",
    [],
    "You are my prisoner now.",
    "defeat_lord_answer_1",
    [
      (troop_set_slot, "$g_talk_troop", 8, "p_main_party"),
      (party_force_add_prisoners, "p_main_party", "$g_talk_troop", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -10),
      (call_script, "script_change_player_relation_with_faction_ex", "$g_talk_troop_faction", -3),
      (call_script, "script_event_hero_taken_prisoner_by_player", "$g_talk_troop"),
      (call_script, "script_add_log_entry", 12, "trp_player", -1, "$g_talk_troop", "$g_talk_troop_faction"),
    ]],

  [anyone, "defeat_lord_answer_1",
    [],
    "I am at your mercy.",
    "close_window",
    []],

  [plyr|anyone, "defeat_lord_answer",
    [],
    "You have fought well. You are free to go.",
    "defeat_lord_answer_2",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 5),
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_add_log_entry", 13, "trp_player", -1, "$g_talk_troop", "$g_talk_troop_faction"),
    ]],

  [anyone, "defeat_lord_answer_2",
    [],
    "{s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_prisoner_released_default"),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 2),
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (lt, "$g_encountered_party_relation", 0),
      (encountered_party_is_attacker),
      (eq, "$g_talk_troop_met", 1),
    ],
    "{playername}!",
    "party_encounter_lord_hostile_attacker",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 2),
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (lt, "$g_encountered_party_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Halt!",
    "party_encounter_lord_hostile_attacker",
    []],

  [anyone, "party_encounter_lord_hostile_attacker",
    [
      (gt, "$g_comment_found", 0),
    ],
    "{s42}",
    "party_encounter_lord_hostile_attacker",
    [
      (try_begin),
        (neq, "$log_comment_relation_change", 0),
        (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", "$log_comment_relation_change"),
      (try_end),
      (assign, "$g_comment_found", 0),
    ]],

  [anyone, "party_encounter_lord_hostile_attacker",
    [],
    "{s43}",
    "party_encounter_lord_hostile_attacker_2",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_surrender_demand_default"),
    ]],

  [plyr|anyone, "party_encounter_lord_hostile_attacker_2",
    [],
    "Is there no way to avoid this battle? I don't want to fight with you.",
    "party_encounter_offer_dont_fight",
    []],

  [plyr|anyone, "party_encounter_lord_hostile_attacker_2",
    [],
    "Don't attack! We surrender.",
    "close_window",
    [
      (assign, "$g_player_surrenders", 1),
    ]],

  [plyr|anyone, "party_encounter_lord_hostile_attacker_2",
    [],
    "We will fight you to the end!",
    "close_window",
    []],

  [anyone, "party_encounter_offer_dont_fight",
    [
      (gt, "$g_talk_troop_relation", 30),
    ],
    "I owe you a favor, don't I. Well... alright then. I will let you go just this once.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -7),
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "party_encounter_offer_dont_fight",
    [],
    "Ha-ha. But I want to fight with you.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (faction_slot_eq, "$g_talk_troop_faction", 21, 2),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "[Our first task is to seize a fortress. Then other lords will join us.]",
    "pretender_start",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (eq, "$g_talk_troop", "$supported_pretender"),
    ],
    "I await your counsel, {playername}.",
    "supported_pretender_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (assign, "$pretender_told_story", 0),
      (eq, "$g_talk_troop_met", 0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Do I know you?.",
    "pretender_intro_1",
    []],

  [plyr|anyone, "pretender_intro_1",
    [],
    "My name is {playername}. At your sevice.",
    "pretender_intro_2",
    []],

  [plyr|anyone, "pretender_intro_1",
    [],
    "I am {playername}. Perhaps you have heard of my exploits.",
    "pretender_intro_2",
    []],

  [anyone, "pretender_intro_2",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (val_sub, ":var0", "fac_kingdom_1"),
      (val_add, ":var0", "str_swadian_rebellion_pretender_intro"),
      (str_store_string, s48, ":var0"),
    ],
    "{s48}",
    "pretender_intro_3",
    []],

  [plyr|anyone, "pretender_intro_3",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (str_store_faction_name, s12, ":var0"),
      (faction_get_slot, ":var1", ":var0", 10),
      (str_store_troop_name, s11, ":var1"),
    ],
    "I thought {s12} was ruled by {s11}?",
    "pretender_rebellion_cause_1",
    [
      (troop_set_slot, "$g_talk_troop", 140, 1),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Greetings, {playername}",
    "pretender_start",
    [
      (assign, "$pretender_told_story", 0),
    ]],

  [plyr|anyone, "pretender_start",
    [
      (troop_slot_eq, "$g_talk_troop", 140, 1),
      (eq, "$pretender_told_story", 0),
    ],
    "What was your story again, if you don't mind my asking?",
    "pretender_rebellion_cause_prelim",
    []],

  [anyone, "pretender_rebellion_cause_prelim",
    [],
    "I shall tell you.",
    "pretender_rebellion_cause_1",
    []],

  [anyone, "pretender_rebellion_cause_1",
    [],
    "{s48}",
    "pretender_rebellion_cause_2",
    [
      (assign, "$pretender_told_story", 1),
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (val_sub, ":var0", "fac_kingdom_1"),
      (val_add, ":var0", "str_swadian_rebellion_pretender_story_1"),
      (str_store_string, s48, ":var0"),
    ]],

  [anyone, "pretender_rebellion_cause_2",
    [],
    "{s48}",
    "pretender_rebellion_cause_3",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (val_sub, ":var0", "fac_kingdom_1"),
      (val_add, ":var0", "str_swadian_rebellion_pretender_story_2"),
      (str_store_string, s48, ":var0"),
    ]],

  [anyone, "pretender_rebellion_cause_3",
    [],
    "{s48}",
    "pretender_start",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (val_sub, ":var0", "fac_kingdom_1"),
      (val_add, ":var0", "str_swadian_rebellion_pretender_story_3"),
      (str_store_string, s48, ":var0"),
    ]],

  [plyr|anyone, "pretender_start",
    [
      (troop_slot_eq, "$g_talk_troop", 140, 1),
    ],
    "I want to take up your cause and help you reclaim your throne!",
    "pretender_discuss_rebellion_1",
    []],

  [plyr|anyone, "pretender_start",
    [],
    "I must leave now.",
    "pretender_end",
    []],

  [anyone, "pretender_discuss_rebellion_1",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (faction_get_slot, ":var1", ":var0", 10),
      (str_store_troop_name, s11, ":var1"),
    ],
    "Are you sure you will be up to the task, {playername}? Reclaiming my throne will be no simple matter. The lords of our realm have all sworn oaths of homage to {s11}. Such oaths to a usurper are of course invalid, and we can expect some of the lords to side with us, but it will be a very tough and challenging struggle ahead.",
    "pretender_discuss_rebellion_2",
    []],

  [plyr|anyone, "pretender_discuss_rebellion_2",
    [],
    "I am ready for this struggle.",
    "pretender_discuss_rebellion_3",
    []],

  [plyr|anyone, "pretender_discuss_rebellion_2",
    [],
    "You are right. Perhaps, I should think about this some more.",
    "pretender_end",
    []],

  [anyone, "pretender_discuss_rebellion_3",
    [
      (neg|troop_slot_ge, "trp_player", 7, 200),
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (faction_get_slot, ":var1", ":var0", 10),
      (str_store_troop_name, s11, ":var1"),
    ],
    "I have no doubt that your support for my cause is heartfelt, {playername}, and I am grateful to you for it. But I don't think we have much of a chance of success. If you can gain renown in the battlefield and make a name for yourself as a great commander, then our friends would not hesitate to join our cause, and our enemies would be wary to take up arms against us. When that time comes, I will come with you gladly. But until that time, it will be wiser not to openly challange the usurper, {s11}.",
    "close_window",
    []],

  [anyone, "pretender_discuss_rebellion_3",
    [
      (gt, "$supported_pretender", 0),
      (str_store_troop_name, s17, "$supported_pretender"),
    ],
    "Haven't you already taken up the cause of {s17}? You must have a very strong sense of justice, indeed. But no, thanks. I will not be part of your game.",
    "close_window",
    []],

  [anyone, "pretender_discuss_rebellion_3",
    [
      (gt, "$players_kingdom", 0),
      (neq, "$players_kingdom", "fac_player_supporters_faction"),
      (neq, "$players_kingdom", "fac_player_faction"),
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (neq, "$players_kingdom", ":var0"),
      (gt, "$player_has_homage", 0),
      (str_store_faction_name, s16, "$players_kingdom"),
      (faction_get_slot, ":var1", "$players_kingdom", 10),
      (str_store_troop_name, s15, ":var1"),
      (str_store_faction_name, s17, ":var0"),
    ],
    "{playername}, you are already oath-bound to serve {s15}. As such, I cannot allow you to take up my cause, and let my enemies claim that I am but a mere puppet of {s16}. No, if I am to have the throne of {s17}, I must do it due to the righteousness of my cause and the support of my subjects alone. If you want to help me, you must first free yourself of your oath to {s15}.",
    "close_window",
    []],

  [anyone, "pretender_discuss_rebellion_3",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (str_store_faction_name, s12, ":var0"),
      (faction_get_slot, ":var1", ":var0", 10),
      (str_store_troop_name, s11, ":var1"),
    ],
    "You are a capable warrior, {playername}, and I am sure with your renown as a commander, and my righteous cause, the nobles and the good people of {s12} will flock to our support. The time is ripe for us to act! I will come with you, and together, we will topple the usurper {s11} and take the throne from his bloodied hands. But first, you must give me your oath of homage and accept me as your liege.",
    "pretender_rebellion_ready",
    []],

  [anyone, "pretender_discuss_rebellion",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (assign, "$town_to_rebel", 0),
      (assign, "$town_to_approach", 0),
      (troop_get_slot, ":var0", "$g_talk_troop", 14),
      (try_for_range, ":var1", "p_town_1", "p_castle_1"),
        (store_faction_of_party, ":var2", ":var1"),
        (eq, ":var2", ":var0"),
        (party_get_slot, ":var3", ":var1", 35),
        (neq, ":var3", 5),
        (try_begin),
          (party_slot_ge, ":var1", 77, 30),
          (assign, "$town_to_rebel", ":var1"),
        (else_try),
          (assign, "$town_to_approach", ":var1"),
          (assign, ":var4", 1),
          (try_begin),
          (try_end),
        (try_end),
      (try_end),
      (eq, "$town_to_rebel", 0),
      (gt, "$town_to_approach", 0),
      (gt, ":var4", 0),
    ],
    "[Before we rebel, I want you to raise support for my cause. I have always had strong backing from the town of {s4}, but you may have good ties in other places. Are you up for that?]",
    "pretender_town_quest",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 141),
      (str_store_party_name, s4, ":var0"),
    ]],

  [anyone, "pretender_discuss_rebellion",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (eq, "$town_to_rebel", 0),
      (gt, "$town_to_approach", 0),
    ],
    "[Before we rebel, I want you to raise support for my cause. If you have good ties with any towns, you should try there. Are you up for that?]",
    "pretender_town_quest",
    []],

  [anyone, "pretender_discuss_rebellion",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (eq, "$town_to_approach", 0),
    ],
    "[Circumstances aren't really right for a rebellion right now. Let us lay low for a while]",
    "pretender_start",
    []],

  [anyone, "pretender_discuss_rebellion",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (gt, "$town_to_rebel", 0),
      (gt, "$players_kingdom", 0),
    ],
    "[You have laid the groundwork for a rebellion, but you are affiliated with another liege]",
    "pretender_start",
    []],

  [anyone, "pretender_discuss_rebellion",
    [
      (is_between, "$g_talk_troop", 0, 0),
      (gt, "$town_to_rebel", 0),
    ],
    "You have done good work. {s4} and possibly other towns are ready to rebel. Whenever you are ready, let us ride forth to war.",
    "pretender_rebellion_ready",
    [
      (str_store_party_name, s4, "$town_to_rebel"),
    ]],

  [plyr|anyone, "pretender_rebellion_ready",
    [
      (troop_get_type, reg3, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "I am ready to pledge myself to your cause.",
    "lord_give_oath_2",
    []],

  [plyr|anyone, "pretender_rebellion_ready",
    [],
    "Let us bide our time a little longer.",
    "pretender_end",
    []],

  [anyone, "lord_give_conclude_2",
    [
      (is_between, "$g_talk_troop", 0, 0),
    ],
    "Forward, then! Our first task is to take hold of a fortress and persuade other lords to join us. You lead the way!",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 25),
      (faction_set_slot, "$g_talk_troop_faction", 21, 0),
      (party_force_add_members, "p_main_party", "$supported_pretender", 1),
      (troop_set_slot, "$supported_pretender", 12, 0),
      (troop_set_auto_equip, "$supported_pretender", 0),
      (str_store_troop_name_link, s6, "$supported_pretender"),
      (display_message, "@{s6} has joined your party."),
      (assign, "$player_made_legitimacy_claim", 0),
      (assign, "$player_made_benefit_claim", 0),
      (assign, "$player_made_strength_claim", 0),
      (assign, "$player_made_benefit_claim", 0),
      (store_relation, ":var0", "$supported_pretender_old_faction", "fac_player_supporters_faction"),
      (val_min, ":var0", -50),
      (call_script, "script_set_player_relation_with_faction", "$supported_pretender_old_faction", ":var0"),
      (str_store_faction_name, s1, "$supported_pretender_old_faction"),
      (faction_set_name, "fac_player_supporters_faction", "@{s1} Rebels"),
      (faction_set_color, "fac_player_supporters_faction", 16711680),
      (call_script, "script_update_all_notes"),
    ]],

  [plyr|anyone, "pretender_town_quest",
    [],
    "[Abracadabra - the town is ready]",
    "pretender_discuss_rebellion",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 141),
      (party_set_slot, ":var0", 77, 40),
    ]],

  [plyr|anyone, "pretender_town_quest",
    [],
    "[Not interested, thanks]",
    "pretender_end",
    []],

  [anyone, "pretender_end",
    [],
    "Farewell for now, then.",
    "close_window",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", -10),
      (store_random_in_range, ":var0", 0, 100),
      (lt, ":var0", 30),
      (eq, "$talk_context", 0),
      (call_script, "script_cf_troop_get_random_enemy_troop_with_occupation", "$g_talk_troop", 2),
      (assign, ":var1", reg0),
      (troop_get_slot, ":var2", ":var1", 22),
      (ge, ":var2", 20),
      (str_store_troop_name, s6, ":var1"),
      (assign, "$temp", ":var1"),
    ],
    "I heard that you have befriended that {s43} called {s6}. Believe me, you can't trust that man. You should end your dealings with him.",
    "lord_event_choose_friend",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_insult_default"),
    ]],

  [plyr|anyone, "lord_event_choose_friend",
    [],
    "I assure you, {s65}, I am no friend of {s6}.",
    "lord_event_choose_friend_renounce",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 5),
      (call_script, "script_change_player_relation_with_troop", "$temp", -10),
    ]],

  [anyone, "lord_event_choose_friend_renounce",
    [],
    "Glad news, {playername}. I would fear for your safety otherwise. If you do encounter {s6}, be on your guard and don't believe a word.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_event_choose_friend",
    [],
    "{s6} is an honourable man, you've no right to speak of him thus.",
    "lord_event_choose_friend_defend",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -10),
      (call_script, "script_change_player_relation_with_troop", "$temp", 5),
    ]],

  [anyone, "lord_event_choose_friend_defend",
    [],
    "As you like, {playername}. A fool you might be, but a loyal fool at the least. {s6}'s loyalty may not be so steadfast, however...",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_event_choose_friend",
    [],
    "I don't want to be involved in your quarrel with {s6}.",
    "lord_event_choose_friend_neutral",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -2),
      (call_script, "script_change_player_relation_with_troop", "$temp", -3),
    ]],

  [anyone, "lord_event_choose_friend_neutral",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Hmph. As you wish, {playername}. Just remember that a {reg18?woman:man} needs friends in this world, and you'll never make any if you never stand with anyone.",
    "lord_pretalk",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (check_quest_active, "qst_join_faction"),
      (eq, "$g_invite_faction_lord", "$g_talk_troop"),
      (try_begin),
        (gt, "$g_invite_offered_center", 0),
        (store_faction_of_party, ":var0", "$g_invite_offered_center"),
        (neq, ":var0", "$g_talk_troop_faction"),
        (call_script, "script_get_poorest_village_of_faction", "$g_talk_troop_faction"),
        (assign, "$g_invite_offered_center", reg0),
      (try_end),
    ],
    "{playername}, I've been expecting you. Word has reached my ears of your exploits. Why, I keep hearing such tales of prowess and bravery that my mind was quickly made up. I knew that I had found someone worthy of becoming my subordinate.",
    "lord_invite_1",
    []],

  [plyr|anyone, "lord_invite_1",
    [],
    "Thank you, {s65}, you honour me with your offer.",
    "lord_invite_2",
    []],

  [plyr|anyone, "lord_invite_1",
    [],
    "It is good to have my true value recognised.",
    "lord_invite_2",
    []],

  [anyone, "lord_invite_2",
    [],
    "Aye. Let us dispense with the formalities, {playername}; are you ready to swear homage to me?",
    "lord_invite_3",
    []],

  [plyr|anyone, "lord_invite_3",
    [],
    "Yes, {s65}.",
    "lord_give_oath_2",
    []],

  [plyr|anyone, "lord_invite_3",
    [],
    "No, {s65}. I cannot serve you right now.",
    "lord_enter_service_reject",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", 50),
      (gt, "$g_talk_troop_faction_relation", 10),
      (le, "$talk_context", 4),
    ],
    "If it isn't my brave champion, {playername}...",
    "lord_start",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (gt, "$g_talk_troop_relation", 10),
      (le, "$talk_context", 4),
    ],
    "Good to see you again {playername}...",
    "lord_start",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (neq, "$g_talk_troop_met", 0),
      (gt, "$g_time_since_last_talk", 24),
      (le, "$talk_context", 4),
    ],
    "We meet again, {playername}...",
    "lord_start",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (le, "$talk_context", 4),
    ],
    "Do I know you?",
    "lord_meet_neutral",
    []],

  [plyr|anyone, "lord_meet_neutral",
    [],
    "I am {playername}.",
    "lord_intro",
    []],

  [plyr|anyone, "lord_meet_neutral",
    [],
    "My name is {playername}. Much obliged to make your acquaintence.",
    "lord_intro",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (eq, "$g_talk_troop_met", 0),
      (lt, "$g_talk_troop_faction_relation", 0),
      (le, "$talk_context", 4),
    ],
    "{s43}",
    "lord_meet_enemy",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_enemy_meet_default"),
    ]],

  [plyr|anyone, "lord_meet_enemy",
    [],
    "I am {playername}, {s65}.",
    "lord_intro",
    []],

  [plyr|anyone, "lord_meet_enemy",
    [],
    "They know me as {playername}. Mark it down, you shall be hearing of me a lot.",
    "lord_intro",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 2),
      (le, "$talk_context", 4),
    ],
    "Well, {playername}...",
    "lord_start",
    []],

  [anyone, "lord_start",
    [
      (gt, "$g_comment_found", 0),
    ],
    "{s42}",
    "lord_start",
    [
      (try_begin),
        (neq, "$log_comment_relation_change", 0),
        (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", "$log_comment_relation_change"),
      (try_end),
      (assign, "$g_comment_found", 0),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_lend_surgeon"),
      (quest_slot_eq, "qst_lend_surgeon", 6, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Your surgeon managed to convince my friend and made the operation.  The matter is in God's hands now,, and all we can do is pray for his recovery. Anyway, I thank you for lending your surgeon to me, {reg18?ma'am:sir}. You have a noble spirit. I will not forget it.",
    "lord_generic_mission_completed",
    [
      (call_script, "script_finish_quest", "qst_lend_surgeon", 100),
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_incriminate_loyal_commander"),
      (check_quest_succeeded, "qst_incriminate_loyal_commander"),
      (quest_get_slot, ":var1", "qst_incriminate_loyal_commander", 2),
      (str_store_troop_name, s3, ":var1"),
      (quest_get_slot, reg5, "qst_incriminate_loyal_commander", 22),
    ],
    "Hah! Our little plot against {s3} worked perfectly, {playername}. The fool has lost one of his most valuable retainers, and we are one step closer to bringing him to his knees. Here, this purse contains {reg5} cents, and I wish you to have it. You deserve every one. And, need I remind you, there could be much more to come if you've a mind to earn it...",
    "lord_generic_mission_completed",
    [
      (call_script, "script_end_quest", "qst_incriminate_loyal_commander"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 5),
      (call_script, "script_change_player_honor", -10),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_incriminate_loyal_commander"),
      (check_quest_failed, "qst_incriminate_loyal_commander"),
    ],
    "You werent't able to complete a simple task. I had set up everything. The only thing you needed to do was sacrifice a messenger, and we would be celebrating now. But no, you were too damned honorable, weren't you?",
    "close_window",
    [
      (call_script, "script_end_quest", "qst_incriminate_loyal_commander"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
      (call_script, "script_change_player_honor", 3),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_meet_spy_in_enemy_town"),
      (check_quest_succeeded, "qst_meet_spy_in_enemy_town"),
    ],
    "Have you brought me any news about that task I gave you? You know the one I mean...",
    "quest_meet_spy_in_enemy_town_completed",
    []],

  [plyr|anyone, "quest_meet_spy_in_enemy_town_completed",
    [],
    "I have the reports you wanted right here.",
    "quest_meet_spy_in_enemy_town_completed_2",
    []],

  [anyone, "quest_meet_spy_in_enemy_town_completed_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Ahh, well done. It's good to have competent {reg18?people:men} on my side. Here is the payment I promised you.",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (add_xp_as_reward, 500),
      (quest_get_slot, ":var0", "qst_meet_spy_in_enemy_town", 22),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (call_script, "script_end_quest", "qst_meet_spy_in_enemy_town"),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_raid_caravan_to_start_war"),
      (check_quest_succeeded, "qst_raid_caravan_to_start_war"),
      (quest_get_slot, ":var1", "qst_raid_caravan_to_start_war", 3),
      (str_store_faction_name, s13, ":var1"),
    ],
    "Brilliant work, {playername}! Your caravan raids really got their attention, I must say. I've just received word that {s13} has declared war! Now the time has come for us to reap the benefits of our hard work, {playername}. And by that I of course mean taking and plundering {s13} land! This war is going to make us rich! Mark my words!",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 10),
      (try_for_range, ":var0", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (store_troop_faction, ":var1", ":var0"),
        (eq, ":var1", "$players_kingdom"),
        (neq, ":var0", "$g_talk_troop"),
        (store_random_in_range, ":var2", -5, 4),
        (call_script, "script_change_player_relation_with_troop", ":var0", ":var2"),
      (try_end),
      (call_script, "script_troop_add_gold", "trp_player", 500),
      (add_xp_as_reward, 2000),
      (call_script, "script_change_player_honor", -5),
      (call_script, "script_end_quest", "qst_raid_caravan_to_start_war"),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_raid_caravan_to_start_war"),
      (check_quest_failed, "qst_raid_caravan_to_start_war"),
    ],
    "You incompetent buffoon! What in Hell made you think that getting yourself captured while trying to start a war was a good idea? These plans took months to prepare, and now everything's been ruined! I will not forget this, {playername}. Oh, be assured that I will not.",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -10),
      (call_script, "script_end_quest", "qst_raid_caravan_to_start_war"),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_collect_debt"),
      (quest_slot_eq, "qst_collect_debt", 11, 1),
      (quest_get_slot, ":var1", "qst_collect_debt", 2),
      (str_store_troop_name, s7, ":var1"),
      (quest_get_slot, ":var2", "qst_collect_debt", 10),
      (store_div, reg3, ":var2", 5),
      (store_sub, reg4, ":var2", reg3),
    ],
    "I'm told that you've collected the money owed me from {s7}. Good, it's past time I had it back. I believe I promised to give you one-fifth of it all, eh? Well, that makes {reg3} cents, so if you give me my share -- that's {reg4} cents -- you can keep the rest.",
    "lord_collect_debt_completed",
    []],

  [plyr|anyone, "lord_collect_debt_completed",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", reg4),
    ],
    "Of course, {s65}. {reg4} cents, all here.",
    "lord_collect_debt_pay",
    []],

  [anyone, "lord_collect_debt_pay",
    [],
    "I must admit I'm impressed, {playername}. I had lost hope of ever getting this money back. Please accept my sincere thanks.",
    "lord_pretalk",
    [
      (troop_remove_gold, "trp_player", reg4),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (add_xp_as_reward, 100),
      (call_script, "script_end_quest", "qst_collect_debt"),
    ]],

  [plyr|anyone, "lord_collect_debt_completed",
    [],
    "I am afraid I don't have the money with me.",
    "lord_collect_debt_no_pay",
    []],

  [anyone, "lord_collect_debt_no_pay",
    [],
    "Is this a joke? I know full well that {s7} gave you the money, and I want every cent owed to me. As far as I'm concerned, I hold you personally in my debt until I see that money.",
    "close_window",
    [
      (call_script, "script_change_debt_to_troop", "$g_talk_troop", reg4),
      (call_script, "script_end_quest", "qst_collect_debt"),
      (call_script, "script_objectionable_action", 4, "str_squander_money"),
    ]],

  [anyone, "lord_start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_kill_local_merchant"),
      (check_quest_succeeded, "qst_kill_local_merchant"),
      (quest_slot_eq, "qst_kill_local_merchant", 11, 1),
    ],
    "I heard you got rid of that poxy merchant that was causing me so much grief. I can see you're not afraid to get your hands dirty, eh? I like that in a {reg18?woman:man}. Here's your reward. Remember, {playername}, stick with me and we'll go a long, long way together.",
    "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", 600),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 4),
      (add_xp_as_reward, 300),
      (call_script, "script_end_quest", "qst_kill_local_merchant"),
      (call_script, "script_objectionable_action", 3, "str_murder_merchant"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_kill_local_merchant"),
      (check_quest_failed, "qst_kill_local_merchant"),
    ],
    "Oh, it's you. Enlighten me, how exactly does one lose a simple fight to some poxy, lowborn merchant? Truly, if I ever need my guardsmen to take a lesson in how to lay down and die, I'll be sure to come to you. Just leave me be, {playername}, I have things to do.",
    "close_window",
    [
      (call_script, "script_end_quest", "qst_kill_local_merchant"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_kill_local_merchant"),
      (check_quest_succeeded, "qst_kill_local_merchant"),
      (quest_slot_eq, "qst_kill_local_merchant", 11, 2),
    ],
    "You! Do you have sawdust between your ears? Did you think that when I said to kill the merchant, I meant you to have a nice chat with him and then let him go?! What possessed you?",
    "lord_kill_local_merchant_let_go",
    []],

  [plyr|anyone, "lord_kill_local_merchant_let_go",
    [],
    "I made sure he will not act against you.",
    "lord_kill_local_merchant_let_go_2",
    []],

  [anyone, "lord_kill_local_merchant_let_go_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Piffle. You were supposed to remove him, not give him a sermon and send him on his way. He had better do as you say, or you'll both regret it. Here, this is half the money I promised you. Don't say a word, {playername}, you're lucky to get even that. I have little use for {reg18?women:men} who cannot follow orders.",
    "lord_pretalk",
    [
      (call_script, "script_troop_add_gold", "trp_player", 300),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (add_xp_as_reward, 500),
      (call_script, "script_end_quest", "qst_kill_local_merchant"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_start",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":var1", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":var2", "p_main_party", "trp_spy_partner"),
      (gt, ":var1", 0),
      (gt, ":var2", 0),
    ],
    "Beautiful work, {playername}! You captured both the spy and his handler, just as I'd hoped, and the pair are now safely ensconced in my dungeon, waiting to be questioned. My torturer shall be busy tonight! Anyway, I'm very pleased with your success, {playername}, and I give you this purse as a token of my appreciation.",
    "lord_follow_spy_completed",
    [
      (party_remove_prisoners, "p_main_party", "trp_spy", 1),
      (party_remove_prisoners, "p_main_party", "trp_spy_partner", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 4),
      (call_script, "script_troop_add_gold", "trp_player", 2000),
      (add_xp_as_reward, 4000),
      (call_script, "script_end_quest", "qst_follow_spy"),
    ]],

  [anyone, "lord_start",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":var1", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":var2", "p_main_party", "trp_spy_partner"),
      (gt, ":var1", 0),
      (eq, ":var2", 0),
    ],
    "Blast and damn you! I wanted TWO prisoners, {playername} -- what you've brought me is one step short of useless! I already know everything the spy knows, it was the handler I was after. Here, half a job gets you half a reward. Take it and begone.",
    "lord_follow_spy_half_completed",
    [
      (party_remove_prisoners, "p_main_party", "trp_spy", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (call_script, "script_troop_add_gold", "trp_player", 1000),
      (add_xp_as_reward, 400),
      (call_script, "script_end_quest", "qst_follow_spy"),
    ]],

  [anyone, "lord_start",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":var1", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":var2", "p_main_party", "trp_spy_partner"),
      (eq, ":var1", 0),
      (gt, ":var2", 0),
    ],
    "I asked you for two prisoners, {playername}, not one. Two. Still, I suppose you did capture the spy's handler, the more important one of the pair. The spy will not dare return here and will prove quite useless to whatever master he served. 'Tis better than nothing. However, you'll understand if I pay you half the promised reward for what is but half a success.",
    "lord_follow_spy_half_completed",
    [
      (party_remove_prisoners, "p_main_party", "trp_spy_partner", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (call_script, "script_troop_add_gold", "trp_player", 1000),
      (add_xp_as_reward, 400),
      (call_script, "script_end_quest", "qst_follow_spy"),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_follow_spy"),
      (eq, "$qst_follow_spy_no_active_parties", 1),
      (party_count_prisoners_of_type, ":var1", "p_main_party", "trp_spy"),
      (party_count_prisoners_of_type, ":var2", "p_main_party", "trp_spy_partner"),
      (eq, ":var1", 0),
      (eq, ":var2", 0),
    ],
    "Truly, {playername}, you are nothing short of totally incompetent. Failing to capture both the spy AND his handler plumbs astonishing new depths of failure. Forget any reward I offered you. You've done nothing to earn it.",
    "lord_follow_spy_failed",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -2),
      (call_script, "script_end_quest", "qst_follow_spy"),
    ]],

  [plyr|anyone, "lord_follow_spy_half_completed",
    [],
    "I did my best, {s65}.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_follow_spy_completed",
    [],
    "Thank you, {s65}.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_follow_spy_failed",
    [],
    "Hrm. As you like, {s65}.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_bring_back_runaway_serfs"),
      (check_quest_succeeded, "qst_bring_back_runaway_serfs"),
    ],
    "Damn me, but you've done it, {playername}. All the serfs are back and they're busy preparing for the harvest. You certainly earned your reward. Here, take it, with my compliments.",
    "lord_generic_mission_completed",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 4),
      (call_script, "script_troop_add_gold", "trp_player", 300),
      (add_xp_as_reward, 300),
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs"),
      (call_script, "script_objectionable_action", 3, "str_round_up_serfs"),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_bring_back_runaway_serfs"),
      (check_quest_failed, "qst_bring_back_runaway_serfs"),
    ],
    "{playername}. I have been waiting patiently for my serfs, yet none have returned. Have you an explanation? Were you outwitted by simple fieldhands, or are you merely incompetent? Or perhaps you are plotting with my enemies, intending to ruin me...",
    "lord_bring_back_runaway_serfs_failed",
    []],

  [plyr|anyone, "lord_bring_back_runaway_serfs_failed",
    [],
    "Forgive me, {s65}, those serfs were slippery as eels.",
    "lord_bring_back_runaway_serfs_failed_1a",
    []],

  [plyr|anyone, "lord_bring_back_runaway_serfs_failed",
    [],
    "Perhaps if you had treated them better...",
    "lord_bring_back_runaway_serfs_failed_1b",
    []],

  [anyone, "lord_bring_back_runaway_serfs_failed_1a",
    [],
    "Hmph, that is hardly an excuse for failure, {playername}. Now if you will excuse me, I need to recruit new men to work these fields before we all starve.",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs"),
    ]],

  [anyone, "lord_bring_back_runaway_serfs_failed_1b",
    [],
    "Hah, now you reveal your true colours, traitor! Your words match your actions all too well. I should never have trusted you.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -10),
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (call_script, "script_change_player_relation_with_center", ":var0", 6),
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_bring_back_runaway_serfs"),
      (check_quest_concluded, "qst_bring_back_runaway_serfs"),
      (assign, reg17, "$qst_bring_back_runaway_serfs_num_parties_returned"),
    ],
    "You disappoint me, {playername}. There were 3 groups of serfs that I charged you to return. 3. Not {reg17}. I suppose the ones who did come back shall have to work twice as hard to make up for those that got away. As for your reward, {playername}, I'll only pay you for the serfs you returned, not the ones you let fly. Here. Take it, and let this business be done.",
    "lord_runaway_serf_half_completed",
    [
      (store_mul, ":var0", "$qst_bring_back_runaway_serfs_num_parties_returned", 100),
      (val_div, ":var0", 2),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", "$qst_bring_back_runaway_serfs_num_parties_returned"),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (add_xp_as_reward, ":var0"),
      (call_script, "script_objectionable_action", 3, "str_round_up_serfs"),
      (call_script, "script_end_quest", "qst_bring_back_runaway_serfs"),
    ]],

  [plyr|anyone, "lord_runaway_serf_half_completed",
    [],
    "Thank you, {s65}. You are indeed generous.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_runaway_serf_half_completed",
    [],
    "Bah, this proved to be a waste of my time.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_deal_with_bandits_at_lords_village"),
      (check_quest_succeeded, "qst_deal_with_bandits_at_lords_village"),
    ],
    "{playername}, I was told that you have crushed the bandits at my village of {s5}. Please know that I am most grateful to you for that. Please, let me pay the expenses of your campaign. Here, I hope these {reg14} cents will be adequate.",
    "lord_deal_with_bandits_completed",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (store_character_level, ":var0", "trp_player"),
      (store_mul, ":var1", ":var0", 20),
      (val_add, ":var1", 300),
      (call_script, "script_troop_add_gold", "trp_player", ":var1"),
      (add_xp_as_reward, 350),
      (call_script, "script_end_quest", "qst_deal_with_bandits_at_lords_village"),
      (assign, reg14, ":var1"),
      (quest_get_slot, ":var2", "qst_deal_with_bandits_at_lords_village", 1),
      (str_store_party_name, s5, ":var2"),
    ]],

  [plyr|anyone, "lord_deal_with_bandits_completed",
    [],
    "Not a problem, {s65}.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_deal_with_bandits_completed",
    [],
    "Glad to be of service.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_deal_with_bandits_completed",
    [],
    "It was mere child's play.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_deal_with_bandits_at_lords_village"),
      (check_quest_concluded, "qst_deal_with_bandits_at_lords_village"),
    ],
    "Damn it, {playername}. I heard that you were unable to drive off the bandits from my village of {s5}, and thanks to you, my village now lies in ruins. Everyone said that you were a capable warrior, but appearently, they were wrong.",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
      (call_script, "script_end_quest", "qst_deal_with_bandits_at_lords_village"),
      (quest_get_slot, ":var0", "qst_deal_with_bandits_at_lords_village", 1),
      (str_store_party_name, s5, ":var0"),
    ]],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_deliver_cattle_to_army"),
      (check_quest_succeeded, "qst_deliver_cattle_to_army"),
      (quest_get_slot, reg13, "qst_deliver_cattle_to_army", 10),
    ],
    "Ah, {playername}. My quartermaster has informed me of your delivery, {reg13} heads of cattle, as I requested. I'm impressed.",
    "lord_deliver_cattle_to_army_thank",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (quest_get_slot, ":var0", "qst_deliver_cattle_to_army", 10),
      (store_mul, ":var1", ":var0", 100),
      (call_script, "script_troop_add_gold", "trp_player", ":var1"),
      (val_div, ":var1", 5),
      (add_xp_as_reward, ":var1"),
      (call_script, "script_end_quest", "qst_deliver_cattle_to_army"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (setup_quest_text, "qst_follow_army"),
      (str_store_string, s2, "@Your mission is complete, {s9} wants you to resume following his army until further notice."),
      (call_script, "script_start_quest", "qst_follow_army", "$g_talk_troop"),
      (assign, "$g_player_follow_army_warnings", 0),
    ]],

  [plyr|anyone, "lord_deliver_cattle_to_army_thank",
    [],
    "Not a problem, {s65}.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_deliver_cattle_to_army_thank",
    [],
    "Glad to be of service.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_deliver_cattle_to_army_thank",
    [],
    "Mere child's play.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_scout_waypoints"),
      (check_quest_succeeded, "qst_scout_waypoints"),
      (str_store_party_name, s13, "$qst_scout_waypoints_wp_1"),
      (str_store_party_name, s14, "$qst_scout_waypoints_wp_2"),
      (str_store_party_name, s15, "$qst_scout_waypoints_wp_3"),
    ],
    "You make a good scout, {playername}. My runner just brought me your reports of the mission to {s13}, {s14} and {s15}. Well done.",
    "lord_scout_waypoints_thank",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (add_xp_as_reward, 100),
      (call_script, "script_end_quest", "qst_scout_waypoints"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (setup_quest_text, "qst_follow_army"),
      (str_store_string, s2, "@Your mission is complete, {s9} wants you to resume following his army until further notice."),
      (call_script, "script_start_quest", "qst_follow_army", "$g_talk_troop"),
      (assign, "$g_player_follow_army_warnings", 0),
    ]],

  [plyr|anyone, "lord_scout_waypoints_thank",
    [],
    "A simple task, {s65}.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_scout_waypoints_thank",
    [],
    "Nothing I couldn't handle.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_scout_waypoints_thank",
    [],
    "My pleasure.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [
      (check_quest_active, "qst_follow_army"),
      (faction_slot_eq, "$g_talk_troop_faction", 7, "$g_talk_troop"),
      (eq, "$g_random_army_quest", "qst_deliver_cattle_to_army"),
      (quest_get_slot, ":var0", "$g_random_army_quest", 10),
      (assign, reg3, ":var0"),
    ],
    "The army's supplies are dwindling too quickly, {playername}. I need you to bring me {reg3} heads of cattle so I can keep the troops fed. I care very little about where you get them, just bring them to me as soon as you can.",
    "lord_mission_told_deliver_cattle_to_army",
    []],

  [plyr|anyone, "lord_mission_told_deliver_cattle_to_army",
    [],
    "Very well, I can find you some cattle.",
    "lord_mission_told_deliver_cattle_to_army_accepted",
    []],

  [plyr|anyone, "lord_mission_told_deliver_cattle_to_army",
    [],
    "Sorry, but I happen to have other plans.",
    "lord_mission_told_deliver_cattle_to_army_rejected",
    []],

  [anyone, "lord_mission_told_deliver_cattle_to_army_accepted",
    [],
    "Excellent! You know what to do, {playername}, now get to it. I need that cattle sooner rather than later.",
    "close_window",
    [
      (call_script, "script_end_quest", "qst_follow_army"),
      (quest_get_slot, ":var0", "$g_random_army_quest", 10),
      (str_store_troop_name_link, s13, "$g_talk_troop"),
      (assign, reg3, ":var0"),
      (setup_quest_text, "$g_random_army_quest"),
      (str_store_string, s2, "@{s13} asked you to gather {reg3} heads of cattle and deliver them back to him."),
      (call_script, "script_start_quest", "$g_random_army_quest", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_mission_told_deliver_cattle_to_army_rejected",
    [],
    "That . . . is unfortunate, {playername}. I shall have to find someone else who's up to the task. Please go now, I've work to do.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_start",
    [
      (check_quest_active, "qst_report_to_army"),
      (quest_slot_eq, "qst_report_to_army", 2, "$g_talk_troop"),
    ],
    "Ah, you have arrived at last, {playername}. We've been expecting you. I hope you have brought with you troops of sufficient number and experience.",
    "lord_report_to_army_asked",
    []],

  [plyr|anyone, "lord_report_to_army_asked",
    [
      (quest_get_slot, ":var0", "qst_report_to_army", 10),
      (call_script, "script_party_count_fit_for_battle", "p_main_party"),
      (gt, reg0, ":var0"),
    ],
    "I have a company of good, hardened soldiers with me. We are ready to join you.",
    "lord_report_to_army_completed",
    []],

  [plyr|anyone, "lord_report_to_army_asked",
    [],
    "I don't have the sufficient number of troops yet. I will need some more time.",
    "lord_report_to_army_continue",
    []],

  [anyone, "lord_report_to_army_completed",
    [],
    "Excellent. I will send the word when I have a task for you. For the moment, just follow us and stay close. We'll be moving soon.",
    "close_window",
    [
      (call_script, "script_end_quest", "qst_report_to_army"),
      (quest_set_slot, "qst_report_to_army", 6, "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (setup_quest_text, "qst_follow_army"),
      (str_store_string, s2, "@{s9} wants you to follow his army until further notice."),
      (call_script, "script_start_quest", "qst_follow_army", "$g_talk_troop"),
      (assign, "$g_player_follow_army_warnings", 0),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_report_to_army_continue",
    [],
    "Then you'd better hurry. We'll be moving out soon against the enemy and I need every able hand we can muster.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_start",
    [
      (check_quest_active, "qst_follow_army"),
      (faction_slot_eq, "$g_talk_troop_faction", 7, "$g_talk_troop"),
      (eq, "$g_random_army_quest", "qst_scout_waypoints"),
      (str_store_party_name, s13, "$qst_scout_waypoints_wp_1"),
      (str_store_party_name, s14, "$qst_scout_waypoints_wp_2"),
      (str_store_party_name, s15, "$qst_scout_waypoints_wp_3"),
    ],
    "{playername}, I need a volunteer to scout the area. We're sorely lacking on information, and I simply must have a better picture of the situation before we can proceed. I want you to go to {s13}, {s14} and {s15} and report back whatever you find.",
    "lord_mission_told_scout_waypoints",
    []],

  [plyr|anyone, "lord_mission_told_scout_waypoints",
    [],
    "You've found your volunteer.",
    "lord_mission_told_scout_waypoints_accepted",
    []],

  [plyr|anyone, "lord_mission_told_scout_waypoints",
    [],
    "I fear I must decline.",
    "lord_mission_told_scout_waypoints_rejected",
    []],

  [anyone, "lord_mission_told_scout_waypoints_accepted",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good {reg18?lass:man}! Simply pass near {s13}, {s14} and {s15} and check out what's there. Make a note of anything you find and return to me as soon as possible.",
    "close_window",
    [
      (call_script, "script_end_quest", "qst_follow_army"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s13, "$qst_scout_waypoints_wp_1"),
      (str_store_party_name_link, s14, "$qst_scout_waypoints_wp_2"),
      (str_store_party_name_link, s15, "$qst_scout_waypoints_wp_3"),
      (setup_quest_text, "$g_random_army_quest"),
      (str_store_string, s2, "@{s9} asked you to scout {s13}, {s14} and {s15}, then report back."),
      (call_script, "script_start_quest", "$g_random_army_quest", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_mission_told_scout_waypoints_rejected",
    [],
    "Hm. I'm disappointed, {playername}. Very disappointed. We'll talk later, I need to go and find somebody to scout for us.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_generic_mission_thank",
    [],
    "You have been most helpful, {playername}. My thanks.",
    "lord_generic_mission_completed",
    []],

  [plyr|anyone, "lord_generic_mission_completed",
    [],
    "It was an honour to serve.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (troop_get_slot, ":var0", "$g_talk_troop", 21),
      (gt, ":var0", 0),
      (assign, reg1, ":var0"),
    ],
    "I think you owe me {reg1} cents, {playername}. Do you intend to pay your debt anytime soon?",
    "lord_pay_debt_2",
    []],

  [plyr|anyone, "lord_pay_debt_2",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 21),
      (store_troop_gold, ":var1", "trp_player"),
      (le, ":var0", ":var1"),
    ],
    "That is why I came, {s65}. Here it is, every cent I owe you.",
    "lord_pay_debt_3_1",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 21),
      (troop_remove_gold, "trp_player", ":var0"),
      (troop_set_slot, "$g_talk_troop", 21, 0),
    ]],

  [plyr|anyone, "lord_pay_debt_2",
    [],
    "Alas, I don't have sufficient funds, {s65}. But I'll pay you soon enough.",
    "lord_pay_debt_3_2",
    []],

  [anyone, "lord_pay_debt_3_1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Ah, excellent. You are a {reg18?woman:man} of honour, {playername}. I am satisfied, your debt to me has been paid in full.",
    "lord_pretalk",
    []],

  [anyone, "lord_pay_debt_3_2",
    [],
    "Well, don't keep me waiting much longer.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [
      (party_slot_eq, "$g_encountered_party", 7, "$g_talk_troop"),
      (ge, "$g_talk_troop_faction_relation", 0),
      (neq, "$g_ransom_offer_rejected", 1),
      (lt, "$g_encountered_party_2", 0),
      (hero_can_join_as_prisoner, "$g_encountered_party"),
      (store_random_in_range, ":var0", 0, 100),
      (lt, ":var0", 10),
      (party_get_num_prisoner_stacks, ":var1", "p_main_party"),
      (assign, "$prisoner_lord_to_buy", -1),
      (try_for_range, ":var2", 0, ":var1"),
        (party_prisoner_stack_get_troop_id, ":var3", "p_main_party", ":var2"),
        (troop_slot_eq, ":var3", 2, 2),
        (store_troop_faction, ":var4", ":var3"),
        (store_relation, ":var5", ":var4", "$g_talk_troop_faction"),
        (lt, ":var5", 0),
        (assign, "$prisoner_lord_to_buy", ":var3"),
      (try_end),
      (gt, "$prisoner_lord_to_buy", 0),
      (assign, ":var6", 1),
      (try_begin),
        (check_quest_active, "qst_capture_enemy_hero"),
        (store_troop_faction, ":var7", "$prisoner_lord_to_buy"),
        (quest_slot_eq, "qst_capture_enemy_hero", 3, ":var7"),
        (assign, ":var6", 0),
      (try_end),
      (eq, ":var6", 1),
      (str_store_troop_name, s3, "$prisoner_lord_to_buy"),
      (assign, reg5, "$prisoner_lord_to_buy"),
      (call_script, "script_calculate_ransom_amount_for_troop", "$prisoner_lord_to_buy"),
      (assign, reg6, reg0),
      (val_div, reg6, 2),
      (assign, "$temp", reg6),
    ],
    "I heard that you have captured our enemy {s3} and he is with you at the moment. I can pay you {reg6} cents for him if you want to get rid of him. You can wait for his family to pay his ransom of course, but there is no telling how long that will take, eh?",
    "lord_buy_prisoner",
    []],

  [plyr|anyone, "lord_buy_prisoner",
    [],
    "I accept your offer. I'll leave {s3} to you for {reg6} cents.",
    "lord_buy_prisoner_accept",
    []],

  [plyr|anyone, "lord_buy_prisoner",
    [],
    "I fear I can't accept your offer.",
    "lord_buy_prisoner_deny",
    [
      (assign, "$g_ransom_offer_rejected", 1),
    ]],

  [anyone, "lord_buy_prisoner_accept",
    [],
    "Excellent! Here's your {reg6} cents. I'll send some men to take him to our prison with due haste.",
    "lord_pretalk",
    [
      (remove_troops_from_prisoners, "$prisoner_lord_to_buy", 1),
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (party_add_prisoners, "$g_encountered_party", "$prisoner_lord_to_buy", 1),
      (troop_set_slot, "$prisoner_lord_to_buy", 8, "$g_encountered_party"),
    ]],

  [anyone, "lord_buy_prisoner_deny",
    [],
    "Mmm. As you wish, {playername}, but you'll not get a better offer. Take it from me.",
    "lord_pretalk",
    []],

  [anyone, "lord_start",
    [],
    "What is it?",
    "lord_talk",
    []],

  [anyone, "lord_pretalk",
    [],
    "Anything else?",
    "lord_talk",
    []],

  [anyone, "hero_pretalk",
    [],
    "Anything else?",
    "lord_talk",
    []],

  [plyr|anyone, "lord_talk",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (check_quest_active, "qst_lend_companion"),
      (quest_slot_eq, "qst_lend_companion", 6, "$g_talk_troop"),
      (store_current_day, ":var0"),
      (quest_get_slot, ":var1", "qst_lend_companion", 10),
      (ge, ":var0", ":var1"),
      (quest_get_slot, ":var2", "qst_lend_companion", 2),
      (str_store_troop_name, s14, ":var2"),
      (troop_get_type, reg3, ":var2"),
      (call_script, "script_troop_get_gender_to_reg18", ":var2"),
    ],
    "I should like {s14} returned to me, {s65}, if you no longer require {reg18?her:his} services.",
    "lord_lend_companion_end",
    []],

  [anyone, "lord_lend_companion_end",
    [
      (neg|hero_can_join, "p_main_party"),
    ],
    "You've too many men in your company already, {playername}. You could not lead any more at the moment.",
    "lord_pretalk",
    []],

  [anyone, "lord_lend_companion_end",
    [],
    "Certainly, {playername}. {reg18?She:He} is a bright {reg18?girl:fellow}, you are lucky to have such worthy companions.",
    "lord_pretalk",
    [
      (quest_get_slot, ":var0", "qst_lend_companion", 2),
      (party_add_members, "p_main_party", ":var0", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (add_xp_as_reward, 100),
      (call_script, "script_end_quest", "qst_lend_companion"),
      (str_store_troop_name, s14, ":var0"),
      (troop_get_type, reg3, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (check_quest_active, "qst_collect_debt"),
      (quest_slot_eq, "qst_collect_debt", 11, 0),
      (quest_get_slot, ":var0", "qst_collect_debt", 2),
      (eq, "$g_talk_troop", ":var0"),
      (quest_get_slot, ":var1", "qst_collect_debt", 6),
      (str_store_troop_name, s1, ":var1"),
    ],
    "I've come to collect the debt you owe to {s1}.",
    "lord_ask_to_collect_debt",
    [
      (assign, "$g_convince_quest", "qst_collect_debt"),
    ]],

  [anyone, "lord_ask_to_collect_debt",
    [],
    "Oh. Well, {s1} did lend me some silver a ways back, but I've done him many favours in the past and I consider that money as my due payment.",
    "lord_ask_to_collect_debt_2",
    []],

  [plyr|anyone, "lord_ask_to_collect_debt_2",
    [],
    "{s1} considers it a debt. He asked me to speak to you on his behalf.",
    "convince_begin",
    []],

  [plyr|anyone, "lord_ask_to_collect_debt_2",
    [],
    "Then I will not press the matter any further.",
    "lord_pretalk",
    []],

  [anyone, "convince_accept",
    [
      (check_quest_active, "qst_collect_debt"),
      (quest_slot_eq, "qst_collect_debt", 2, "$g_talk_troop"),
      (quest_get_slot, ":var0", "qst_collect_debt", 6),
      (str_store_troop_name, s8, ":var0"),
      (quest_get_slot, reg10, "qst_collect_debt", 10),
    ],
    "My debt to {s8} has long been overdue and was a source of great discomfort to me. Thank you for accepting to take the money to him. Please give him these {reg10} cents and thank him on my behalf.",
    "close_window",
    [
      (call_script, "script_troop_add_gold", "trp_player", reg10),
      (quest_set_slot, "qst_collect_debt", 11, 1),
      (call_script, "script_succeed_quest", "qst_collect_debt"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (check_quest_active, "qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 2),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 4),
      (this_or_next|eq, ":var0", "$g_talk_troop"),
      (eq, ":var1", "$g_talk_troop"),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 3),
      (quest_get_slot, ":var3", "qst_persuade_lords_to_make_peace", 15),
      (str_store_faction_name, s12, ":var2"),
      (str_store_faction_name, s13, ":var3"),
    ],
    "Please, {s64}, it's time to end this war between {s12} and {s13}.",
    "lord_ask_to_make_peace",
    [
      (assign, "$g_convince_quest", "qst_persuade_lords_to_make_peace"),
    ]],

  [anyone, "lord_ask_to_make_peace",
    [],
    "Eh? I'm not sure I heard you right, {playername}. War is not easily forgotten by either side of the conflict, and I have a very long memory. Why should I take any interest in brokering peace with those dogs?",
    "lord_ask_to_make_peace_2",
    []],

  [plyr|anyone, "lord_ask_to_make_peace_2",
    [],
    "Perhaps I can talk you into it...",
    "convince_begin",
    []],

  [plyr|anyone, "lord_ask_to_make_peace_2",
    [],
    "Never mind, peace can wait for now.",
    "lord_pretalk",
    []],

  [anyone, "convince_accept",
    [
      (check_quest_active, "qst_persuade_lords_to_make_peace"),
      (this_or_next|quest_slot_eq, "qst_persuade_lords_to_make_peace", 2, "$g_talk_troop"),
      (quest_slot_eq, "qst_persuade_lords_to_make_peace", 4, "$g_talk_troop"),
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 15),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 3),
      (str_store_faction_name, s12, ":var0"),
      (str_store_faction_name, s13, ":var1"),
      (try_begin),
        (eq, ":var0", "$g_talk_troop_faction"),
        (str_store_faction_name, s14, ":var1"),
      (else_try),
        (str_store_faction_name, s14, ":var0"),
      (try_end),
    ],
    "You... have convinced me, {playername}. Very well then, you've my blessing to bring a peace offer to {s14}. I cannot guarantee they will accept it, but on the off-chance they do, I will stand by it.",
    "close_window",
    [
      (store_mul, ":var0", "$g_talk_troop", -1),
      (try_begin),
        (quest_slot_eq, "qst_persuade_lords_to_make_peace", 2, "$g_talk_troop"),
        (quest_set_slot, "qst_persuade_lords_to_make_peace", 2, ":var0"),
      (else_try),
        (quest_set_slot, "qst_persuade_lords_to_make_peace", 4, ":var0"),
      (try_end),
      (quest_set_slot, "qst_persuade_lords_to_make_peace", 19, 1500),
      (assign, "$g_leave_encounter", 1),
      (neg|quest_slot_ge, "qst_persuade_lords_to_make_peace", 2, 0),
      (neg|quest_slot_ge, "qst_persuade_lords_to_make_peace", 4, 0),
      (call_script, "script_succeed_quest", "qst_persuade_lords_to_make_peace"),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (check_quest_active, "qst_duel_for_lady"),
      (neg|check_quest_concluded, "qst_duel_for_lady"),
      (quest_slot_eq, "qst_duel_for_lady", 2, "$g_talk_troop"),
      (quest_get_slot, ":var0", "qst_duel_for_lady", 6),
      (str_store_troop_name, s1, ":var0"),
    ],
    "I want you to take back your accusations against {s1}.",
    "lord_challenge_duel_for_lady",
    []],

  [anyone, "lord_challenge_duel_for_lady",
    [],
    "What accusations? Everyone knows that she beds her stable boys and anyone else she can lay hands on while her husband is away. I merely repeat the words of many.",
    "lord_challenge_duel_for_lady_2",
    []],

  [plyr|anyone, "lord_challenge_duel_for_lady_2",
    [],
    "You will recant these lies, or fight me to first blood!",
    "lord_challenge_duel_for_lady_3",
    []],

  [plyr|anyone, "lord_challenge_duel_for_lady_2",
    [],
    "If you say so...",
    "lord_pretalk",
    []],

  [anyone, "lord_challenge_duel_for_lady_3",
    [],
    "You are challenging me to a duel? How droll! As you wish, {playername}, it will be good sport to bash your head in.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -20),
      (assign, "$g_leave_encounter", 1),
      (try_begin),
        (is_between, "$g_encountered_party", "p_town_1", "p_castle_1"),
        (party_get_slot, ":var0", "$g_encountered_party", 16),
      (else_try),
        (assign, ":var1", 100000),
        (assign, ":var2", -1),
        (try_for_range, ":var3", "p_town_1", "p_castle_1"),
          (store_distance_to_party_from_party, ":var4", ":var3", "p_main_party"),
          (lt, ":var4", ":var1"),
          (assign, ":var1", ":var4"),
          (assign, ":var2", ":var3"),
        (try_end),
        (party_get_slot, ":var0", ":var2", 16),
      (try_end),
      (modify_visitors_at_site, ":var0"),
      (reset_visitors),
      (set_visitor, 0, "trp_player"),
      (set_visitor, 1, "$g_talk_troop"),
      (set_jump_mission, "mt_arena_challenge_fight"),
      (jump_to_scene, ":var0"),
      (try_begin),
        (neq, "$talk_context", 1),
        (jump_to_menu, "mnu_arena_duel_fight"),
      (try_end),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (check_quest_active, "qst_deliver_message"),
      (quest_get_slot, ":var0", "qst_deliver_message", 2),
      (eq, "$g_talk_troop", ":var0"),
      (quest_get_slot, ":var1", "qst_deliver_message", 6),
      (str_store_troop_name, s9, ":var1"),
    ],
    "I bring a message from {s9}.",
    "lord_message_delivered",
    []],

  [anyone, "lord_message_delivered",
    [],
    "Oh? Let me see that... Well well well! It was good of you to bring me this, {playername}. Take my seal as proof that I've received it, and give my regards to {s9} when you see him again.",
    "lord_pretalk",
    [
      (call_script, "script_end_quest", "qst_deliver_message"),
      (quest_get_slot, ":var0", "qst_deliver_message", 6),
      (str_store_troop_name, s9, ":var0"),
      (call_script, "script_change_player_relation_with_troop", ":var0", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (check_quest_active, "qst_deliver_message_to_enemy_lord"),
      (quest_get_slot, ":var0", "qst_deliver_message_to_enemy_lord", 2),
      (eq, "$g_talk_troop", ":var0"),
      (quest_get_slot, ":var1", "qst_deliver_message_to_enemy_lord", 6),
      (str_store_troop_name, s9, ":var1"),
    ],
    "I bring a message from {s9}.",
    "lord_message_delivered_enemy",
    []],

  [anyone, "lord_message_delivered_enemy",
    [],
    "Oh? Let me see that... Hmmm. It was good of you to bring me this, {playername}. Take my seal as proof that I've received it, with my thanks.",
    "close_window",
    [
      (call_script, "script_end_quest", "qst_deliver_message_to_enemy_lord"),
      (quest_get_slot, ":var0", "qst_deliver_message_to_enemy_lord", 6),
      (call_script, "script_change_player_relation_with_troop", ":var0", 3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (check_quest_active, "qst_deliver_message_to_prisoner_lord"),
      (quest_slot_eq, "qst_deliver_message_to_prisoner_lord", 2, "$g_talk_troop"),
      (quest_get_slot, ":var0", "qst_deliver_message_to_prisoner_lord", 6),
      (str_store_troop_name, s11, ":var0"),
    ],
    "I bring a message from {s11}.",
    "lord_deliver_message_prisoner",
    [
      (call_script, "script_end_quest", "qst_deliver_message_to_prisoner_lord"),
    ]],

  [anyone, "lord_deliver_message_prisoner",
    [],
    "Can it be true? Oh, thank you kindly, {playername}! You have brought hope and some small ray of light to these bleak walls. Perhaps one day I will be able to repay you.",
    "lord_deliver_message_prisoner_2",
    []],

  [plyr|anyone, "lord_deliver_message_prisoner_2",
    [],
    " 'Twas the least I could do, {s65}.",
    "lord_deliver_message_prisoner_2a",
    []],

  [anyone, "lord_deliver_message_prisoner_2a",
    [],
    "You've no idea how grateful I am, {playername}. A thousand thanks and more.",
    "close_window",
    []],

  [plyr|anyone, "lord_deliver_message_prisoner_2",
    [],
    "Worry not, {s65}. You'll have ample opportunity once you are free again.",
    "lord_deliver_message_prisoner_2b",
    []],

  [anyone, "lord_deliver_message_prisoner_2b",
    [],
    "Hah, of course, {playername}. My eternal thanks go with you.",
    "close_window",
    []],

  [plyr|anyone, "lord_talk",
    [
      (troop_slot_ge, "$g_talk_troop", 8, 0),
      (check_quest_active, "qst_rescue_lord_by_replace"),
      (quest_slot_eq, "qst_rescue_lord_by_replace", 2, "$g_talk_troop"),
      (neg|check_quest_succeeded, "qst_rescue_lord_by_replace"),
    ],
    "Fear not, I am here to rescue you.",
    "lord_rescue_by_replace_offer",
    []],

  [anyone, "lord_rescue_by_replace_offer",
    [],
    "By God, are you serious? What is your plan?",
    "lord_rescue_by_replace_offer_2",
    []],

  [plyr|anyone, "lord_rescue_by_replace_offer_2",
    [],
    "A simple ruse, {s65}. If we exchange garments, I shall take your place here in prison, while you make your escape disguised as myself. I paid the guards a handsome bribe, with which I am sure they have already purchased half the wine stocks of the nearest saloon. With some luck they'll soon get so drunk they'd have trouble recognising their own mothers, let alone telling one of us from the other. At least not until you are safely away.",
    "lord_rescue_by_replace_offer_3",
    []],

  [anyone, "lord_rescue_by_replace_offer_3",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Hmm, it might just work... But what of you, my {reg18?lady:good sir}? The guards won't take kindly to this trickery. You may end up spending some time in this cell yourself.",
    "lord_rescue_by_replace_offer_4",
    []],

  [plyr|anyone, "lord_rescue_by_replace_offer_4",
    [],
    "Not to worry, {s65}. The place is already starting to grow on me.",
    "lord_rescue_by_replace_offer_5a",
    []],

  [plyr|anyone, "lord_rescue_by_replace_offer_4",
    [],
    "I shall be fine as long there is an ample reward waiting at the end.",
    "lord_rescue_by_replace_offer_5b",
    []],

  [anyone, "lord_rescue_by_replace_offer_5a",
    [],
    "You are a brave soul indeed. I won't forget this.",
    "lord_rescue_by_replace_offer_6",
    []],

  [anyone, "lord_rescue_by_replace_offer_5b",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Of course, my {reg18?lady:good sir}, of course! Come to me when you have regained your freedom, and perhaps I shall be able to repay the debt I owe you.",
    "lord_rescue_by_replace_offer_6",
    []],

  [plyr|anyone, "lord_rescue_by_replace_offer_6",
    [],
    "Quickly, {s65}, let us change garments. It is past time you were away from here.",
    "close_window",
    [
      (call_script, "script_succeed_quest", "qst_rescue_lord_by_replace"),
      (quest_get_slot, ":var0", "qst_rescue_lord_by_replace", 2),
      (quest_get_slot, ":var1", "qst_rescue_lord_by_replace", 1),
      (party_remove_prisoners, ":var1", ":var0", 1),
      (troop_set_slot, ":var0", 8, -1),
      (assign, "$auto_menu", -1),
      (assign, "$capturer_party", "$g_encountered_party"),
      (jump_to_menu, "mnu_captivity_rescue_lord_taken_prisoner"),
      (finish_mission),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (eq, "$players_oath_renounced_against_kingdom", "$g_talk_troop_faction"),
      (str_store_faction_name, s4, "$g_talk_troop_faction"),
    ],
    "{s66}, I wish to restore my old oath to {s4}.",
    "lord_ask_pardon_after_oath_renounced",
    []],

  [anyone, "lord_ask_pardon_after_oath_renounced",
    [
      (faction_get_slot, ":var0", "$g_talk_troop_faction", 10),
      (neq, ":var0", "$g_talk_troop"),
      (str_store_troop_name, s4, ":var0"),
    ],
    "That is too great a matter for me to decide, {playername}. You should seek out {s4}. Such clemency is his alone to grant or deny.",
    "lord_pretalk",
    []],

  [anyone, "lord_ask_pardon_after_oath_renounced",
    [
      (assign, ":var0"),
      (try_for_range, ":var1", "p_town_1", "p_village_1"),
        (store_faction_of_party, ":var2", ":var1"),
        (eq, ":var2", "fac_player_supporters_faction"),
        (party_slot_eq, ":var1", 155, "$g_talk_troop_faction"),
        (val_add, ":var0", 1),
      (try_end),
      (store_mul, ":var3", ":var0", 500),
      (store_current_hours, ":var4"),
      (val_sub, ":var4", "$players_oath_renounced_begin_time"),
      (val_add, ":var3", ":var4"),
      (try_begin),
        (gt, ":var3", 800),
        (assign, ":var5", -1),
        (try_begin),
          (gt, ":var3", 1500),
          (try_begin),
            (eq, "$players_oath_renounced_given_center", 0),
            (store_random_in_range, ":var5", 0, ":var0"),
          (try_end),
        (else_try),
          (assign, "$players_oath_renounced_given_center", 0),
        (try_end),
        (assign, ":var6", 0),
        (try_for_range, ":var1", "p_town_1", "p_village_1"),
          (store_faction_of_party, ":var2", ":var1"),
          (eq, ":var2", "fac_player_supporters_faction"),
          (party_slot_eq, ":var1", 155, "$g_talk_troop_faction"),
          (try_begin),
            (eq, ":var5", 0),
            (assign, "$players_oath_renounced_given_center", ":var1"),
          (else_try),
            (neq, "$players_oath_renounced_given_center", ":var1"),
            (try_begin),
              (eq, ":var6", 0),
              (str_store_party_name, s17, ":var1"),
            (else_try),
              (eq, ":var6", 1),
              (str_store_party_name, s16, ":var1"),
              (str_store_string, s17, "@{s16} and {s17}"),
            (else_try),
              (str_store_party_name, s16, ":var1"),
              (str_store_string, s17, "@{s16}, {s17}"),
            (try_end),
            (val_add, ":var6", 1),
          (try_end),
          (val_sub, ":var5", 1),
        (try_end),
        (try_begin),
          (eq, ":var6", 0),
          (str_store_string, s11, "@Very well, I will accept you back into my ranks, if you're ready to swear your solemn oath once more."),
          (assign, "$players_oath_renounced_terms_state", 1),
        (else_try),
          (str_store_string, s11, "@A pardon will only be possible if you are willing to cede {s17} to me. Do you agree my terms?"),
          (assign, "$players_oath_renounced_terms_state", 2),
        (try_end),
      (else_try),
        (str_store_string, s11, "@No. There is no chance of peace between us, I am not interested."),
        (assign, "$players_oath_renounced_terms_state", 0),
      (try_end),
    ],
    "{s11}.",
    "lord_ask_pardon_terms",
    []],

  [plyr|anyone, "lord_ask_pardon_terms",
    [
      (eq, "$players_oath_renounced_terms_state", 0),
    ],
    "As you like, {s65}. I will accept your judgment.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_ask_pardon_terms",
    [
      (eq, "$players_oath_renounced_terms_state", 0),
    ],
    "A shame, {s65}. A shame.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_ask_pardon_terms",
    [
      (eq, "$players_oath_renounced_terms_state", 0),
    ],
    "Very well, go and die without me.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_ask_pardon_terms",
    [
      (eq, "$players_oath_renounced_terms_state", 1),
    ],
    "Aye, I am ready.",
    "lord_ask_pardon_after_renounce_peace",
    []],

  [plyr|anyone, "lord_ask_pardon_terms",
    [
      (eq, "$players_oath_renounced_terms_state", 1),
    ],
    "On second thought, no. I don't wish to be in your service again.",
    "lord_ask_pardon_terms_rejected",
    []],

  [plyr|anyone, "lord_ask_pardon_terms",
    [
      (eq, "$players_oath_renounced_terms_state", 2),
    ],
    "Aye, I agree to those terms.",
    "lord_ask_pardon_after_renounce_peace",
    []],

  [plyr|anyone, "lord_ask_pardon_terms",
    [
      (eq, "$players_oath_renounced_terms_state", 2),
    ],
    "That is too high a price, {s65}. I must decline.",
    "lord_ask_pardon_terms_rejected",
    []],

  [anyone, "lord_ask_pardon_after_renounce_peace",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Excellent. Though you strayed from us, {playername}, it gladdens all our hearts that you have found your way back to the right path. I hereby restore your status as an honoured {reg18?woman:man} in my service.",
    "lord_pretalk",
    [
      (try_for_range, ":var0", "p_town_1", "p_village_1"),
        (store_faction_of_party, ":var1", ":var0"),
        (eq, ":var1", "fac_player_supporters_faction"),
        (party_slot_eq, ":var0", 155, "$g_talk_troop_faction"),
        (neq, ":var0", "$players_oath_renounced_given_center"),
        (call_script, "script_give_center_to_faction", ":var0", "$g_talk_troop_faction"),
      (try_end),
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (assign, "$player_has_homage", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
    ]],

  [anyone, "lord_ask_pardon_terms_rejected",
    [],
    "Then get out of my sight, traitor! Begone with you, and do not come back!",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (lt, "$g_talk_troop_faction_relation", 0),
      (this_or_next|eq, "$players_kingdom", 0),
      (eq, "$players_kingdom", "fac_player_supporters_faction"),
      (neq, "$players_oath_renounced_against_kingdom", "$g_talk_troop_faction"),
      (assign, ":var0", 1),
      (try_begin),
        (gt, "$supported_pretender", 0),
        (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
        (assign, ":var0", 0),
      (try_end),
      (eq, ":var0", 1),
      (str_store_faction_name, s4, "$g_talk_troop_faction"),
    ],
    "I wish to make peace with {s4}.",
    "lord_ask_pardon",
    []],

  [anyone, "lord_ask_pardon",
    [
      (lt, "$g_talk_troop_relation", -10),
    ],
    "Do you indeed, {playername}? Then go and kill yourselve. Give us all peace.",
    "lord_pretalk",
    []],

  [anyone, "lord_ask_pardon",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (assign, ":var0", 0),
      (try_for_range, ":var1", "p_town_1", "p_salt_mine"),
        (store_faction_of_party, ":var2", ":var1"),
        (eq, ":var2", "fac_player_supporters_faction"),
        (assign, ":var0", 1),
      (try_end),
      (eq, ":var0", 1),
    ],
    "{playername}, you are a {reg18?woman:man} without a master, holding lands in your name, without having allegience to any kingdom. As long as that continues, no leader would accept a lasting peace with you.",
    "lord_pretalk",
    []],

  [anyone, "lord_ask_pardon",
    [
      (store_sub, ":var0", 4, "$g_talk_troop_faction_relation"),
      (val_mul, ":var0", ":var0"),
      (store_mul, reg16, ":var0", 10),
    ],
    "Hmm. I could use my considerable influence to arrange a pardon for you, {playername}, but there are some who see you as an enemy and will not be satisfied unless you pay tribute. All in all, you'd need to bring no less than {reg16} cents to make any friends in {s4}.",
    "lord_ask_pardon_2",
    []],

  [plyr|anyone, "lord_ask_pardon_2",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", reg16),
    ],
    "I have the money here. {reg16} cents.",
    "lord_ask_pardon_tribue_accept",
    []],

  [plyr|anyone, "lord_ask_pardon_2",
    [],
    "I fear I cannot pay that much.",
    "lord_ask_pardon_tribue_deny",
    []],

  [anyone, "lord_ask_pardon_tribue_accept",
    [],
    "Excellent, {playername}. I'll use the coin to smooth the feathers of those that can oppose your pardon, and I'm sure that word will soon spread that you are no longer an enemy of {s4}.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", reg16),
      (try_begin),
        (eq, "$players_kingdom", 0),
        (call_script, "script_set_player_relation_with_faction", "$g_talk_troop_faction", 0),
      (else_try),
        (call_script, "script_diplomacy_start_peace_between_kingdoms", "$g_talk_troop_faction", "$players_kingdom"),
      (try_end),
      (assign, "$g_leave_town_outside", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_ask_pardon_tribue_deny",
    [],
    "Then there's nothing I can do for you, {playername}. No silver, no pardon.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_talk",
    [
      (store_partner_quest, ":var0"),
      (ge, ":var0", 0),
    ],
    "About the task you gave me...",
    "lord_active_mission_1",
    []],

  [plyr|anyone, "lord_talk",
    [
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (eq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$player_has_homage", 0),
      (gt, "$mercenary_service_accumulated_pay", 0),
    ],
    "{s67}, I humbly request the weekly payment for my service.",
    "lord_pay_mercenary",
    []],

  [anyone, "lord_pay_mercenary",
    [
      (assign, reg8, "$mercenary_service_accumulated_pay"),
    ],
    "Hmm, let me see... According to my ledgers, we owe you {reg8} cents for your work. Here you are.",
    "lord_pay_mercenary_2",
    [
      (troop_add_gold, "trp_player", "$mercenary_service_accumulated_pay"),
      (assign, "$mercenary_service_accumulated_pay", 0),
    ]],

  [plyr|anyone, "lord_pay_mercenary_2",
    [],
    "Much obliged.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_talk",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (store_partner_quest, ":var0"),
      (lt, ":var0", 0),
    ],
    "Do you have any tasks for me?",
    "lord_request_mission_ask",
    []],

  [plyr|anyone, "lord_talk",
    [
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (ge, "$g_talk_troop_faction_relation", 0),
      (faction_slot_eq, "$g_talk_troop_faction", 100, 0),
    ],
    "I'm interested in joining the army as a regular soldier",
    "lord_request_join_soldier",
    []],

  [anyone, "lord_request_join_soldier",
    [
      (neq, "$players_kingdom", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You've already joined a side, {reg18?ma'am:sir}.",
    "lord_leave",
    []],

  [anyone, "lord_request_join_soldier",
    [
      (lt, "$g_talk_troop_relation", 0),
    ],
    "Forget it {playername}. A coward like you would disgrace our army.",
    "lord_leave",
    []],

  [anyone, "lord_request_join_soldier",
    [
      (lt, "$g_talk_troop_faction_relation", 0),
    ],
    "I'm sorry, {playername}, some of the higher officers have a bad opinion of you.",
    "lord_leave",
    []],

  [anyone, "lord_request_join_soldier",
    [
      (call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":var0", reg0),
      (val_add, ":var0", 2500),
      (val_mul, ":var0", 4),
      (call_script, "script_round_value", ":var0"),
      (assign, ":var0", reg0),
      (assign, "$temp", ":var0"),
      (faction_get_slot, ":var1", "$g_talk_troop_faction", 10),
      (neq, ":var1", "$g_talk_troop"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
      (str_store_troop_name, s10, ":var1"),
    ],
    "Very well, {playername}. I offer you a wage of {reg0} cents per month over a time of 90 days.   In case you think about joining {s9} as an officer later, speak to our great general {s10}.   What do you think?",
    "lord_request_join_soldier2",
    []],

  [anyone, "lord_request_join_soldier",
    [
      (call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":var0", reg0),
      (val_add, ":var0", 2500),
      (call_script, "script_round_value", ":var0"),
      (assign, ":var0", reg0),
      (assign, "$temp", ":var0"),
      (faction_get_slot, ":var1", "$g_talk_troop_faction", 10),
      (eq, ":var1", "$g_talk_troop"),
    ],
    "Very well, {playername}. I offer you a wage of {reg0} cents per month over a time of 90 days.   In case you think about joining us as an officer later, speak with me once you think you are strong enough.   What do you think?",
    "lord_request_join_soldier2",
    []],

  [plyr|anyone, "lord_request_join_soldier2",
    [],
    "I'm willing to sign the papers.",
    "lord_request_join_soldier3",
    []],

  [plyr|anyone, "lord_request_join_soldier2",
    [],
    "Later, perhaps.",
    "lord_leave",
    []],

  [plyr|anyone, "lord_request_join_soldier2",
    [
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Actually, I'd prefer an officer position.",
    "lord_ask_enter_service",
    []],

  [plyr|anyone, "lord_request_join_soldier2",
    [
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Actually, I'd prefer an officer position.",
    "lord_ask_enter_service_wrong",
    []],

  [anyone, "lord_ask_enter_service_wrong",
    [],
    "As I said: Speak to our general. Now, are interested or not?",
    "lord_request_join_soldier2",
    []],

  [anyone, "lord_request_join_soldier3",
    [],
    "Here they are.",
    "lord_leave",
    [
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (store_current_hours, ":var0"),
      (store_add, "$mercenary_service_next_pay_time", ":var0", 168),
      (assign, "$mercenary_service_accumulated_pay", 0),
      (store_current_day, ":var1"),
      (store_add, "$mercenary_service_next_renew_day", ":var1", 90),
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (faction_slot_eq, "$g_talk_troop_faction", 100, 1),
    ],
    "Would you be interested in hiring a good gunslinger?",
    "lord_request_join_gunslinger",
    []],

  [anyone, "lord_request_join_gunslinger",
    [
      (neq, "$players_kingdom", 0),
    ],
    "You've already joined a side, amigo.",
    "lord_leave",
    []],

  [anyone, "lord_request_join_gunslinger",
    [
      (lt, "$g_talk_troop_relation", 0),
    ],
    "Forget it {playername}. A coward like you would disgrace our gang.",
    "lord_leave",
    []],

  [anyone, "lord_request_join_gunslinger",
    [
      (lt, "$g_talk_troop_faction_relation", 0),
    ],
    "I'm sorry, {playername}, some of the higher gang members have a bad opinion of you.",
    "lord_leave",
    []],

  [anyone, "lord_request_join_gunslinger",
    [
      (call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":var0", reg0),
      (val_add, ":var0", 3000),
      (call_script, "script_round_value", ":var0"),
      (assign, ":var0", reg0),
      (assign, "$temp", ":var0"),
      (faction_get_slot, ":var1", "$g_talk_troop_faction", 10),
      (neq, ":var1", "$g_talk_troop"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
      (str_store_troop_name, s10, ":var1"),
    ],
    "Very well, {playername}. I offer you a wage of {reg0} cents per month over a time of 90 days.   In case you think about joining {s9} as a real member later, speak to our great leader {s10}.   What do you think?",
    "lord_request_join_gunslinger2",
    []],

  [anyone, "lord_request_join_gunslinger",
    [
      (call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":var0", reg0),
      (val_add, ":var0", 3000),
      (call_script, "script_round_value", ":var0"),
      (assign, ":var0", reg0),
      (assign, "$temp", ":var0"),
      (faction_get_slot, ":var1", "$g_talk_troop_faction", 10),
      (eq, ":var1", "$g_talk_troop"),
    ],
    "Very well, {playername}. I offer you a wage of {reg0} cents per month over a time of 90 days.   In case you think about joining us as a real member later, speak with me once you think you are strong enough.   What do you think?",
    "lord_request_join_gunslinger2",
    []],

  [plyr|anyone, "lord_request_join_gunslinger2",
    [],
    "I'm willing to sign the papers.",
    "lord_request_join_gunslinger3",
    []],

  [plyr|anyone, "lord_request_join_gunslinger2",
    [],
    "Later, perhaps.",
    "lord_leave",
    []],

  [plyr|anyone, "lord_request_join_gunslinger2",
    [
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Actually, I'd prefer a real member's position.",
    "lord_ask_enter_service",
    []],

  [plyr|anyone, "lord_request_join_gunslinger2",
    [
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Actually, I'd prefer a real member's position.",
    "lord_ask_enter_service_wrong",
    []],

  [anyone, "lord_ask_enter_service_wrong",
    [],
    "As I said: Speak to our leader. Now, are interested or not?",
    "lord_request_join_soldier2",
    []],

  [anyone, "lord_request_join_gunslinger3",
    [],
    "Here they are.",
    "lord_leave",
    [
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (store_current_hours, ":var0"),
      (store_add, "$mercenary_service_next_pay_time", ":var0", 168),
      (assign, "$mercenary_service_accumulated_pay", 0),
      (store_current_day, ":var1"),
      (store_add, "$mercenary_service_next_renew_day", ":var1", 90),
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
    ]],

  [anyone, "lord_intro",
    [],
    "{s11}",
    "lord_start",
    [
      (faction_get_slot, ":var0", "$g_talk_troop_faction", 10),
      (str_store_faction_name, s6, "$g_talk_troop_faction"),
      (assign, reg4, 0),
      (str_store_troop_name, s4, "$g_talk_troop"),
      (try_begin),
        (eq, ":var0", "$g_talk_troop"),
        (str_store_string, s9, "@I am {s4}, the army commander of {s6}", 0),
      (else_try),
        (str_store_string, s9, "@I am {s4}, a commanding officer of {s6}", 0),
      (try_end),
      (assign, ":var1", 0),
      (str_clear, s8),
      (try_for_range_backwards, ":var2", "p_town_1", "p_salt_mine"),
        (party_slot_eq, ":var2", 7, "$g_talk_troop"),
        (try_begin),
          (eq, ":var1", 0),
          (str_store_party_name, s8, ":var2"),
        (else_try),
          (eq, ":var1", 1),
          (str_store_party_name, s7, ":var2"),
          (str_store_string, s8, "@{s7} and {s8}"),
        (else_try),
          (str_store_party_name, s7, ":var2"),
          (str_store_string, s8, "@{s7}, {s8}"),
        (try_end),
        (val_add, ":var1", 1),
      (try_end),
      (assign, reg5, ":var1"),
      (str_store_string, s11, "@{s9}{reg5? and the owner of {s8}.:.", 0),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (le, "$talk_context", 2),
      (ge, "$g_talk_troop_faction_relation", 0),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (store_partner_quest, ":var0"),
      (neq, ":var0", "qst_join_faction"),
    ],
    "{s66}, I have come to offer you my services!",
    "lord_ask_enter_service",
    []],

  [plyr|anyone, "lord_talk",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (le, "$talk_context", 2),
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (eq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$player_has_homage", 0),
      (store_partner_quest, ":var0"),
      (neq, ":var0", "qst_join_faction"),
    ],
    "{s66}, I wish to become your sworn {reg18?woman:man} and fight for your honour.",
    "lord_ask_enter_service",
    []],

  [plyr|anyone, "lord_talk",
    [
      (le, "$talk_context", 2),
      (ge, "$g_talk_troop_faction_relation", 0),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (eq, "$players_kingdom", "$g_talk_troop_faction"),
      (eq, "$player_has_homage", 1),
    ],
    "{s66}, I wish to be released from my oath to you.",
    "lord_ask_leave_service",
    []],

  [plyr|anyone, "lord_talk",
    [
      (eq, 1, 0),
      (le, "$talk_context", 2),
      (ge, "$g_talk_troop_faction_relation", 0),
    ],
    "I have an offer for you.",
    "lord_talk_preoffer",
    []],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
    ],
    "I want to give some troops to you.",
    "lord_give_troops",
    []],

  [anyone, "lord_give_troops",
    [],
    "Well, I could use some good soldiers. Thank you.",
    "lord_pretalk",
    [
      (change_screen_give_members),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", 7, "trp_player"),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
    ],
    "I have a new task for you.",
    "lord_give_order_ask",
    []],

  [anyone, "lord_give_order_ask",
    [],
    "Yes?",
    "lord_give_order",
    []],

  [plyr|anyone, "lord_give_order",
    [],
    "Follow me.",
    "lord_give_order_answer",
    [
      (assign, "$temp", 11),
      (assign, "$temp_2", "p_main_party"),
    ]],

  [plyr|anyone, "lord_give_order",
    [],
    "Go to...",
    "lord_give_order_details_ask",
    [
      (assign, "$temp", 7),
    ]],

  [plyr|anyone, "lord_give_order",
    [],
    "Raid around the village of...",
    "lord_give_order_details_ask",
    [
      (assign, "$temp", 5),
    ]],

  [plyr|anyone, "lord_give_order",
    [],
    "Patrol around...",
    "lord_give_order_details_ask",
    [
      (assign, "$temp", 4),
    ]],

  [plyr|anyone, "lord_give_order",
    [
      (neg|troop_slot_eq, "$g_talk_troop", 16, -1),
    ],
    "I won't need you for some time. You are free to do as you like.",
    "lord_give_order_stop",
    []],

  [plyr|anyone, "lord_give_order",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_give_order_details_ask",
    [],
    "Where?",
    "lord_give_order_details",
    []],

  [repeat_for_parties|plyr|anyone, "lord_give_order_details",
    [
      (store_repeat_object, ":var0"),
      (store_faction_of_party, ":var1", ":var0"),
      (store_relation, ":var2", ":var1", "$players_kingdom"),
      (assign, ":var3", 0),
      (try_begin),
        (eq, "$temp", 7),
        (try_begin),
          (this_or_next|party_slot_eq, ":var0", 0, 2),
          (party_slot_eq, ":var0", 0, 3),
          (eq, ":var1", "$players_kingdom"),
          (assign, ":var3", 1),
        (try_end),
      (else_try),
        (eq, "$temp", 5),
        (try_begin),
          (party_slot_eq, ":var0", 0, 4),
          (lt, ":var2", 0),
          (assign, ":var3", 1),
        (try_end),
      (else_try),
        (eq, "$temp", 4),
        (try_begin),
          (eq, ":var1", "$players_kingdom"),
          (is_between, ":var0", "p_town_1", "p_salt_mine"),
          (assign, ":var3", 1),
        (try_end),
      (try_end),
      (eq, ":var3", 1),
      (neq, ":var0", "$g_encountered_party"),
      (str_store_party_name, s1, ":var0"),
    ],
    "{s1}",
    "lord_give_order_answer",
    [
      (store_repeat_object, "$temp_2"),
    ]],

  [plyr|anyone, "lord_give_order_details",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_give_order_stop",
    [],
    "Alright. I will do that.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 16, -1),
      (troop_set_slot, "$g_talk_troop", 17, -1),
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (try_begin),
        (gt, ":var0", 0),
        (call_script, "script_party_set_ai_state", ":var0", -1, -1),
        (party_set_slot, ":var0", 30, -1),
      (try_end),
    ]],

  [anyone, "lord_give_order_answer",
    [
      (assign, ":var0", 0),
      (try_begin),
        (troop_slot_ge, "$g_talk_troop", 58, 60),
        (assign, ":var0", 1),
      (else_try),
        (troop_slot_ge, "$g_talk_troop", 58, 10),
        (neg|troop_slot_eq, "$g_talk_troop", 16, -1),
        (assign, ":var0", 1),
      (try_end),
      (troop_get_slot, ":var1", "$g_talk_troop", 10),
      (this_or_next|le, ":var1", 0),
      (eq, ":var0", 0),
    ],
    "I am sorry. I need to attend my own business at the moment.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 16, -1),
      (troop_set_slot, "$g_talk_troop", 17, -1),
    ]],

  [auto_proceed|anyone, "lord_give_order_answer",
    [],
    ".",
    "lord_give_order_answer_2",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (call_script, "script_party_set_ai_state", ":var0", "$temp", "$temp_2"),
      (try_begin),
        (eq, "$temp", 11),
        (party_set_slot, ":var0", 30, "$temp_2"),
      (else_try),
        (party_set_slot, ":var0", 30, -1),
      (try_end),
      (troop_set_slot, "$g_talk_troop", 16, "$temp"),
      (troop_set_slot, "$g_talk_troop", 17, "$temp_2"),
      (call_script, "script_recalculate_ai_for_troop", "$g_talk_troop"),
    ]],

  [anyone, "lord_give_order_answer_2",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (party_slot_eq, ":var0", 4, "$temp"),
      (party_slot_eq, ":var0", 5, "$temp_2"),
      (assign, "$g_leave_encounter", 1),
    ],
    "I will do that.",
    "close_window",
    []],

  [anyone, "lord_give_order_answer_2",
    [],
    "I am sorry, it is not possible for me to do that.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 16, -1),
      (troop_set_slot, "$g_talk_troop", 17, -1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", 7, "trp_player"),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (faction_slot_eq, "$players_kingdom", 4, 0),
    ],
    "I want to start a new campaign. Let us assemble the army here.",
    "lord_give_order_call_to_arms_verify",
    []],

  [anyone, "lord_give_order_call_to_arms_verify",
    [],
    "You wish to summon all lords for a new campaign?",
    "lord_give_order_call_to_arms_verify_2",
    []],

  [plyr|anyone, "lord_give_order_call_to_arms_verify_2",
    [],
    "Yes. We must gather all our forces before we march on the enemy.",
    "lord_give_order_call_to_arms",
    []],

  [plyr|anyone, "lord_give_order_call_to_arms_verify_2",
    [],
    "On second thought, it won't be necessary to summon everyone.",
    "lord_pretalk",
    []],

  [anyone, "lord_give_order_call_to_arms",
    [],
    "Alright then. I will send messengers and tell everyone to come here.",
    "lord_pretalk",
    [
      (faction_set_slot, "$players_kingdom", 4, 1),
      (assign, "$g_recalculate_ais", 1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (faction_slot_eq, "$players_kingdom", 7, "trp_player"),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (neg|faction_slot_eq, "$players_kingdom", 4, 0),
    ],
    "I want to end the campaign and let everyone return home.",
    "lord_give_order_disband_army_verify",
    []],

  [anyone, "lord_give_order_disband_army_verify",
    [],
    "You want to end the current campaign and release all lords from duty?",
    "lord_give_order_disband_army_2",
    []],

  [plyr|anyone, "lord_give_order_disband_army_2",
    [],
    "Yes. We no longer need all our forces here.",
    "lord_give_order_disband_army",
    []],

  [plyr|anyone, "lord_give_order_disband_army_2",
    [],
    "On second thought, it will be better to stay together for now.",
    "lord_pretalk",
    []],

  [anyone, "lord_give_order_disband_army",
    [],
    "Alright. I will let everyone know that they are released from duty.",
    "lord_pretalk",
    [
      (faction_set_slot, "$players_kingdom", 4, 0),
      (try_for_range, ":var0", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (troop_get_slot, ":var1", ":var0", 10),
        (gt, ":var1", 0),
        (party_slot_eq, ":var1", 30, "p_main_party"),
        (call_script, "script_party_set_ai_state", ":var1", -1, -1),
        (party_set_slot, ":var1", 30, -1),
      (try_end),
      (assign, "$g_recalculate_ais", 1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (ge, "$g_talk_troop_faction_relation", 0),
    ],
    "I wish to ask you something.",
    "lord_talk_ask_something",
    []],

  [anyone, "lord_talk_ask_something",
    [],
    "Aye? What is it?",
    "lord_talk_ask_something_2",
    []],

  [plyr|anyone, "lord_talk_ask_something_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
    ],
    "I want to know the location of someone.",
    "lord_talk_ask_location",
    []],

  [plyr|anyone, "lord_talk_ask_something_2",
    [],
    "What are you and your men doing?",
    "lord_tell_objective",
    []],

  [plyr|anyone, "lord_talk_ask_something_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
    ],
    "How goes the war?",
    "lord_talk_ask_about_war",
    []],

  [plyr|anyone, "lord_talk_ask_something_2",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_talk_ask_location",
    [],
    "Very well, I may or may not have an answer for you. About whom do you wish to hear?",
    "lord_talk_ask_location_2",
    []],

  [repeat_for_troops|plyr|anyone, "lord_talk_ask_location_2",
    [
      (store_repeat_object, ":var0"),
      (neq, "$g_talk_troop", ":var0"),
      (is_between, ":var0", "trp_kingdom_1_lord", "trp_heroes_end"),
      (this_or_next|troop_slot_eq, ":var0", 2, 2),
      (troop_slot_eq, ":var0", 2, 4),
      (store_troop_faction, ":var1", ":var0"),
      (eq, "$g_encountered_party_faction", ":var1"),
      (str_store_troop_name, s1, ":var0"),
    ],
    "{s1}",
    "lord_talk_ask_location_3",
    [
      (store_repeat_object, "$hero_requested_to_learn_location"),
    ]],

  [plyr|anyone, "lord_talk_ask_location_2",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_talk_ask_location_3",
    [
      (call_script, "script_update_troop_location_notes", "$hero_requested_to_learn_location", 1),
      (call_script, "script_get_information_about_troops_position", "$hero_requested_to_learn_location", 0),
    ],
    "{s1}",
    "lord_pretalk",
    []],

  [anyone, "lord_talk_ask_about_war",
    [],
    "{s12}",
    "lord_talk_ask_about_war_2",
    [
      (assign, ":var0", 0),
      (try_for_range_backwards, ":var1", "fac_player_supporters_faction", "fac_kingdoms_end"),
        (faction_slot_eq, ":var1", 21, 0),
        (store_relation, ":var2", ":var1", "$g_talk_troop_faction"),
        (lt, ":var2", 0),
        (try_begin),
          (eq, ":var0", 0),
          (str_store_faction_name_link, s12, ":var1"),
        (else_try),
          (eq, ":var0", 1),
          (str_store_faction_name_link, s11, ":var1"),
          (str_store_string, s12, "@{s11} and {s12}"),
        (else_try),
          (str_store_faction_name_link, s11, ":var1"),
          (str_store_string, s12, "@{s11}, {s12}"),
        (try_end),
        (val_add, ":var0", 1),
      (try_end),
      (try_begin),
        (eq, ":var0", 0),
        (str_store_string, s12, "@We are not at war with anyone."),
      (else_try),
        (str_store_string, s12, "@We are at war with {s12}."),
      (try_end),
    ]],

  [repeat_for_factions|plyr|anyone, "lord_talk_ask_about_war_2",
    [
      (store_repeat_object, ":var0"),
      (is_between, ":var0", "fac_player_supporters_faction", "fac_kingdoms_end"),
      (faction_slot_eq, ":var0", 21, 0),
      (store_relation, ":var1", ":var0", "$g_talk_troop_faction"),
      (lt, ":var1", 0),
      (str_store_faction_name, s1, ":var0"),
    ],
    "Tell me more about the war with {s1}.",
    "lord_talk_ask_about_war_details",
    [
      (store_repeat_object, "$faction_requested_to_learn_more_details_about_the_war_against"),
    ]],

  [plyr|anyone, "lord_talk_ask_about_war_2",
    [],
    "That's all I wanted to know. Thank you.",
    "lord_pretalk",
    []],

  [anyone, "lord_talk_ask_about_war_details",
    [],
    "We have {reg5?{reg5}:no} {reg3?armies:army} and they have {reg6?{reg6}:none}. Overall, {s9}.",
    "lord_talk_ask_about_war_2",
    [
      (call_script, "script_faction_get_number_of_armies", "$g_encountered_party_faction"),
      (assign, reg5, reg0),
      (assign, reg3, 1),
      (try_begin),
        (eq, reg5, 1),
        (assign, reg3, 0),
      (try_end),
      (call_script, "script_faction_get_number_of_armies", "$faction_requested_to_learn_more_details_about_the_war_against"),
      (assign, reg6, reg0),
      (assign, reg4, 1),
      (try_begin),
        (eq, reg6, 1),
        (assign, reg4, 0),
      (try_end),
      (store_div, ":var0", reg5, 2),
      (store_div, ":var1", reg6, 2),
      (store_sub, ":var2", ":var0", ":var1"),
      (val_clamp, ":var2", -4, 5),
      (val_add, ":var2", 4),
      (store_add, ":var3", "str_war_report_minus_4", ":var2"),
      (str_store_string, s9, ":var3"),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_encountered_party_relation", 0),
      (str_store_troop_name, s4, "$g_talk_troop"),
    ],
    "I say this only once, {s4}! Surrender or die!",
    "party_encounter_lord_hostile_ultimatum_surrender",
    []],

  [anyone, "party_encounter_lord_hostile_ultimatum_surrender",
    [],
    "{s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_challenged_default"),
      (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
      (try_begin),
        (gt, "$g_talk_troop_relation", -10),
        (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (try_end),
      (assign, "$encountered_party_hostile", 1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$talk_context", 2),
      (neq, "$g_encountered_party_faction", "$players_kingdom"),
      (ge, "$g_encountered_party_relation", 0),
    ],
    "I'm here to deliver you my demands!",
    "lord_predemand",
    []],

  [anyone, "lord_predemand",
    [],
    "Eh? What do you want?",
    "lord_demand",
    []],

  [plyr|anyone, "lord_demand",
    [
      (neq, "$g_encountered_party_faction", "$players_kingdom"),
      (ge, "$g_encountered_party_relation", 0),
    ],
    "I offer you one chance to surrender or die.",
    "lord_ultimatum_surrender",
    []],

  [anyone, "lord_ultimatum_surrender",
    [
      (ge, "$g_encountered_party_relation", 0),
    ],
    "{s43}",
    "lord_attack_verify",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_unprovoked_attack_default"),
    ]],

  [plyr|anyone, "lord_attack_verify",
    [],
    "Forgive me sir. I don't know what I was thinking.",
    "lord_attack_verify_cancel",
    []],

  [anyone, "lord_attack_verify_cancel",
    [],
    "Be gone, then.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "lord_attack_verify",
    [],
    "That is none of your business. Prepare to fight!",
    "lord_attack_verify_commit",
    []],

  [anyone, "lord_ultimatum_surrender",
    [],
    "{s43}",
    "lord_attack_verify_b",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_unnecessary_attack_default"),
      (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
    ]],

  [plyr|anyone, "lord_attack_verify_b",
    [],
    "Forgive me. I don't know what I was thinking.",
    "lord_attack_verify_cancel",
    []],

  [plyr|anyone, "lord_attack_verify_b",
    [],
    "I stand my ground. Prepare to fight!",
    "lord_attack_verify_commit",
    []],

  [anyone, "lord_attack_verify_commit",
    [],
    "{s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_challenged_default"),
      (call_script, "script_make_kingdom_hostile_to_player", "$g_encountered_party_faction", -3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -30),
    ]],

  [plyr|anyone, "lord_demand",
    [],
    "Forgive me. It's nothing.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_talk",
    [
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (troop_slot_eq, "$g_talk_troop", 140, 0),
      (assign, ":var0", 0),
      (try_for_range, ":var1", 0, 0),
        (troop_slot_eq, ":var1", 14, "$g_talk_troop_faction"),
        (assign, ":var0", ":var1"),
      (try_end),
      (troop_slot_ge, ":var0", 5, 1),
      (str_store_troop_name, s45, ":var0"),
      (troop_get_type, reg3, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
    ],
    "I have met in my travels one who calls {reg18?herself:himself} {s45}...",
    "liege_defends_claim_1",
    []],

  [anyone, "liege_defends_claim_1",
    [],
    "Oh really? It is not everyone who dares mention that name in my presence. I am not sure whether to reward your bravery, or punish you for your impudence.",
    "liege_defends_claim_2",
    [
      (troop_set_slot, "$g_talk_troop", 140, 1),
    ]],

  [anyone, "liege_defends_claim_2",
    [],
    "Very well. I will indulge your curiosity. But listen closely, because I do not wish to speak of this matter again.",
    "liege_defends_claim_3",
    []],

  [anyone, "liege_defends_claim_3",
    [],
    "{s48}",
    "liege_defends_claim_4",
    [
      (store_sub, ":var0", "$g_talk_troop_faction", "fac_kingdom_1"),
      (val_add, ":var0", "str_swadian_rebellion_monarch_response_1"),
      (str_store_string, s48, ":var0"),
    ]],

  [anyone, "liege_defends_claim_4",
    [],
    "{s48}",
    "lord_talk",
    [
      (store_sub, ":var0", "$g_talk_troop_faction", "fac_kingdom_1"),
      (val_add, ":var0", "str_swadian_rebellion_monarch_response_2"),
      (str_store_string, s48, ":var0"),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (gt, "$supported_pretender", 0),
      (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
      (troop_slot_eq, "$g_talk_troop", 140, 0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (troop_slot_ge, "$g_talk_troop", 10, 1),
      (str_store_troop_name, s12, "$supported_pretender"),
      (str_store_faction_name, s14, "$supported_pretender_old_faction"),
      (faction_get_slot, ":var0", "$supported_pretender_old_faction", 10),
      (str_store_troop_name, s15, ":var0"),
    ],
    "{s12} is the rightful ruler of {s14}. Join our cause against the usurper, {s15}!",
    "lord_join_rebellion_suggest",
    []],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$cheat_mode", 1),
      (gt, "$supported_pretender", 0),
      (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (troop_slot_ge, "$g_talk_troop", 10, 1),
    ],
    "CHEAT: Join our cause by force.",
    "lord_join_rebellion_suggest_cheat",
    []],

  [plyr|anyone, "party_encounter_lord_hostile_attacker_2",
    [
      (eq, "$cheat_mode", 1),
      (gt, "$supported_pretender", 0),
      (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (troop_slot_ge, "$g_talk_troop", 10, 1),
    ],
    "CHEAT: Join our cause by force.",
    "lord_join_rebellion_suggest_cheat",
    []],

  [anyone, "lord_join_rebellion_suggest_cheat",
    [],
    "Cheat:Allright.",
    "lord_join_rebellion_ask_for_order",
    [
      (troop_set_slot, "$g_talk_troop", 140, 1),
      (call_script, "script_change_troop_faction", "$g_talk_troop", "$players_kingdom"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "party_encounter_lord_hostile_attacker_2",
    [
      (gt, "$supported_pretender", 0),
      (eq, "$supported_pretender_old_faction", "$g_talk_troop_faction"),
      (troop_slot_eq, "$g_talk_troop", 140, 0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (troop_slot_ge, "$g_talk_troop", 10, 1),
      (str_store_troop_name, s12, "$supported_pretender"),
      (str_store_faction_name, s14, "$supported_pretender_old_faction"),
      (faction_get_slot, ":var0", "$supported_pretender_old_faction", 10),
      (str_store_troop_name, s15, ":var0"),
    ],
    "{s12} is your rightful ruler. Join our cause against the usurper, {s15}!",
    "lord_join_rebellion_suggest",
    []],

  [anyone, "lord_join_rebellion_suggest",
    [
      (eq, "$talk_context", 2),
      (encountered_party_is_attacker),
      (lt, "$g_talk_troop_relation", -5),
    ],
    "I have no time to bandy words with the likes of you. Now defend yourself!",
    "party_encounter_lord_hostile_attacker_2",
    [
      (troop_set_slot, "$g_talk_troop", 140, 1),
    ]],

  [anyone, "lord_join_rebellion_suggest",
    [
      (lt, "$g_talk_troop_relation", -10),
    ],
    "I have no time to bandy words with the likes of you.",
    "lord_start",
    [
      (troop_set_slot, "$g_talk_troop", 140, 1),
    ]],

  [anyone, "lord_join_rebellion_suggest",
    [
      (assign, "$g_rebellion_suggest_friends_stronger", 0),
      (call_script, "script_init_ai_calculation"),
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (gt, ":var0", 0),
      (party_get_slot, ":var1", ":var0", 57),
      (party_get_slot, ":var2", ":var0", 58),
      (party_get_slot, ":var3", ":var0", 56),
      (val_sub, ":var1", ":var3"),
      (val_add, ":var2", ":var3"),
      (gt, ":var1", ":var2"),
      (assign, "$g_rebellion_suggest_friends_stronger", 1),
      (encountered_party_is_attacker),
    ],
    "{s43}",
    "party_encounter_lord_hostile_attacker_2",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_talk_later_default"),
    ]],

  [anyone, "lord_join_rebellion_suggest",
    [
      (eq, "$g_rebellion_suggest_friends_stronger", 1),
    ],
    "{s43}",
    "lord_start",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_talk_later_default"),
    ]],

  [anyone, "lord_join_rebellion_suggest",
    [],
    "{s43}",
    "lord_join_rebellion_suggest_1b",
    [
      (troop_set_slot, "$g_talk_troop", 140, 1),
      (faction_get_slot, ":var0", "$players_kingdom", 10),
      (troop_get_type, reg3, ":var0"),
      (faction_get_slot, ":var1", "$g_talk_troop_faction", 10),
      (str_store_troop_name, s45, ":var0"),
      (str_store_troop_name, s46, ":var1"),
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_dilemma_default"),
      (call_script, "script_find_rival_from_faction", "$g_talk_troop", "$players_kingdom"),
      (assign, "$rival_lord", reg0),
      (assign, "$rebellion_chance", 40),
      (assign, "$prior_argument_value", 0),
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 1),
      (store_mul, ":var2", reg0, "$player_made_legitimacy_claim"),
      (val_add, "$prior_argument_value", ":var2"),
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 2),
      (store_mul, ":var2", reg0, "$player_made_ruler_claim"),
      (val_add, "$prior_argument_value", ":var2"),
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 4),
      (store_mul, ":var2", reg0, "$player_made_strength_claim"),
      (val_add, "$prior_argument_value", ":var2"),
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 3),
      (store_mul, ":var2", reg0, "$player_made_benefit_claim"),
      (val_add, "$prior_argument_value", ":var2"),
      (val_div, "$prior_argument_value", 5),
    ]],

  [anyone, "lord_join_rebellion_suggest_1b",
    [],
    "{s43}",
    "lord_join_rebellion_suggest_2",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_dilemma_2_default"),
    ]],

  [anyone, "lord_join_rebellion_suggest_2",
    [
      (neq, "$prior_argument_value", 0),
    ],
    "{s47}",
    "lord_join_rebellion_suggest_2",
    [
      (try_begin),
        (gt, "$prior_argument_value", 10),
        (str_store_string, s47, "str_rebellion_prior_argument_very_favorable"),
        (str_store_string, s49, "str_but_comma_3"),
      (else_try),
        (gt, "$prior_argument_value", 0),
        (str_store_string, s47, "str_rebellion_prior_argument_favorable"),
        (str_store_string, s49, "str_but_comma_3"),
      (else_try),
        (is_between, "$prior_argument_value", -10, 0),
        (str_store_string, s47, "str_rebellion_prior_argument_unfavorable"),
        (str_store_string, s49, "str_and_comma_3"),
      (else_try),
        (lt, "$prior_argument_value", -10),
        (str_store_string, s47, "str_rebellion_prior_argument_very_unfavorable"),
        (str_store_string, s49, "str_and_comma_3"),
      (try_end),
      (val_add, "$rebellion_chance", "$prior_argument_value"),
      (assign, reg6, "$prior_argument_value"),
      (assign, "$prior_argument_value", 0),
      (assign, reg7, "$rebellion_chance"),
      (display_message, "@Prior argument effect: {reg6}, rebellion chance: {reg7}"),
    ]],

  [anyone, "lord_join_rebellion_suggest_2",
    [
      (gt, "$rival_lord", 0),
    ],
    "{s43}",
    "lord_join_rebellion_suggest_2",
    [
      (str_store_troop_name, s44, "$rival_lord"),
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_rival_default"),
      (assign, "$rival_lord", 0),
      (val_sub, "$rebellion_chance", 30),
      (assign, reg7, "$rebellion_chance"),
      (display_message, "@Rebellion chance -30 from rival = {reg7}"),
    ]],

  [anyone, "lord_join_rebellion_suggest_2",
    [],
    "So tell me. Why should I support {s45}?",
    "lord_join_rebellion_suggest_3",
    []],

  [plyr|anyone, "lord_join_rebellion_suggest_3",
    [
      (troop_get_type, reg39, "$g_talk_troop"),
    ],
    "Legality -- {s45} has the better claim to the throne",
    "lord_join_rebellion_suggest_4",
    [
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 1),
      (val_add, "$player_made_legitimacy_claim", 1),
      (assign, "$current_argument", 1),
      (assign, "$current_argument_value", reg0),
    ]],

  [plyr|anyone, "lord_join_rebellion_suggest_3",
    [
      (troop_get_type, reg39, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "Justice -- {s45} will treat {reg18?her:his} subjects better than {s46}",
    "lord_join_rebellion_suggest_4",
    [
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 2),
      (val_add, "$player_made_ruler_claim", 1),
      (assign, "$current_argument", 2),
      (assign, "$current_argument_value", reg0),
    ]],

  [plyr|anyone, "lord_join_rebellion_suggest_3",
    [
      (troop_get_type, reg39, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "Expediency -- {s45} will win, and the sooner  {reg18?she:he} wins, the sooner this war will end.",
    "lord_join_rebellion_suggest_4",
    [
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 4),
      (val_add, "$player_made_strength_claim", 1),
      (assign, "$current_argument", 4),
      (assign, "$current_argument_value", reg0),
    ]],

  [plyr|anyone, "lord_join_rebellion_suggest_3",
    [
      (troop_get_type, reg39, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "Self-interest -- {s45} will reward  {reg18?her:his} followers well.",
    "lord_join_rebellion_suggest_4",
    [
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 3),
      (val_add, "$player_made_benefit_claim", 1),
      (assign, "$current_argument", 3),
      (assign, "$current_argument_value", reg0),
    ]],

  [plyr|anyone, "lord_join_rebellion_suggest_3",
    [],
    "None of the usual reasons. My thinking is a little different.",
    "lord_join_rebellion_suggest_4",
    [
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 0),
      (assign, "$current_argument", 0),
      (assign, "$current_argument_value", 0),
    ]],

  [plyr|anyone, "lord_join_rebellion_suggest_3",
    [],
    "There is more than one reason. I will let you make up your own mind.",
    "lord_join_rebellion_suggest_4",
    [
      (call_script, "script_rebellion_arguments", "$g_talk_troop", 0),
      (assign, "$current_argument", 0),
      (assign, "$current_argument_value", 0),
    ]],

  [plyr|anyone, "lord_join_rebellion_suggest_3",
    [],
    "If that is your reasoning, perhaps you should remain loyal to {s46}.",
    "lord_join_rebellion_suggest_5",
    [
      (assign, "$rebellion_check", 1),
      (assign, "$rebellion_chance", 0),
    ]],

  [anyone, "lord_join_rebellion_suggest_4",
    [
      (neq, "$current_argument", 0),
      (gt, "$current_argument_value", 0),
      (assign, ":var0", 0),
      (assign, ":var1", 0),
      (try_begin),
        (gt, "$player_made_benefit_claim", 0),
        (val_add, ":var0", 1),
        (assign, ":var1", 3),
      (try_end),
      (try_begin),
        (gt, "$player_made_strength_claim", 0),
        (val_add, ":var0", 1),
        (try_begin),
          (gt, "$player_made_strength_claim", "$player_made_benefit_claim"),
          (assign, ":var1", 4),
        (try_end),
      (try_end),
      (try_begin),
        (gt, "$player_made_ruler_claim", 0),
        (val_add, ":var0", 1),
        (try_begin),
          (gt, "$player_made_ruler_claim", "$player_made_strength_claim"),
          (gt, "$player_made_ruler_claim", "$player_made_benefit_claim"),
          (assign, ":var1", 2),
        (try_end),
      (try_end),
      (try_begin),
        (gt, "$player_made_benefit_claim", 0),
        (val_add, ":var0", 1),
        (try_begin),
          (gt, "$player_made_legitimacy_claim", "$player_made_ruler_claim"),
          (gt, "$player_made_legitimacy_claim", "$player_made_strength_claim"),
          (gt, "$player_made_legitimacy_claim", "$player_made_benefit_claim"),
          (assign, ":var1", 1),
        (try_end),
      (try_end),
      (neq, "$current_argument", ":var1"),
      (store_random_in_range, ":var2", 1, 5),
      (assign, reg10, ":var2"),
      (assign, reg11, ":var0"),
      (display_message, "@Consistency check: {reg10}/{reg11}"),
      (lt, ":var2", ":var0"),
    ],
    "Hmm. Do you perhaps tell each lord something different, depending on what you think he most wants to hear?",
    "lord_join_rebellion_suggest_4",
    [
      (assign, "$current_argument_value", -5),
    ]],

  [anyone, "lord_join_rebellion_suggest_4",
    [],
    "Very well. {s51}{s52}{s53}{s54}{s55}",
    "lord_join_rebellion_suggest_5",
    [
      (try_for_range, ":var0", 51, 60),
        (str_clear, ":var0"),
      (try_end),
      (try_begin),
        (neq, "$current_argument", 0),
        (try_begin),
          (gt, "$current_argument_value", 0),
          (str_store_string, s51, "str_rebellion_argument_favorable"),
        (else_try),
          (eq, "$current_argument_value", 0),
          (str_store_string, s51, "str_rebellion_argument_neutral"),
        (else_try),
          (lt, "$current_argument_value", 0),
          (str_store_string, s51, "str_rebellion_argument_unfavorable"),
        (try_end),
        (val_add, "$rebellion_chance", "$current_argument_value"),
        (assign, reg6, "$current_argument_value"),
        (assign, reg7, "$rebellion_chance"),
        (display_message, "@Current argument effect: {reg6}, rebellion chance: {reg7}"),
        (store_skill_level, ":var1", "skl_persuasion", "trp_player"),
        (val_mul, ":var1", 5),
        (store_random_in_range, ":var2", -10, ":var1"),
        (store_add, ":var3", ":var2", "$current_argument_value"),
        (str_store_string, s52, "str_and_comma_1"),
        (try_begin),
          (gt, ":var2", 10),
          (str_store_string, s53, "str_rebellion_persuasion_favorable"),
          (try_begin),
            (lt, "$current_argument_value", 0),
            (str_store_string, s52, "str_but_comma_1"),
          (try_end),
        (else_try),
          (lt, ":var3", 0),
          (lt, ":var2", 0),
          (str_store_string, s53, "str_rebellion_persuasion_unfavorable"),
          (try_begin),
            (ge, "$current_argument_value", 0),
            (str_store_string, s52, "str_but_comma_1"),
          (try_end),
        (else_try),
          (str_store_string, s53, "str_rebellion_persuasion_neutral"),
          (try_begin),
            (lt, "$current_argument_value", 0),
            (str_store_string, s52, "str_but_comma_1"),
          (try_end),
        (try_end),
        (val_add, "$rebellion_chance", ":var2"),
        (assign, reg6, ":var2"),
        (assign, reg7, "$rebellion_chance"),
        (display_message, "@Persuasion effect: {reg6}, rebellion chance: {reg7}"),
        (str_store_string, s54, "str_and_comma_2"),
        (try_begin),
          (gt, ":var3", 0),
          (lt, "$g_talk_troop_relation", 5),
          (str_store_string, s54, "str_but_comma_2"),
        (else_try),
          (le, ":var3", 0),
          (ge, "$g_talk_troop_relation", 5),
          (str_store_string, s54, "str_but_comma_2"),
        (try_end),
      (try_end),
      (try_begin),
        (gt, "$g_talk_troop_relation", 20),
        (str_store_string, s55, "str_rebellion_relation_very_favorable"),
      (else_try),
        (gt, "$g_talk_troop_relation", 5),
        (str_store_string, s55, "str_rebellion_relation_favorable"),
      (else_try),
        (gt, "$g_talk_troop_relation", -5),
        (str_store_string, s55, "str_rebellion_relation_neutral"),
      (else_try),
        (str_store_string, s55, "str_rebellion_relation_unfavorable"),
      (try_end),
      (val_add, "$rebellion_chance", "$g_talk_troop_relation"),
      (assign, reg6, "$g_talk_troop_relation"),
      (assign, reg7, "$rebellion_chance"),
      (display_message, "@Personal relation effect: {reg6}, rebellion chance: {reg7}"),
      (store_random_in_range, "$rebellion_check", 0, 100),
      (assign, reg6, "$rebellion_check"),
      (display_message, "@Rebellion check: {reg6}"),
    ]],

  [anyone, "lord_join_rebellion_suggest_5",
    [
      (lt, "$rebellion_check", "$rebellion_chance"),
    ],
    "{s43}",
    "lord_join_rebellion_ask_for_order",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_agree_default"),
      (troop_set_slot, "$g_talk_troop", 140, 1),
      (call_script, "script_change_troop_faction", "$g_talk_troop", "$players_kingdom"),
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (party_set_faction, ":var0", "$players_kingdom"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_join_rebellion_suggest_5",
    [
      (encountered_party_is_attacker),
    ],
    "{s43}",
    "party_encounter_lord_hostile_attacker_2",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_refuse_default"),
    ]],

  [anyone, "lord_join_rebellion_suggest_5",
    [],
    "{s43}",
    "lord_talk",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_rebellion_refuse_default"),
    ]],

  [anyone, "lord_join_rebellion_ask_for_order",
    [],
    "Alright. So, what's the plan? What do you want me to do?",
    "lord_give_order",
    []],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$cheat_mode", 1),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
    ],
    "CHEAT:I want to suggest a course of action.",
    "lord_suggest_action_ask",
    []],

  [anyone, "lord_tell_objective",
    [
      (troop_slot_ge, "$g_talk_troop", 8, 0),
    ],
    "What am I doing? What does it look like I'm doing?! I'm a prisoner here!",
    "lord_pretalk",
    []],

  [anyone, "lord_tell_objective",
    [
      (troop_slot_eq, "$g_talk_troop", 10, -1),
    ],
    "I am not commanding any men at the moment.",
    "lord_pretalk",
    []],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 7),
      (party_get_attached_to, ":var0", "$g_talk_troop_party"),
      (try_begin),
        (lt, ":var0", 0),
        (party_get_cur_town, ":var0", "$g_talk_troop_party"),
      (try_end),
      (is_between, ":var0", "p_town_1", "p_salt_mine"),
    ],
    "We are resting at {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 7),
    ],
    "We are travelling to {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 16),
    ],
    "We are recruiting new soldiers from {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 4),
    ],
    "We are scouting for the enemy around {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 5),
    ],
    "We are laying waste to the village of {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 14),
    ],
    "We are retreating to {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 1),
    ],
    "We are besieging {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 10),
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (party_is_active, ":var0"),
    ],
    "We are pursuing {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (party_slot_eq, "$g_talk_troop_party", 4, 11),
    ],
    "We are accompanying {s1}.",
    "lord_pretalk",
    [
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "lord_tell_objective",
    [
      (assign, ":var0", 0),
      (try_begin),
        (party_slot_eq, "$g_talk_troop_party", 4, -1),
        (assign, ":var0", 1),
      (else_try),
        (party_slot_eq, "$g_talk_troop_party", 4, 10),
        (party_get_slot, ":var1", "$g_talk_troop_party", 5),
        (neg|party_is_active, ":var1"),
        (assign, ":var0", 1),
      (try_end),
      (eq, ":var0", 1),
    ],
    "We are reconsidering our next objective.",
    "lord_pretalk",
    []],

  [anyone, "lord_tell_objective",
    [],
    "I don't know: {reg1} {s1}",
    "lord_pretalk",
    [
      (party_get_slot, reg1, "$g_talk_troop_party", 4),
      (party_get_slot, ":var0", "$g_talk_troop_party", 5),
      (str_store_party_name, s1, ":var0"),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (eq, "$talk_context", 2),
      (eq, "$g_talk_troop_faction", "$players_kingdom"),
      (party_slot_eq, "$g_encountered_party", 31, 0),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 7, "trp_player"),
    ],
    "Will you follow me? I have a plan.",
    "lord_ask_follow",
    []],

  [anyone, "lord_ask_follow",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 33),
      (store_current_hours, ":var1"),
      (lt, ":var1", ":var0"),
    ],
    "I enjoy your company, {playername}, but there are other things I must attend to. Perhaps in a few days I can ride with you again.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_ask_follow",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 7),
      (troop_get_slot, ":var1", "trp_player", 7),
      (val_mul, ":var0", 3),
      (val_div, ":var0", 4),
      (lt, ":var1", ":var0"),
    ],
    "That would hardly be proper, {playername}. Why don't you follow me instead?",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_ask_follow",
    [
      (lt, "$g_talk_troop_relation", 25),
    ],
    "{s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_follow_refusal_default"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_ask_follow",
    [],
    "Lead the way, {playername}! Let us bring death and defeat to all our enemies.",
    "close_window",
    [
      (party_set_slot, "$g_talk_troop_party", 30, "p_main_party"),
      (call_script, "script_party_decide_next_ai_state_under_command", "$g_talk_troop_party"),
      (store_current_hours, ":var0"),
      (store_add, ":var1", 30, "$g_talk_troop_relation"),
      (val_div, ":var1", 2),
      (val_add, ":var0", ":var1"),
      (party_set_slot, "$g_encountered_party", 32, ":var0"),
      (party_set_slot, "$g_encountered_party", 31, 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_talk_preoffer",
    [],
    "Yes?",
    "lord_talk_offer",
    []],

  [plyr|anyone, "lord_talk_offer",
    [
      (eq, 1, 0),
    ],
    "I wish to ransom one of your prisoners.",
    "knight_offer_join",
    []],

  [plyr|anyone, "lord_talk_offer",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "knight_offer_join",
    [
      (call_script, "script_cf_is_quest_troop", "$g_talk_troop"),
    ],
    "I fear I cannot join you at the moment, {playername}, I've important business to attend to and it cannot wait.",
    "hero_pretalk",
    []],

  [anyone, "knight_offer_join",
    [
      (lt, "$g_talk_troop_relation", 5),
      (store_character_level, ":var0", "trp_player"),
      (store_character_level, ":var1", "$g_talk_troop"),
      (val_mul, ":var0", 2),
      (lt, ":var0", ":var1"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You forget your place, {reg18?ma'am:sir}. I do not take orders from the likes of you.",
    "hero_pretalk",
    []],

  [anyone, "knight_offer_join",
    [
      (assign, ":var0", 0),
      (try_for_range, ":var1", "trp_kingdom_1_lord", "trp_heroes_end"),
        (troop_slot_eq, ":var1", 2, 3),
        (val_add, ":var0", 1),
      (try_end),
      (assign, reg5, ":var0"),
      (store_add, reg6, reg5, 1),
      (val_mul, reg6, reg6),
      (val_mul, reg6, 1000),
      (gt, reg6, 0),
    ],
    "I would be glad to fight at your side, my friend, but there is a problem... The thing is, I've found myself in a bit of debt that I must repay very soon. {reg6} cents altogether, and I am honour-bound to return every coin. Unless you've got {reg6} cents with you that you can spare, I've to keep my mind on getting this weight off my neck.",
    "knight_offer_join_2",
    []],

  [anyone, "knight_offer_join",
    [
      (gt, reg6, 100000),
    ],
    "Join you? I think not.",
    "close_window",
    []],

  [anyone, "knight_offer_join",
    [],
    "Aye, my friend, I'll be happy to join you.",
    "knight_offer_join_2",
    []],

  [plyr|anyone, "knight_offer_join_2",
    [
      (gt, reg6, 0),
      (store_troop_gold, ":var0", "trp_player"),
      (gt, ":var0", reg6),
    ],
    "Here, take it, all {reg6} cents you need. 'Tis only money.",
    "knight_offer_join_accept",
    [
      (troop_remove_gold, "trp_player", reg6),
    ]],

  [plyr|anyone, "knight_offer_join_2",
    [
      (le, reg6, 0),
    ],
    "Then let us ride together, my friend.",
    "knight_offer_join_accept",
    []],

  [plyr|anyone, "knight_offer_join_2",
    [
      (eq, "$talk_context", 8),
    ],
    "That's good to know. I will think on it.",
    "close_window",
    []],

  [plyr|anyone, "knight_offer_join_2",
    [
      (neq, "$talk_context", 8),
    ],
    "That's good to know. I will think on it.",
    "hero_pretalk",
    []],

  [anyone, "knight_offer_join_accept",
    [
      (troop_slot_ge, "$g_talk_troop", 10, 1),
    ],
    "I've some trusted men in my band who could be of use to you. What do you wish to do with them?",
    "knight_offer_join_accept_party",
    []],

  [anyone, "knight_offer_join_accept",
    [],
    "Ah, certainly, it might be fun!",
    "close_window",
    [
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "knight_offer_join_accept_party",
    [],
    "You may disband your men. I've no need for other troops.",
    "knight_join_party_disband",
    []],

  [plyr|anyone, "knight_offer_join_accept_party",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (party_can_join_party, ":var0", "p_main_party"),
    ],
    "Your men may join as well. We need every soldier we can muster.",
    "knight_join_party_join",
    []],

  [plyr|anyone, "knight_offer_join_accept_party",
    [
      (is_between, "$g_encountered_party", "p_town_1", "p_salt_mine"),
    ],
    "Lead your men out of the town. I shall catch up with you on the road.",
    "knight_join_party_lead_out",
    []],

  [plyr|anyone, "knight_offer_join_accept_party",
    [
      (neg|is_between, "$g_encountered_party", "p_town_1", "p_salt_mine"),
    ],
    "Keep doing what you were doing. I'll catch up with you later.",
    "knight_join_party_lead_out",
    []],

  [anyone, "knight_join_party_disband",
    [],
    "Ah . . . Very well, {playername}. Much as I dislike losing good men, the decision is yours. I'll disband my troops and join you.",
    "close_window",
    [
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (party_detach, ":var0"),
      (remove_party, ":var0"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "knight_join_party_join",
    [],
    "Excellent. My lads and I will ride with you.",
    "close_window",
    [
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      (party_remove_members, "p_main_party", "$g_talk_troop", 1),
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (assign, "$g_move_heroes", 1),
      (call_script, "script_party_add_party", "p_main_party", ":var0"),
      (party_detach, ":var0"),
      (remove_party, ":var0"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "knight_join_party_lead_out",
    [],
    "Very well then. I shall maintain a patrol of this area. Return if you have further orders for me.",
    "close_window",
    [
      (call_script, "script_recruit_troop_as_companion", "$g_talk_troop"),
      (party_remove_members, "p_main_party", "$g_talk_troop", 1),
      (troop_get_slot, ":var0", "$g_talk_troop", 10),
      (party_set_faction, ":var0", "fac_player_supporters_faction"),
      (party_detach, ":var0"),
      (party_set_ai_behavior, ":var0", ai_bhvr_patrol_location),
      (party_set_flags, ":var0", 65536, 0),
    ]],

  [anyone, "lord_enter_service_reject",
    [],
    "What pigswill! And to think I would offer you a place among my best officers. Begone, beggar, before I lose my temper!",
    "close_window",
    [
      (try_begin),
        (store_partner_quest, ":var0"),
        (eq, ":var0", "qst_join_faction"),
        (call_script, "script_abort_quest", "qst_join_faction", 1),
      (try_end),
      (assign, "$g_invite_faction", 0),
      (assign, "$g_invite_faction_lord", 0),
      (assign, "$g_invite_offered_center", 0),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_ask_enter_service",
    [
      (gt, "$players_kingdom", 0),
      (neq, "$players_kingdom", "$g_talk_troop_faction"),
      (faction_get_slot, ":var0", "$players_kingdom", 10),
      (neq, ":var0", "trp_player"),
      (str_store_troop_name, s5, ":var0"),
    ],
    "You are already oath-bound to serve {s5}, are you not?",
    "lord_give_oath_under_oath_already",
    []],

  [plyr|anyone, "lord_give_oath_under_oath_already",
    [],
    "Indeed I am, {s65}. Forgive my rambling.",
    "lord_pretalk",
    []],

  [anyone, "lord_ask_enter_service",
    [
      (lt, "$g_talk_troop_relation", -5),
    ],
    "I accept oaths only from those I can trust to keep them, {playername}.",
    "lord_pretalk",
    []],

  [anyone, "lord_ask_enter_service",
    [
      (assign, "$g_invite_offered_center", -1),
      (troop_get_slot, ":var0", "trp_player", 7),
      (store_mul, ":var1", "$g_talk_troop_relation", 5),
      (val_add, ":var1", ":var0"),
      (call_script, "script_get_number_of_hero_centers", "trp_player"),
      (assign, ":var2", reg0),
      (store_mul, ":var3", ":var2", 50),
      (val_add, ":var1", ":var3"),
      (ge, ":var1", 150),
      (try_begin),
        (eq, ":var2", 0),
        (call_script, "script_get_poorest_village_of_faction", "$g_talk_troop_faction"),
        (gt, reg0, 0),
        (assign, "$g_invite_offered_center", reg0),
      (try_end),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You are known as a brave {reg18?woman:man} and a fine leader of men, {playername}. I shall be pleased to accept your skills into my service and bestow membership upon you, if you are ready to enlist the service.",
    "lord_give_oath_1",
    []],

  [anyone, "lord_ask_enter_service",
    [],
    "You've yet to show yourself as a competent commander, {playername}. Fight my enemies and prove to me that you are worthy of becoming my subordinate. Then we may speak more of this.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_give_oath_1",
    [],
    "I am ready, {s65}.",
    "lord_give_oath_2",
    []],

  [plyr|anyone, "lord_give_oath_1",
    [],
    "Forgive me, {s65}, I must give the matter more thought first...",
    "lord_give_oath_give_up",
    []],

  [anyone, "lord_give_oath_give_up",
    [],
    "What are you playing at, {playername}? Go and make up your mind, and stop wasting my time.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_give_oath_2",
    [],
    "Good. Then repeat the words of the oath with me: I enter military service of {s41}.",
    "lord_give_oath_3",
    [
      (str_store_faction_name, s41, "$g_talk_troop_faction"),
      (try_begin),
        (is_between, "$g_talk_troop", 0, 0),
        (troop_get_slot, ":var0", "$g_talk_troop", 14),
        (str_store_faction_name, s41, ":var0"),
      (try_end),
    ]],

  [plyr|anyone, "lord_give_oath_3",
    [],
    "I enter military service of {s41}.",
    "lord_give_oath_4",
    []],

  [plyr|anyone, "lord_give_oath_3",
    [],
    "Excuse me, but I feel I need to think about this.",
    "lord_give_oath_give_up",
    []],

  [anyone, "lord_give_oath_4",
    [],
    "I will remain as your loyal and devoted follower as long as my breath remains....",
    "lord_give_oath_5",
    []],

  [plyr|anyone, "lord_give_oath_5",
    [],
    "I will remain as your loyal and devoted follower as long as my breath remains...",
    "lord_give_oath_6",
    []],

  [plyr|anyone, "lord_give_oath_5",
    [],
    "May I ask for some time to think about this?",
    "lord_give_oath_give_up",
    []],

  [anyone, "lord_give_oath_6",
    [],
    "...and I will be at your side to fight your enemies should you need my help.",
    "lord_give_oath_7",
    []],

  [plyr|anyone, "lord_give_oath_7",
    [],
    "...and I will be at your side to fight your enemies should you need my help.",
    "lord_give_oath_8",
    []],

  [plyr|anyone, "lord_give_oath_7",
    [],
    "Please give me more time to think about this.",
    "lord_give_oath_give_up",
    []],

  [anyone, "lord_give_oath_8",
    [],
    "Finally, I will obey all your orders and those of your higher rank officers.",
    "lord_give_oath_9",
    []],

  [plyr|anyone, "lord_give_oath_9",
    [],
    "Finally, I will obey all your orders and those of your higher rank officers.",
    "lord_give_oath_10",
    []],

  [plyr|anyone, "lord_give_oath_9",
    [],
    "I must have more time to consider this.",
    "lord_give_oath_give_up",
    []],

  [anyone, "lord_give_oath_10",
    [],
    "Very well. You have given me your solemn oath, {playername}. May you uphold it always, with proper courage and devotion.",
    "lord_give_oath_go_on_2",
    []],

  [anyone, "lord_give_oath_go_on_2",
    [
      (assign, reg1, 1),
      (try_begin),
        (le, "$g_invite_offered_center", 0),
        (assign, reg1, 0),
      (else_try),
        (str_store_party_name, s1, "$g_invite_offered_center"),
      (try_end),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Let it be known that from this day forward, you are my sworn {reg18?follower:man}. I give you my protection and grant you the right to bear flag of this country, and I pledge that I shall not deprive you of your life, liberty or properties except by the martial laws of this country.{reg1? Furthermore I give you the lands of {s1} with all its rents and revenues :}",
    "lord_give_oath_go_on_3",
    []],

  [anyone, "lord_give_oath_go_on_3",
    [],
    "You have done a wise thing, {playername}. Serve me well and I promise, you will rise high.",
    "lord_give_conclude",
    []],

  [plyr|anyone, "lord_give_conclude",
    [
      (troop_get_type, reg39, "$g_talk_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "I thank you, {reg18?ma'am:sir}.",
    "lord_give_conclude_2",
    [
      (try_begin),
        (is_between, "$g_talk_troop", 0, 0),
        (assign, "$supported_pretender", "$g_talk_troop"),
        (troop_get_slot, "$supported_pretender_old_faction", "$g_talk_troop", 14),
        (troop_set_faction, "$g_talk_troop", "fac_player_supporters_faction"),
        (faction_set_slot, "fac_player_supporters_faction", 10, "$g_talk_troop"),
        (assign, "$g_talk_troop_faction", "fac_player_supporters_faction"),
        (quest_set_slot, "qst_rebel_against_kingdom", 6, "$g_talk_troop"),
        (quest_set_slot, "qst_rebel_against_kingdom", 3, "$supported_pretender_old_faction"),
        (str_store_faction_name_link, s14, "$supported_pretender_old_faction"),
        (str_store_troop_name_link, s13, "$g_talk_troop"),
        (setup_quest_text, "qst_rebel_against_kingdom"),
        (str_store_string, s2, "@You promised to help {s13} claim the throne of {s14}."),
        (call_script, "script_start_quest", "qst_rebel_against_kingdom", "$g_talk_troop"),
      (try_end),
      (try_begin),
        (is_between, "$players_oath_renounced_against_kingdom", "fac_player_supporters_faction", "fac_kingdoms_end"),
        (neq, "$players_oath_renounced_against_kingdom", "$g_talk_troop_faction"),
        (store_relation, ":var0", "fac_player_supporters_faction", "$players_oath_renounced_against_kingdom"),
        (val_min, ":var0", -40),
        (call_script, "script_set_player_relation_with_faction", "$players_oath_renounced_against_kingdom", ":var0"),
        (call_script, "script_update_all_notes"),
        (assign, "$g_recalculate_ais", 1),
      (try_end),
      (try_begin),
        (is_between, "$players_kingdom", "fac_player_supporters_faction", "fac_kingdoms_end"),
        (neq, "$players_kingdom", "fac_player_supporters_faction"),
        (faction_get_slot, ":var1", "$players_kingdom", 10),
        (call_script, "script_add_log_entry", 23, "trp_player", -1, ":var1", "$players_kingdom"),
        (call_script, "script_player_leave_faction", 1),
      (try_end),
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (try_begin),
        (gt, "$g_invite_offered_center", 0),
        (call_script, "script_give_center_to_lord", "$g_invite_offered_center", "trp_player", 0),
        (call_script, "script_add_log_entry", 22, "trp_player", "$g_invite_offered_center", "$g_talk_troop", "$g_talk_troop_faction"),
      (try_end),
      (call_script, "script_add_log_entry", 21, "trp_player", -1, "$g_talk_troop", "$g_talk_troop_faction"),
      (try_begin),
        (check_quest_active, "qst_join_faction"),
        (eq, "$g_invite_faction_lord", "$g_talk_troop"),
        (call_script, "script_end_quest", "qst_join_faction"),
      (else_try),
        (check_quest_active, "qst_join_faction"),
        (call_script, "script_abort_quest", "qst_join_faction", 0),
      (try_end),
      (assign, "$player_has_homage", 1),
      (assign, "$g_player_banner_granted", 1),
      (assign, "$g_invite_faction", 0),
      (assign, "$g_invite_faction_lord", 0),
      (assign, "$g_invite_offered_center", 0),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_give_conclude_2",
    [],
    "I have great hopes for you {playername}. I know you shall prove yourself worthy of the trust I have placed in you.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_ask_enter_service",
    [
      (str_store_faction_name, s5, "$g_talk_troop_faction"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Heh, a wise move, {playername}. With loyal service, a {reg18?woman:man} in my service could become wealthy and powerful, and our enemies... Well, our enemies are as wheat before a scythe. However, to enter my service you must first renounce all worldly oaths and bonds, and swear to serve only the {s5}.",
    "lord_enter_service_swear",
    []],

  [plyr|anyone, "lord_enter_service_swear",
    [],
    "I do so swear, {s65}.",
    "lord_enter_service_swear_accepted",
    []],

  [plyr|anyone, "lord_enter_service_swear",
    [],
    "I need some time to think about this.",
    "lord_enter_service_swear_denied",
    []],

  [anyone, "lord_enter_service_swear_denied",
    [],
    "Are you having me on? I've no time for games, {playername}. Make up your mind and stop wasting my time.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_enter_service_swear_accepted",
    [
      (str_store_faction_name, s5, "$g_talk_troop_faction"),
    ],
    "Then it is my pleasure to welcome you to the service of my house. From this day on, {playername}, you are a soldier of the {s5} with all the duties and privileges that come with it.",
    "lord_enter_service_swear_accepted_2",
    []],

  [anyone, "lord_enter_service_swear_accepted_2",
    [
      (str_store_faction_name, s5, "$g_talk_troop_faction"),
    ],
    "I charge you with rooting out and destroying the forces of our enemies wherever you may find them. Moreover, I will have special tasks for you from time to time, as may some of my other subordinates. Serve, fight, and honour your oaths. These things will take you far, if you've a mind for promotion. May God grant us long lives and many victories to toast in my hall!",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_ask_leave_service",
    [
      (ge, "$g_talk_troop_relation", 1),
    ],
    "Hrm. Has your oath become burdensome, {playername}? It is unusual to request release from homage, but in respect of your fine service, I will not hold you if you truly wish to end it. Though you would be sorely missed.",
    "lord_ask_leave_service_verify",
    []],

  [anyone, "lord_ask_leave_service",
    [],
    "Release from homage? Hmm, perhaps it would be for the best... However, {playername}, you must be sure that release is what you desire. This is not a thing done lightly.",
    "lord_ask_leave_service_verify",
    []],

  [plyr|anyone, "lord_ask_leave_service_verify",
    [],
    "It is something I must do, {s65}.",
    "lord_ask_leave_service_2",
    []],

  [plyr|anyone, "lord_ask_leave_service_verify",
    [],
    "You are right, {s65}. My place is here.",
    "lord_ask_leave_service_giveup",
    []],

  [anyone, "lord_ask_leave_service_giveup",
    [],
    "I am pleased to hear it, {playername}. I hope you'll banish such unworthy thoughts from your mind from now on.",
    "lord_pretalk",
    []],

  [anyone, "lord_ask_leave_service_2",
    [],
    "Then you are sure?",
    "lord_ask_leave_service_verify_again",
    []],

  [plyr|anyone, "lord_ask_leave_service_verify_again",
    [],
    "Yes, {s65}.",
    "lord_ask_leave_service_3",
    []],

  [plyr|anyone, "lord_ask_leave_service_verify_again",
    [],
    "Of course not, {s65}. I am ever your loyal follower.",
    "lord_ask_leave_service_giveup",
    []],

  [anyone, "lord_ask_leave_service_3",
    [],
    "As you wish. I hereby declare your oaths to be null and void. You will no longer hold land or titles in my name, and you are released from your duties to my house. You are free, {playername}.",
    "lord_ask_leave_service_end",
    [
      (call_script, "script_add_log_entry", 23, "trp_player", -1, "$g_talk_troop", "$g_talk_troop_faction"),
      (call_script, "script_player_leave_faction", 1),
    ]],

  [plyr|anyone, "lord_ask_leave_service_end",
    [],
    "Thank you. It was an honour to serve you..",
    "lord_ask_leave_service_end_2",
    []],

  [plyr|anyone, "lord_ask_leave_service_end",
    [],
    "My thanks. It feels good to be free once again.",
    "lord_ask_leave_service_end_2",
    []],

  [anyone, "lord_ask_leave_service_end_2",
    [],
    "Farewell then, {playername}, and good luck go with you.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_active_mission_1",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_lend_companion"),
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (check_quest_active, "qst_lend_companion"),
      (quest_slot_eq, "qst_lend_companion", 6, "$g_talk_troop"),
      (store_current_day, ":var1"),
      (quest_get_slot, ":var2", "qst_lend_companion", 10),
      (ge, ":var1", ":var2"),
    ],
    "Oh, you want your companion back? I see...",
    "lord_lend_companion_end",
    []],

  [anyone, "lord_active_mission_1",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_lend_companion"),
    ],
    "{playername}, I must beg your patience, I still have need of your companion. Please return later when things have settled.",
    "lord_pretalk",
    []],

  [anyone, "lord_active_mission_1",
    [],
    "Yes, have you made any progress on it?",
    "lord_active_mission_2",
    []],

  [plyr|anyone, "lord_active_mission_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (check_quest_active, "qst_capture_prisoners"),
      (quest_slot_eq, "qst_capture_prisoners", 6, "$g_talk_troop"),
      (quest_get_slot, ":var0", "qst_capture_prisoners", 10),
      (quest_get_slot, ":var1", "qst_capture_prisoners", 2),
      (party_count_prisoners_of_type, ":var2", "p_main_party", ":var1"),
      (ge, ":var2", ":var0"),
      (assign, reg1, ":var0"),
      (str_store_troop_name_plural, s1, ":var1"),
    ],
    "Indeed. I brought you {reg1} {s1} as prisoners.",
    "lord_generic_mission_thank",
    [
      (quest_get_slot, ":var0", "qst_capture_prisoners", 10),
      (quest_get_slot, ":var1", "qst_capture_prisoners", 2),
      (party_remove_prisoners, "p_main_party", ":var1", ":var0"),
      (party_add_prisoners, "$g_encountered_party", ":var1", ":var0"),
      (call_script, "script_finish_quest", "qst_capture_prisoners", 100),
    ]],

  [plyr|anyone, "lord_active_mission_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_capture_enemy_hero"),
      (assign, ":var1", 0),
      (quest_get_slot, ":var2", "qst_capture_enemy_hero", 3),
      (party_get_num_prisoner_stacks, ":var3", "p_main_party"),
      (try_for_range, ":var4", 0, ":var3"),
        (party_prisoner_stack_get_troop_id, ":var5", "p_main_party", ":var4"),
        (troop_is_hero, ":var5"),
        (store_troop_faction, ":var6", ":var5"),
        (eq, ":var2", ":var6"),
        (troop_slot_eq, ":var5", 2, 2),
        (assign, ":var1", 1),
        (quest_set_slot, "qst_capture_enemy_hero", 2, ":var5"),
      (try_end),
      (eq, ":var1", 1),
      (str_store_faction_name, s13, ":var2"),
    ],
    "Oh, indeed. I've captured a noble from {s13} for you.",
    "capture_enemy_hero_thank",
    []],

  [anyone, "capture_enemy_hero_thank",
    [],
    "Many thanks, my friend. He will serve very well for a bargain. You've done fine work here. Please accept these {reg5} cents for your help.",
    "capture_enemy_hero_thank_2",
    [
      (quest_get_slot, ":var0", "qst_capture_enemy_hero", 2),
      (quest_get_slot, ":var1", "qst_capture_enemy_hero", 3),
      (party_remove_prisoners, "p_main_party", ":var0", 1),
      (store_relation, ":var2", "$g_encountered_party_faction", ":var1"),
      (try_begin),
        (lt, ":var2", 0),
        (party_add_prisoners, "$g_encountered_party", ":var0", 1),
      (else_try),
        (troop_set_slot, ":var0", 8, -1),
      (try_end),
      (quest_get_slot, ":var3", "qst_capture_enemy_hero", 22),
      (call_script, "script_troop_add_gold", "trp_player", ":var3"),
      (add_xp_as_reward, 2500),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 4),
      (call_script, "script_end_quest", "qst_capture_enemy_hero"),
    ]],

  [plyr|anyone, "capture_enemy_hero_thank_2",
    [],
    "Certainly, {s65}.",
    "lord_pretalk",
    []],

  [plyr|anyone, "capture_enemy_hero_thank_2",
    [],
    "It was nothing.",
    "lord_pretalk",
    []],

  [plyr|anyone, "capture_enemy_hero_thank_2",
    [],
    "Give me more of a challenge next time.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_active_mission_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_raise_troops"),
      (quest_get_slot, ":var1", ":var0", 2),
      (quest_get_slot, ":var2", ":var0", 10),
      (party_count_companions_of_type, ":var3", "p_main_party", ":var1"),
      (ge, ":var3", ":var2"),
      (assign, reg1, ":var2"),
      (str_store_troop_name_plural, s13, ":var1"),
    ],
    "Indeed. I have raised {reg1} {s13}. You can take them.",
    "lord_raise_troops_thank",
    [
      (quest_get_slot, ":var0", "qst_raise_troops", 2),
      (quest_get_slot, ":var1", "qst_raise_troops", 10),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 8),
      (party_remove_members, "p_main_party", ":var0", ":var1"),
      (call_script, "script_end_quest", "qst_raise_troops"),
      (troop_get_slot, ":var2", "$g_talk_troop", 10),
      (gt, ":var2", 0),
      (party_add_members, ":var2", ":var0", ":var1"),
    ]],

  [anyone, "lord_raise_troops_thank",
    [],
    "These men may well turn the tide in my plans, {playername}. I am confident you've trained them well. My thanks and my compliments to you.",
    "lord_raise_troops_thank_2",
    []],

  [plyr|anyone, "lord_raise_troops_thank_2",
    [],
    "Well, the lads are at your command now. I am sure you will take good care of them.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_active_mission_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_collect_taxes"),
      (check_quest_succeeded, "qst_collect_taxes"),
      (eq, "$qst_collect_taxes_halve_taxes", 0),
      (quest_get_slot, ":var1", "qst_collect_taxes", 22),
      (store_mul, ":var2", ":var1", 8),
      (val_div, ":var2", 10),
      (store_troop_gold, ":var3", "trp_player"),
      (ge, ":var3", ":var2"),
      (assign, reg19, ":var1"),
      (quest_get_slot, ":var4", "qst_collect_taxes", 1),
      (str_store_party_name, s3, ":var4"),
    ],
    "Here are all the taxes from {s3}. It comes up to {reg19} cents.",
    "lord_collect_taxes_success",
    []],

  [plyr|anyone, "lord_active_mission_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_collect_taxes"),
      (check_quest_succeeded, "qst_collect_taxes"),
      (eq, "$qst_collect_taxes_halve_taxes", 1),
      (quest_get_slot, ":var1", "qst_collect_taxes", 22),
      (store_mul, ":var2", ":var1", 95),
      (val_div, ":var2", 100),
      (store_troop_gold, ":var3", "trp_player"),
      (ge, ":var3", ":var2"),
      (assign, reg19, ":var1"),
      (quest_get_slot, ":var4", "qst_collect_taxes", 1),
      (str_store_party_name, s3, ":var4"),
    ],
    "Here are the taxes from {s3}. It comes up to {reg19} cents.",
    "lord_collect_taxes_half_success",
    []],

  [plyr|anyone, "lord_active_mission_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_collect_taxes"),
      (check_quest_failed, "qst_collect_taxes"),
      (quest_get_slot, ":var1", "qst_collect_taxes", 22),
      (store_troop_gold, ":var2", "trp_player"),
      (ge, ":var2", ":var1"),
      (assign, reg19, ":var1"),
      (quest_get_slot, ":var3", "qst_collect_taxes", 1),
      (str_store_party_name, s3, ":var3"),
    ],
    "Unfortunately, a revolt broke up while I was collecting the taxes. I could only collect {reg19} cents.",
    "lord_collect_taxes_fail",
    []],

  [anyone, "lord_collect_taxes_success",
    [
      (quest_get_slot, ":var0", "qst_collect_taxes", 22),
      (store_mul, ":var1", ":var0", 8),
      (val_div, ":var1", 10),
      (assign, reg20, ":var1"),
      (store_sub, reg21, ":var0", ":var1"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Well done, {playername}, very well done indeed! You were truly the right {reg18?woman:man} for the job. I promised you a fifth of the taxes, so that amounts to {reg21} cents. If you give me {reg20} cents, you may keep the difference. A good result for everyone, eh?",
    "lord_pretalk",
    [
      (troop_remove_gold, "trp_player", reg20),
      (quest_set_slot, "qst_collect_taxes", 22, 0),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 4),
      (call_script, "script_end_quest", "qst_collect_taxes"),
    ]],

  [anyone, "lord_collect_taxes_half_success",
    [
      (quest_get_slot, ":var0", "qst_collect_taxes", 22),
      (val_mul, ":var0", 95),
      (val_div, ":var0", 100),
      (assign, reg20, ":var0"),
    ],
    "What?! Is this some scheme of yours, {playername}? That's less than half the taxes I'm owed! You have let them get away with murder as well as my money. What a farce! You can forget the money I promised you, I'm taking {reg20} cents from what you collected, and you're lucky I'm leaving you a few coins for honour's sake.",
    "lord_pretalk",
    [
      (troop_remove_gold, "trp_player", reg20),
      (quest_set_slot, "qst_collect_taxes", 22, 0),
      (call_script, "script_end_quest", "qst_collect_taxes"),
    ]],

  [anyone, "lord_collect_taxes_fail",
    [],
    "God, what a bloody mess you've gotten us into, {playername}.This could turn very ugly if I do not take immediate action.I hope you're not here expecting to be paid for failure.Hand over my {reg19} cents, and end our business together.",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (quest_get_slot, ":var0", "qst_collect_taxes", 22),
      (troop_remove_gold, "trp_player", ":var0"),
      (quest_set_slot, "qst_collect_taxes", 22, 0),
      (call_script, "script_end_quest", "qst_collect_taxes"),
    ]],

  [plyr|anyone, "lord_active_mission_2",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_hunt_down_fugitive"),
      (check_quest_succeeded, "qst_hunt_down_fugitive"),
      (quest_get_slot, ":var1", "qst_hunt_down_fugitive", 1),
      (str_store_party_name, s3, ":var1"),
      (quest_get_slot, ":var2", "qst_hunt_down_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var2"),
      (str_store_string, s4, s50),
    ],
    "I found {s4} hiding at {s3} and shot him down.",
    "lord_hunt_down_fugitive_success",
    []],

  [plyr|anyone, "lord_active_mission_2",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_hunt_down_fugitive"),
      (check_quest_failed, "qst_hunt_down_fugitive"),
    ],
    "I'm afraid he got away.",
    "lord_hunt_down_fugitive_fail",
    []],

  [anyone, "lord_hunt_down_fugitive_success",
    [],
    "And we'll all be a lot better off without him! Thank you, {playername}, for removing this long-festering thorn from my side. 'Tis good to know you can be trusted to handle things with an appropriate level of tactfulness. A bounty I promised, and a bounty you shall have. Exactly ten dollars!",
    "lord_hunt_down_fugitive_success_2",
    [
      (add_xp_as_reward, 300),
    ]],

  [plyr|anyone, "lord_hunt_down_fugitive_success_2",
    [],
    "Let me take the money, {s65}. Thank you.",
    "lord_hunt_down_fugitive_reward_accept",
    []],

  [plyr|anyone, "lord_hunt_down_fugitive_success_2",
    [],
    "This is blood money. I can't accept it.",
    "lord_hunt_down_fugitive_reward_reject",
    []],

  [anyone, "lord_hunt_down_fugitive_reward_accept",
    [],
    "Yep, here you are, {playername}. Once again, you've my thanks for ridding me of that {s44}.",
    "lord_pretalk",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_lord_insult_default"),
      (str_store_string, s44, ":var0"),
      (call_script, "script_troop_add_gold", "trp_player", 1000),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
    ]],

  [anyone, "lord_hunt_down_fugitive_reward_reject",
    [],
    "So justice is its own reward for you, {playername}? Alright, then. Thanks for ridding me of that {s44}.",
    "lord_pretalk",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_lord_insult_default"),
      (str_store_string, s44, ":var0"),
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
    ]],

  [anyone, "lord_hunt_down_fugitive_fail",
    [],
    "It is a sad day when that {s44} manages to avoid the hand of justice yet again. I thought you would be able to do this, {playername}. Clearly I was wrong.",
    "lord_pretalk",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_lord_insult_default"),
      (str_store_string, s44, ":var0"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
    ]],

  [plyr|anyone, "lord_active_mission_2",
    [
      (check_quest_active, "qst_hideout2"),
      (quest_slot_eq, "qst_hideout2", 6, "$g_talk_troop"),
      (check_quest_succeeded, "qst_hideout2"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "I made it back, {reg18?ma'am:sir}...",
    "defend_hideout_success",
    []],

  [anyone, "defend_hideout_success",
    [],
    "I heard you held off the Sheriff and his men and saved our hideout, for now. That ought to buy us enough time if those assholes ever come back. And here's your reward, {s8}.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_hideout", 21),
      (add_xp_as_reward, ":var0"),
      (call_script, "script_change_troop_renown", "trp_player", 10),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 5),
      (call_script, "script_change_player_relation_with_faction", "fac_outlaws", 5),
      (call_script, "script_end_quest", "qst_hideout2"),
      (store_random_in_range, ":var1", 1, 100),
      (try_begin),
        (le, ":var1", 50),
        (str_store_string, s8, "@a Sawn-Off Winchester"),
        (troop_add_item, "trp_player", "itm_winchester_shorty"),
      (else_try),
        (str_store_string, s8, "@25 bucks"),
        (call_script, "script_troop_add_gold", "trp_player", 2500),
      (try_end),
    ]],

  [plyr|anyone, "lord_active_mission_2",
    [
      (check_quest_active, "qst_hideout2"),
      (quest_slot_eq, "qst_hideout2", 6, "$g_talk_troop"),
      (check_quest_failed, "qst_hideout2"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "I made it back, {reg18?ma'am:sir}...",
    "defend_hideout_failure",
    []],

  [anyone, "defend_hideout_failure",
    [],
    "I've been told that we lost the fight and our most important hideout was overrun by the Sheriff and his men. This is devastating. Do you have anything to say for yourself?",
    "defend_hideout_failed",
    []],

  [plyr|anyone, "defend_hideout_failed",
    [],
    "I'm sorry, we were totally surrounded.",
    "defend_hideout_failed_2",
    []],

  [plyr|anyone, "defend_hideout_failed",
    [],
    "I was the last man standing and the odds weren't in our favor...",
    "defend_hideout_failed_3",
    []],

  [anyone, "defend_hideout_failed_2",
    [],
    "Well, you knew the odds weren't gonna be in your favor. I guess there's only so much you could do given the circumstances.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_hideout", 21),
      (call_script, "script_end_quest", "qst_hideout"),
      (add_xp_as_reward, ":var0"),
      (call_script, "script_end_quest", "qst_hideout2"),
    ]],

  [anyone, "defend_hideout_failed_3",
    [],
    "Well, you knew damn well the odds weren't gonna be in our favor. It's funny how you were the only survivor in all that mess...",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -3),
      (call_script, "script_end_quest", "qst_hideout2"),
    ]],

  [plyr|anyone, "lord_active_mission_2",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_bring_back_deserters"),
      (quest_get_slot, ":var1", ":var0", 2),
      (quest_get_slot, ":var2", ":var0", 10),
      (party_count_prisoners_of_type, ":var3", "p_main_party", ":var1"),
      (ge, ":var3", ":var2"),
      (assign, reg1, ":var2"),
      (call_script, "script_troop_get_gender_to_reg18", "$g_talk_troop"),
    ],
    "Yes {reg18?ma'am:sir}. I have brought {reg1} deserters as you asked me to.",
    "lord_generic_mission_thank",
    [
      (quest_get_slot, ":var0", "qst_bring_back_deserters", 2),
      (quest_get_slot, ":var1", "qst_bring_back_deserters", 10),
      (party_remove_prisoners, "p_main_party", ":var0", ":var1"),
      (faction_get_slot, ":var2", "$g_talk_troop_faction", 43),
      (try_begin),
        (gt, ":var2", 0),
        (troop_get_slot, ":var3", "$g_talk_troop", 10),
        (gt, ":var3", 0),
        (party_add_members, ":var3", ":var2", ":var1"),
      (try_end),
      (quest_get_slot, reg8, "qst_bring_back_deserters", 22),
      (call_script, "script_troop_add_gold", "trp_player", reg8),
      (quest_get_slot, ":var4", "qst_bring_back_deserters", 21),
      (add_xp_as_reward, ":var4"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (call_script, "script_end_quest", "qst_bring_back_deserters"),
    ]],

  [plyr|anyone, "lord_active_mission_2",
    [],
    "I am still working on it.",
    "lord_active_mission_3",
    []],

  [plyr|anyone, "lord_active_mission_2",
    [],
    "I am afraid I won't be able to do this quest.",
    "lord_mission_failed",
    []],

  [anyone, "lord_active_mission_3",
    [],
    "Good. Remember, I am counting on you.",
    "lord_pretalk",
    []],

  [anyone, "lord_mission_failed",
    [],
    "{s43}",
    "lord_pretalk",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_mission_failed_default"),
      (store_partner_quest, ":var0"),
      (call_script, "script_abort_quest", ":var0", 1),
    ]],

  [anyone, "lord_suggest_action_ask",
    [],
    "What do you suggest?",
    "lord_suggest_action",
    []],

  [plyr|anyone, "lord_suggest_action",
    [],
    "I want to join your faction.",
    "lord_suggest_join_faction",
    []],

  [anyone, "lord_suggest_join_faction",
    [],
    "Alright then.",
    "lord_give_oath_5",
    []],

  [plyr|anyone, "lord_suggest_action",
    [],
    "Cheat:I want to know your leaded party ID.",
    "lord_suggest_learn_party_id",
    []],

  [anyone, "lord_suggest_learn_party_id",
    [
      (troop_get_slot, reg0, "$g_talk_troop", 10),
    ],
    "It is {reg0}.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_suggest_action",
    [
      (eq, "$players_kingdom", "$g_talk_troop_faction"),
    ],
    "I want to be your kingdom's marshall.",
    "lord_suggest_become_marshall",
    []],

  [anyone, "lord_suggest_become_marshall",
    [],
    "Alright then.",
    "lord_pretalk",
    [
      (faction_set_slot, "$g_talk_troop_faction", 7, "trp_player"),
      (faction_set_slot, "$g_talk_troop_faction", 4, 0),
      (assign, "$g_recalculate_ais", 1),
    ]],

  [plyr|anyone, "lord_suggest_action",
    [
      (neq, "$talk_context", 4),
    ],
    "Let us attack an enemy town or castle.",
    "lord_suggest_attack_enemy_castle",
    []],

  [plyr|anyone, "lord_suggest_action",
    [
      (neq, "$talk_context", 4),
    ],
    "Let us return back to a friendly town.",
    "lord_suggest_go_to_friendly_town",
    []],

  [plyr|anyone, "lord_suggest_action",
    [
      (neq, "$talk_context", 4),
    ],
    "Let us attack an enemy war party.",
    "lord_suggest_attack_enemy_party",
    []],

  [plyr|anyone, "lord_suggest_action",
    [
      (eq, "$talk_context", 4),
    ],
    "Let us lift this siege.",
    "lord_suggest_lift_siege",
    []],

  [plyr|anyone, "lord_suggest_action",
    [
      (neq, "$talk_context", 4),
    ],
    "Follow me.",
    "lord_suggest_follow_me",
    []],

  [plyr|anyone, "lord_suggest_action",
    [
      (neq, "$talk_context", 4),
    ],
    "Follow someone.",
    "lord_suggest_follow_other",
    []],

  [plyr|anyone, "lord_suggest_action",
    [
      (neq, "$talk_context", 4),
    ],
    "Raid a village.",
    "lord_suggest_raid_village",
    []],

  [plyr|anyone, "lord_suggest_action",
    [],
    "Like me.",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 20),
    ]],

  [anyone, "lord_suggest_lift_siege",
    [],
    "As you wish, {playername}.",
    "close_window",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", -1),
      (party_leave_cur_battle, "$g_talk_troop_party"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_suggest_go_to_friendly_town",
    [],
    "Hmm. Which town or castle do you suggest we go to?",
    "lord_suggest_go_to_friendly_town2",
    []],

  [repeat_for_parties|plyr|anyone, "lord_suggest_go_to_friendly_town2",
    [
      (store_repeat_object, ":var0"),
      (this_or_next|party_slot_eq, ":var0", 0, 2),
      (party_slot_eq, ":var0", 0, 3),
      (neq, ":var0", "$g_encountered_party"),
      (store_faction_of_party, ":var1", ":var0"),
      (eq, ":var1", "$g_talk_troop_faction"),
      (str_store_party_name, s1, ":var0"),
    ],
    "{s1}",
    "lord_suggest_go_to_friendly_town3",
    [
      (store_repeat_object, "$town_suggested_to_go_to"),
    ]],

  [plyr|anyone, "lord_suggest_go_to_friendly_town2",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_suggest_go_to_friendly_town3",
    [
      (str_store_party_name, s1, "$town_suggested_to_go_to"),
    ],
    "Very well, we go to {s1}.",
    "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", 7, "$town_suggested_to_go_to"),
    ]],

  [anyone, "lord_suggest_attack_enemy_party",
    [],
    "Hmm. Which party do you suggest we attack?",
    "lord_suggest_attack_enemy_party2",
    []],

  [repeat_for_parties|plyr|anyone, "lord_suggest_attack_enemy_party2",
    [
      (store_repeat_object, ":var0"),
      (party_slot_eq, ":var0", 0, 13),
      (party_is_active, ":var0"),
      (store_faction_of_party, ":var1", ":var0"),
      (store_relation, ":var2", ":var1", "$g_talk_troop_faction"),
      (le, ":var2", -10),
      (call_script, "script_get_closest_walled_center", ":var0"),
      (assign, ":var3", reg0),
      (str_store_party_name, s3, ":var3"),
      (str_store_faction_name, s2, ":var1"),
      (str_store_party_name, s1, ":var0"),
    ],
    "{s1} of {s2} around {s3}",
    "lord_suggest_attack_enemy_party3",
    [
      (store_repeat_object, "$suggested_to_attack_party"),
    ]],

  [plyr|anyone, "lord_suggest_attack_enemy_party2",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_suggest_attack_enemy_party3",
    [
      (str_store_party_name, s1, "$suggested_to_attack_party"),
    ],
    "As you wish, we will attack {s1}.",
    "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", 10, "$suggested_to_attack_party"),
    ]],

  [anyone, "lord_suggest_attack_enemy_castle",
    [],
    "Hmm. Which one do you suggest we attack?",
    "lord_suggets_attack_enemy_castle2",
    []],

  [repeat_for_parties|plyr|anyone, "lord_suggets_attack_enemy_castle2",
    [
      (store_repeat_object, ":var0"),
      (this_or_next|party_slot_eq, ":var0", 0, 2),
      (party_slot_eq, ":var0", 0, 3),
      (store_faction_of_party, ":var1", ":var0"),
      (store_relation, ":var2", ":var1", "$g_talk_troop_faction"),
      (le, ":var2", -10),
      (str_store_faction_name, s2, ":var1"),
      (str_store_party_name, s1, ":var0"),
    ],
    "{s1} of {s2}",
    "lord_suggets_attack_enemy_castle3",
    [
      (store_repeat_object, "$suggested_to_attack_center"),
    ]],

  [plyr|anyone, "lord_suggets_attack_enemy_castle2",
    [],
    "Never mind my lord.",
    "lord_pretalk",
    []],

  [anyone, "lord_suggets_attack_enemy_castle3",
    [
      (str_store_party_name, s1, "$suggested_to_attack_center"),
    ],
    "That should be possible. Very well, we'll attack {s1}.",
    "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", 1, "$suggested_to_attack_center"),
    ]],

  [anyone, "lord_suggest_raid_village",
    [],
    "Hmm. Which village do you suggest we attack?",
    "lord_suggest_raid_village_2",
    []],

  [repeat_for_parties|plyr|anyone, "lord_suggest_raid_village_2",
    [
      (store_repeat_object, ":var0"),
      (party_slot_eq, ":var0", 0, 4),
      (store_faction_of_party, ":var1", ":var0"),
      (store_relation, ":var2", ":var1", "$g_talk_troop_faction"),
      (le, ":var2", -10),
      (str_store_faction_name, s2, ":var1"),
      (str_store_party_name, s1, ":var0"),
    ],
    "{s1} of {s2}",
    "lord_suggest_raid_village_3",
    [
      (store_repeat_object, "$suggested_to_attack_center"),
    ]],

  [plyr|anyone, "lord_suggest_raid_village_2",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_suggest_raid_village_3",
    [
      (str_store_party_name, s1, "$suggested_to_attack_center"),
    ],
    "That should be possible. Very well, we'll attack {s1}.",
    "lord_pretalk",
    [
      (call_script, "script_party_set_ai_state", "$g_talk_troop_party", 5, "$suggested_to_attack_center"),
    ]],

  [anyone, "lord_suggest_follow_me",
    [],
    "Aye, I'll follow you.",
    "lord_pretalk",
    [
      (party_set_slot, "$g_talk_troop_party", 30, "p_main_party"),
      (call_script, "script_party_decide_next_ai_state_under_command", "$g_talk_troop_party"),
    ]],

  [anyone, "lord_suggest_follow_other",
    [],
    "Who do you want me to follow?",
    "lord_suggest_follow_other_2",
    []],

  [repeat_for_parties|plyr|anyone, "lord_suggest_follow_other_2",
    [
      (store_repeat_object, ":var0"),
      (party_slot_eq, ":var0", 0, 13),
      (neq, ":var0", "$g_talk_troop"),
      (store_faction_of_party, ":var1", ":var0"),
      (eq, ":var1", "$g_talk_troop_faction"),
      (str_store_party_name, s1, ":var0"),
    ],
    "{s1}",
    "lord_suggest_follow_other_3",
    [
      (store_repeat_object, "$town_suggested_to_go_to"),
    ]],

  [plyr|anyone, "lord_suggest_follow_other_2",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "lord_suggest_follow_other_3",
    [
      (str_store_party_name, s1, "$town_suggested_to_go_to"),
    ],
    "As you wish, I shall be accompanying {s1}.",
    "lord_pretalk",
    [
      (party_set_slot, "$g_talk_troop_party", 30, "$town_suggested_to_go_to"),
      (call_script, "script_party_decide_next_ai_state_under_command", "$g_talk_troop_party"),
    ]],

  [plyr|anyone, "lord_suggest_action",
    [],
    "Nothing, {s65}. It's not important.",
    "lord_pretalk",
    []],

  [auto_proceed|anyone, "lord_request_mission_ask",
    [
      (eq, "$players_kingdom", 0),
      (ge, "$g_talk_troop_faction_relation", 0),
      (ge, "$g_talk_troop_relation", 0),
      (troop_slot_ge, "trp_player", 7, 30),
      (neg|faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
      (faction_get_slot, ":var0", "$g_talk_troop_faction", 31),
      (assign, ":var1", 0),
      (try_for_range, ":var2", "fac_player_supporters_faction", "fac_kingdoms_end"),
        (faction_slot_eq, "$g_talk_troop_faction", 21, 0),
        (store_relation, ":var3", "$g_talk_troop_faction", ":var2"),
        (lt, ":var3", 0),
        (val_add, ":var1", 1),
      (try_end),
      (ge, ":var1", 1),
      (store_current_hours, ":var4"),
      (store_add, ":var5", ":var0", 168),
      (val_add, ":var0", 24),
      (ge, ":var4", ":var0"),
      (store_random_in_range, ":var6", 0, 100),
      (this_or_next|lt, ":var6", 20),
      (ge, ":var4", ":var5"),
    ],
    "Warning: This line should never display.",
    "lord_propose_mercenary",
    [
      (store_current_hours, ":var0"),
      (faction_set_slot, "$g_talk_troop_faction", 31, ":var0"),
    ]],

  [anyone, "lord_propose_mercenary",
    [
      (call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":var0", reg0),
      (val_add, ":var0", 100),
      (call_script, "script_round_value", ":var0"),
      (assign, ":var0", reg0),
      (assign, "$temp", ":var0"),
      (faction_get_slot, ":var1", "$g_talk_troop_faction", 10),
      (neq, ":var1", "$g_talk_troop"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
      (str_store_troop_name, s10, ":var1"),
    ],
    "As it happens, {playername}, I promised {s10} that I would hire a company of mercenaries for an upcoming campaign. What do you say to entering the service of {s9} as a mercenary captain? I've no doubt that you would be up to the task.",
    "lord_mercenary_service",
    []],

  [plyr|anyone, "lord_mercenary_service",
    [],
    "I'm not interested, thank you.",
    "lord_mercenary_service_reject",
    []],

  [plyr|anyone, "lord_mercenary_service",
    [],
    "Aye, I'll join {s9}.",
    "lord_mercenary_service_accept",
    []],

  [plyr|anyone, "lord_mercenary_service",
    [],
    "I'm interested. Please tell me more.",
    "lord_mercenary_elaborate_pay",
    []],

  [anyone, "lord_mercenary_service_accept",
    [
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
    ],
    "Perfect. Of course you shall have to make a formal declaration of allegiance, and give your oath that you and your company will remain in service to {s9} for a period of no less than three months.",
    "lord_mercenary_service_verify",
    []],

  [plyr|anyone, "lord_mercenary_service_verify",
    [],
    "As you wish. Your enemies are my enemies.",
    "lord_mercenary_service_verify_2",
    []],

  [plyr|anyone, "lord_mercenary_service_verify",
    [],
    "On second thought, forget it.",
    "lord_mercenary_service_reject",
    []],

  [anyone, "lord_mercenary_service_verify_2",
    [],
    "That will do. You've made a wise choice, my friend. {s9} does well by its loyal fighters, you will receive many rewards for your service.",
    "lord_mercenary_service_accept_3",
    [
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (store_current_hours, ":var0"),
      (store_add, "$mercenary_service_next_pay_time", ":var0", 168),
      (assign, "$mercenary_service_accumulated_pay", 0),
      (store_current_day, ":var1"),
      (store_add, "$mercenary_service_next_renew_day", ":var1", 90),
      (call_script, "script_player_join_faction", "$g_talk_troop_faction"),
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
    ]],

  [anyone, "lord_mercenary_service_accept_3",
    [],
    "Now, I suggest you prepare for a serious campaign. Train and equip your soldiers as best you can in the meantime, and respond quickly when you are summoned for duty.",
    "lord_pretalk",
    []],

  [anyone, "lord_mercenary_service_reject",
    [
      (str_store_faction_name, s9, "$g_talk_troop_faction"),
    ],
    "I'm very sorry to hear that. You'll find no better place than {s9}, be sure of that.",
    "lord_pretalk",
    []],

  [anyone, "lord_mercenary_elaborate_pay",
    [
      (assign, reg12, "$temp"),
    ],
    "I can offer you a contract for three months. At the end of those three, it can be extended month by month. An initial sum of {reg12} cents will be paid to you to seal the contract. After that, you'll receive wages from {s10} each week, according to the number and quality of the soldiers in your company. You still have your rights to battlefield loot and salvage, as well as any prisoners you capture. War can be very profitable at times...",
    "lord_mercenary_elaborate_1",
    [
      (faction_get_slot, ":var0", "$g_talk_troop_faction", 10),
      (str_store_troop_name, s10, ":var0"),
    ]],

  [anyone, "lord_mercenary_service_elaborate_duty",
    [],
    "Duties... There are only a few, none of them difficult. The very first thing is to declare your allegiance. An oath of loyalty to our cause. Once that's done, you shall be required to fulfill certain responsibilities. You'll participate in military campaigns, fulfill any duties given to you by your commanders, and most of all you shall attack the enemies of our state wherever you might find them.",
    "lord_mercenary_elaborate_1",
    [
      (faction_get_slot, ":var0", "$g_talk_troop_faction", 10),
      (str_store_troop_name, s10, ":var0"),
    ]],

  [plyr|anyone, "lord_mercenary_elaborate_1",
    [],
    "And what about my duties as a mercenary?",
    "lord_mercenary_service_elaborate_duty",
    []],

  [plyr|anyone, "lord_mercenary_elaborate_1",
    [],
    "Can I hold on to any forts I take?",
    "lord_mercenary_elaborate_castle",
    []],

  [plyr|anyone, "lord_mercenary_elaborate_1",
    [
      (neg|troop_slot_ge, "trp_player", 13, 1),
    ],
    "Can I fly my own banner?",
    "lord_mercenary_elaborate_banner",
    []],

  [plyr|anyone, "lord_mercenary_elaborate_1",
    [],
    "How much will you pay me for my service?",
    "lord_mercenary_elaborate_pay",
    []],

  [plyr|anyone, "lord_mercenary_elaborate_1",
    [],
    "Sounds good. I wish to enter your service as a mercenary.",
    "lord_mercenary_service_accept",
    []],

  [plyr|anyone, "lord_mercenary_elaborate_1",
    [],
    "Apologies, my gun is not for hire.",
    "lord_mercenary_service_reject",
    []],

  [anyone, "lord_mercenary_elaborate_castle",
    [
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Only my loyal followers can own lands and forts in my realm. A mercenary can not be trusted with such a responsibility. However, after serving for some time, you can swear homage to me and become my follower. Then you will be rewarded with a fief.",
    "lord_mercenary_elaborate_1",
    []],

  [anyone, "lord_mercenary_elaborate_castle",
    [],
    "Only loyal followers of {s10} can be assigned lands and forts. You understand, a simple mercenary cannot be trusted with such responsibility. However, after serving for some time, you may earn the right to enter service of {s10} and become his officer. Then you would be rewarded with a fief.",
    "lord_mercenary_elaborate_1",
    []],

  [anyone, "lord_mercenary_elaborate_banner",
    [
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Only my sworn followers have the honour of carrying their own banners. However, after some time in mercenary service, you may earn the opportunity to swear homage to me and become my follower, gaining the right to choose a banner of your own and fight under it in battle.",
    "lord_mercenary_elaborate_1",
    []],

  [anyone, "lord_mercenary_elaborate_banner",
    [],
    "Only sworn followers of {s10} have the honour of carrying their own banners. However, after some time of mercenary service, perhaps you can earn the opportunity to enter service of {s10} and become his officer, gaining the right to choose a banner of your own and fight under it in battle.",
    "lord_mercenary_elaborate_1",
    []],

  [anyone, "lord_request_mission_ask",
    [
      (store_partner_quest, ":var0"),
      (ge, ":var0", 0),
    ],
    "You still haven't finished the last job I gave you, {playername}. You should be working on that, not asking me for other things to do.",
    "lord_pretalk",
    []],

  [anyone, "lord_request_mission_ask",
    [
      (troop_slot_eq, "$g_talk_troop", 20, 1),
    ],
    "I don't have any other jobs for you right now.",
    "lord_pretalk",
    []],

  [auto_proceed|anyone, "lord_request_mission_ask",
    [],
    "A task?",
    "lord_tell_mission",
    [
      (call_script, "script_get_random_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_deliver_message"),
    ],
    "I need to send a letter to {s13} who should be currently at {s4}. If you will be heading towards there, would you deliver it to him? The letter needs to be in his hands in 30 days.",
    "lord_mission_deliver_message",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (quest_get_slot, ":var1", "$random_quest_no", 1),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":var0"),
      (str_store_party_name_link, s4, ":var1"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to take a message to {s13}. {s13} was believed to be at {s4} when you were given this quest."),
    ]],

  [plyr|anyone, "lord_mission_deliver_message",
    [],
    "Certainly, I intend to pass by {s4} and it would be no trouble.",
    "lord_mission_deliver_message_accepted",
    []],

  [plyr|anyone, "lord_mission_deliver_message",
    [],
    "I doubt I'll be seeing {s13} anytime soon, {s65}. You'd best send it with someone else.",
    "lord_mission_deliver_message_rejected",
    []],

  [plyr|anyone, "lord_mission_deliver_message",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I am not your errand {reg18?girl:boy}. Hire a courier or wire a telegram.",
    "lord_mission_deliver_message_rejected_rudely",
    []],

  [anyone, "lord_mission_deliver_message_accepted",
    [],
    "I appreciate it, {playername}. Here's the letter, and a small sum to cover your travel expenses. Give my regards to {s13} when you arrive.",
    "close_window",
    [
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (quest_get_slot, reg8, "$random_quest_no", 22),
      (call_script, "script_troop_add_gold", "trp_player", reg8),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_mission_deliver_message_rejected",
    [],
    "Ah, alright then. Well, I am sure I will find someone else.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_mission_deliver_message_rejected_rudely",
    [],
    "Hm, is this how you respond to a polite request for a small favor? A poor show, {playername}. I didn't know you would take offence.",
    "lord_mission_deliver_message_rejected_rudely_2",
    []],

  [plyr|anyone, "lord_mission_deliver_message_rejected_rudely_2",
    [],
    "Then you shall know better from now on.",
    "lord_mission_deliver_message_rejected_rudely_3",
    []],

  [plyr|anyone, "lord_mission_deliver_message_rejected_rudely_2",
    [],
    "Forgive my temper, {s65}. I'll deliver your letter.",
    "lord_mission_deliver_message_accepted",
    []],

  [anyone, "lord_mission_deliver_message_rejected_rudely_3",
    [],
    "Alright. I will remember that.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -4),
      (quest_set_slot, "$random_quest_no", 25, 150),
      (troop_set_slot, "$g_talk_troop", 20, 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_deliver_message_to_enemy_lord"),
    ],
    "I need to deliver a letter to {s13} of {s15}, who must be at {s4} currently. If you are going towards there, would you deliver my letter to him? The letter needs to reach him in 40 days.",
    "lord_mission_deliver_message",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (quest_get_slot, ":var1", "$random_quest_no", 1),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":var0"),
      (str_store_party_name_link, s4, ":var1"),
      (store_troop_faction, ":var2", ":var0"),
      (str_store_faction_name_link, s15, ":var2"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to take a message to {s13} of {s15}. {s13} was believed to be at {s4} when you were given this quest."),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_escort_lady"),
    ],
    "There is a small thing... My {s17} {s13} is due for a visit to her relatives at {s14}. The visit has been postponed several times already with all the trouble on the roads, but this time she is adamant about going. So, I want to at least make sure she's well-guarded. I trust you well, {playername} so I would be very grateful if you could escort her to {s14} and make sure she arrives safe and sound.",
    "lord_mission_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 4),
      (quest_get_slot, ":var1", "$random_quest_no", 1),
      (try_begin),
        (troop_slot_eq, "$g_talk_troop", 33, ":var0"),
        (str_store_string, s17, "str_daughter"),
      (else_try),
        (str_store_string, s17, "str_wife"),
      (try_end),
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":var0"),
      (str_store_party_name_link, s14, ":var1"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to escort his {s17} {s13} to {s14}."),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_deal_with_bandits_at_lords_village"),
    ],
    "A group of bandits have taken refuge in my village of {s1}. They are plundering nearby farms, and getting rich and fat stealing my taxes and feasting on my cattle.I'd like nothing better than to go out there and teach them a lesson, but I have my hands full at the moment, so I can't do anything about it.",
    "lord_mission_deal_with_bandits_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_party_name_link, s15, ":var0"),
      (str_store_troop_name_link, s13, "$g_talk_troop"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s13} asked you to deal with the bandits who are occupying the village of {s15} and then report back to him."),
    ]],

  [plyr|anyone, "lord_mission_deal_with_bandits_told",
    [],
    "No problem, I can go to {s1} and deal with these scum for you.",
    "lord_mission_deal_with_bandits_accepted",
    []],

  [plyr|anyone, "lord_mission_deal_with_bandits_told",
    [],
    "You will have to find help elsewhere, I am too busy.",
    "lord_mission_deal_with_bandits_rejected",
    []],

  [anyone, "lord_mission_deal_with_bandits_accepted",
    [],
    "Will you do that? Know that, I will be grateful to you. Here is some money for the expenses of your campaign. Make an example of those {s44}s.",
    "close_window",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_lord_insult_default"),
      (str_store_string, s44, ":var0"),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_troop_add_gold", "trp_player", 200),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_mission_deal_with_bandits_rejected",
    [],
    "Ah... Very well then, forget I brought it up.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_raise_troops"),
    ],
    "Noone should have to admit this, {playername}, but I was inspecting my soldiers the other day and there are men here who don't know which end of a musket to hold. {s44} You are an experienced combatant, {playername}. Will you train some troops for me? I would be grateful to you.",
    "lord_tell_mission_raise_troops",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_troop_train_request_default"),
      (str_store_string, s44, ":var0"),
    ]],

  [plyr|anyone, "lord_tell_mission_raise_troops",
    [],
    "How many men do you need?",
    "lord_tell_mission_raise_troops_2",
    []],

  [anyone, "lord_tell_mission_raise_troops_2",
    [],
    "If you can raise {reg1} {s14} and bring them to me, that will probably be enough.",
    "lord_mission_raise_troops_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (quest_get_slot, reg1, "$random_quest_no", 10),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name_plural, s14, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to raise {reg1} {s14} and bring them to him."),
    ]],

  [plyr|anyone, "lord_mission_raise_troops_told",
    [
      (quest_get_slot, reg1, "$random_quest_no", 10),
    ],
    "Of course, {s65}. Give me {reg1} fresh recruits and I'll train them to be {s14}.",
    "lord_mission_raise_troops_accepted",
    []],

  [plyr|anyone, "lord_mission_raise_troops_told",
    [],
    "I am too busy these days to train anyone.",
    "lord_mission_raise_troops_rejected",
    []],

  [anyone, "lord_mission_raise_troops_accepted",
    [],
    "You've taken a weight off my shoulders, {playername}. I shall tell my sergeants to send you the recruits and attach them to your command. Also, I'll advance you some money to help with expenses. Here, this purse should do it. Thank you for your help.",
    "close_window",
    [
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_troop_add_gold", "trp_player", 100),
      (quest_get_slot, ":var0", "$random_quest_no", 4),
      (quest_get_slot, ":var1", "$random_quest_no", 10),
      (party_add_members, "p_main_party", ":var0", ":var1"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_mission_raise_troops_rejected",
    [],
    "Oh, of course. I had expected as much. Well, good luck to you then.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_collect_taxes"),
      (is_between, "$g_talk_troop", "trp_knight_1_1", "trp_knight_3_1"),
      (assign, reg9, 0),
      (try_begin),
        (quest_get_slot, ":var0", "$random_quest_no", 1),
        (party_slot_eq, ":var0", 0, 3),
        (assign, reg9, 1),
      (try_end),
    ],
    "You probably know that I am the protector of the {reg9?town:village} of {s3}. However, it has been months since {s3} has delivered the taxes and rents due. Apparently the populace there has grown unruly lately and I need someone to go there and remind them of their obligations. And to . . . persuade them if they won't listen. If you go there and raise the taxes they owe goverment, I will grant you one-fifth of everything you collect.",
    "lord_mission_collect_taxes_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s3, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to collect taxes from {s3}. He offered to leave you one-fifth of all the money you collect there."),
    ]],

  [plyr|anyone, "lord_mission_collect_taxes_told",
    [],
    "A fair offer, {s65}. We have an agreement.",
    "lord_mission_collect_taxes_accepted",
    []],

  [plyr|anyone, "lord_mission_collect_taxes_told",
    [],
    "Forgive me, I don't have the time.",
    "lord_mission_collect_taxes_rejected",
    []],

  [anyone, "lord_mission_collect_taxes_accepted",
    [],
    "Welcome news, {playername}. I will entrust this matter to you. Remember, those {reg9?townsmen:peasants} are foxy beasts, they will make every excuse not to pay me my rightful incomes. Do not let them fool you.",
    "close_window",
    [
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (assign, "$g_leave_encounter", 1),
      (assign, reg9, 0),
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (try_begin),
        (party_slot_eq, ":var0", 0, 3),
        (assign, reg9, 1),
      (try_end),
    ]],

  [anyone, "lord_mission_collect_taxes_rejected",
    [],
    "Oh, yes. Well, good luck to you then.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_hunt_down_fugitive"),
    ],
    "I have something you could help with, an issue with the lawless villain known as {s4}.  He murdered one of my men and has been on the run from his judgment ever since. I can't let him get away with avoiding justice, so I've put a bounty of ten dollars on his head. Friends of the murdered man reckon that this assassin may have taken refuge with his kinsmen at {s3}. You might be able to hunt him down and give him what he deserves, and claim the bounty for yourself.",
    "lord_mission_hunt_down_fugitive_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (quest_get_slot, ":var1", "$random_quest_no", 13),
      (str_store_party_name_link, s6, "$current_town"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s3, ":var0"),
      (call_script, "script_get_name_from_dna_to_s50", ":var1"),
      (str_store_string, s4, s50),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to hunt down a fugitive named {s4}. He is currently believed to be at {s3}."),
    ]],

  [plyr|anyone, "lord_mission_hunt_down_fugitive_told",
    [],
    "Then I will hunt him down and execute the law.",
    "lord_mission_hunt_down_fugitive_accepted",
    []],

  [plyr|anyone, "lord_mission_hunt_down_fugitive_told",
    [],
    "I am too busy to go after him at the moment.",
    "lord_mission_hunt_down_fugitive_rejected",
    []],

  [anyone, "lord_mission_hunt_down_fugitive_accepted",
    [],
    "That's excellent, {playername}. I will be grateful to you and so will the family of the man he murdered. And of course the bounty on his head will be yours if you can get him. Well, good hunting to you.",
    "close_window",
    [
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_mission_hunt_down_fugitive_rejected",
    [],
    "As you wish, {playername}.I suppose there are plenty of bounty hunters around to get the job done . . .",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_kill_local_merchant"),
    ],
    "There's a rich rancher here in {s3}. There is a certain way he deals with rivals: He hires gunslingers and a few days later the rival is shot defending himself. Unfortunately, there's no way to prove it's his doing and throw him in jail. So I need a man I can trust. Someone who will bring justice to him. For good.",
    "lord_mission_told_kill_local_merchant",
    [
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s3, "$current_town"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to assassinate a local rancher at {s3}."),
    ]],

  [plyr|anyone, "lord_mission_told_kill_local_merchant",
    [],
    "Don't worry. He'll be dead soon.",
    "lord_mission_accepted_kill_local_merchant",
    []],

  [plyr|anyone, "lord_mission_told_kill_local_merchant",
    [],
    "I'm not a murderer. Find someone else.",
    "lord_mission_rejected",
    []],

  [anyone, "lord_mission_accepted_kill_local_merchant",
    [],
    "Excellent. I trust you, {playername}. Don't disappoint me. Go now and wait for my word. I'll send you a message telling when and where you can catch that asshole. Kill him and I'll reward you generously.",
    "close_window",
    [
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (assign, "$g_leave_town", 1),
      (assign, "$qst_kill_local_merchant_center", "$current_town"),
      (rest_for_hours, 10, 4, 0),
      (finish_mission),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_meet_spy_in_enemy_town"),
      (neg|is_between, "$g_talk_troop", "trp_knight_5_1", "trp_knight_1_1_wife"),
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_party_name, s13, ":var0"),
      (store_faction_of_party, ":var1"),
      (str_store_faction_name, s14, ":var1"),
    ],
    "I have a sensitive matter which needs tending to, {playername}, and nobody trustworthy to take care of it. The fact is that I have a spy in {s13} to keep an eye on things for me, and report anything that might warrant my attention. Every week I send someone to collect the spy's reports and bring them back to me. The job's yours if you wish it.",
    "lord_mission_told_meet_spy_in_enemy_town",
    []],

  [plyr|anyone, "lord_mission_told_meet_spy_in_enemy_town",
    [],
    "I don't mind a bit of skullduggery. Count me in.",
    "quest_meet_spy_in_enemy_town_accepted",
    []],

  [plyr|anyone, "lord_mission_told_meet_spy_in_enemy_town",
    [],
    "I must decline. This cloak-and-dagger work isn't fit for me.",
    "quest_meet_spy_in_enemy_town_rejected",
    []],

  [anyone, "quest_meet_spy_in_enemy_town_accepted",
    [],
    "Excellent! Make your way to {s13} as soon as you can, the spy will be waiting.",
    "quest_meet_spy_in_enemy_town_accepted_response",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (quest_get_slot, ":var1", "$random_quest_no", 10),
      (store_sub, ":var2", ":var1", "str_secret_sign_1"),
      (val_add, ":var2", "str_countersign_1"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_string, s11, ":var1"),
      (str_store_string, s12, ":var2"),
      (str_store_party_name_link, s13, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} has asked you to meet with a spy in {s13}."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_cf_center_get_free_walker", ":var0"),
      (call_script, "script_center_set_walker_to_type", ":var0", reg0, 3),
      (str_store_item_name, s14, "$spy_item_worn"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "quest_meet_spy_in_enemy_town_accepted_response",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_party_name_link, s13, ":var0"),
    ],
    "{s13} is heavily defended. How can I get close without being noticed?",
    "quest_meet_spy_in_enemy_town_accepted_2",
    []],

  [anyone, "quest_meet_spy_in_enemy_town_accepted_2",
    [],
    "You shall have to use stealth. Take care to avoid enemy strongholds, villages and patrols, and don't bring too many men with you. If you fail to sneak in the first time, give it a while for the garrison to lower its guard again, or you may have a difficult time infiltrating the town.",
    "quest_meet_spy_in_enemy_town_accepted_response",
    []],

  [plyr|anyone, "quest_meet_spy_in_enemy_town_accepted_response",
    [],
    "How will I recognise the spy?",
    "quest_meet_spy_in_enemy_town_accepted_3",
    []],

  [anyone, "quest_meet_spy_in_enemy_town_accepted_3",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_party_name_link, s13, ":var0"),
      (troop_get_type, reg7, "$spy_quest_troop"),
      (call_script, "script_troop_get_gender_to_reg18", "$spy_quest_troop"),
      (quest_get_slot, ":var1", "$random_quest_no", 10),
      (store_sub, ":var2", ":var1", "str_secret_sign_1"),
      (val_add, ":var2", "str_countersign_1"),
      (str_store_string, s11, ":var1"),
      (str_store_string, s12, ":var2"),
    ],
    "Once you get to {s13} you must talk to the locals, the spy will be one of them. If you think you've found the spy, say the phrase '{s11}' The spy will respond with the phrase '{s12}' Thus you will know the other, and {reg18?she:he} will give you any information {reg18?she:he}'s gathered in my service.",
    "quest_meet_spy_in_enemy_town_accepted_response",
    []],

  [plyr|anyone, "quest_meet_spy_in_enemy_town_accepted_response",
    [],
    "Will I be paid?",
    "quest_meet_spy_in_enemy_town_accepted_4",
    []],

  [anyone, "quest_meet_spy_in_enemy_town_accepted_4",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Of course, I have plenty of silver in my coffers for loyal {reg18?women:men} like you. Do well by me, {playername}, and you'll rise high.",
    "quest_meet_spy_in_enemy_town_accepted_response",
    []],

  [plyr|anyone, "quest_meet_spy_in_enemy_town_accepted_response",
    [],
    "I know what to do. Farewell, my lord.",
    "quest_meet_spy_in_enemy_town_accepted_end",
    []],

  [anyone, "quest_meet_spy_in_enemy_town_accepted_end",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 10),
      (store_sub, ":var1", ":var0", "str_secret_sign_1"),
      (val_add, ":var1", "str_countersign_1"),
      (str_store_string, s11, ":var0"),
      (str_store_string, s12, ":var1"),
    ],
    "Good luck, {playername}. Remember, the secret phrase is '{s11}' The counterphrase is '{s12}' Bring any reports back to me, and I'll compensate you for your trouble.",
    "lord_pretalk",
    []],

  [anyone, "quest_meet_spy_in_enemy_town_rejected",
    [],
    "As you wish, {playername}, but I strongly advise you to forget anything I told you about any spies. They do not exist, have never existed, and no one will ever find them. Remember that.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_raid_caravan_to_start_war"),
      (neg|is_between, "$g_talk_troop", "trp_knight_5_1", "trp_knight_1_1_wife"),
      (quest_get_slot, ":var0", "$random_quest_no", 3),
      (str_store_faction_name_link, s13, ":var0"),
    ],
    "I can't stand being at peace with {s13}, {playername}. We've let those shitheads have their way for far too long. They're starting to piss me off with their arrogance. We gotta get to shooting them before it's too late. Unfortunately, some of the bleeding hearts among our commanders are blocking us from declaring war. Buncha cowards.",
    "lord_mission_told_raid_caravan_to_start_war",
    []],

  [plyr|anyone, "lord_mission_told_raid_caravan_to_start_war",
    [],
    "You're right, {s65}, but what can we do?",
    "lord_mission_tell_raid_caravan_to_start_war_2",
    []],

  [plyr|anyone, "lord_mission_told_raid_caravan_to_start_war",
    [],
    "They ain't done anything to me.",
    "quest_raid_caravan_to_start_war_rejected_1",
    []],

  [anyone, "lord_mission_tell_raid_caravan_to_start_war_2",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 3),
      (str_store_faction_name_link, s13, ":var0"),
    ],
    "Ah, it's good to hear someone who understands! As a matter of fact, there is something we can do, {playername}. A little bit of provocation. The dogs in {s13} are very fond of their carriages, and rely on them heavily. If one of our war parties managed to enter their territory and ambush some of their carriages, they would have ample cause to declare war on us. And then, well, even the cowards among us must rise to defend themselves. So what do you say? Are you interested?",
    "lord_mission_tell_raid_caravan_to_start_war_3",
    []],

  [plyr|anyone, "lord_mission_tell_raid_caravan_to_start_war_3",
    [],
    "An excellent plan. Count me in.",
    "quest_raid_caravan_to_start_war_accepted",
    []],

  [plyr|anyone, "lord_mission_tell_raid_caravan_to_start_war_3",
    [],
    "Why don't you raid the carriages yourself?",
    "lord_mission_tell_raid_caravan_to_start_war_4",
    []],

  [anyone, "lord_mission_tell_raid_caravan_to_start_war_4",
    [],
    "Well, {playername}, some of the commanders in our army won't like the idea of someone inciting a war without their consent. They are already looking for an excuse to get at me, and if I did this they could make me pay for it dearly. You, on the other hand, are young and well liked and daring, so you might just get away with it. And of course I will back you up and defend your actions against your opponents. All in all, a few captains might be upset at your endeavour, but I am sure you won't be bothered with that.",
    "lord_mission_tell_raid_caravan_to_start_war_5",
    []],

  [plyr|anyone, "lord_mission_tell_raid_caravan_to_start_war_5",
    [],
    "Then I'll go and raid those carriages!",
    "quest_raid_caravan_to_start_war_accepted",
    []],

  [plyr|anyone, "lord_mission_tell_raid_caravan_to_start_war_5",
    [],
    "I don't like this. Find yourself someone else to take the blame for your schemes.",
    "quest_raid_caravan_to_start_war_rejected_2",
    []],

  [anyone, "quest_raid_caravan_to_start_war_accepted",
    [],
    "Very good! Now, don't forget that you must capture and loot at least {reg13} carriages to make sure that those fools in {s13} get really infuriated. Once you do that, return to me and make sure you're not captured by their patrols. If they catch you, our plan will fail without a doubt and you will be facing a long time in prison. Now, good luck and good hunting to you.",
    "close_window",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 3),
      (quest_get_slot, ":var1", "$random_quest_no", 10),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_faction_name_link, s13, ":var0"),
      (assign, reg13, ":var1"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to capture and loot {reg13} carriages so as to provoke a war with {s13}."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 5),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "quest_raid_caravan_to_start_war_rejected_1",
    [],
    "Hah. It's only a matter of time before this peace is shattered.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "quest_raid_caravan_to_start_war_rejected_2",
    [],
    "Hm. As you wish, {playername}. I thought you had some fire in you, but I guess I was wrong.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_bring_back_runaway_serfs"),
    ],
    "Well, some of the serfs working my fields in {s4} have run away. The ungrateful swine, I let them plough my fields and rent my cottages, and this is how they repay me! From what I've been hearing, they're running to {s3} as fast as they can, and have split up into three groups to try and avoid capture. I want you to capture all three groups and fetch them back to {s4} by whatever means necessary. I should really have them hanged for attempting to escape, but we need hands for the upcoming harvest, so I'll let them go off this time with a good beating.",
    "lord_mission_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (quest_get_slot, ":var1", "$random_quest_no", 7),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s3, ":var0"),
      (str_store_party_name_link, s4, ":var1"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to catch the three groups of runaway serfs and bring them back to {s4}, alive and breathing. He said that all three groups are heading towards {s3}."),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_follow_spy"),
    ],
    "I have good information that a man in this very town is actually an enemy spy. He should be seized and hanged for his impudence, but we also believe that very soon he will leave town to meet with his master, the man to whom the spy feeds all his little whispers. The spy himself is of little import, but the master is a dangerous man, and could tell us a great deal if we could only get our hands on him...",
    "lord_tell_mission_follow_spy",
    []],

  [anyone, "lord_tell_mission_follow_spy",
    [],
    "I want you to wait here until the spy leaves town. Then you must follow him, stealthily, to the meeting place. You must take absolute care not to be seen by the spy on your way, else he may suspect foul play and turn back. When the master appears, you must ambush and arrest them and bring the pair back to me. Alive, if you please.",
    "lord_tell_mission_follow_spy_2",
    []],

  [plyr|anyone, "lord_tell_mission_follow_spy_2",
    [],
    "I'll do it, {s65}.",
    "lord_tell_mission_follow_spy_accepted",
    []],

  [plyr|anyone, "lord_tell_mission_follow_spy_2",
    [],
    "This kind of work sounds too delicate for me.",
    "lord_tell_mission_follow_spy_rejected",
    []],

  [anyone, "lord_tell_mission_follow_spy_accepted",
    [],
    "Good, I'm sure you'll do a fine job of it. One of my men will point the spy out to you when he leaves, so you will know the man to follow. Remember, I want them both, and I want them alive.",
    "close_window",
    [
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_party_name_link, s12, "$g_encountered_party"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to follow the spy that will leave {s12}. Be careful not to let the spy see you on the way, or he may get suspicious and turn back. Once the spy meets with his accomplice, you are to capture them and bring them back to {s11}."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (spawn_around_party, "p_main_party", "pt_spy_partners"),
      (assign, "$qst_follow_spy_spy_partners_party", reg0),
      (party_set_position, "$qst_follow_spy_spy_partners_party", pos63),
      (party_set_ai_behavior, "$qst_follow_spy_spy_partners_party", ai_bhvr_hold),
      (party_set_flags, "$qst_follow_spy_spy_partners_party", 65536, 0),
      (set_spawn_radius, 0),
      (spawn_around_party, "$g_encountered_party", "pt_spy"),
      (assign, "$qst_follow_spy_spy_party", reg0),
      (party_set_ai_behavior, "$qst_follow_spy_spy_party", ai_bhvr_travel_to_party),
      (party_set_ai_object, "$qst_follow_spy_spy_party", "$qst_follow_spy_spy_partners_party"),
      (party_set_flags, "$qst_follow_spy_spy_party", 65536, 0),
      (assign, "$g_leave_town", 1),
      (rest_for_hours, 2, 4, 0),
    ]],

  [anyone, "lord_tell_mission_follow_spy_rejected",
    [],
    "A shame. Well, carry on as you were, {playername}...",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_capture_enemy_hero"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "There is a difficult job I need done, {playername}, and you may be the {reg18?women:men} who can pull it off. I need someone to capture one of the officers of {s13} and bring him to me. Afterwards, I'll be able to exchange him in return for a relative of mine held by {s13}. It is a simple enough job, but whomever you choose will be heavily guarded. Are you up for a fight?",
    "lord_tell_mission_capture_enemy_hero",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 3),
      (str_store_faction_name, s13, ":var0"),
    ]],

  [plyr|anyone, "lord_tell_mission_capture_enemy_hero",
    [],
    "Consider it done, {s65}.",
    "lord_tell_mission_capture_enemy_hero_accepted",
    []],

  [plyr|anyone, "lord_tell_mission_capture_enemy_hero",
    [],
    "I can't do it, {s65}. I'm not a kidnapper.",
    "lord_tell_mission_capture_enemy_hero_rejected",
    []],

  [anyone, "lord_tell_mission_capture_enemy_hero_accepted",
    [],
    "I like your spirit! Go and bring me one of our enemies, and I'll toast your name in the saloon when you return! And reward you for your efforts, of course...",
    "close_window",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 3),
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_faction_name_link, s13, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to capture a commanding officer from {s13}, any noble, and then drag your victim back to {s11} for safekeeping."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_tell_mission_capture_enemy_hero_rejected",
    [],
    "I guess you don't have the balls for this, {playername}. I'll find someone who does.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_lend_companion"),
    ],
    "I don't have a job for you right now, but your companion {s3} is a skilled {reg18?lass:fellow} and I need someone with {reg18?her:his} talents. Will you lend {reg18?her:him} to me for a while?",
    "lord_tell_mission_lend_companion",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (quest_get_slot, ":var1", "$random_quest_no", 10),
      (val_add, ":var1", 1),
      (assign, reg1, ":var1"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name, s3, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (troop_get_type, reg3, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
      (str_store_string, s2, "@{s9} asked you to lend your companion {s3} to him for a week."),
    ]],

  [plyr|anyone, "lord_tell_mission_lend_companion",
    [],
    "How long will you be needing {reg18?her:him}?",
    "lord_tell_mission_lend_companion_2",
    []],

  [anyone, "lord_tell_mission_lend_companion_2",
    [],
    "Just a few days; a week at most.",
    "lord_mission_lend_companion_told",
    []],

  [plyr|anyone, "lord_mission_lend_companion_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (str_store_troop_name, s3, ":var0"),
    ],
    "Then I will leave {s3} with you for one week.",
    "lord_tell_mission_lend_companion_accepted",
    []],

  [plyr|anyone, "lord_mission_lend_companion_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (str_store_troop_name, s3, ":var0"),
    ],
    "I'm sorry, but I can't do without {s3} for a whole week.",
    "lord_tell_mission_lend_companion_rejected",
    []],

  [anyone, "lord_tell_mission_lend_companion_accepted",
    [],
    "I can't thank you enough, {playername}. Don't worry; your companion will be returned quickly.",
    "close_window",
    [
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (party_remove_members, "p_main_party", ":var0", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_tell_mission_lend_companion_rejected",
    [],
    "Well, that's damned unfortunate, but I suppose I cannot force you or {s3} to agree. I shall have to make do without.",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_collect_debt"),
    ],
    "A while ago, I loaned out a bunch of money to {s3}. {reg4} cents, actually. He was supposed to pay it back within a month but I haven't received a penny from him since. That was months ago. If you could collect the debt from him on my behalf, I'd be very grateful. I'd even let you keep one fifth of the money for your trouble. What do you say?",
    "lord_tell_mission_collect_debt",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (quest_get_slot, ":var1", "$random_quest_no", 1),
      (quest_get_slot, reg4, "$random_quest_no", 10),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name_link, s3, ":var0"),
      (str_store_party_name_link, s4, ":var1"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} asked you to collect the debt of {reg4} cents {s3} owes to him. {s3} was at {s4} when you were given this quest."),
    ]],

  [plyr|anyone, "lord_tell_mission_collect_debt",
    [],
    "Do you know where I can find {s3}, {s65}?",
    "lord_tell_mission_collect_debt_2",
    []],

  [anyone, "lord_tell_mission_collect_debt_2",
    [],
    "If you leave now, you should be able to find him at {s4}. I'm sure it won't take much convincing to get the money out of him.",
    "lord_tell_mission_collect_debt_3",
    []],

  [plyr|anyone, "lord_tell_mission_collect_debt_3",
    [],
    "Then I'll talk to {s3} on your behalf.",
    "lord_tell_mission_collect_debt_accepted",
    []],

  [plyr|anyone, "lord_tell_mission_collect_debt_3",
    [],
    "I really don't think I'd be able to help.",
    "lord_tell_mission_collect_debt_rejected",
    []],

  [anyone, "lord_tell_mission_collect_debt_accepted",
    [],
    "Thank you, {playername}. Please, talk to {s3} and don't leave him without my money.",
    "close_window",
    [
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "lord_tell_mission_collect_debt_rejected",
    [],
    "Yeah, I guess you're right, {playername}. I'm never getting that money back...",
    "lord_pretalk",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_incriminate_loyal_commander"),
      (quest_get_slot, ":var0", "qst_incriminate_loyal_commander", 2),
      (quest_get_slot, ":var1", "qst_incriminate_loyal_commander", 4),
      (quest_get_slot, ":var2", "qst_incriminate_loyal_commander", 1),
      (str_store_troop_name_link, s13, ":var0"),
      (str_store_party_name_link, s14, ":var2"),
      (str_store_troop_name_link, s15, ":var1"),
    ],
    "I tell you, that blubbering fool {s13} is not fit to lead the army of {s14}. God knows he would be killed in first battle in an instant were it not for his loyal officers, {s15}. As long as he has his captains aiding him, it will be a difficult job beating him. So I need to get {s15} out of the picture, and I have a plan just to do that... With your help, naturally.",
    "lord_tell_mission_incriminate_commander",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander",
    [],
    "{s66}, I am all ears.",
    "lord_tell_mission_incriminate_commander_2",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander",
    [],
    "I don't wish to involve myself in anything dishonourable against {s15}.",
    "lord_tell_mission_incriminate_commander_rejected",
    []],

  [anyone, "lord_tell_mission_incriminate_commander_rejected",
    [],
    "Dishonourable? Bah! I was hoping I could count on you, {playername}, but you've shown me what a fool I was. I shall have to find someone whose loyalty I can trust.",
    "lord_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -5),
      (call_script, "script_change_player_honor", 2),
    ]],

  [anyone, "lord_tell_mission_incriminate_commander_2",
    [],
    "I have written a fake letter to {s15}, bearing my own seal, which implicates him in a conspiracy with us to stage a coup in {s14}, in my favour. If we can make {s13} believe the letter is genuine, he will deal with {s15} very swiftly. Of course, the challenge there is to convince {s13} that the letter is indeed real...",
    "lord_tell_mission_incriminate_commander_3",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander_3",
    [],
    "Please continue, {s65}...",
    "lord_tell_mission_incriminate_commander_4",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander_3",
    [],
    "No, I will not sully myself with this incriminal scheme.",
    "lord_tell_mission_incriminate_commander_rejected",
    []],

  [anyone, "lord_tell_mission_incriminate_commander_4",
    [],
    "This is where you come into play. You'll take the letter to {s14}, then give it to one of your trusted soldiers and instruct him to take it to {s15}. I will have one of my spies inform the town garrison so that your man will be arrested on his way. The guards will then find the letter and take it to {s13}. They'll interrogate your man, of course, to try and get the truth out of him, but all he knows is that you ordered the letter to be delivered to {s15} under the utmost secrecy. {s13} knows you serve me, and the fool will certainly believe the whole charade.",
    "lord_tell_mission_incriminate_commander_5",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander_5",
    [],
    "Is that all?",
    "lord_tell_mission_incriminate_commander_7",
    []],

  [anyone, "lord_tell_mission_incriminate_commander_7",
    [
      (str_store_troop_name, s8, "$incriminate_quest_sacrificed_troop"),
      (str_store_troop_name_plural, s9, "$incriminate_quest_sacrificed_troop"),
    ],
    "There is one more thing... Your messenger must be someone trustworthy. If you sent the letter with a lowly private, someone expendable, {s13} might suspect a plot. He may have the wits of a snail, but even a snail can see the obvious. Give the letter to someone of rank. One of your {s9}, perhaps.",
    "lord_tell_mission_incriminate_commander_8",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander_8",
    [],
    "What? I can't send one of my trusted {s9} to his death!",
    "lord_tell_mission_incriminate_commander_9",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander_8",
    [],
    "Then a {s8} it will be.",
    "lord_tell_mission_incriminate_commander_fin",
    []],

  [anyone, "lord_tell_mission_incriminate_commander_9",
    [],
    "Come now, {playername}. There is a place for sentimentality, but this is not it. Believe me, you shall be generously compensated, and what is the purpose of soldiers if not to die at our say-so?",
    "lord_tell_mission_incriminate_commander_10",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander_10",
    [],
    "A {s8} it is.",
    "lord_tell_mission_incriminate_commander_fin",
    []],

  [plyr|anyone, "lord_tell_mission_incriminate_commander_10",
    [],
    "No, I'll not sacrifice one of my chosen men.",
    "lord_tell_mission_incriminate_commander_rejected",
    []],

  [anyone, "lord_tell_mission_incriminate_commander_fin",
    [],
    "I can't tell you how pleased I am to hear that, {playername}. You are removing one of the greatest obstacles in my path. Here is the letter, as well as three dollars for your expenses. Remember, there'll be more once you succeed. Much, much more...",
    "lord_pretalk",
    [
      (quest_get_slot, ":var0", "qst_incriminate_loyal_commander", 2),
      (quest_get_slot, ":var1", "qst_incriminate_loyal_commander", 4),
      (quest_get_slot, ":var2", "qst_incriminate_loyal_commander", 1),
      (call_script, "script_troop_add_gold", "trp_player", 300),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
      (str_store_troop_name_link, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":var0"),
      (str_store_party_name_link, s14, ":var2"),
      (str_store_troop_name_plural, s15, "$incriminate_quest_sacrificed_troop"),
      (str_store_troop_name_link, s16, ":var1"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} gave you a fake letter to fool {s13} into banishing his officer {s16}. You are to go near {s14}, give the letter to one of your {s15} and send him into the town as a messenger, believing his orders to be genuine."),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_capture_prisoners"),
    ],
    "A group of my soldiers were captured in a recent skirmish with the enemy. Thankfully we have a mutual agreement of prisoner exchange, and they will release my men, but they want us to give them prisoners of equal rank and number. Prisoners I don't currently have. I need a reliable man to find me {reg1} {s3} as prisoners so that I may exchange them.",
    "lord_mission_told",
    [
      (quest_get_slot, ":var0", "qst_capture_prisoners", 2),
      (quest_get_slot, ":var1", "qst_capture_prisoners", 10),
      (assign, reg1, ":var1"),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name_by_count, s3, ":var0", ":var1"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} has requested you to bring him {reg1} {s3} as prisoners."),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_bring_back_deserters"),
    ],
    "I am worried about the growing number of deserters. If we don't do something about it, we may soon have noone left to fight in our wars. I just had {reg1} {s3} escaped my army. I would ask you to hang the bastards but we are short of men and we need them back in the ranks.",
    "lord_mission_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 10),
      (quest_get_slot, ":var1", "$random_quest_no", 2),
      (store_random_in_range, ":var2", 15, 21),
      (set_spawn_radius, ":var2"),
      (spawn_around_party, "$g_encountered_party", "pt_deserters"),
      (assign, ":var3", reg0),
      (party_add_members, ":var3", ":var1", ":var0"),
      (party_set_flags, reg0, 262144, 1),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_troop_name_plural, s3, ":var1"),
      (assign, reg1, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s9} has requested you to bring back {reg1} {s3} as prisoners."),
    ]],

  [anyone, "lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_hideout2"),
      (ge, "$g_talk_troop_faction_relation", 10),
      (is_between, "$g_talk_troop", "trp_knight_5_1", "trp_knight_1_1_wife"),
      (neg|check_quest_active, "qst_hideout"),
    ],
    "I have a very important mission in mind. Our main hideout has beed discovered and reported to a local Deputy Sheriff. I have information that he's leading his militia to ransack the place. I will need every man I can trust to defend the hideout. We can't let some obnoxious lawman overrun our precious operation!",
    "lord_mission_told",
    [
      (party_set_flags, "p_target", 256, 0),
      (party_set_flags, "p_target", 262144, 1),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s13, "$g_encountered_party"),
      (str_store_party_name, s4, "$g_encountered_party"),
      (setup_quest_text, "qst_hideout2"),
      (str_store_string, s2, "@{s9} has asked you to defend the hideout from the Sheriff and his men."),
    ]],

  [anyone, "lord_tell_mission",
    [],
    "No, {playername}. I don't need your help right now.",
    "lord_pretalk",
    []],

  [plyr|anyone, "lord_mission_told",
    [],
    "You can count on me, {s65}.",
    "lord_mission_accepted",
    []],

  [plyr|anyone, "lord_mission_told",
    [],
    "Can't do it. Sorry, boss.",
    "lord_mission_rejected",
    []],

  [anyone, "lord_mission_accepted",
    [],
    "Excellent, {playername}. Good luck.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (try_begin),
        (eq, "$random_quest_no", "qst_escort_lady"),
        (quest_get_slot, ":var0", "$random_quest_no", 4),
        (troop_set_slot, ":var0", 12, 0),
        (troop_join, ":var0"),
      (else_try),
        (eq, "$random_quest_no", "qst_deliver_message_to_enemy_lord"),
        (call_script, "script_troop_add_gold", "trp_player", 10),
      (else_try),
        (eq, "$random_quest_no", "qst_bring_back_runaway_serfs"),
        (quest_get_slot, ":var1", "$random_quest_no", 12),
        (quest_get_slot, ":var2", "$random_quest_no", 1),
        (quest_get_slot, ":var3", "$random_quest_no", 9),
        (set_spawn_radius, 3),
        (spawn_around_party, ":var1", ":var3"),
        (assign, "$qst_bring_back_runaway_serfs_party_1", reg0),
        (party_set_ai_behavior, "$qst_bring_back_runaway_serfs_party_1", ai_bhvr_travel_to_party),
        (party_set_ai_object, "$qst_bring_back_runaway_serfs_party_1", ":var2"),
        (party_set_flags, "$qst_bring_back_runaway_serfs_party_1", 65536, 0),
        (spawn_around_party, ":var1", ":var3"),
        (assign, "$qst_bring_back_runaway_serfs_party_2", reg0),
        (party_set_ai_behavior, "$qst_bring_back_runaway_serfs_party_2", ai_bhvr_travel_to_party),
        (party_set_ai_object, "$qst_bring_back_runaway_serfs_party_2", ":var2"),
        (party_set_flags, "$qst_bring_back_runaway_serfs_party_2", 65536, 0),
        (spawn_around_party, ":var1", ":var3"),
        (assign, "$qst_bring_back_runaway_serfs_party_3", reg0),
        (party_set_ai_behavior, "$qst_bring_back_runaway_serfs_party_3", ai_bhvr_travel_to_party),
        (party_set_ai_object, "$qst_bring_back_runaway_serfs_party_3", ":var2"),
        (party_set_flags, "$qst_bring_back_runaway_serfs_party_3", 65536, 0),
        (rest_for_hours, 1, 4),
      (try_end),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (try_begin),
        (eq, "$random_quest_no", "qst_lend_surgeon"),
        (assign, "$g_leave_town_outside", 1),
        (assign, "$auto_enter_town", "$g_encountered_party"),
        (rest_for_hours, 4),
        (assign, "$lord_requested_to_talk_to", "$g_talk_troop"),
      (try_end),
    ]],

  [anyone, "lord_mission_rejected",
    [],
    "I guess you're not as capable as I thought.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (try_begin),
        (quest_slot_eq, "$random_quest_no", 25, 0),
        (quest_set_slot, "$random_quest_no", 25, 1),
      (try_end),
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [plyr|anyone, "lord_talk",
    [
      (troop_slot_ge, "$g_talk_troop", 8, 0),
    ],
    "I have to leave now. Good-bye.",
    "lord_leave_prison",
    []],

  [plyr|anyone, "lord_talk",
    [
      (lt, "$g_talk_troop_faction_relation", 0),
    ],
    "I'm done talking to you. Good-bye.",
    "lord_leave",
    []],

  [plyr|anyone, "lord_talk",
    [
      (ge, "$g_talk_troop_faction_relation", 0),
    ],
    "I have to leave now. Good-bye.",
    "lord_leave",
    []],

  [anyone, "lord_leave",
    [
      (neg|troop_slot_ge, "$g_talk_troop", 8, 0),
      (lt, "$g_talk_troop_faction_relation", 0),
      (store_partner_quest, ":var0"),
      (lt, ":var0", 0),
      (troop_slot_eq, "$g_talk_troop", 20, 0),
      (call_script, "script_get_random_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0),
      (ge, "$random_quest_no", 0),
    ],
    "Before you go, {playername}, I have something to ask of you... We may be enemies in this war, but I pray that you believe, as I do, that we can still be civil towards each other. Thus I hoped that you would be kind enough to assist me in something important to me.",
    "lord_leave_give_quest",
    []],

  [plyr|anyone, "lord_leave_give_quest",
    [],
    "I am listening.",
    "enemy_lord_tell_mission",
    []],

  [anyone, "enemy_lord_tell_mission",
    [
      (eq, "$random_quest_no", "qst_lend_surgeon"),
    ],
    "I have a friend here, an old tough veteran, who is very sick. Pestilence has infected an old battle wound, and unless he is seen to by a surgeon soon,  he will surely die. This man is dear to me, {playername}, but he's also stubborn as a hog and refuses to have anyone look at his injury because he doesn't trust the physicians here. I have heard that you've a capable surgeon with you. If you would let your surgeon come here and have a look, {reg18?she:he} may be able to convince him to give his consent to an operation. Please, I will be deeply indebted to you if you grant me this request.",
    "lord_mission_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 4),
      (str_store_troop_name_link, s1, "$g_talk_troop"),
      (str_store_troop_name, s3, ":var0"),
      (troop_get_type, reg3, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@Lend your experienced surgeon {s3} to {s1}."),
    ]],

  [anyone, "enemy_lord_tell_mission",
    [
      (str_store_quest_name, s7, "$random_quest_no"),
    ],
    "ERROR: MATCHED WITH QUEST: {s7}.",
    "close_window",
    []],

  [anyone, "lord_leave_prison",
    [],
    "We'll meet again.",
    "close_window",
    []],

  [auto_proceed|anyone, "lord_leave",
    [
      (faction_slot_eq, "$g_talk_troop_faction", 10, "$g_talk_troop"),
    ],
    "Alright, {playername}. Farewell.",
    "close_window",
    [
      (eq, "$talk_context", 2),
      (assign, "$g_leave_encounter", 1),
    ]],

  [auto_proceed|anyone, "lord_leave",
    [
      (ge, "$g_talk_troop_relation", 10),
    ],
    "Nice seeing you, {playername}.",
    "close_window",
    [
      (eq, "$talk_context", 2),
      (assign, "$g_leave_encounter", 1),
    ]],

  [auto_proceed|anyone, "lord_leave",
    [
      (ge, "$g_talk_troop_faction_relation", 0),
    ],
    "Good-bye.",
    "close_window",
    [
      (eq, "$talk_context", 2),
      (assign, "$g_leave_encounter", 1),
    ]],

  [auto_proceed|anyone, "lord_leave",
    [],
    "We'll meet again, I'm sure.",
    "close_window",
    [
      (eq, "$talk_context", 2),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "member_chat",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
    ],
    "Are you enjoying the journey, {s65}?",
    "lady_journey_1",
    []],

  [anyone, "lady_journey_1",
    [],
    "I am doing quite fine, {playername}. Thank you for your concern.",
    "close_window",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
      (check_quest_active, "qst_duel_for_lady"),
      (check_quest_succeeded, "qst_duel_for_lady"),
      (quest_slot_eq, "qst_duel_for_lady", 6, "$g_talk_troop"),
      (le, "$talk_context", 4),
      (quest_get_slot, ":var0", "qst_duel_for_lady", 2),
      (str_store_troop_name_link, s13, ":var0"),
    ],
    "My dear {playername}, how joyous to see you again! I heard you gave that vile {s13} a well-deserved lesson. I hope he never forgets his humiliation. I've a reward for you, but I fear it's little compared to what you've done for me.",
    "lady_qst_duel_for_lady_succeeded_1",
    []],

  [plyr|anyone, "lady_qst_duel_for_lady_succeeded_1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Oh, it will just have to do.",
    "lady_qst_duel_for_lady_succeeded_2",
    [
      (str_store_string, s10, "@Then take it, with my eternal thanks. You are a noble {reg18?woman:man}. I will never forget that you helped me in my time of need."),
    ]],

  [plyr|anyone, "lady_qst_duel_for_lady_succeeded_1",
    [],
    "{s66}, this is far too much!",
    "lady_qst_duel_for_lady_succeeded_2",
    [
      (str_store_string, s10, "@Forgive me, {playername}, but I must insist you accept it. The money means little to me, and I owe you so much. Here, take it, and let us speak no more of this."),
      (call_script, "script_change_player_honor", 1),
    ]],

  [plyr|anyone, "lady_qst_duel_for_lady_succeeded_1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Please, {s65}, no reward is necessary.",
    "lady_qst_duel_for_lady_succeeded_2",
    [
      (str_store_string, s10, "@{playername}, what a dear {reg18?woman:man} you are, but I will not allow you to refuse this. I owe you far more than I can say, and I am sure you can put this money to far better use than I."),
      (call_script, "script_change_player_honor", 2),
    ]],

  [anyone, "lady_qst_duel_for_lady_succeeded_2",
    [],
    "{s10}",
    "lady_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 10),
      (add_xp_as_reward, 1000),
      (call_script, "script_troop_add_gold", "trp_player", 2000),
      (call_script, "script_end_quest", "qst_duel_for_lady"),
    ]],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
      (check_quest_active, "qst_duel_for_lady"),
      (check_quest_failed, "qst_duel_for_lady"),
      (quest_slot_eq, "qst_duel_for_lady", 6, "$g_talk_troop"),
      (le, "$talk_context", 4),
      (quest_get_slot, ":var0", "qst_duel_for_lady", 2),
      (str_store_troop_name_link, s13, ":var0"),
    ],
    "I was told that you sought satisfaction from {s13} to prove my innocence, {playername}. It was a fine gesture, and I thank you for your efforts.",
    "lady_qst_duel_for_lady_failed",
    []],

  [plyr|anyone, "lady_qst_duel_for_lady_failed",
    [],
    "I beg your forgiveness for my defeat, {s65}...",
    "lady_qst_duel_for_lady_failed_2",
    []],

  [anyone, "lady_qst_duel_for_lady_failed_2",
    [],
    "It matters not, dear {playername}. You tried. The truth cannot be proven at the point of a gun, but you willingly put your life at stake for my honour. That alone will convince many of my innocence.",
    "lady_pretalk",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 6),
      (add_xp_as_reward, 400),
      (call_script, "script_end_quest", "qst_duel_for_lady"),
    ]],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
      (check_quest_active, "qst_escort_lady"),
      (eq, "$talk_context", 10),
      (quest_slot_eq, "qst_escort_lady", 4, "$g_talk_troop"),
    ],
    "Thank you for escorting me here, {playername}. Please accept this gift as a token of my gratitude. I hope we shall meet again sometime in the future.",
    "lady_escort_lady_succeeded",
    [
      (quest_get_slot, ":var0", "qst_escort_lady", 1),
      (add_xp_as_reward, 300),
      (call_script, "script_troop_add_gold", "trp_player", 250),
      (call_script, "script_end_quest", "qst_escort_lady"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (troop_set_slot, "$g_talk_troop", 12, ":var0"),
      (remove_member_from_party, "$g_talk_troop"),
    ]],

  [plyr|anyone, "lady_escort_lady_succeeded",
    [],
    "It was an honor to serve you, {s65}.",
    "close_window",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
      (le, "$talk_context", 4),
      (check_quest_active, "qst_rescue_lord_by_replace"),
      (check_quest_succeeded, "qst_rescue_lord_by_replace"),
      (quest_slot_eq, "qst_rescue_lord_by_replace", 6, "$g_talk_troop"),
      (troop_get_slot, ":var0", "$g_talk_troop", 31),
      (try_begin),
        (gt, ":var0", 0),
        (str_store_string, s17, "str_father"),
      (else_try),
        (str_store_string, s17, "str_husband"),
      (try_end),
    ],
    "Oh, {playername}, you brought him back to me! Thank you ever so much for rescuing my {s17}. Please, take this as some small repayment for your noble deed.",
    "lady_generic_mission_succeeded",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 8),
      (add_xp_as_reward, 2000),
      (call_script, "script_troop_add_gold", "trp_player", 1500),
      (call_script, "script_end_quest", "qst_rescue_lord_by_replace"),
    ]],

  [plyr|anyone, "lady_generic_mission_succeeded",
    [],
    "Always an honour to serve, {s65}.",
    "lady_pretalk",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
      (eq, "$g_talk_troop_met", 0),
      (le, "$talk_context", 4),
    ],
    "I say, you don't look familiar...",
    "lady_premeet",
    []],

  [plyr|anyone, "lady_premeet",
    [],
    "I am {playername}.",
    "lady_meet",
    []],

  [plyr|anyone, "lady_premeet",
    [],
    "My name is {playername}. At your service.",
    "lady_meet",
    []],

  [anyone, "lady_meet",
    [],
    "{playername}? I do not believe I've heard of you before.",
    "lady_meet_end",
    []],

  [anyone, "lady_meet_end",
    [],
    "Can I help you with anything?",
    "lady_talk",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 4),
      (le, "$talk_context", 4),
    ],
    "Yes?",
    "lady_talk",
    []],

  [anyone, "lady_pretalk",
    [],
    "Anything else?",
    "lady_talk",
    []],

  [plyr|anyone, "lady_talk",
    [
      (store_partner_quest, ":var0"),
      (lt, ":var0", 0),
    ],
    "Is there anything I can do to win your favour?",
    "lady_ask_for_quest",
    [
      (call_script, "script_get_random_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0),
    ]],

  [anyone, "lady_ask_for_quest",
    [
      (troop_slot_eq, "$g_talk_troop", 20, 1),
    ],
    "I don't have anything else for you to do right now.",
    "lady_pretalk",
    []],

  [anyone, "lady_ask_for_quest",
    [
      (eq, "$random_quest_no", "qst_rescue_lord_by_replace"),
    ],
    "Oh, I fear I may never see my {s17}, {s13}, again... He is a prisoner in the dungeon of {s14}. We have tried to negotiate his ransom, but it has been set too high. We can never hope to raise that much money without selling everything we own, and God knows {s13} would rather spend his life in prison than make us destitute. Instead I came up with a plan to get him out of there, but it requires someone to make a great sacrifice, and so far my pleas have fallen on deaf ears...",
    "lady_mission_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (quest_get_slot, ":var1", "$random_quest_no", 2),
      (try_begin),
        (troop_get_slot, ":var2", "$g_talk_troop", 30),
        (gt, ":var2", 0),
        (str_store_string, s17, "str_husband"),
      (else_try),
        (str_store_string, s17, "str_father"),
      (try_end),
      (str_store_troop_name, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":var1"),
      (str_store_party_name_link, s14, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to rescue her {s17}, {s13}, from {s14} by switching clothes and taking his place in prison."),
    ]],

  [anyone, "lady_ask_for_quest",
    [
      (eq, "$random_quest_no", "qst_deliver_message_to_prisoner_lord"),
    ],
    "My poor {s17}, {s13}, is a prisoner in the {s14} dungeons. The only way we can talk to each other is by exchanging letters whenever we can, but the journey is so dangerous that we get little chance to do so. Please, would you deliver one for me?",
    "lady_mission_told",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (quest_get_slot, ":var1", "$random_quest_no", 2),
      (try_begin),
        (troop_get_slot, ":var2", "$g_talk_troop", 30),
        (gt, ":var2", 0),
        (str_store_string, s17, "str_husband"),
      (else_try),
        (str_store_string, s17, "str_father"),
      (try_end),
      (str_store_troop_name, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":var1"),
      (str_store_party_name_link, s14, ":var0"),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@{s11} asked you to deliver a message to {s13}, who is imprisoned at {s14}."),
    ]],

  [anyone, "lady_ask_for_quest",
    [
      (eq, "$random_quest_no", "qst_duel_for_lady"),
    ],
    "Dear {playername}, you are kind to ask, but you know little of my troubles and I can't possibly ask you to throw yourself into danger on my behalf.",
    "lady_quest_duel_for_lady",
    []],

  [plyr|anyone, "lady_quest_duel_for_lady",
    [],
    "Tell me what the problem is, and I can make my own decision.",
    "lady_quest_duel_for_lady_2",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (str_store_troop_name, s11, "$g_talk_troop"),
      (str_store_troop_name_link, s13, ":var0"),
      (str_store_string, s2, "@You agreed to challenge {s13} to defend {s11}'s honour."),
      (setup_quest_text, "$random_quest_no"),
    ]],

  [anyone, "lady_quest_duel_for_lady_2",
    [],
    "Very well, as you wish it... My husband has made certain enemies in his life, {playername}. One of the most insidious is {s13}. He is going around making terrible accusations against me, impugning my honour at every turn! Because he cannot harm my husband directly, he is using me as a target to try and stain our name. You should hear the awful things he's said! I only wish there was someone brave enough to make him recant his slander, but {s13} is a very fierce warrior, and he's widely feared...",
    "lady_quest_duel_for_lady_3",
    []],

  [plyr|anyone, "lady_quest_duel_for_lady_3",
    [],
    "I fear him not, {s65}. I will make him take back his lies.",
    "lady_quest_duel_for_lady_3_accepted",
    []],

  [anyone, "lady_quest_duel_for_lady_3_accepted",
    [],
    "Oh! I can't ask that of you, {playername}, but... I would be forever indebted to you, and you are so sure. It would mean so much if you would defend my honour. Thank you a thousand times, all my prayers and my favour go with you.",
    "close_window",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 2),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
      (call_script, "script_report_quest_troop_positions", "$random_quest_no", ":var0", 3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 3),
    ]],

  [plyr|anyone, "lady_quest_duel_for_lady_3",
    [],
    "If he's that dangerous, perhaps maybe it would be better to ignore him...",
    "lady_quest_duel_for_lady_3_rejected",
    []],

  [anyone, "lady_quest_duel_for_lady_3_rejected",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Oh... Perhaps you're right, {playername}. I should let go of these silly childhood ideas of chivalry and courage. {reg18?People:Men} are not like that, not anymore. Good day to you.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
    ]],

  [anyone, "lady_ask_for_quest",
    [],
    "No, {playername}, I've no need for a champion right now.",
    "lady_pretalk",
    []],

  [plyr|anyone, "lady_mission_told",
    [],
    "As you wish it, {s65}, it shall be done.",
    "lady_mission_accepted",
    []],

  [plyr|anyone, "lady_mission_told",
    [],
    "{s66}, I fear I cannot help you right now.",
    "lady_mission_rejected",
    []],

  [anyone, "lady_mission_accepted",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You are a true {reg18?lady:gentleman}, {playername}. Thank you so much for helping me",
    "close_window",
    [
      (try_begin),
        (eq, "$random_quest_no", "qst_deliver_message_to_prisoner_lord"),
        (quest_get_slot, reg8, "qst_deliver_message_to_prisoner_lord", 22),
        (call_script, "script_troop_add_gold", "trp_player", reg8),
      (try_end),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
    ]],

  [anyone, "lady_mission_rejected",
    [],
    "You'll not help a woman in need? You should be ashamed, {playername}... Please leave me, I have some important embroidery to catch up.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [plyr|anyone, "lady_talk",
    [],
    "I want to improve my relation with a lord. Can you help me?",
    "lady_restore_relation",
    []],

  [anyone, "lady_restore_relation",
    [
      (le, "$g_talk_troop_relation", 0),
    ],
    "{playername}, I don't know you well enough to act on your behalf. I am sorry.",
    "lady_pretalk",
    []],

  [anyone, "lady_restore_relation",
    [],
    "Hmm. I guess you got on the wrong side of somebody. Very well, who do you want to restore your relation with?",
    "lady_restore_relation_2",
    []],

  [repeat_for_troops|plyr|anyone, "lady_restore_relation_2",
    [
      (store_repeat_object, ":var0"),
      (is_between, ":var0", "trp_kingdom_1_lord", "trp_heroes_end"),
      (store_troop_faction, ":var1", ":var0"),
      (eq, "$g_talk_troop_faction", ":var1"),
      (call_script, "script_troop_get_player_relation", ":var0"),
      (lt, reg0, 0),
      (str_store_troop_name, s1, ":var0"),
    ],
    "{s1}",
    "lady_restore_relation_2b",
    [
      (store_repeat_object, "$troop_to_restore_relations_with"),
    ]],

  [plyr|anyone, "lady_restore_relation_2",
    [],
    "Never mind. I get along with everyone well enough.",
    "lady_pretalk",
    []],

  [anyone, "lady_restore_relation_2b",
    [
      (str_store_troop_name, s10, "$troop_to_restore_relations_with"),
    ],
    "Well I can try to help you there. I am sure a few expensive gifts will make {s10} look at you more favorably.",
    "lady_restore_relation_3",
    []],

  [anyone, "lady_restore_relation_3",
    [
      (str_store_troop_name, s10, "$troop_to_restore_relations_with"),
      (assign, "$lady_restore_cost_1", 1000),
      (assign, "$lady_restore_cost_2", 2000),
      (assign, "$lady_restore_cost_3", 3000),
      (assign, reg10, "$lady_restore_cost_1"),
      (assign, reg11, "$lady_restore_cost_2"),
      (assign, reg12, "$lady_restore_cost_3"),
      (troop_get_type, reg4, "$troop_to_restore_relations_with"),
      (call_script, "script_troop_get_gender_to_reg18", "$troop_to_restore_relations_with"),
    ],
    "You can improve your relation with {s10} by sending {reg18?her:him} a gift worth {reg10} cents. But if you can afford spending {reg11} cents on the gift, it would make a good impression on {reg18?her:him}. And if you can go up to {reg12} cents, that would really help smooth things out.",
    "lady_restore_relation_4",
    []],

  [plyr|anyone, "lady_restore_relation_4",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", "$lady_restore_cost_1"),
      (assign, reg10, "$lady_restore_cost_1"),
    ],
    "I think a gift of {reg10} cents will do.",
    "lady_restore_relation_5",
    [
      (assign, "$temp", 1),
      (assign, "$temp_2", "$lady_restore_cost_1"),
    ]],

  [plyr|anyone, "lady_restore_relation_4",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", "$lady_restore_cost_2"),
      (assign, reg11, "$lady_restore_cost_2"),
    ],
    "Maybe I can afford {reg11} cents.",
    "lady_restore_relation_5",
    [
      (assign, "$temp", 2),
      (assign, "$temp_2", "$lady_restore_cost_2"),
    ]],

  [plyr|anyone, "lady_restore_relation_4",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", "$lady_restore_cost_3"),
      (assign, reg12, "$lady_restore_cost_3"),
    ],
    "In that case, I am ready to spend {reg12} cents.",
    "lady_restore_relation_5",
    [
      (assign, "$temp", 3),
      (assign, "$temp_2", "$lady_restore_cost_3"),
    ]],

  [plyr|anyone, "lady_restore_relation_4",
    [],
    "I don't think I can afford a gift at the moment.",
    "lady_restore_relation_cant_afford",
    []],

  [anyone, "lady_restore_relation_5",
    [],
    "Excellent. Then I'll choose an appropriate gift for you and send it to {s10} with your compliments. I am sure {reg18?she:he} will appreciate the gesture.",
    "lady_restore_relation_6",
    [
      (troop_remove_gold, "trp_player", "$temp_2"),
      (call_script, "script_change_player_relation_with_troop", "$troop_to_restore_relations_with", "$temp"),
      (troop_get_type, reg4, "$troop_to_restore_relations_with"),
      (call_script, "script_troop_get_gender_to_reg18", "$troop_to_restore_relations_with"),
    ]],

  [plyr|anyone, "lady_restore_relation_6",
    [],
    "Thank you for your help, ma'am.",
    "lady_pretalk",
    []],

  [anyone, "lady_restore_relation_cant_afford",
    [],
    "I am afraid, I can't be of much help in that case, {playername}. I am sorry.",
    "lady_pretalk",
    []],

  [plyr|anyone, "lady_talk",
    [],
    "I must beg my leave.",
    "lady_leave",
    []],

  [auto_proceed|anyone, "lady_leave",
    [],
    "Farewell, {playername}.",
    "close_window",
    [
      (eq, "$talk_context", 2),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "convince_begin",
    [],
    "I still don't see why I should accept what you're asking of me.",
    "convince_options",
    [
      (quest_get_slot, "$convince_value", "$g_convince_quest", 19),
    ]],

  [plyr|anyone, "convince_options",
    [
      (assign, reg8, "$convince_value"),
    ],
    "Then I'll make it worth your while. ({reg8} cents)",
    "convince_bribe",
    []],

  [plyr|anyone, "convince_options",
    [
      (store_div, "$convince_relation_penalty", "$convince_value", 300),
      (val_add, "$convince_relation_penalty", 1),
      (assign, reg9, "$convince_relation_penalty"),
    ],
    "Please, do it for the sake of our friendship. (-{reg9} to relation)",
    "convince_friendship",
    []],

  [plyr|anyone, "convince_options",
    [],
    "Let me try and convince you. (Persuasion)",
    "convince_persuade_begin",
    []],

  [plyr|anyone, "convince_options",
    [],
    "Never mind.",
    "lord_pretalk",
    []],

  [anyone, "convince_bribe",
    [],
    "Mmm, a generous gift to my coffers would certainly help matters... {reg8} cents should do it. If you agree, then I'll go with your suggestion.",
    "convince_bribe_verify",
    []],

  [plyr|anyone, "convince_bribe_verify",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (lt, ":var0", "$convince_value"),
    ],
    "I'm afraid my finances will not allow for such a gift.",
    "convince_bribe_cant_afford",
    []],

  [plyr|anyone, "convince_bribe_verify",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", "$convince_value"),
    ],
    "Very well, please accept these {reg8} cents as a token of my gratitude.",
    "convince_bribe_goon",
    []],

  [plyr|anyone, "convince_bribe_verify",
    [],
    "Let me think about this some more.",
    "convince_begin",
    []],

  [anyone, "convince_bribe_cant_afford",
    [],
    "Ah. In that case, there is little I can do, unless you have some further argument to make.",
    "convince_options",
    []],

  [anyone, "convince_bribe_goon",
    [],
    "My dear {playername}, your generous gift has led me to reconsider what you ask, and I have come to appreciate the wisdom of your proposal.",
    "convince_accept",
    [
      (troop_remove_gold, "trp_player", "$convince_value"),
    ]],

  [anyone, "convince_friendship",
    [
      (store_add, ":var0", 5, "$convince_relation_penalty"),
      (ge, "$g_talk_troop_relation", ":var0"),
    ],
    "You've done well by me in the past, {playername}, and for that I will go along with your request, but know that I do not like you using our relationship this way.",
    "convince_friendship_verify",
    []],

  [plyr|anyone, "convince_friendship_verify",
    [],
    "I am sorry, my friend, but I need your help in this.",
    "convince_friendship_go_on",
    []],

  [plyr|anyone, "convince_friendship_verify",
    [],
    "If it will not please you, then I'll try something else.",
    "lord_pretalk",
    []],

  [anyone, "convince_friendship_go_on",
    [],
    "Alright then, {playername}, I will accept this for your sake. But remember, you owe me for this.",
    "convince_accept",
    [
      (store_sub, ":var0", 0, "$convince_relation_penalty"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", ":var0"),
    ]],

  [anyone, "convince_friendship",
    [
      (ge, "$g_talk_troop_relation", -5),
    ],
    "I don't think I owe you such a favor {playername}. I see no reason to accept this for you.",
    "lord_pretalk",
    []],

  [anyone, "convince_friendship",
    [],
    "Is this a joke? You've some nerve asking me for favours, {playername}, and let me assure you you'll get none.",
    "lord_pretalk",
    []],

  [anyone, "convince_persuade_begin",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 26),
      (store_current_hours, ":var1"),
      (store_add, ":var2", ":var0", 24),
      (gt, ":var1", ":var2"),
    ],
    "Very well. Make your case.",
    "convince_persuade_begin_2",
    []],

  [plyr|anyone, "convince_persuade_begin_2",
    [],
    "[Attempt to persuade]",
    "convince_persuade",
    [
      (try_begin),
        (store_random_in_range, ":var0", 0, 100),
        (lt, ":var0", 30),
        (store_current_hours, ":var1"),
        (troop_set_slot, "$g_talk_troop", 26, ":var1"),
      (try_end),
      (store_skill_level, ":var2", "skl_persuasion", "trp_player"),
      (store_add, ":var3", ":var2", 5),
      (store_random_in_range, ":var4", 0, ":var3"),
      (store_random_in_range, ":var5", 0, ":var3"),
      (store_add, ":var0", ":var4", ":var5"),
      (assign, ":var6", "$convince_value"),
      (convert_to_fixed_point, ":var6"),
      (store_sqrt, ":var6", ":var6"),
      (convert_from_fixed_point, ":var6"),
      (val_div, ":var6", 10),
      (val_add, ":var6", 4),
      (store_sub, "$persuasion_strength", ":var0", ":var6"),
      (val_mul, "$persuasion_strength", 20),
      (assign, reg5, "$persuasion_strength"),
      (val_sub, "$convince_value", "$persuasion_strength"),
      (quest_set_slot, "$g_convince_quest", 19, "$convince_value"),
      (str_store_troop_name, s50, "$g_talk_troop"),
      (troop_get_type, reg51, "$g_talk_troop"),
      (try_begin),
        (lt, "$persuasion_strength", -30),
        (str_store_string, s5, "str_persuasion_summary_very_bad"),
      (else_try),
        (lt, "$persuasion_strength", -10),
        (str_store_string, s5, "str_persuasion_summary_bad"),
      (else_try),
        (lt, "$persuasion_strength", 10),
        (str_store_string, s5, "str_persuasion_summary_average"),
      (else_try),
        (lt, "$persuasion_strength", 30),
        (str_store_string, s5, "str_persuasion_summary_good"),
      (else_try),
        (str_store_string, s5, "str_persuasion_summary_very_good"),
      (try_end),
      (dialog_box, "@{s5} (Persuasion strength: {reg5})", "@Persuasion Attempt"),
    ]],

  [plyr|anyone, "convince_persuade_begin_2",
    [],
    "Wait, perhaps there is another way to convince you.",
    "convince_begin",
    []],

  [anyone, "convince_persuade_begin",
    [],
    "By God's grace, {playername}! Haven't we talked enough already? I am tired of listening to you, and I do not want to hear any more of it right now.",
    "lord_pretalk",
    []],

  [anyone, "convince_persuade",
    [
      (le, "$convince_value", 0),
    ],
    "Alright, alright. You have persuaded me to it. I'll go ahead with what you suggest.",
    "convince_accept",
    []],

  [anyone, "convince_persuade",
    [
      (gt, "$persuasion_strength", 5),
    ],
    "You've a point, {playername}, I'll admit that much. However I am not yet convinced I should do as you bid.",
    "convince_options",
    []],

  [anyone, "convince_persuade",
    [
      (gt, "$persuasion_strength", -5),
    ],
    "Enough, {playername}. You've a lot of arguments, but I find none of them truly convincing. I stand by what I said before.",
    "convince_options",
    []],

  [anyone, "convince_persuade",
    [],
    "Truthfully, {playername}, I fail to see the virtue of your reasoning. What you ask for makes even less sense now than it did before.",
    "convince_options",
    []],

  [anyone, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (troop_slot_eq, "$g_talk_troop", 2, 5),
      (eq, "$talk_context", 12),
      (str_store_party_name, s1, "$g_encountered_party"),
    ],
    "I must congratulate you on your victory, my {reg18?lady:good sir}. Welcome to {s1}. We, the housekeepers of this castle, are at your service.",
    "siege_won_seneschal_1",
    []],

  [plyr|anyone, "siege_won_seneschal_1",
    [],
    "Are you the seneschal?",
    "siege_won_seneschal_2",
    []],

  [anyone, "siege_won_seneschal_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Indeed I am, my {reg18?lady:good sir}. I have always served the masters of {s1} to the best of my ability, whichever side they might be on. Thus you may count on my utmost loyalty for as long as you are the owner of this place. Now, do you intend to keep me on as the seneschal? I promise you will not be disappointed.",
    "siege_won_seneschal_3",
    []],

  [plyr|anyone, "siege_won_seneschal_3",
    [],
    "Very well, you may keep your post for the time being.",
    "siege_won_seneschal_4",
    []],

  [plyr|anyone, "siege_won_seneschal_3",
    [],
    "You can stay, but I shall be keeping a close watch on you.",
    "siege_won_seneschal_4",
    []],

  [anyone, "siege_won_seneschal_4",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thank you, my {reg18?lady:good sir}. If you do not mind my impudence, may I inquire as to what you wish to do with the castle?",
    "siege_won_seneschal_5",
    []],

  [plyr|anyone, "siege_won_seneschal_5",
    [],
    "I will sell it to another lord.",
    "siege_won_seneschal_6",
    []],

  [plyr|anyone, "siege_won_seneschal_5",
    [],
    "I intend to claim it for myself.",
    "siege_won_seneschal_6",
    []],

  [plyr|anyone, "siege_won_seneschal_5",
    [],
    "I haven't given it much thought. What are my options?",
    "siege_won_seneschal_list_options",
    []],

  [anyone, "siege_won_seneschal_list_options",
    [],
    "According to our laws and traditions, you can do one of several things. First, you could station a garrison here to protect the castle from any immediate counterattacks, then request an audience with some wealthy lord and ask him to make you an offer. It would be worth a tidy sum, believe you me. If you do not wish to sell, then you will have to find yourself a liege lord and protector who would accept homage from you. Without a royal investiture and an army at your back, you would have a difficult time holding on to the castle. Both you and {s1} would become great big targets for any man with a few soldiers and a scrap of ambition. ",
    "siege_won_seneschal_list_options_2",
    []],

  [plyr|anyone, "siege_won_seneschal_list_options_2",
    [],
    "What do you mean, a liege lord and protector? I won this place by my own hand, I don't need anyone else!",
    "siege_won_seneschal_list_options_3",
    []],

  [anyone, "siege_won_seneschal_list_options_3",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Of course you don't, my {reg18?lady:good sir}. However, no lord in the land will recognize your claim to the castle unless it is verified by royal decree. They would call {s1} an outlaw stronghold and take it from you at the earliest opportunity. Surely not even you could stand against a whole army.",
    "siege_won_seneschal_list_options_4",
    []],

  [plyr|anyone, "siege_won_seneschal_list_options_4",
    [],
    "Hmm. I'll give it some thought.",
    "siege_won_seneschal_6",
    []],

  [anyone, "siege_won_seneschal_6",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I am very pleased to hear it, my {reg18?lady:good sir}. I am only trying to serve you to the best of my ability. Now, if at any time you find you have further need of me, I will be in the great hall arranging a smooth handover of the castle to your forces. ",
    "close_window",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 5),
      (eq, "$g_talk_troop_met", 0),
      (str_store_party_name, s1, "$g_encountered_party"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}. I do not believe I've made your acquiantance. Let me extend my welcome to you as the seneschal of {s1}.",
    "seneschal_intro_1",
    []],

  [plyr|anyone, "seneschal_intro_1",
    [],
    "A pleasure to meet you, {s65}.",
    "seneschal_intro_1a",
    []],

  [anyone, "seneschal_intro_1a",
    [],
    "How can I help you?",
    "seneschal_talk",
    []],

  [plyr|anyone, "seneschal_intro_1",
    [],
    "What exactly do you do here?",
    "seneschal_intro_1b",
    []],

  [anyone, "seneschal_intro_1b",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Ah, a seneschal's duties are many, {reg18?ma'am:sir}. For example, I collect the rents from my lord's estates, I manage the castle's storerooms, I deal with the local peasantry, I take care of castle staff, I arrange supplies for the garrison... All mundane matters on this fief are my responsibility, on behalf of my lord. Everything except commanding the soldiers themselves.",
    "seneschal_talk",
    []],

  [anyone, "start",
    [
      (troop_slot_eq, "$g_talk_troop", 2, 5),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}.",
    "seneschal_talk",
    []],

  [anyone, "seneschal_pretalk",
    [],
    "Anything else?",
    "seneschal_talk",
    []],

  [plyr|anyone, "seneschal_talk",
    [
      (store_relation, ":var0", "fac_player_supporters_faction", "$g_encountered_party_faction"),
      (ge, ":var0", 0),
    ],
    "I would like to ask you a question...",
    "seneschal_ask_something",
    []],

  [plyr|anyone, "seneschal_talk",
    [
      (store_relation, ":var0", "fac_player_supporters_faction", "$g_encountered_party_faction"),
      (ge, ":var0", 0),
    ],
    "I wish to know more about someone...",
    "seneschal_ask_about_someone",
    []],

  [anyone, "seneschal_ask_about_someone",
    [],
    "Perhaps I may be able to help. Whom did you have in mind?",
    "seneschal_ask_about_someone_2",
    []],

  [repeat_for_troops|plyr|anyone, "seneschal_ask_about_someone_2",
    [
      (store_repeat_object, ":var0"),
      (is_between, ":var0", "trp_kingdom_1_lord", "trp_heroes_end"),
      (store_troop_faction, ":var1", ":var0"),
      (eq, "$g_encountered_party_faction", ":var1"),
      (str_store_troop_name, s1, ":var0"),
    ],
    "{s1}",
    "seneschal_ask_about_someone_3",
    [
      (store_repeat_object, "$hero_requested_to_learn_relations"),
    ]],

  [plyr|anyone, "seneschal_ask_about_someone_2",
    [],
    "Never mind.",
    "seneschal_pretalk",
    []],

  [anyone, "seneschal_ask_about_someone_3",
    [
      (call_script, "script_troop_write_family_relations_to_s1", "$hero_requested_to_learn_relations"),
      (call_script, "script_troop_write_owned_centers_to_s2", "$hero_requested_to_learn_relations"),
    ],
    "{s2}{s1}",
    "seneschal_ask_about_someone_4",
    [
      (add_troop_note_from_dialog, "$hero_requested_to_learn_relations", 2),
    ]],

  [anyone, "seneschal_ask_about_someone_relation",
    [
      (call_script, "script_troop_count_number_of_enemy_troops", "$hero_requested_to_learn_relations"),
      (assign, ":var0", reg0),
      (try_begin),
        (gt, ":var0", 1),
        (try_for_range, ":var1", 1, ":var0"),
          (store_add, ":var2", 40, ":var1"),
          (troop_get_slot, ":var3", "$hero_requested_to_learn_relations", ":var2"),
          (str_store_troop_name_link, s50, ":var3"),
          (try_begin),
            (eq, ":var1", 1),
            (troop_get_slot, ":var3", "$hero_requested_to_learn_relations", 40),
            (str_store_troop_name_link, s51, ":var3"),
            (str_store_string, s51, "str_s50_and_s51"),
          (else_try),
            (str_store_string, s51, "str_s50_comma_s51"),
          (try_end),
        (try_end),
      (else_try),
        (eq, ":var0", 1),
        (troop_get_slot, ":var3", "$hero_requested_to_learn_relations", 40),
        (str_store_troop_name_link, s51, ":var3"),
      (else_try),
        (str_store_string, s51, "str_noone"),
      (try_end),
      (troop_get_type, reg1, "$hero_requested_to_learn_relations"),
      (call_script, "script_troop_get_gender_to_reg18", "$hero_requested_to_learn_relations"),
    ],
    "{reg18?She:He} hates {s51}.",
    "seneschal_ask_about_someone_4",
    [
      (add_troop_note_from_dialog, "$hero_requested_to_learn_relations", 3),
    ]],

  [plyr|anyone, "seneschal_ask_about_someone_4",
    [],
    "Where does {s1} stand with others?.",
    "seneschal_ask_about_someone_relation",
    []],

  [plyr|anyone, "seneschal_ask_about_someone_4",
    [],
    "My thanks, that was helpful.",
    "seneschal_pretalk",
    []],

  [plyr|anyone, "seneschal_talk",
    [],
    "I must take my leave of you now. Farewell.",
    "close_window",
    []],

  [anyone, "seneschal_ask_something",
    [],
    "I'll do what I can to help, of course. What did you wish to ask?",
    "seneschal_ask_something_2",
    []],

  [plyr|anyone, "seneschal_ask_something_2",
    [],
    "Perhaps you know where to find someone...",
    "seneschal_ask_location",
    []],

  [anyone, "seneschal_ask_location",
    [],
    "Well, a man in my position does hear a lot of things. Of whom were you thinking?",
    "seneschal_ask_location_2",
    []],

  [repeat_for_troops|plyr|anyone, "seneschal_ask_location_2",
    [
      (store_repeat_object, ":var0"),
      (is_between, ":var0", "trp_kingdom_1_lord", "trp_heroes_end"),
      (store_troop_faction, ":var1", ":var0"),
      (eq, "$g_encountered_party_faction", ":var1"),
      (str_store_troop_name, s1, ":var0"),
    ],
    "{s1}",
    "seneschal_ask_location_3",
    [
      (store_repeat_object, "$hero_requested_to_learn_location"),
    ]],

  [plyr|anyone, "seneschal_ask_location_2",
    [],
    "Never mind.",
    "seneschal_pretalk",
    []],

  [anyone, "seneschal_ask_location_3",
    [
      (call_script, "script_get_information_about_troops_position", "$hero_requested_to_learn_location", 0),
    ],
    "{s1}",
    "seneschal_pretalk",
    []],

  [anyone, "start",
    [
      (eq, "$caravan_escort_state", 1),
      (eq, "$g_encountered_party", "$caravan_escort_party_id"),
      (le, "$talk_context", 2),
      (store_distance_to_party_from_party, reg0, "$caravan_escort_destination_town", "$caravan_escort_party_id"),
      (lt, reg0, 5),
      (str_store_party_name, s3, "$caravan_escort_destination_town"),
      (assign, reg3, "$caravan_escort_agreed_reward"),
    ],
    "There! I can see the church tower of {s3} in the distance. We've made it safely. Here, take this purse of {reg3} cents, as I promised. I hope we can travel together again someday.",
    "close_window",
    [
      (assign, "$caravan_escort_state", 0),
      (call_script, "script_troop_add_gold", "trp_player", "$caravan_escort_agreed_reward"),
      (assign, reg4, "$caravan_escort_agreed_reward"),
      (val_mul, reg4, 1),
      (add_xp_as_reward, reg4),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "start",
    [
      (eq, "$caravan_escort_state", 1),
      (eq, "$g_encountered_party", "$caravan_escort_party_id"),
      (eq, "$talk_context", 2),
    ],
    "We've made it this far... Is everything clear up ahead?",
    "talk_caravan_escort",
    []],

  [plyr|anyone, "talk_caravan_escort",
    [],
    "There might be bandits nearby. Stay close.",
    "talk_caravan_escort_2a",
    []],

  [anyone, "talk_caravan_escort_2a",
    [],
    "Trust me, {playername}, we're already staying as close to you as we can. Lead the way.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "talk_caravan_escort",
    [],
    "No sign of trouble, we can breathe easy.",
    "talk_caravan_escort_2b",
    []],

  [anyone, "talk_caravan_escort_2b",
    [],
    "I won't breathe easy until we get to {s1}. Let's keep moving.",
    "close_window",
    [
      (str_store_party_name, s1, "$caravan_escort_destination_town"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 2),
      (eq, "$g_encountered_party_type", 11),
      (party_slot_ge, "$g_encountered_party", 52, "$g_current_hours"),
      (play_sound, "snd_encounter_stagecoach_neutral"),
    ],
    "What do you want? We gave you money less than three days ago.",
    "merchant_talk",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 2),
      (eq, "$g_encountered_party_type", 11),
      (ge, "$g_encountered_party_relation", 0),
    ],
    "Howdy, partner.",
    "merchant_talk",
    [
      (play_sound, "snd_encounter_stagecoach_neutral"),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 2),
      (eq, "$g_encountered_party_type", 11),
      (lt, "$g_encountered_party_relation", 0),
      (faction_get_slot, ":var0", "$g_encountered_party_faction", 10),
      (str_store_troop_name, s9, ":var0"),
      (play_sound, "snd_encounter_stagecoach_enemy"),
    ],
    "Now you hold on just a second! Try anything, and {s9} will see to it that you're shot dead! Get lost or face the consequences!",
    "merchant_talk",
    []],

  [anyone, "start",
    [
      (party_slot_eq, "$g_encountered_party", 0, 11),
      (this_or_next|eq, "$talk_context", 2),
      (eq, "$talk_context", 0),
    ],
    "Yes? What do you want?",
    "merchant_talk",
    [
      (play_sound, "snd_encounter_stagecoach_neutral"),
    ]],

  [anyone, "merchant_pretalk",
    [],
    "Anything else?",
    "merchant_talk",
    []],

  [plyr|anyone, "merchant_talk",
    [
      (le, "$talk_context", 2),
      (check_quest_active, "qst_raid_caravan_to_start_war"),
      (neg|check_quest_concluded, "qst_raid_caravan_to_start_war"),
      (quest_slot_eq, "qst_raid_caravan_to_start_war", 3, "$g_encountered_party_faction"),
      (str_store_faction_name, s17, "$players_kingdom"),
    ],
    "You are trespassing in {s17} territory. I am confiscating this caravan and all its goods!",
    "caravan_start_war_quest_1",
    []],

  [anyone, "caravan_start_war_quest_1",
    [
      (str_store_faction_name, s17, "$players_kingdom"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "What? What nonsense is this? We are nowhere near your territory, {reg18?wench:scoundrel}, and moreover we have a peace treaty with {s17}!",
    "caravan_start_war_quest_2",
    []],

  [plyr|anyone, "caravan_start_war_quest_2",
    [],
    "We'll see about that! Defend yourselves!",
    "merchant_attack",
    []],

  [plyr|anyone, "caravan_start_war_quest_2",
    [],
    "Never mind, it was only a joke afterall. Goodbye.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "merchant_talk",
    [
      (le, "$talk_context", 2),
      (eq, "$g_encountered_party_faction", "$players_kingdom"),
    ],
    "I have an offer for you.",
    "merchant_talk_offer",
    []],

  [anyone, "merchant_talk_offer",
    [],
    "What is it?",
    "merchant_talk_offer_2",
    []],

  [plyr|anyone, "merchant_talk_offer_2",
    [
      (eq, "$talk_context", 2),
      (eq, "$g_encountered_party_faction", "$players_kingdom"),
    ],
    "I can escort you to your destination for a price.",
    "caravan_offer_protection",
    []],

  [plyr|anyone, "merchant_talk_offer_2",
    [],
    "Nothing. Forget it",
    "merchant_pretalk",
    []],

  [plyr|anyone, "merchant_talk",
    [
      (eq, "$talk_context", 2),
      (neg|party_slot_ge, "$g_encountered_party", 52, "$g_current_hours"),
    ],
    "This is a robbery!",
    "merchant_demand",
    []],

  [anyone, "merchant_demand",
    [
      (eq, "$talk_context", 2),
    ],
    "What do you want? Please, we don't want any trouble.",
    "merchant_demand_2",
    []],

  [plyr|anyone, "merchant_demand_2",
    [
      (neq, "$g_encountered_party_faction", "$players_kingdom"),
    ],
    "Just give me some money and nobody gets hurt.",
    "merchant_demand_toll",
    []],

  [anyone, "merchant_demand_toll",
    [
      (gt, "$g_strength_ratio", 70),
      (store_div, reg6, "$g_ally_strength", 2),
      (val_add, reg6, 940),
      (assign, "$temp", reg6),
    ],
    "Please, I don't want any trouble. I can give you {reg6} cents, just let us go.",
    "merchant_demand_toll_2",
    []],

  [anyone, "merchant_demand_toll",
    [
      (store_div, reg6, "$g_ally_strength", 4),
      (val_add, reg6, 350),
      (assign, "$temp", reg6),
    ],
    "I don't want any trouble. I can give you {reg6} cents if you'll let us go.",
    "merchant_demand_toll_2",
    []],

  [plyr|anyone, "merchant_demand_toll_2",
    [],
    "Alright, just gimme the money and make it quick.",
    "merchant_demand_toll_accept",
    []],

  [anyone, "merchant_demand_toll_accept",
    [
      (assign, reg6, "$temp"),
    ],
    "Alright, alright, here's {reg6} cents. ",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_troop_add_gold", "trp_player", "$temp"),
      (store_add, ":var0", "$g_current_hours", 72),
      (party_set_slot, "$g_encountered_party", 52, ":var0"),
      (call_script, "script_change_player_relation_with_faction", "$g_encountered_party_faction", -1),
      (call_script, "script_add_log_entry", 3, "trp_player", -1, -1, "$g_encountered_party_faction"),
      (assign, reg6, "$temp"),
    ]],

  [plyr|anyone, "merchant_demand_toll_2",
    [],
    "I changed my mind, I can't take your money.",
    "merchant_pretalk",
    []],

  [plyr|anyone, "merchant_demand_toll_2",
    [],
    "No, I want everything you have! [Attack]",
    "merchant_attack",
    []],

  [plyr|anyone, "merchant_demand_2",
    [
      (neq, "$g_encountered_party_faction", "$players_kingdom"),
    ],
    "Hand over everything you have or I'll kill all of you!",
    "merchant_attack_begin",
    []],

  [plyr|anyone, "merchant_demand_2",
    [],
    "Nothing. Forget it.",
    "merchant_pretalk",
    []],

  [anyone, "merchant_attack_begin",
    [],
    "Are you really robbing us?",
    "merchant_attack_verify",
    []],

  [plyr|anyone, "merchant_attack_verify",
    [],
    "Of course not, I was just fuckin' around.",
    "merchant_attack_verify_norob",
    []],

  [anyone, "merchant_attack_verify_norob",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You've got to be sick in the head to joke about that, {reg18?miss:mister}. For a second there I thought we were in real trouble.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "merchant_attack_verify",
    [],
    "Of course I'm fuckin' robbing you! Do I look like I'm kidding, asshole?",
    "merchant_attack",
    []],

  [anyone, "merchant_attack",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Not without a fight, you {reg18?bitch:son of a bitch}!",
    "close_window",
    [
      (store_relation, ":var0", "$g_encountered_party_faction", "fac_player_supporters_faction"),
      (val_min, ":var0", 0),
      (call_script, "script_add_log_entry", 3, "trp_player", -1, -1, "$g_encountered_party_faction"),
    ]],

  [anyone, "caravan_offer_protection",
    [],
    "Hell, why not. With all the bandits and whatnot around these parts, I can't afford not to have protection.",
    "caravan_offer_protection_2",
    [
      (get_party_ai_object, ":var0", "$g_encountered_party"),
      (store_distance_to_party_from_party, "$caravan_distance_to_target", ":var0", "$g_encountered_party"),
      (assign, "$caravan_escort_offer", "$caravan_distance_to_target"),
      (val_sub, "$caravan_escort_offer", 10),
      (call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":var1", reg0),
      (val_min, ":var1", 200),
      (val_add, ":var1", 100),
      (val_mul, "$caravan_escort_offer", ":var1"),
      (val_div, "$caravan_escort_offer", 15),
      (val_max, "$caravan_escort_offer", 20),
    ]],

  [anyone, "caravan_offer_protection_2",
    [
      (lt, "$caravan_distance_to_target", 10),
    ],
    "An escort? We're almost there already! Thank you for the offer, though.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "caravan_offer_protection_2",
    [
      (get_party_ai_object, ":var0", "$g_encountered_party"),
      (str_store_party_name, s1, ":var0"),
      (assign, reg2, "$caravan_escort_offer"),
    ],
    "We're on the way to {s1}. If you escort us there, there's {reg2} cents in it for you.",
    "caravan_offer_protection_3",
    []],

  [plyr|anyone, "caravan_offer_protection_3",
    [],
    "Agreed.",
    "caravan_offer_protection_4",
    []],

  [anyone, "caravan_offer_protection_4",
    [],
    "I want you to stay close to us along the way. We'll need your help if we get ambushed by bandits.",
    "caravan_offer_protection_5",
    []],

  [plyr|anyone, "caravan_offer_protection_5",
    [],
    "Don't worry, you can trust me.",
    "caravan_offer_protection_6",
    []],

  [anyone, "caravan_offer_protection_6",
    [
      (get_party_ai_object, ":var0", "$g_encountered_party"),
      (str_store_party_name, s1, ":var0"),
    ],
    "Good. Come and collect your money when we're within sight of {s1}. For now, let's just get underway.",
    "close_window",
    [
      (get_party_ai_object, ":var0", "$g_encountered_party"),
      (assign, "$caravan_escort_destination_town", ":var0"),
      (assign, "$caravan_escort_party_id", "$g_encountered_party"),
      (assign, "$caravan_escort_agreed_reward", "$caravan_escort_offer"),
      (assign, "$caravan_escort_state", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "caravan_offer_protection_3",
    [],
    "Forget it.",
    "caravan_offer_protection_4b",
    []],

  [anyone, "caravan_offer_protection_4b",
    [],
    "Maybe another time, then.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "merchant_talk",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_troop_faction_relation", 0),
    ],
    "Not so fast. First, hand over all your goods and money.",
    "talk_caravan_enemy_2",
    []],

  [anyone, "talk_caravan_enemy_2",
    [],
    "Never! It's our duty to protect these goods. You'll have to fight us first, asshole!",
    "close_window",
    [
      (store_relation, ":var0", "$g_encountered_party_faction", "fac_player_supporters_faction"),
      (val_min, ":var0", 0),
      (call_script, "script_add_log_entry", 3, "trp_player", -1, -1, "$g_encountered_party_faction"),
    ]],

  [plyr|anyone, "merchant_talk",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (faction_slot_eq, "$g_encountered_party_faction", 51, "$g_talk_troop"),
      (this_or_next|eq, "$g_encountered_party_faction", "fac_player_supporters_faction"),
      (party_slot_eq, "$g_encountered_party", 7, "trp_player"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}. Will you be visiting the prison?",
    "prison_guard_players",
    []],

  [plyr|anyone, "prison_guard_players",
    [],
    "Yes. Unlock the door.",
    "close_window",
    [
      (call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle"),
    ]],

  [plyr|anyone, "prison_guard_players",
    [],
    "No, not now.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (faction_slot_eq, "$g_encountered_party_faction", 51, "$g_talk_troop"),
    ],
    "Yes? What do you want?",
    "prison_guard_talk",
    []],

  [plyr|anyone, "prison_guard_talk",
    [],
    "Who is imprisoned here?",
    "prison_guard_ask_prisoners",
    []],

  [plyr|anyone, "prison_guard_talk",
    [],
    "I want to speak with a prisoner.",
    "prison_guard_visit_prison",
    []],

  [anyone, "prison_guard_ask_prisoners",
    [],
    "Currently, {s51} {reg1?are:is} imprisoned here.",
    "prison_guard_talk",
    [
      (party_clear, "p_temp_party"),
      (assign, ":var0", 0),
      (party_get_num_prisoner_stacks, ":var1", "$g_encountered_party"),
      (try_for_range, ":var2", 0, ":var1"),
        (party_prisoner_stack_get_troop_id, ":var3", "$g_encountered_party", ":var2"),
        (troop_is_hero, ":var3"),
        (party_add_members, "p_temp_party", ":var3", 1),
        (val_add, ":var0", 1),
      (try_end),
      (call_script, "script_print_party_members", "p_temp_party"),
      (try_begin),
        (gt, ":var0", 1),
        (assign, reg1, 1),
      (else_try),
        (assign, reg1, 0),
      (try_end),
    ]],

  [anyone, "prison_guard_visit_prison",
    [
      (this_or_next|faction_slot_eq, "$g_encountered_party_faction", 7, "trp_player"),
      (this_or_next|party_slot_eq, "$g_encountered_party", 7, "trp_player"),
      (eq, "$g_encountered_party_faction", "$players_kingdom"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Of course, {reg18?ma'am:sir}. Go in.",
    "close_window",
    [
      (call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle"),
    ]],

  [anyone, "prison_guard_visit_prison",
    [],
    "You need to get permission from the commandant to talk to prisoners.",
    "prison_guard_visit_prison_2",
    []],

  [plyr|anyone, "prison_guard_visit_prison_2",
    [],
    "Alright then. I'll try that.",
    "close_window",
    []],

  [plyr|anyone, "prison_guard_visit_prison_2",
    [],
    "Come on now. I thought you were the boss here.",
    "prison_guard_visit_prison_3",
    []],

  [anyone, "prison_guard_visit_prison_3",
    [],
    "He-heh. You got that right. Still, I can't let you into the prison.",
    "prison_guard_visit_prison_4",
    []],

  [plyr|anyone, "prison_guard_visit_prison_4",
    [],
    "Alright then. I'll leave now.",
    "close_window",
    []],

  [plyr|anyone, "prison_guard_visit_prison_4",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 100),
    ],
    "I've got this shiny dollar coin here. I reckon it belongs to you.",
    "prison_guard_visit_prison_5",
    []],

  [anyone, "prison_guard_visit_prison_5",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "That is a shiny coin. I can't refuse a generous {reg18?woman:man} such as yourself. Go in.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 100),
      (call_script, "script_enter_dungeon", "$current_town", "mt_visit_town_castle"),
    ]],

  [plyr|anyone, "prison_guard_talk",
    [],
    "Nevermind.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (faction_slot_eq, "$g_encountered_party_faction", 52, "$g_talk_troop"),
      (this_or_next|eq, "$g_encountered_party_faction", "fac_player_supporters_faction"),
      (party_slot_eq, "$g_encountered_party", 7, "trp_player"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Your orders, {reg18?ma'am:sir}?",
    "castle_guard_players",
    []],

  [plyr|anyone, "castle_guard_players",
    [],
    "Open the door. I will go in now.",
    "close_window",
    [
      (call_script, "script_enter_court", "$current_town"),
    ]],

  [plyr|anyone, "castle_guard_players",
    [],
    "Never mind.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (faction_slot_eq, "$g_encountered_party_faction", 52, "$g_talk_troop"),
      (eq, "$sneaked_into_town", 1),
      (gt, "$g_time_since_last_talk", 0),
    ],
    "Get out of my sight, you son of a bitch! You stink!",
    "castle_guard_sneaked_intro_1",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (faction_slot_eq, "$g_encountered_party_faction", 52, "$g_talk_troop"),
      (eq, "$sneaked_into_town", 1),
    ],
    "Get lost before I lose my temper, you inbred bastard!",
    "close_window",
    []],

  [plyr|anyone, "castle_guard_sneaked_intro_1",
    [],
    "I want to enter the hall and speak to the commander.",
    "castle_guard_sneaked_intro_2",
    []],

  [plyr|anyone, "castle_guard_sneaked_intro_1",
    [],
    "[Leave]",
    "close_window",
    []],

  [anyone, "castle_guard_sneaked_intro_2",
    [],
    "Are you out of your mind, you idiot? Get the hell out of here or I'll make you leave.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (faction_slot_eq, "$g_encountered_party_faction", 52, "$g_talk_troop"),
    ],
    "What do you want?",
    "castle_guard_intro_1",
    []],

  [plyr|anyone, "castle_guard_intro_1",
    [],
    "I want to enter the hall and speak to the commander.",
    "castle_guard_intro_2",
    []],

  [plyr|anyone, "castle_guard_intro_1",
    [],
    "Never mind.",
    "close_window",
    []],

  [anyone, "castle_guard_intro_2",
    [],
    "You can go in after leaving your weapons with me. No one is allowed to take weapons into the commander's quarters.",
    "castle_guard_intro_2",
    []],

  [plyr|anyone, "castle_guard_intro_2",
    [],
    "Here, take my weapons. I'll go in.",
    "close_window",
    [
      (call_script, "script_enter_court", "$current_town"),
    ]],

  [plyr|anyone, "castle_guard_intro_2",
    [],
    "No, I give my weapons to no one.",
    "castle_guard_intro_2b",
    []],

  [anyone, "castle_guard_intro_2b",
    [],
    "Then you can't go in.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 3),
    ],
    "What do you want?",
    "castle_gate_guard_talk",
    []],

  [anyone, "castle_gate_guard_pretalk",
    [],
    "Yes?",
    "castle_gate_guard_talk",
    []],

  [plyr|anyone, "castle_gate_guard_talk",
    [
      (ge, "$g_encountered_party_relation", 0),
    ],
    "We need shelter for the night. Will you let us in?",
    "castle_gate_open",
    []],

  [plyr|anyone, "castle_gate_guard_talk",
    [
      (party_slot_ge, "$g_encountered_party", 7, 1),
    ],
    "I want to speak with the commander of the castle.",
    "request_meeting_castle_lord",
    []],

  [plyr|anyone, "castle_gate_guard_talk",
    [],
    "I want to speak with someone in the castle.",
    "request_meeting_other",
    []],

  [plyr|anyone, "castle_gate_guard_talk",
    [],
    "[Leave]",
    "close_window",
    []],

  [anyone, "request_meeting_castle_lord",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 7),
      (call_script, "script_get_troop_attached_party", ":var0"),
      (eq, "$g_encountered_party", reg0),
      (str_store_troop_name, s2, ":var0"),
      (assign, "$lord_requested_to_talk_to", ":var0"),
    ],
    "Wait here. {s2} will see you.",
    "close_window",
    []],

  [anyone, "request_meeting_castle_lord",
    [],
    "My commander is not here now.",
    "castle_gate_guard_pretalk",
    []],

  [anyone, "request_meeting_other",
    [],
    "Who is that?",
    "request_meeting_3",
    []],

  [repeat_for_troops|plyr|anyone, "request_meeting_3",
    [
      (store_repeat_object, ":var0"),
      (troop_is_hero, ":var0"),
      (troop_slot_eq, ":var0", 2, 2),
      (call_script, "script_get_troop_attached_party", ":var0"),
      (eq, "$g_encountered_party", reg0),
      (str_store_troop_name, s3, ":var0"),
    ],
    "{s3}",
    "request_meeting_4",
    [
      (store_repeat_object, "$lord_requested_to_talk_to"),
    ]],

  [plyr|anyone, "request_meeting_3",
    [],
    "Never mind.",
    "close_window",
    [
      (assign, "$lord_requested_to_talk_to", 0),
    ]],

  [anyone, "request_meeting_4",
    [],
    "Wait there. I'll send him your request.",
    "request_meeting_5",
    []],

  [plyr|anyone, "request_meeting_5",
    [],
    "I'm waiting...",
    "request_meeting_6",
    []],

  [anyone, "request_meeting_6",
    [
      (call_script, "script_troop_get_player_relation", "$lord_requested_to_talk_to"),
      (assign, ":var0", reg0),
      (gt, ":var0", -20),
    ],
    "Alright. {s2} will talk to you now.",
    "close_window",
    [
      (str_store_troop_name, s2, "$lord_requested_to_talk_to"),
    ]],

  [anyone, "request_meeting_6",
    [
      (str_store_troop_name, s2, "$lord_requested_to_talk_to"),
    ],
    "{s2} refuses to see you. Get lost.",
    "close_window",
    []],

  [anyone, "castle_gate_open",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 7),
      (call_script, "script_get_troop_attached_party", ":var0"),
      (eq, "$g_encountered_party", reg0),
      (ge, "$g_encountered_party_relation", 0),
      (call_script, "script_troop_get_player_relation", ":var0"),
      (assign, ":var1", reg0),
      (ge, ":var1", 5),
      (str_store_troop_name, s2, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "{s2} will be happy to see you, {reg18?ma'am:sir}. Come on in. I am opening the gates for you.",
    "close_window",
    [
      (assign, "$g_permitted_to_center", 1),
    ]],

  [anyone, "castle_gate_open",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 7),
      (call_script, "script_get_troop_attached_party", ":var0"),
      (neq, "$g_encountered_party", reg0),
      (ge, "$g_encountered_party_relation", 0),
      (call_script, "script_troop_get_player_relation", ":var0"),
      (assign, ":var1", reg0),
      (ge, ":var1", 5),
      (str_store_troop_name, s2, ":var0"),
    ],
    "{s2} is not here right now. But I think he would approve of you taking shelter here. Come on in. I am opening the gates for you.",
    "close_window",
    [
      (assign, "$g_permitted_to_center", 1),
    ]],

  [anyone, "castle_gate_open",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 7),
      (call_script, "script_troop_get_player_relation", ":var0"),
      (assign, ":var1", reg0),
      (ge, ":var1", -2),
    ],
    "Come on in. I am opening the gates for you.",
    "close_window",
    [
      (assign, "$g_permitted_to_center", 1),
    ]],

  [anyone, "castle_gate_open",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 7),
      (call_script, "script_troop_get_player_relation", ":var0"),
      (assign, ":var1", reg0),
      (ge, ":var1", -19),
      (str_store_troop_name, s2, ":var0"),
    ],
    "Come on in. But make sure your men behave sensibly within the walls. {s2} does not want trouble here.",
    "close_window",
    [
      (assign, "$g_permitted_to_center", 1),
    ]],

  [anyone, "castle_gate_open",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 7),
      (str_store_troop_name, s2, ":var0"),
    ],
    "{s2} does not want you here. Begone now.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 5),
    ],
    "You're just in time. Let's join forces and teach those assholes a lesson.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 6),
    ],
    "Big mistake. Big, stupid mistake.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_relation", 17),
    ],
    "I don't think we've been introduced properly. You saved my life out there, and I still don't know your name...",
    "ally_thanks_meet",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_relation", 5),
    ],
    "Thanks for the help, I guess. I'm {s1}, and you are?",
    "ally_thanks_meet",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (eq, "$g_talk_troop_met", 0),
      (ge, "$g_talk_troop_relation", 0),
      (str_store_troop_name, s1, "$g_talk_troop"),
    ],
    "Thanks for your help, stranger. We haven't met properly yet, have we? What is your name?",
    "ally_thanks_meet",
    []],

  [plyr|anyone, "ally_thanks_meet",
    [],
    "My name is {playername}.",
    "ally_thanks_meet_2",
    []],

  [anyone, "ally_thanks_meet_2",
    [
      (ge, "$g_talk_troop_relation", 15),
      (str_store_troop_name, s1, "$g_talk_troop"),
    ],
    "Well met, {playername}. My name is {s1}, and now I owe you big time. If there's ever anything I can help you with, just let me know...",
    "close_window",
    []],

  [anyone, "ally_thanks_meet_2",
    [
      (ge, "$g_talk_troop_relation", 5),
    ],
    "Well met {playername}. I'm in your debt for what you just did. I hope one day I will find a way to repay it.",
    "close_window",
    []],

  [anyone, "ally_thanks_meet_2",
    [],
    "Well met {playername}. I'm {s1}. Thanks for the help. I hope we meet again.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", 30),
      (ge, "$g_relation_boost", 10),
    ],
    "Again you save our necks, {playername}! Truly, you are the best of friends. {s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
      (try_begin),
        (party_stack_get_troop_id, ":var0", "p_encountered_party_backup", 0),
        (is_between, ":var0", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (call_script, "script_add_log_entry", 17, "trp_player", -1, ":var0", -1),
      (try_end),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", 20),
      (ge, "$g_relation_boost", 5),
    ],
    "You arrived just in the nick of time! {playername}. You have my deepest thanks! {s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
      (try_begin),
        (party_stack_get_troop_id, ":var0", "p_encountered_party_backup", 0),
        (is_between, ":var0", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (call_script, "script_add_log_entry", 17, "trp_player", -1, ":var0", -1),
      (try_end),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", 0),
      (ge, "$g_relation_boost", 3),
    ],
    "You turned up just in time, {playername}. I will not forget your help. {s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
      (try_begin),
        (party_stack_get_troop_id, ":var0", "p_encountered_party_backup", 0),
        (is_between, ":var0", "trp_kingdom_1_lord", "trp_knight_1_1_wife"),
        (call_script, "script_add_log_entry", 17, "trp_player", -1, ":var0", -1),
      (try_end),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_talk_troop_relation", -5),
    ],
    "Good to see you here, {playername}. {s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_default"),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
      (ge, "$g_relation_boost", 4),
    ],
    "{s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_grudging_default"),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (troop_is_hero, "$g_talk_troop"),
    ],
    "{s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_battle_won_unfriendly_default"),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (ge, "$g_relation_boost", 10),
      (party_get_num_companions, reg1, "$g_encountered_party"),
      (val_sub, reg1, 1),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thanks for the help, {reg18?ma'am:sir}. You saved {reg1?our lives:my life} out there.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (ge, "$g_relation_boost", 5),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thanks for the help, {reg18?ma'am:sir}. Things weren't goin' too well until you showed up.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 13),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thank you for your help, {reg18?ma'am:sir}. It was fortunate to have you nearby.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 8),
      (store_conversation_troop, ":var0"),
      (eq, ":var0", "trp_kidnapped_girl"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thanks for rescuing me, {reg18?ma'am:sir}. Will you take me to my family now?",
    "kidnapped_girl_liberated_battle",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 8),
    ],
    "I am in your debt for freeing me friend.",
    "freed_hero_answer",
    []],

  [plyr|anyone, "freed_hero_answer",
    [],
    "You're not going anywhere. You'll be my prisoner now!",
    "freed_hero_answer_1",
    [
      (store_conversation_troop, ":var0"),
      (party_add_prisoners, "p_main_party", ":var0", 1),
    ]],

  [anyone, "freed_hero_answer_1",
    [],
    "Fuck! The same bad luck I've always had!",
    "close_window",
    []],

  [plyr|anyone, "freed_hero_answer",
    [],
    "You're free to go, {s65}.",
    "freed_hero_answer_2",
    []],

  [anyone, "freed_hero_answer_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thank you, {reg18?ma'am:sir}. I never forget someone who's done me a good turn.",
    "close_window",
    []],

  [plyr|anyone, "freed_hero_answer",
    [],
    "Would you like to join me?",
    "freed_hero_answer_3",
    []],

  [anyone, "freed_hero_answer_3",
    [
      (store_random_in_range, ":var0", 0, 2),
      (eq, ":var0", 0),
    ],
    "Alright, I'll join you.",
    "close_window",
    [
      (store_conversation_troop, ":var0"),
      (party_add_members, "p_main_party", ":var0", 1),
    ]],

  [anyone, "freed_hero_answer_3",
    [],
    "No, I want to go on my own.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 9),
    ],
    "You'll not live long to enjoy your victory. My kinsmen will soon wipe out the stain of this defeat.",
    "defeat_hero_answer",
    []],

  [plyr|anyone, "defeat_hero_answer",
    [],
    "You are my prisoner now.",
    "defeat_hero_answer_1",
    [
      (party_add_prisoners, "p_main_party", "$g_talk_troop", 1),
      (troop_set_slot, "$g_talk_troop", 8, "p_main_party"),
      (call_script, "script_event_hero_taken_prisoner_by_player", "$g_talk_troop"),
    ]],

  [anyone, "defeat_hero_answer_1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You're gonna regret bein' born, you {reg18?bitch:son of a bitch}!",
    "close_window",
    []],

  [plyr|anyone, "defeat_hero_answer",
    [],
    "You're free to go this time, but don't cross my path again.",
    "defeat_hero_answer_2",
    []],

  [anyone, "defeat_hero_answer_2",
    [],
    "We will meet again.",
    "close_window",
    []],

  [trp_local_merchant, "start",
    [],
    "Mercy! Please don't kill me!",
    "local_merchant_mercy",
    []],

  [plyr|anyone, "local_merchant_mercy",
    [
      (quest_get_slot, ":var0", "qst_kill_local_merchant", 6),
      (str_store_troop_name, s2, ":var0"),
    ],
    "I have nothing against you personally. But unfortunately, {s2} wants you dead. Sorry.",
    "local_merchant_mercy_no",
    []],

  [anyone, "local_merchant_mercy_no",
    [],
    "Damn you! I hope you burn in Hell for this!",
    "close_window",
    []],

  [plyr|anyone, "local_merchant_mercy",
    [],
    "I'll let you live, if you promise me...",
    "local_merchant_mercy_yes",
    []],

  [anyone, "local_merchant_mercy_yes",
    [],
    "Of course, I promise, I'll do anything. Just spare my life... ",
    "local_merchant_mercy_yes_2",
    []],

  [plyr|anyone, "local_merchant_mercy_yes_2",
    [],
    "You are going to forget about {s2}'s debt to you. And you will sign a paper stating that he owes you nothing.",
    "local_merchant_mercy_yes_3",
    []],

  [anyone, "local_merchant_mercy_yes_3",
    [],
    "Yes, of course. I'll do as you say.",
    "local_merchant_mercy_yes_4",
    []],

  [plyr|anyone, "local_merchant_mercy_yes_4",
    [],
    "And if you so much as think about complaining about this, I'll come back for you, and it won't matter how much you scream for mercy then. Do you understand me?",
    "local_merchant_mercy_yes_5",
    []],

  [anyone, "local_merchant_mercy_yes_5",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}! Don't worry. You won't hear no complaints outta me!",
    "local_merchant_mercy_yes_6",
    []],

  [plyr|anyone, "local_merchant_mercy_yes_6",
    [],
    "Good. Go get outta here before I change my mind.",
    "close_window",
    [
      (quest_set_slot, "qst_kill_local_merchant", 11, 2),
      (call_script, "script_succeed_quest", "qst_kill_local_merchant"),
      (finish_mission),
    ]],

  [trp_fugitive_original, "start",
    [],
    "Yes, what do you want?",
    "fugitive_original_1",
    []],

  [plyr|trp_fugitive_original, "fugitive_original_1",
    [
      (quest_get_slot, ":var0", "qst_hunt_down_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
    ],
    "I'm looking for {s4}. You fit his description.",
    "fugitive_original_2",
    []],

  [plyr|trp_fugitive_original, "fugitive_original_1",
    [],
    "Nothing. Sorry to trouble you.",
    "close_window",
    []],

  [trp_fugitive_original, "fugitive_original_2",
    [],
    "I don't know who that is, and it sure as hell ain't me. Now stop bothering me and get outta here.",
    "fugitive_original_3",
    []],

  [plyr|trp_fugitive_original, "fugitive_original_3",
    [],
    "No. I want to know why you're hiding. If you're innocent, you have nothing to fear. I'm gonna go have a little chat with your neighbors, and if they verify your story, I'll leave.",
    "fugitive_original_4",
    []],

  [anyone, "fugitive_original_4",
    [],
    "If it's gonna come to this, then it's either you or me. Only one of is us gonna leave this town alive.  I challenge you to a duel.",
    "fugitive_original_5",
    []],

  [plyr|trp_fugitive_original, "fugitive_original_5",
    [],
    "That's how it will be.",
    "close_window",
    [
      (assign, "$fugitive_duel_reminder_count", 0),
      (quest_set_slot, "qst_hunt_down_fugitive", 11, 2),
    ]],

  [plyr|trp_fugitive_original, "fugitive_original_5",
    [],
    "I'm not risking my life in a gunfight. I'm gonna get the sheriff over here to surround you with his men.",
    "fugitive_original_6",
    []],

  [anyone, "fugitive_original_6",
    [],
    "I'm afraid I can't let you do that. They're gonna hang me. I'd rather kill one more asshole than face the gallows.",
    "close_window",
    [
      (set_party_battle_mode),
      (try_for_agents, ":var0"),
        (agent_get_troop_id, ":var1", ":var0"),
        (eq, ":var1", "trp_fugitive_original"),
        (agent_set_team, ":var0", 1),
      (try_end),
      (quest_set_slot, "qst_hunt_down_fugitive", 11, 1),
    ]],

  [trp_fugitive_wanted_1, "start",
    [],
    "Uh, hello?",
    "fugitive_wanted_1_1",
    []],

  [plyr|trp_fugitive_wanted_1, "fugitive_wanted_1_1",
    [
      (quest_get_slot, ":var0", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
      (quest_get_slot, ":var1", "qst_wanted_fugitive", 16),
      (str_store_string, s5, ":var1"),
      (quest_get_slot, ":var2", "qst_wanted_fugitive", 12),
      (str_store_party_name, s6, ":var2"),
    ],
    "I'm looking for {s4}.  He's wanted in {s6} for {s5}. You fit his description.",
    "fugitive_wanted_1_2",
    []],

  [plyr|trp_fugitive_wanted_1, "fugitive_wanted_1_1",
    [],
    "Nothing. Sorry to trouble you.",
    "close_window",
    []],

  [trp_fugitive_wanted_1, "fugitive_wanted_1_2",
    [],
    "Uh, listen Mister. My crime isn't such a big deal, but I can't let you bring me in! My brother-in-law's the local judge, and he's had it in for me from the first day I got married to his sister!  He'll hang me without a trial!",
    "fugitive_wanted_1_3",
    []],

  [plyr|trp_fugitive_wanted_1, "fugitive_wanted_1_3",
    [],
    "If you're innocent, you have nothing to fear. Let me take you in and I'll see that justice is done properly.",
    "fugitive_wanted_1_4",
    []],

  [anyone, "fugitive_wanted_1_4",
    [],
    "I told you there ain't no justice for me!   If'n you don't back down, I'll shoot you you right where you stand!",
    "fugitive_wanted_1_5",
    []],

  [plyr|trp_fugitive_wanted_1, "fugitive_wanted_1_5",
    [],
    "I'd like to see you try. Get ready for my brand of justice.",
    "close_window",
    [
      (assign, "$fugitive_duel_reminder_count", 0),
      (quest_set_slot, "qst_wanted_fugitive", 11, 2),
    ]],

  [plyr|trp_fugitive_wanted_1, "fugitive_wanted_1_5",
    [],
    "I'll talk with the local sheriff and put you under his protection.",
    "fugitive_wanted_1_6",
    []],

  [anyone, "fugitive_wanted_1_6",
    [],
    "They're all in cohoots together! They set me up! You pushed me to this!",
    "close_window",
    [
      (set_party_battle_mode),
      (try_for_agents, ":var0"),
        (agent_get_troop_id, ":var1", ":var0"),
        (eq, ":var1", "trp_fugitive_wanted_1"),
        (agent_set_team, ":var0", 1),
      (try_end),
      (quest_set_slot, "qst_wanted_fugitive", 11, 1),
    ]],

  [trp_fugitive_wanted_2, "start",
    [],
    "What the hell are you lookin' at?",
    "fugitive_wanted_2_1",
    []],

  [plyr|trp_fugitive_wanted_2, "fugitive_wanted_2_1",
    [
      (quest_get_slot, ":var0", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
      (quest_get_slot, ":var1", "qst_wanted_fugitive", 16),
      (str_store_string, s5, ":var1"),
      (quest_get_slot, ":var2", "qst_wanted_fugitive", 12),
      (str_store_party_name, s6, ":var2"),
    ],
    "I'm lookin' at {s4}, wanted in {s6} for {s5}.",
    "fugitive_wanted_2_2",
    []],

  [plyr|trp_fugitive_wanted_2, "fugitive_wanted_2_1",
    [],
    "Nothing. Sorry to trouble you.",
    "close_window",
    []],

  [trp_fugitive_wanted_2, "fugitive_wanted_2_2",
    [],
    "Well ain't you smart? But are you smart enough to turn around and walk away 'fore I paint the thoroughfare red with your blood?",
    "fugitive_wanted_2_3",
    []],

  [plyr|trp_fugitive_wanted_2, "fugitive_wanted_2_3",
    [],
    "This is your last chance. Hand over your weapons and come with me.",
    "fugitive_wanted_2_4",
    []],

  [anyone, "fugitive_wanted_2_4",
    [],
    "I ain't goin' anywhere with you. Take your gun and leave, or take your paces. It's your choice.",
    "fugitive_wanted_2_5",
    []],

  [plyr|trp_fugitive_wanted_2, "fugitive_wanted_2_5",
    [],
    "You gonna skin that smoke wagon, or are you just gonna stand there lookin' dumb?",
    "close_window",
    [
      (assign, "$fugitive_duel_reminder_count", 0),
      (quest_set_slot, "qst_wanted_fugitive", 11, 2),
    ]],

  [plyr|trp_fugitive_wanted_2, "fugitive_wanted_2_5",
    [],
    "I won't be takin' my paces. I prefer to do my killin' up close.",
    "fugitive_wanted_2_6",
    []],

  [anyone, "fugitive_wanted_2_6",
    [],
    "You dirty son-of-a-bitch!",
    "close_window",
    [
      (set_party_battle_mode),
      (try_for_agents, ":var0"),
        (agent_get_troop_id, ":var1", ":var0"),
        (eq, ":var1", "trp_fugitive_wanted_2"),
        (agent_set_team, ":var0", 1),
      (try_end),
      (quest_set_slot, "qst_wanted_fugitive", 11, 1),
    ]],

  [trp_fugitive_wanted_3, "start",
    [],
    "You a lawman?  You smell like a lawman.",
    "fugitive_wanted_3_1",
    []],

  [plyr|trp_fugitive_wanted_3, "fugitive_wanted_3_1",
    [
      (quest_get_slot, ":var0", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
      (quest_get_slot, ":var1", "qst_wanted_fugitive", 16),
      (str_store_string, s5, ":var1"),
      (quest_get_slot, ":var2", "qst_wanted_fugitive", 12),
      (str_store_party_name, s6, ":var2"),
    ],
    "And you smell like a man wanted for {s5}.",
    "fugitive_wanted_3_2",
    []],

  [plyr|trp_fugitive_wanted_3, "fugitive_wanted_3_1",
    [],
    "Nothing. Sorry to trouble you.",
    "close_window",
    []],

  [trp_fugitive_wanted_3, "fugitive_wanted_3_2",
    [],
    "Yes, I am {s4}. I take it you've heard of me. Tell me, how are the good people of {s6} these days?",
    "fugitive_wanted_3_3",
    []],

  [plyr|trp_fugitive_wanted_3, "fugitive_wanted_3_3",
    [],
    "They'll be much better once you've been brought to trial for your heinous crimes. Will you come peacefully?",
    "fugitive_wanted_3_4",
    []],

  [anyone, "fugitive_wanted_3_4",
    [],
    "Now if you'd have really heard of me, you'd already know the answer to that.  I'm gonna kill you dead for insultin' my reputation.",
    "fugitive_wanted_3_5",
    []],

  [plyr|trp_fugitive_wanted_3, "fugitive_wanted_3_5",
    [],
    "Let's see if you shoot have as fast as you talk",
    "close_window",
    [
      (assign, "$fugitive_duel_reminder_count", 0),
      (quest_set_slot, "qst_wanted_fugitive", 11, 2),
    ]],

  [plyr|trp_fugitive_wanted_3, "fugitive_wanted_3_5",
    [],
    "You think I'm dumb enough to draw on you? I'm gonna kill you right now.",
    "fugitive_wanted_3_6",
    []],

  [anyone, "fugitive_wanted_3_6",
    [],
    "How sad.  A man after my own heart. And now I have to kill you.",
    "close_window",
    [
      (set_party_battle_mode),
      (try_for_agents, ":var0"),
        (agent_get_troop_id, ":var1", ":var0"),
        (eq, ":var1", "trp_fugitive_wanted_3"),
        (agent_set_team, ":var0", 1),
      (try_end),
      (quest_set_slot, "qst_wanted_fugitive", 11, 1),
    ]],

  [trp_wanted_sign, "start",
    [
      (eq, "$g_wanted_quest_completed", 1),
    ],
    "You are finished with this fugitive.",
    "close_window",
    [
      (get_player_agent_no, ":var0"),
      (scene_prop_get_instance, ":var1", "spr_wanted_poster_camera", 0),
      (prop_instance_get_position, pos1, ":var1"),
      (agent_get_horse, ":var2", ":var0"),
      (try_begin),
        (lt, ":var2", 0),
        (agent_set_position, ":var0", pos1),
      (else_try),
        (agent_set_position, ":var2", pos1),
      (try_end),
    ]],

  [trp_wanted_sign, "start",
    [
      (neg|check_quest_active, "qst_wanted_fugitive"),
    ],
    "Wanted dead or alive: {s4}^Wanted for {s5}^Last known location: {s3}^Reward: {reg0} Dollars",
    "wanted_sign_1",
    [
      (get_player_agent_no, ":var0"),
      (scene_prop_get_instance, ":var1", "spr_wanted_poster_camera", 0),
      (prop_instance_get_position, pos1, ":var1"),
      (agent_get_horse, ":var2", ":var0"),
      (try_begin),
        (lt, ":var2", 0),
        (agent_set_position, ":var0", pos1),
      (else_try),
        (agent_set_position, ":var2", pos1),
      (try_end),
      (quest_set_slot, "qst_wanted_fugitive", 12, "$current_town"),
      (quest_set_slot, "qst_wanted_fugitive", 6, "$g_talk_troop"),
      (quest_get_slot, ":var3", "qst_wanted_fugitive", 1),
      (str_store_party_name, s3, ":var3"),
      (quest_get_slot, ":var4", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var4"),
      (str_store_string, s4, s50),
      (quest_get_slot, ":var5", "qst_wanted_fugitive", 16),
      (str_store_string, s5, ":var5"),
      (quest_get_slot, ":var6", "qst_wanted_fugitive", 22),
      (assign, reg0, ":var6"),
      (val_div, reg0, 100),
      (str_store_party_name, s6, "$current_town"),
      (setup_quest_text, "qst_wanted_fugitive"),
      (str_store_string, s2, "@{s4} is wanted dead or alive for {s5} in {s6}. He is currently believed to be at {s3}."),
    ]],

  [trp_wanted_sign, "start",
    [
      (check_quest_active, "qst_wanted_fugitive"),
      (quest_slot_eq, "qst_wanted_fugitive", 12, "$current_town"),
    ],
    "Wanted dead or alive: {s4}^Wanted for {s5}^Last known location: {s3}^Reward: {reg0} Dollars",
    "wanted_sign_1",
    [
      (get_player_agent_no, ":var0"),
      (scene_prop_get_instance, ":var1", "spr_wanted_poster_camera", 0),
      (prop_instance_get_position, pos1, ":var1"),
      (agent_get_horse, ":var2", ":var0"),
      (try_begin),
        (lt, ":var2", 0),
        (agent_set_position, ":var0", pos1),
      (else_try),
        (agent_set_position, ":var2", pos1),
      (try_end),
      (quest_get_slot, ":var3", "qst_wanted_fugitive", 1),
      (str_store_party_name, s3, ":var3"),
      (quest_get_slot, ":var4", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var4"),
      (str_store_string, s4, s50),
      (quest_get_slot, ":var5", "qst_wanted_fugitive", 16),
      (str_store_string, s5, ":var5"),
      (quest_get_slot, ":var6", "qst_wanted_fugitive", 22),
      (assign, reg0, ":var6"),
      (val_div, reg0, 100),
    ]],

  [trp_wanted_sign, "start",
    [
      (check_quest_active, "qst_wanted_fugitive"),
      (neg|quest_slot_eq, "qst_wanted_fugitive", 12, "$current_town"),
    ],
    "Wanted dead or alive: {s4}^Wanted for {s5}^Last known location: {s3}^Reward: {reg0} Dollars ^^ (You accepted this bounty in {s6})",
    "wanted_sign_1",
    [
      (get_player_agent_no, ":var0"),
      (scene_prop_get_instance, ":var1", "spr_wanted_poster_camera", 0),
      (prop_instance_get_position, pos1, ":var1"),
      (agent_get_horse, ":var2", ":var0"),
      (try_begin),
        (lt, ":var2", 0),
        (agent_set_position, ":var0", pos1),
      (else_try),
        (agent_set_position, ":var2", pos1),
      (try_end),
      (quest_get_slot, ":var3", "qst_wanted_fugitive", 1),
      (str_store_party_name, s3, ":var3"),
      (quest_get_slot, ":var4", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var4"),
      (str_store_string, s4, s50),
      (quest_get_slot, ":var5", "qst_wanted_fugitive", 16),
      (str_store_string, s5, ":var5"),
      (quest_get_slot, ":var6", "qst_wanted_fugitive", 22),
      (assign, reg0, ":var6"),
      (val_div, reg0, 100),
      (quest_get_slot, ":var7", "qst_wanted_fugitive", 12),
      (str_store_party_name, s6, ":var7"),
    ]],

  [plyr|trp_wanted_sign, "wanted_sign_1",
    [
      (neg|check_quest_active, "qst_wanted_fugitive"),
    ],
    "I will bring him to justice.",
    "wanted_sign_2",
    [
      (call_script, "script_start_quest", "qst_wanted_fugitive", "$g_talk_troop"),
    ]],

  [plyr|trp_wanted_sign, "wanted_sign_1",
    [
      (check_quest_active, "qst_wanted_fugitive"),
      (check_quest_succeeded, "qst_wanted_fugitive"),
    ],
    "(Claim your reward)",
    "wanted_sign_reward_1",
    []],

  [plyr|trp_wanted_sign, "wanted_sign_1",
    [
      (check_quest_active, "qst_wanted_fugitive"),
      (neg|check_quest_succeeded, "qst_wanted_fugitive"),
    ],
    "I am abandoning this bounty.",
    "wanted_sign_cancel",
    []],

  [plyr|trp_wanted_sign, "wanted_sign_1",
    [
      (check_quest_active, "qst_wanted_fugitive"),
      (check_quest_failed, "qst_wanted_fugitive"),
    ],
    "(Admit your failure)",
    "wanted_sign_fail",
    []],

  [plyr|trp_wanted_sign, "wanted_sign_1",
    [],
    "I'm not interested in this right now.",
    "close_window",
    []],

  [trp_wanted_sign, "wanted_sign_2",
    [],
    "To claim your reward, simply return here after {s4} has been killed or captured.",
    "close_window",
    []],

  [trp_wanted_sign, "wanted_sign_reward_1",
    [],
    "{s4} has been brought to justice. The bounty is ${reg0}.",
    "wanted_sign_reward_2",
    [
      (quest_get_slot, ":var0", "qst_wanted_fugitive", 22),
      (assign, reg0, ":var0"),
      (val_div, reg0, 100),
      (quest_get_slot, ":var1", "qst_wanted_fugitive", 21),
      (add_xp_as_reward, ":var1"),
    ]],

  [plyr|trp_wanted_sign, "wanted_sign_reward_2",
    [],
    "(Accept the reward)",
    "wanted_sign_reward_accept",
    []],

  [plyr|trp_wanted_sign, "wanted_sign_reward_2",
    [],
    "(Donate the reward to the victims of his crimes)",
    "wanted_sign_reward_reject",
    []],

  [trp_wanted_sign, "wanted_sign_reward_accept",
    [],
    "You claim your reward for the bounty of {s4}.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_wanted_fugitive", 22),
      (assign, "$g_wanted_quest_completed", 1),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (call_script, "script_end_quest", "qst_wanted_fugitive"),
      (call_script, "script_setup_wanted_fugitive_quest"),
    ]],

  [trp_wanted_sign, "wanted_sign_reward_reject",
    [],
    "You donate your reward for the bounty of {s4} to the victims of his crimes.",
    "close_window",
    [
      (call_script, "script_change_player_honor", 2),
      (assign, "$g_wanted_quest_completed", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (call_script, "script_end_quest", "qst_wanted_fugitive"),
      (call_script, "script_setup_wanted_fugitive_quest"),
    ]],

  [trp_wanted_sign, "wanted_sign_cancel",
    [],
    "{s4} is someone else's problem now.",
    "close_window",
    [
      (assign, "$g_wanted_quest_completed", 1),
      (call_script, "script_cancel_quest", "qst_wanted_fugitive"),
      (call_script, "script_setup_wanted_fugitive_quest"),
    ]],

  [trp_wanted_sign, "wanted_sign_fail",
    [],
    "Word seems to have gotten around that {s4} got the better of you.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_center", "$current_town", -1),
      (assign, "$g_wanted_quest_completed", 1),
      (call_script, "script_end_quest", "qst_wanted_fugitive"),
      (call_script, "script_setup_wanted_fugitive_quest"),
    ]],

  [anyone, "member_chat",
    [
      (check_quest_active, "qst_incriminate_loyal_commander"),
      (quest_slot_eq, "qst_incriminate_loyal_commander", 11, 0),
      (store_conversation_troop, "$g_talk_troop"),
      (eq, "$g_talk_troop", "$incriminate_quest_sacrificed_troop"),
      (quest_get_slot, ":var0", "qst_incriminate_loyal_commander", 1),
      (store_distance_to_party_from_party, ":var1", "p_main_party", ":var0"),
      (lt, ":var1", 10),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}?",
    "sacrificed_messenger_1",
    []],

  [plyr|anyone, "sacrificed_messenger_1",
    [
      (quest_get_slot, ":var0", "qst_incriminate_loyal_commander", 1),
      (str_store_party_name, s1, ":var0"),
      (quest_get_slot, ":var1", "qst_incriminate_loyal_commander", 4),
      (str_store_troop_name, s2, ":var1"),
    ],
    "Take this letter to {s1} and give it to {s2}.",
    "sacrificed_messenger_2",
    []],

  [plyr|anyone, "sacrificed_messenger_1",
    [],
    "Nothing. Nothing at all.",
    "close_window",
    []],

  [anyone, "sacrificed_messenger_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}. You can trust me. I will not fail you.",
    "sacrificed_messenger_3",
    []],

  [plyr|anyone, "sacrificed_messenger_3",
    [],
    "Good. I will not forget your service. You will be rewarded when you return.",
    "close_window",
    [
      (party_remove_members, "p_main_party", "$g_talk_troop", 1),
      (set_spawn_radius, 0),
      (spawn_around_party, "p_main_party", "pt_sacrificed_messenger"),
      (assign, ":var0", reg0),
      (party_add_members, ":var0", "$g_talk_troop", 1),
      (party_set_ai_behavior, ":var0", ai_bhvr_travel_to_party),
      (quest_get_slot, ":var1", "qst_incriminate_loyal_commander", 1),
      (party_set_ai_object, ":var0", ":var1"),
      (party_set_flags, ":var0", 65536, 0),
      (quest_set_slot, "qst_incriminate_loyal_commander", 11, 2),
      (quest_set_slot, "qst_incriminate_loyal_commander", 8, ":var0"),
    ]],

  [plyr|anyone, "sacrificed_messenger_3",
    [],
    "Arggh! I can't do this. I can't send you to your own death!",
    "sacrificed_messenger_cancel",
    []],

  [anyone, "sacrificed_messenger_cancel",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "What do you mean,{reg18?ma'am:sir}?",
    "sacrificed_messenger_cancel_2",
    []],

  [plyr|anyone, "sacrificed_messenger_cancel_2",
    [
      (quest_get_slot, ":var0", "qst_incriminate_loyal_commander", 6),
      (str_store_troop_name, s3, ":var0"),
    ],
    "There is a trap set for you in the town. {s3} ordered me to sacrifice one of my chosen warriors to fool the enemy, but he will just need to find another way.",
    "sacrificed_messenger_cancel_3",
    [
      (quest_get_slot, ":var0", "qst_incriminate_loyal_commander", 6),
      (quest_set_slot, "qst_incriminate_loyal_commander", 11, 1),
      (call_script, "script_change_player_relation_with_troop", ":var0", -5),
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_fail_quest", "qst_incriminate_loyal_commander"),
    ]],

  [anyone, "sacrificed_messenger_cancel_3",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Much obliged, {reg18?ma'am:sir}. I will follow you to the gates of hell, {reg18?ma'am:sir}. But even so, I'd prefer not to go inside.",
    "close_window",
    []],

  [party_tpl|pt_sacrificed_messenger, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Don't worry, {reg18?ma'am:sir}. I'm on my way.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_spy, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day {reg18?ma'am:sir}. Such fine weather, ain't it? If you'll excuse me now I must go on my way.",
    "follow_spy_talk",
    []],

  [plyr|anyone, "follow_spy_talk",
    [
      (quest_get_slot, ":var0", "qst_follow_spy", 6),
      (str_store_troop_name, s1, ":var0"),
    ],
    "In the name of {s1}, you are under arrest!",
    "follow_spy_talk_2",
    []],

  [anyone, "follow_spy_talk_2",
    [],
    "You won't get me alive!",
    "close_window",
    []],

  [plyr|anyone, "follow_spy_talk",
    [],
    "Never mind me. I was just passing by.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_spy_partners, "start",
    [],
    "Greetings.",
    "spy_partners_talk",
    []],

  [plyr|anyone, "spy_partners_talk",
    [
      (quest_get_slot, ":var0", "qst_follow_spy", 6),
      (str_store_troop_name, s1, ":var0"),
    ],
    "In the name of {s1} You are under arrest!",
    "spy_partners_talk_2",
    []],

  [anyone, "spy_partners_talk_2",
    [],
    "You will have to fight us first!",
    "close_window",
    []],

  [plyr|anyone, "spy_partners_talk",
    [],
    "Never mind me. I was just passing by.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_runaway_serfs, "start",
    [
      (party_slot_eq, "$g_encountered_party", 10, 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day {reg18?ma'am:sir}.",
    "runaway_serf_intro_1",
    [
      (party_set_slot, "$g_encountered_party", 10, 1),
    ]],

  [plyr|anyone, "runaway_serf_intro_1",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 6),
      (str_store_troop_name, s4, ":var0"),
    ],
    "I have been sent by your {s4} whom you are running from. I am told that you will not be punished you if you return now.",
    "runaway_serf_intro_2",
    []],

  [anyone, "runaway_serf_intro_2",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 1),
      (str_store_party_name, s6, ":var0"),
      (quest_get_slot, ":var1", "qst_bring_back_runaway_serfs", 7),
      (str_store_party_name, s1, ":var1"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "My good {reg18?ma'am:sir}. Our lives at our village {s1} was unbearable. We worked all day long and still went to bed hungry. We are going to {s6} to start a new life, where we will be treated like humans.",
    "runaway_serf_intro_3",
    []],

  [plyr|anyone, "runaway_serf_intro_3",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (str_store_party_name, s1, ":var0"),
    ],
    "You will go back to {s1} now, or I will shoot out your legs and drag you back!",
    "runaway_serf_go_back",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (call_script, "script_change_player_relation_with_center", ":var0", -1),
    ]],

  [plyr|anyone, "runaway_serf_intro_3",
    [],
    "Well, maybe you are right. Alright then. If anyone asks, I haven't seen you.",
    "runaway_serf_let_go",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (call_script, "script_change_player_relation_with_center", ":var0", 1),
    ]],

  [party_tpl|pt_runaway_serfs, "runaway_serf_go_back",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (str_store_party_name, s5, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Alright then, {reg18?ma'am:sir}. I can see there ain't no changin your mind. We'll head back to {s5} now.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (party_set_ai_object, "$g_encountered_party", ":var0"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "runaway_serf_let_go",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Bless you, {reg18?ma'am:sir}. We will not forget your help.",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 11, 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_runaway_serfs, "start",
    [
      (party_slot_eq, "$g_encountered_party", 11, 1),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day {reg18?ma'am:sir}. Don't worry. If anyone asks, we haven't seen you.",
    "runaway_serf_reconsider",
    []],

  [plyr|anyone, "runaway_serf_reconsider",
    [],
    "I've changed my mind. You're going back to your village afterall.",
    "runaway_serf_go_back",
    [
      (party_set_slot, "$g_encountered_party", 11, 0),
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (call_script, "script_change_player_relation_with_center", ":var0", -2),
    ]],

  [plyr|anyone, "runaway_serf_reconsider",
    [],
    "Good. Go quickly now before I change my mind.",
    "runaway_serf_let_go",
    []],

  [party_tpl|pt_runaway_serfs, "start",
    [
      (party_slot_eq, "$g_encountered_party", 11, 0),
      (get_party_ai_object, ":var0"),
      (quest_get_slot, ":var1", "qst_bring_back_runaway_serfs", 7),
      (neq, ":var1", ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day {reg18?ma'am:sir}. We were heading back to {s5}, but I am afraid we lost our way.",
    "runaway_serf_talk_caught",
    []],

  [plyr|anyone, "runaway_serf_talk_caught",
    [],
    "Don't make the mistake of takin me for a fool. You are going back now!",
    "runaway_serf_go_back",
    []],

  [plyr|anyone, "runaway_serf_talk_caught",
    [],
    "Well, if you are that eager to go, then go.",
    "runaway_serf_let_go",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (call_script, "script_change_player_relation_with_center", ":var0", 1),
    ]],

  [party_tpl|pt_runaway_serfs, "start",
    [
      (quest_get_slot, ":var0", "qst_bring_back_runaway_serfs", 7),
      (str_store_party_name, s5, ":var0"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "We are on our way back to {s5}, {reg18?ma'am:sir}.",
    "runaway_serf_talk_again_return",
    []],

  [plyr|anyone, "runaway_serf_talk_again_return",
    [],
    "Get a move on, posthaste. The sooner you return the better.",
    "runaway_serf_talk_again_return_2",
    []],

  [plyr|anyone, "runaway_serf_talk_again_return",
    [],
    "Good. Keep going.",
    "runaway_serf_talk_again_return_2",
    []],

  [plyr|anyone, "runaway_serf_talk_again_return_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}. As you wish.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|auto_proceed|pt_deserters, "start",
    [
      (eq, "$talk_context", 2),
      (ge, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "deserters_f1",
    [
      (str_store_string, s11, "@Seen anyone we can kill and loot? We're startin' to run out of money."),
      (str_store_string, s12, "@We've got no fight with you. Know of anyone nearby that has heavy pockets?"),
      (str_store_string, s13, "@Good to see you out here. We're getting desperate. Anything you can do to help?"),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_deserters, "deserters_f1",
    [],
    "{s4}",
    "deserters_f2",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_f2",
    [],
    "That shiny equipment you deserted with doesn't belong in your hands. I think I'll kill you and take it.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_deserters, "deserters_f2",
    [],
    "I need more soldiers. Any of you looking to get back to work?",
    "deserters_f4",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_f2",
    [],
    "Yeah, these guys that just went by here an hour ago looked pretty vulnerable.",
    "deserters_f3",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_f2",
    [],
    "Nothing comes to mind. I have to keep traveling.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|party_tpl|pt_deserters, "deserters_f2",
    [
      (check_quest_active, "qst_bring_back_deserters"),
      (quest_get_slot, ":var0", "qst_bring_back_deserters", 2),
      (party_count_members_of_type, ":var1", "$g_encountered_party", ":var0"),
      (gt, ":var1", 1),
    ],
    "Friends, if you surrender to me now, you'll be able rejoin your army without punishment.",
    "deserters_join_as_prisoner",
    []],

  [party_tpl|pt_deserters, "deserters_f3",
    [],
    "We'll keep an eye out. Much appreciated.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_deserters, "deserters_f4",
    [
      (lt, "$g_talk_party_faction_relation", 10),
    ],
    "No, we left our armies for a reason. We don't like you enough to try taking orders again. What else do you need?",
    "deserters_f2",
    []],

  [party_tpl|pt_deserters, "deserters_f4",
    [
      (ge, "$g_talk_party_faction_relation", 10),
    ],
    "We'll consider it. We're getting pretty tired of not getting paid.",
    "common_recruitment_1",
    []],

  [party_tpl|auto_proceed|pt_deserters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (party_get_slot, ":var0", "$g_encountered_party", 3),
      (store_current_hours, ":var1"),
      (store_sub, ":var2", ":var0", ":var1"),
      (gt, ":var2", 0),
    ],
    "Warning: This line should never be displayed.",
    "deserters_ep1",
    [
      (str_store_string, s11, "@Still want to give us more of your money or something?"),
      (str_store_string, s12, "@What part of get lost didn't you understand?"),
      (str_store_string, s13, "@You better have a good reason for stickin' around."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_deserters, "deserters_ep1",
    [],
    "{s4}",
    "deserters_ep2",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_ep2",
    [],
    "Sorry to trouble you. I'll be on my way now.",
    "deserters_ep3",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_ep2",
    [],
    "Unfortunately for you, it's your turn to pay me this time.",
    "deserters_ep4",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_ep2",
    [
      (check_quest_active, "qst_bring_back_deserters"),
      (quest_get_slot, ":var0", "qst_bring_back_deserters", 2),
      (party_count_members_of_type, ":var1", "$g_encountered_party", ":var0"),
      (gt, ":var1", 1),
    ],
    "Listen Closely. Lay down your weapons and surrender to me now. You'll be able rejoin your army without punishment.",
    "deserters_join_as_prisoner",
    []],

  [party_tpl|pt_deserters, "deserters_ep3",
    [],
    "Stop fooling around and go make yourself some more money. I want to see those pockets full the next time I see you.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_deserters, "deserters_ep4",
    [],
    "What is this shit? You want trouble? Well you got it now!",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 3, 0),
      (party_ignore_player, "$g_encountered_party", 0),
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_deserters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
      (encountered_party_is_attacker),
    ],
    "Warning: This line should never be displayed.",
    "deserters_e1",
    [
      (str_store_string, s11, "@We left our army and fight only for ourselves from now on. Hand over everything you've got or we'll kill you all!"),
      (str_store_string, s12, "@If you aren't prepared to pay for passage, we're prepared to kill you where you stand."),
      (str_store_string, s13, "@Let's see those hands. We want everything you're carryin."),
      (store_random_in_range, ":var0", 11, 14),
      (str_store_string_reg, s4, ":var0"),
    ]],

  [party_tpl|pt_deserters, "deserters_e1",
    [],
    "{s4}",
    "deserters_e2",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_e2",
    [],
    "When I'm done with you, you'll regret ever leaving the army.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_deserters, "deserters_e2",
    [],
    "I'm not looking for trouble. Maybe we can pay our way?",
    "deserters_eb1",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_e2",
    [
      (store_skill_level, reg1, "skl_persuasion", "trp_player"),
    ],
    "Maybe you haven't heard of {playername}. You should reconsider your threat. (Persuasion)",
    "deserters_e3",
    [
      (call_script, "script_persuasion_attempt", reg1),
    ]],

  [plyr|party_tpl|pt_deserters, "deserters_e2",
    [
      (check_quest_active, "qst_bring_back_deserters"),
      (quest_get_slot, ":var0", "qst_bring_back_deserters", 2),
      (party_count_members_of_type, ":var1", "$g_encountered_party", ":var0"),
      (gt, ":var1", 1),
    ],
    "If you surrender to me now, you'll be able rejoin your army without punishment. Otherwise you'll deal with me.",
    "deserters_join_as_prisoner",
    []],

  [party_tpl|pt_deserters, "deserters_e3",
    [
      (eq, reg0, 0),
    ],
    "I don't care you you think you are. Let's kill this arrogant son-of-a-bitch!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_deserters, "deserters_e3",
    [
      (eq, reg0, 1),
    ],
    "Uh, I did not realize that. Well, {playername}, we didn't intend to be so impolite. Move on through, but don't linger, or we'll have no choice but to kill you.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_deserters, "deserters_eb1",
    [
      (call_script, "script_party_store_robbery_amount_to_reg5", "$g_talk_party_faction_relation", "p_main_party", "$g_encountered_party"),
      (call_script, "script_game_get_money_text", reg5),
    ],
    "Well, it looks to me that {s1} should be enough. Plus, we'll save money on bullets too.",
    "deserters_eb2",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_eb2",
    [
      (store_troop_gold, reg2),
      (ge, reg2, reg5),
    ],
    "Alright, here's your damn money.",
    "deserters_eb3",
    [
      (troop_remove_gold, "trp_player", reg5),
    ]],

  [party_tpl|pt_deserters, "deserters_eb3",
    [],
    "That wasn't so hard, was it? Get out of my face before I change my mind.",
    "close_window",
    [
      (store_current_hours, ":var0"),
      (val_add, ":var0", 72),
      (party_set_slot, "$g_encountered_party", 3, ":var0"),
      (party_ignore_player, "$g_encountered_party", 72),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|party_tpl|pt_deserters, "deserters_eb2",
    [],
    "Huh? Well it seems I don't have that much money with me.",
    "deserters_eb4",
    []],

  [party_tpl|pt_deserters, "deserters_eb4",
    [],
    "Well, I guess that's just too bad. We're gonna bleed it out of ya!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|auto_proceed|pt_deserters, "start",
    [
      (eq, "$talk_context", 2),
      (lt, "$g_talk_party_faction_relation", 0),
    ],
    "Warning: This line should never be displayed.",
    "deserters_n1",
    []],

  [party_tpl|pt_deserters, "deserters_n1",
    [],
    "Uh? What the hell is so important that you needed to bother us about it?",
    "deserters_n2",
    []],

  [plyr|party_tpl|pt_deserters, "deserters_n2",
    [],
    "It's time for your dirt nap, and I'm here to tuck you in.",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 3, 0),
      (party_ignore_player, "$g_encountered_party", 0),
      (encounter_attack),
    ]],

  [plyr|party_tpl|pt_deserters, "deserters_n2",
    [],
    "[Leave]",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|party_tpl|pt_deserters, "deserters_n2",
    [
      (check_quest_active, "qst_bring_back_deserters"),
      (quest_get_slot, ":var0", "qst_bring_back_deserters", 2),
      (party_count_members_of_type, ":var1", "$g_encountered_party", ":var0"),
      (gt, ":var1", 1),
    ],
    "You have one chance to surrender to me now, and you'll be able rejoin your army without punishment.",
    "deserters_join_as_prisoner",
    []],

  [party_tpl|pt_deserters, "deserters_join_as_prisoner",
    [
      (call_script, "script_party_calculate_strength", "p_main_party", 0),
      (assign, ":var0", reg0),
      (call_script, "script_party_calculate_strength", "$g_encountered_party", 0),
      (assign, ":var1", reg0),
      (val_mul, ":var1", 2),
      (ge, ":var0", ":var1"),
    ],
    "Hmm.. We have little opportunity out here, and this may be for the best. We'll become your prisoners then.",
    "close_window",
    [
      (assign, "$g_enemy_surrenders", 1),
    ]],

  [party_tpl|pt_deserters, "deserters_join_as_prisoner",
    [],
    "What? Nobody tells us to surrender!",
    "close_window",
    [
      (party_set_slot, "$g_encountered_party", 3, 0),
      (party_ignore_player, "$g_encountered_party", 0),
      (encounter_attack),
    ]],

  [anyone, "start",
    [
      (store_conversation_troop, reg1),
      (ge, reg1, "trp_town_1_tavernkeeper"),
      (lt, reg1, "trp_town_1_merchant"),
    ],
    "Hey, what can I do you for?",
    "tavernkeeper_talk",
    []],

  [anyone, "tavernkeeper_pretalk",
    [],
    "Anything else?",
    "tavernkeeper_talk",
    []],

  [plyr|anyone, "tavernkeeper_talk",
    [
      (check_quest_active, "qst_deliver_wine"),
      (quest_slot_eq, "qst_deliver_wine", 1, "$g_encountered_party"),
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (quest_get_slot, ":var1", "qst_deliver_wine", 10),
      (store_item_kind_count, ":var2", ":var0"),
      (ge, ":var2", ":var1"),
      (assign, reg9, ":var1"),
      (str_store_item_name, s4, ":var0"),
    ],
    "I was told to deliver you {reg9} units of {s4}.",
    "tavernkeeper_deliver_wine",
    []],

  [anyone, "tavernkeeper_deliver_wine",
    [],
    "At last! My stock was almost depleted. I had paid the cost of the {s4} in advance. Here, take these {reg5} cents. That should cover your pay. And give {s9} my regards. I'll put in a good word for you next time I deal with him.",
    "tavernkeeper_pretalk",
    [
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (quest_get_slot, ":var1", "qst_deliver_wine", 10),
      (quest_get_slot, ":var2", "qst_deliver_wine", 22),
      (quest_get_slot, ":var3", "qst_deliver_wine", 6),
      (troop_remove_items, "trp_player", ":var0", ":var1"),
      (call_script, "script_troop_add_gold", "trp_player", ":var2"),
      (assign, ":var4", ":var2"),
      (val_mul, ":var4", 2),
      (add_xp_as_reward, ":var4"),
      (assign, reg5, ":var2"),
      (str_store_item_name, s4, ":var0"),
      (str_store_troop_name, s9, ":var3"),
      (quest_get_slot, ":var5", "qst_deliver_wine", 12),
      (call_script, "script_change_player_relation_with_center", ":var5", 2),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (call_script, "script_end_quest", "qst_deliver_wine"),
    ]],

  [plyr|anyone, "tavernkeeper_talk",
    [
      (check_quest_active, "qst_deliver_wine"),
      (quest_slot_eq, "qst_deliver_wine", 1, "$g_encountered_party"),
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (quest_get_slot, ":var1", "qst_deliver_wine", 10),
      (store_item_kind_count, ":var2", ":var0"),
      (lt, ":var2", ":var1"),
      (gt, ":var2", 0),
      (assign, reg9, ":var1"),
      (str_store_item_name, s4, ":var0"),
    ],
    "I was told to deliver you {reg9} units of {s4}, but I lost some of the cargo on the way.",
    "tavernkeeper_deliver_wine_incomplete",
    []],

  [anyone, "tavernkeeper_deliver_wine_incomplete",
    [],
    "Attacked by bandits eh? You are lucky they left you alive. Anyway, I can pay you no more than {reg5} cents for this. And I will let {s1} know that my order was delivered less than completely, so you will probably be charged for this loss.",
    "tavernkeeper_pretalk",
    [
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (quest_get_slot, ":var1", "qst_deliver_wine", 10),
      (quest_get_slot, ":var2", "qst_deliver_wine", 22),
      (quest_get_slot, ":var3", "qst_deliver_wine", 6),
      (store_item_kind_count, ":var4", ":var0"),
      (troop_remove_items, "trp_player", ":var0", ":var4"),
      (val_mul, ":var2", ":var4"),
      (val_div, ":var2", ":var1"),
      (call_script, "script_troop_add_gold", "trp_player", ":var2"),
      (assign, reg5, ":var2"),
      (assign, ":var5", ":var2"),
      (val_mul, ":var5", 4),
      (add_xp_as_reward, ":var5"),
      (str_store_troop_name, s1, ":var3"),
      (assign, ":var6", "$qst_deliver_wine_debt"),
      (store_sub, ":var7", ":var1", ":var4"),
      (val_mul, ":var6", ":var7"),
      (val_div, ":var6", ":var1"),
      (val_add, "$debt_to_merchants_guild", ":var6"),
      (quest_get_slot, ":var8", "qst_deliver_wine", 12),
      (call_script, "script_change_player_relation_with_center", ":var8", 1),
      (call_script, "script_end_quest", "qst_deliver_wine"),
    ]],

  [plyr|anyone, "tavernkeeper_talk",
    [
      (check_quest_active, "qst_deliver_wine"),
      (quest_slot_eq, "qst_deliver_wine", 1, "$g_encountered_party"),
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (store_item_kind_count, ":var1", ":var0"),
      (eq, ":var1", 0),
      (quest_get_slot, reg9, "qst_deliver_wine", 10),
      (str_store_item_name, s4, ":var0"),
    ],
    "I was told to deliver you {reg9} units of {s4}, but I lost the cargo on the way.",
    "tavernkeeper_deliver_wine_lost",
    []],

  [anyone, "tavernkeeper_deliver_wine_lost",
    [],
    "What? I was waiting for that {s4} for weeks! And now you are telling me that you lost it? You may rest assured that I will let {s1} know about this.",
    "tavernkeeper_pretalk",
    [
      (add_xp_as_reward, 40),
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (quest_get_slot, ":var1", "qst_deliver_wine", 6),
      (str_store_item_name, s4, ":var0"),
      (str_store_troop_name, s1, ":var1"),
      (val_add, "$debt_to_merchants_guild", "$qst_deliver_wine_debt"),
      (call_script, "script_end_quest", "qst_deliver_wine"),
    ]],

  [plyr|anyone, "tavernkeeper_talk",
    [
      (store_current_hours, ":var0"),
      (val_sub, ":var0", 24),
      (gt, ":var0", "$buy_drinks_last_time"),
    ],
    "I'd like to buy every man who comes in here tonight a bottle of your best wine.",
    "tavernkeeper_buy_drinks",
    []],

  [anyone, "tavernkeeper_buy_drinks",
    [],
    "That'll be ten dollars. What should I tell everyone?",
    "tavernkeeper_buy_drinks_2",
    [
      (assign, "$temp", 1000),
      (assign, reg5, "$temp"),
    ]],

  [plyr|anyone, "tavernkeeper_buy_drinks_2",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", "$temp"),
      (str_store_party_name, s10, "$current_town"),
    ],
    "Let everyone know of the generosity of {playername} to the people of {s10}.",
    "tavernkeeper_buy_drinks_end",
    []],

  [anyone, "tavernkeeper_buy_drinks_end",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Don't you worry, {reg18?ma'am:sir}. Your name will be cheered and toasted here all night.",
    "tavernkeeper_pretalk",
    [
      (troop_remove_gold, "trp_player", "$temp"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (store_current_hours, ":var0"),
      (assign, "$buy_drinks_last_time", ":var0"),
    ]],

  [plyr|anyone, "tavernkeeper_buy_drinks_2",
    [],
    "Actually, cancel that order.",
    "tavernkeeper_pretalk",
    []],

  [plyr|anyone, "tavernkeeper_talk",
    [],
    "I guess I should leave now.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_ransom_broker_1", "trp_tavern_traveler_1"),
      (eq, "$g_talk_troop_met", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Greetings to you, {reg18?ma'am:sir}. You look like someone who should get to know me.",
    "ransom_broker_intro",
    []],

  [plyr|anyone, "ransom_broker_intro",
    [],
    "Why is that?",
    "ransom_broker_intro_2",
    []],

  [anyone, "ransom_broker_intro_2",
    [],
    "I broker ransoms for the poor wretches who are captured in these endless wars. Normally I travel between the salt mines and the slave markets on the coast, on commission from those whose relatives have gone missing. But if I'm out on my errands of mercy, and I come across a fellow dragging around a captive or two, well, there's no harm in a little speculative investment, is there? And you look like the type who might have a prisoner to sell.",
    "ransom_broker_info_talk",
    [
      (assign, "$ransom_broker_families_told", 0),
      (assign, "$ransom_broker_prices_told", 0),
      (assign, "$ransom_broker_ransom_me_told", 0),
    ]],

  [plyr|anyone, "ransom_broker_info_talk",
    [
      (eq, "$ransom_broker_families_told", 0),
    ],
    "What if their families can't pay?",
    "ransom_broker_families",
    []],

  [anyone, "ransom_broker_families",
    [],
    "Oh, then I spin them a few heartwarming tales of life on the galleys. You'd be surprised what sorts of treasures a peasant can dig out of his cowshed or wheedle out of his cousins, assuming he's got the proper motivation! And if in the end they cannot come up with the silver, then there are always slave merchants who are looking for galley slaves. One cannot do Heaven's work with an empty purse, you see.",
    "ransom_broker_info_talk",
    [
      (assign, "$ransom_broker_families_told", 1),
    ]],

  [plyr|anyone, "ransom_broker_info_talk",
    [
      (eq, "$ransom_broker_prices_told", 0),
    ],
    "What can I get for a prisoner?",
    "ransom_broker_prices",
    []],

  [anyone, "ransom_broker_prices",
    [],
    "It varies. I fancy that I have a fine eye for assessing a ransom. There are a dozen little things about a man that will tell you whether he goes to bed hungry, or dines each night on soft dumplings and goose. The real money of course is in the gentry, and if you ever want to do my job you'll want to learn about every landowning family you can, their estates, their heraldry, their offspring both lawful and bastard, and, of course, their credit with the merchants.",
    "ransom_broker_info_talk",
    [
      (assign, "$ransom_broker_prices_told", 1),
    ]],

  [plyr|anyone, "ransom_broker_info_talk",
    [
      (eq, "$ransom_broker_ransom_me_told", 0),
    ],
    "Would you be able to ransom me if I were taken?",
    "ransom_broker_ransom_me",
    []],

  [anyone, "ransom_broker_ransom_me",
    [],
    "Of course. I'm welcome in every saloon in the west. There's not many who can say that! So always be sure to keep a pot of cents buried somewhere, and a loyal servant who can find it in a hurry.",
    "ransom_broker_info_talk",
    [
      (assign, "$ransom_broker_ransom_me_told", 1),
    ]],

  [plyr|anyone, "ransom_broker_info_talk",
    [],
    "That's all I need to know. Thanks.",
    "ransom_broker_pretalk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_ransom_broker_1", "trp_tavern_traveler_1"),
    ],
    "Greetings. If you have any prisoners, I will be happy to buy them from you.",
    "ransom_broker_talk",
    []],

  [anyone, "ransom_broker_pretalk",
    [],
    "Anyway, if you have any prisoners, I will be happy to buy them from you.",
    "ransom_broker_talk",
    []],

  [plyr|anyone, "ransom_broker_talk",
    [
      (store_num_regular_prisoners, reg0),
      (ge, reg0, 1),
    ],
    "Then you'd better bring your purse. I have got prisoners to sell.",
    "ransom_broker_sell_prisoners",
    []],

  [plyr|anyone, "ransom_broker_talk",
    [],
    "Tell me about what you do again.",
    "ransom_broker_intro_2",
    []],

  [plyr|anyone, "ransom_broker_talk",
    [],
    "Not this time. Good-bye.",
    "close_window",
    []],

  [anyone, "ransom_broker_sell_prisoners",
    [],
    "Let me see what you have...",
    "ransom_broker_sell_prisoners_2",
    [
      (change_screen_trade_prisoners),
    ]],

  [anyone, "ransom_broker_sell_prisoners_2",
    [],
    "I will be staying here for a few days. Let me know if you need my services.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_tavern_traveler_1", "trp_tavern_bookseller_1"),
      (str_store_troop_name, s10, "$g_talk_troop"),
      (eq, "$g_talk_troop_met", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Greetings, friend. You look like the kind of {reg18?woman:man} who'd do well to know me. I travel all across this wilderness, and I keep an open ear. I can provide you information that you might find useful, and for a bargain.",
    "tavern_traveler_talk",
    [
      (assign, "$traveler_land_asked", 0),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_tavern_traveler_1", "trp_tavern_bookseller_1"),
      (gt, "$last_lost_companion", 0),
      (assign, ":var0", -1),
      (troop_get_slot, ":var0", "$last_lost_companion", 12),
      (is_between, ":var0", "p_town_1", "p_castle_1"),
      (str_store_troop_name, s10, "$last_lost_companion"),
      (str_store_party_name, s11, ":var0"),
    ],
    "Greetings, {playername}. I saw your companion {s10} at a saloon in {s11} some days ago. I thought you might like to know.",
    "tavern_traveler_lost_companion_thanks",
    [
      (assign, "$last_lost_companion", 0),
    ]],

  [plyr|anyone, "tavern_traveler_lost_companion_thanks",
    [
      (troop_get_type, reg3, "$last_lost_companion"),
      (call_script, "script_troop_get_gender_to_reg18", "$last_lost_companion"),
    ],
    "Thanks. I'll go and find {reg18?her:him} there.",
    "tavern_traveler_pretalk",
    []],

  [plyr|anyone, "tavern_traveler_lost_companion_thanks",
    [],
    "Thanks, but I don't really care.",
    "tavern_traveler_pretalk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_tavern_traveler_1", "trp_tavern_bookseller_1"),
    ],
    "Greetings, {playername}.",
    "tavern_traveler_talk",
    [
      (assign, "$traveler_land_asked", 0),
    ]],

  [anyone, "tavern_traveler_pretalk",
    [],
    "Yes?",
    "tavern_traveler_talk",
    []],

  [plyr|anyone, "tavern_traveler_talk",
    [
      (eq, "$traveler_land_asked", 0),
    ],
    "What can you tell me about this land?",
    "tavern_traveler_tell_kingdoms",
    [
      (assign, "$traveler_land_asked", 1),
    ]],

  [anyone, "tavern_traveler_tell_kingdoms",
    [],
    "This land is being fought over, just as it always has been. As a result, there's seldom a break to the bitter wars which plague this land and drain its life blood. Well, at least this must be a good place to be for an adventurer such as yourself. With some luck and skill, you can make a name for yourself here, amass a fortune perhaps, or gain great power. Opportunities are endless and so are the rewards, if you are willing to risk your life for them.",
    "tavern_traveler_tell_kingdoms_2",
    []],

  [plyr|anyone, "tavern_traveler_tell_kingdoms_2",
    [],
    "Tell me more about these opportunities.",
    "tavern_traveler_tell_kingdoms_3",
    []],

  [plyr|anyone, "tavern_traveler_tell_kingdoms_2",
    [],
    "Thank you. That was all I needed to know",
    "close_window",
    []],

  [anyone, "tavern_traveler_tell_kingdoms_3",
    [
      (gt, "$player_has_homage", 0),
    ],
    "Well, you probably know everything I could tell you already. You seem to be doing pretty well.",
    "tavern_traveler_tell_kingdoms_4",
    []],

  [anyone, "tavern_traveler_tell_kingdoms_3",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "The kingdoms will pay good money for mercenaries if they are engaged in a war. If you have done a bit of fighting, speaking with one of their lords will probably result in being offered a mercenary contract. However the real rewards come if you can manage to become a vassal to a king. A vassal can own villages, castles and towns and get rich with the taxes and revenues of these estates. Normally, only nobles of the realm own land in this way, but in time of war, a king will not hesitate to accept someone who distinugishes {reg18?herself:himself} on the battlefield as a vassal, and grant {reg18?her:him} the right to own land.",
    "tavern_traveler_tell_kingdoms_4",
    []],

  [anyone, "tavern_traveler_tell_kingdoms_4",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "The only path closed to one such as you would be becoming the {reg18?queen:king} of a kingdom. The people and nobles of these lands would never accept an upstart adventurer as their ruler. But don't think that kings can sit on their thrones too comfortably, either. They have their own rivals, those who are born to the right family, who could go around and stir up trouble saying they have a better claim to the throne than the current king. If those claim holders could find supporters, they could easily start civil wars and perhaps even replace the king one day.",
    "tavern_traveler_tell_kingdoms_5",
    []],

  [plyr|anyone, "tavern_traveler_tell_kingdoms_5",
    [],
    "Interesting. Where can I find these claim holders?",
    "tavern_traveler_tell_kingdoms_6",
    []],

  [plyr|anyone, "tavern_traveler_tell_kingdoms_5",
    [],
    "I guess I heard enough already. Thank you.",
    "close_window",
    []],

  [anyone, "tavern_traveler_tell_kingdoms_6",
    [],
    "A claim holder's life would be in danger in his own country of course. Therefore, they usually stay at rival courts, raising support and hoping to find someone willing to champion their cause. I usually hear news about some of them, and may be able to tell you their location with some precision. But of course, I would ask for a little something for such a service.",
    "tavern_traveler_pretalk",
    [
      (assign, "$traveller_claimants_mentioned", 1),
    ]],

  [plyr|anyone, "tavern_traveler_talk",
    [
      (eq, "$traveller_claimants_mentioned", 1),
    ],
    "I want to know the location of a claimant.",
    "tavern_traveler_pretender_location",
    []],

  [anyone, "tavern_traveler_pretender_location",
    [],
    "Whose location do you want to know?",
    "tavern_traveler_pretender_location_ask",
    []],

  [repeat_for_troops|plyr|anyone, "tavern_traveler_pretender_location_ask",
    [
      (store_repeat_object, ":var0"),
      (is_between, ":var0", 0, 0),
      (neg|troop_slot_eq, ":var0", 2, 2),
      (troop_slot_ge, ":var0", 12, 1),
      (str_store_troop_name, s11, ":var0"),
      (neq, ":var0", "$supported_pretender"),
    ],
    "{s11}",
    "tavern_traveler_pretender_location_ask_2",
    [
      (store_repeat_object, "$temp"),
    ]],

  [plyr|anyone, "tavern_traveler_pretender_location_ask",
    [],
    "Never mind.",
    "tavern_traveler_pretalk",
    []],

  [anyone, "tavern_traveler_pretender_location_ask_2",
    [],
    "I can reveal this information to you for a small price, let's say 30 cents.",
    "tavern_traveler_pretender_location_ask_money",
    []],

  [plyr|anyone, "tavern_traveler_pretender_location_ask_money",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 30),
    ],
    "Alright. Here's 30 cents.",
    "tavern_traveler_pretender_location_tell",
    [
      (troop_remove_gold, "trp_player", 30),
    ]],

  [plyr|anyone, "tavern_traveler_pretender_location_ask_money",
    [],
    "Never mind.",
    "tavern_traveler_pretalk",
    []],

  [anyone, "tavern_traveler_pretender_location_tell",
    [],
    "{s15} is currently at {s11}.",
    "tavern_traveler_pretalk",
    [
      (str_store_troop_name, s15, "$temp"),
      (troop_get_slot, ":var0", "$temp", 12),
      (str_store_party_name, s11, ":var0"),
    ]],

  [plyr|anyone, "tavern_traveler_talk",
    [],
    "I am looking for one of my companions...",
    "tavern_traveler_companion_location",
    []],

  [anyone, "tavern_traveler_companion_location",
    [],
    "Maybe I can help you. Who are you looking for?",
    "tavern_traveler_companion_location_ask",
    []],

  [repeat_for_troops|plyr|anyone, "tavern_traveler_companion_location_ask",
    [
      (store_repeat_object, ":var0"),
      (is_between, ":var0", "trp_npc1", "trp_kingdom_heroes_including_player_begin"),
      (troop_slot_ge, ":var0", 12, 1),
      (troop_slot_ge, ":var0", 82, 1),
      (str_store_troop_name, s11, ":var0"),
    ],
    "{s11}",
    "tavern_traveler_companion_location_ask_2",
    [
      (store_repeat_object, "$temp"),
    ]],

  [plyr|anyone, "tavern_traveler_companion_location_ask",
    [],
    "Never mind.",
    "close_window",
    []],

  [anyone, "tavern_traveler_companion_location_ask_2",
    [
      (str_store_troop_name, s15, "$temp"),
    ],
    "I guess I know where {s15} is. For 30 cents, I'll tell you.",
    "tavern_traveler_companion_location_ask_money",
    []],

  [plyr|anyone, "tavern_traveler_companion_location_ask_money",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 30),
    ],
    "Alright. Here is 30 cents.",
    "tavern_traveler_companion_location_tell",
    [
      (troop_remove_gold, "trp_player", 30),
    ]],

  [plyr|anyone, "tavern_traveler_companion_location_ask_money",
    [],
    "Never mind.",
    "close_window",
    []],

  [anyone, "tavern_traveler_companion_location_tell",
    [],
    "{s15} is currently at {s11}.",
    "close_window",
    [
      (str_store_troop_name, s15, "$temp"),
      (troop_get_slot, ":var0", "$temp", 12),
      (str_store_party_name, s11, ":var0"),
    ]],

  [plyr|anyone, "tavern_traveler_talk",
    [],
    "Farewell.",
    "close_window",
    []],

  [anyone, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (is_between, "$g_talk_troop", "trp_tavern_traveler_1", "trp_tavern_bookseller_1"),
      (party_get_slot, ":var0", "$g_encountered_party", 97),
      (str_store_faction_name, s17, ":var0"),
    ],
    "Greetings. They say you're the kind of {reg18?woman:man} who'd be interested to hear that I travel frequently to {s17}. I'll tell you all I know for just a dollar.",
    "tavern_traveler_answer",
    []],

  [plyr|anyone, "tavern_traveler_answer",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 100),
    ],
    "Here's a dollar. Tell me what you know.",
    "tavern_traveler_continue",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 97),
      (call_script, "script_update_faction_traveler_notes", ":var0"),
      (change_screen_notes, 2, ":var0"),
    ]],

  [plyr|anyone, "tavern_traveler_answer",
    [],
    "Sorry friend. I am not interested.",
    "close_window",
    []],

  [anyone, "tavern_traveler_continue",
    [],
    "Well, that's all I can tell you. Good bye.",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 100),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_tavern_bookseller_1", "trp_tavern_minstrel_1"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day {reg18?ma'am:sir}, will you be looking at my books?",
    "bookseller_talk",
    []],

  [plyr|anyone, "bookseller_talk",
    [],
    "Yes. Show me what you have for sale.",
    "bookseller_buy",
    []],

  [anyone, "bookseller_buy",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Of course {reg18?ma'am:sir}.",
    "book_trade_completed",
    [
      (change_screen_trade),
    ]],

  [anyone, "book_trade_completed",
    [],
    "Anything else?",
    "bookseller_talk",
    []],

  [plyr|anyone, "bookseller_talk",
    [],
    "Nothing. Thanks.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_tavern_minstrel_1", "trp_npc1"),
    ],
    "TODO: Hello. I am a minstrel. (Not implemeted yet)",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 14),
      (neg|check_quest_active, "qst_eliminate_bandits_infesting_village"),
      (neg|check_quest_active, "qst_deal_with_bandits_at_lords_village"),
      (assign, ":var0", "p_salt_mine"),
      (try_for_range, ":var1", "p_village_1", ":var0"),
        (party_slot_eq, ":var1", 120, "$g_encountered_party"),
        (party_slot_ge, ":var1", 39, 1),
        (str_store_party_name, s1, ":var1"),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", 1, ":var1"),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", 11, 0),
        (party_get_slot, ":var2", ":var1", 25),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", 6, ":var2"),
        (quest_set_slot, "qst_eliminate_bandits_infesting_village", 12, ":var1"),
        (assign, ":var0", 0),
      (try_end),
      (party_get_slot, ":var3", ":var1", 25),
      (eq, "$g_talk_troop", ":var3"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Excuse me, {reg18?ma'am:sir}? You look like someone who could help us. Will you hear me out?",
    "farmer_from_bandit_village_1",
    []],

  [plyr|anyone, "farmer_from_bandit_village_1",
    [],
    "What is the matter?",
    "farmer_from_bandit_village_2",
    []],

  [plyr|anyone, "farmer_from_bandit_village_1",
    [],
    "What are you blathering on about? Speak out.",
    "farmer_from_bandit_village_2",
    []],

  [anyone, "farmer_from_bandit_village_2",
    [],
    "A band of outlaws have taken refuge in our village. They take everything we have, force us to serve them, and do us much evil. If one of us so much as breathes a word of protest, they kill the poor soul on the spot right away. Our lives have become unbearable. I risked my skin and ran away to find someone who can help us.",
    "farmer_from_bandit_village_3",
    []],

  [plyr|anyone, "farmer_from_bandit_village_3",
    [],
    "Why don't you go to the commanding officer assigned to protect your village? He should take care of the vermin.",
    "farmer_from_bandit_village_4",
    []],

  [anyone, "farmer_from_bandit_village_4",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I did, {reg18?ma'am:sir}, but our commander's men did not let me see him and said he was occupied with more important matters and that we should deal with our own problem ourselves. Please {reg18?ma'am:sir}, you look like a {reg18?woman:man} of virtue, and you have no doubt many friends and soldiers at your service. If there is anyone who can help us, it's you.",
    "farmer_from_bandit_village_5",
    [
      (assign, "$temp", 0),
    ]],

  [plyr|anyone, "farmer_from_bandit_village_5",
    [],
    "Very well, I'll help you. Where is this village?",
    "farmer_from_bandit_village_accepted",
    []],

  [plyr|anyone, "farmer_from_bandit_village_5",
    [],
    "I can't be bothered with this right now.",
    "farmer_from_bandit_village_denied",
    []],

  [plyr|anyone, "farmer_from_bandit_village_5",
    [
      (eq, "$temp", 0),
    ],
    "Why would I fight these bandits? What's in it for me?",
    "farmer_from_bandit_village_barter",
    []],

  [anyone, "farmer_from_bandit_village_accepted",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "God bless you, {reg18?ma'am:sir}. Our village is {s7}. It is not too far from here.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_eliminate_bandits_infesting_village", 1),
      (str_store_party_name_link, s7, ":var0"),
      (setup_quest_text, "qst_eliminate_bandits_infesting_village"),
      (str_store_string, s2, "@A villager from {s7} begged you to save their village from the bandits that took refuge there."),
      (call_script, "script_start_quest", "qst_eliminate_bandits_infesting_village", "$g_talk_troop"),
    ]],

  [anyone, "farmer_from_bandit_village_denied",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "As you say {reg18?ma'am:sir}. Forgive me for taking up your time.",
    "close_window",
    []],

  [anyone, "farmer_from_bandit_village_barter",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "We are but poor farmers {reg18?ma'am:sir}, and the bandits have already got most of what we have on this world. Still, we'll be glad to share with you whatever we have got, and we'll always be in your gratitude if you help us.",
    "farmer_from_bandit_village_5",
    [
      (assign, "$temp", 1),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 14),
      (is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
      (check_quest_active, "qst_eliminate_bandits_infesting_village"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thank you for helping us,{reg18?ma'am:sir}. I wish you all the luck in the world in crushing those bandits!",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_trainer_1", "trp_ransom_broker_1"),
      (eq, "$g_talk_troop_met", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day to you {reg18?lass:lad}. You look like another adventurer who has come to try {reg18?her:his} chance in these lands. Well, trust my word, you won't be able to survive long here unless you know how to fight yourself out of a tight spot.",
    "trainer_intro_1",
    []],

  [plyr|anyone, "trainer_intro_1",
    [],
    "Thank you for your advice. This place looks like a training field. Maybe I can learn about fighting here?",
    "trainer_intro_2",
    []],

  [anyone, "trainer_intro_2",
    [],
    "Indeed you can. I am a veteran warrior... fought a good deal in the wars in my time. But these days, I train young novices in this area. I can find you some opponents to practice melee if you like. Or if you have any questions about the theory of combat, feel free to ask. For all ranged/mounted training just visit the Ranged weapon practice or Horseback practice grounds.",
    "trainer_intro_3",
    []],

  [plyr|anyone, "trainer_intro_3",
    [],
    "Yes, I do have a few questions.",
    "trainer_intro_4a",
    []],

  [plyr|anyone, "trainer_intro_3",
    [],
    "Actually, I can move on to practice.",
    "trainer_intro_4b",
    []],

  [anyone, "trainer_intro_4a",
    [],
    "Well, ask anything you like.",
    "trainer_talk_combat",
    []],

  [anyone, "trainer_intro_4b",
    [],
    "Good. It's good to find someone eager for practice. Let's see what you will do.",
    "trainer_practice_1",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_trainer_1", "trp_ransom_broker_1"),
      (neq, "$waiting_for_training_fight_result", 0),
      (neq, "$training_fight_won", 0),
    ],
    "That was a good fight. ",
    "trainer_practice_1",
    [
      (val_sub, "$num_opponents_to_beat_in_a_row", 1),
      (assign, "$waiting_for_training_fight_result", 0),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_trainer_1", "trp_ransom_broker_1"),
      (neq, "$waiting_for_training_fight_result", 0),
    ],
    "Ha! Looks like you've developed a bit of a limp there. Don't worry, even losses have their value, provided you learn from them. Shake the stars out of your eyes and get back in there. There's no other way to win.",
    "trainer_practice_1",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 3),
      (assign, "$waiting_for_training_fight_result", 0),
    ]],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_trainer_1", "trp_ransom_broker_1"),
    ],
    "Good day. Ready for some training today?",
    "trainer_talk",
    []],

  [anyone, "trainer_pretalk",
    [],
    "Ah, are you ready for some training?",
    "trainer_talk",
    []],

  [plyr|anyone, "trainer_talk",
    [],
    "I am ready for some practice.",
    "trainer_practice_1",
    []],

  [plyr|anyone, "trainer_talk",
    [],
    "First, tell me something about combat...",
    "trainer_combat_begin",
    []],

  [plyr|anyone, "trainer_talk",
    [],
    "I need to leave now. Farewell.",
    "close_window",
    []],

  [anyone, "trainer_combat_begin",
    [],
    "What do you want to know?",
    "trainer_talk_combat",
    []],

  [anyone, "trainer_combat_pretalk",
    [],
    "What else do you want to know?",
    "trainer_talk_combat",
    []],

  [plyr|anyone, "trainer_talk_combat",
    [],
    "Tell me about defending myself.",
    "trainer_explain_defense",
    []],

  [plyr|anyone, "trainer_talk_combat",
    [],
    "Tell me about attacking with weapons.",
    "trainer_explain_attack",
    []],

  [plyr|anyone, "trainer_talk_combat",
    [],
    "Tell me about fighting on horseback.",
    "trainer_explain_horseback",
    []],

  [plyr|anyone, "trainer_talk_combat",
    [],
    "I guess I know all the theory I need. Let's talk about something else.",
    "trainer_pretalk",
    []],

  [anyone, "trainer_explain_defense",
    [],
    "Good question. The first thing you should know as a fighter is how to defend yourself. Keeping yourself out of harm's way is the first rule of combat, and it is much more important than giving harm to others. Everybody can swing a Tomahawk around and hope to cut some flesh, but only those fighters that are experts at defense live to tell of it.",
    "trainer_explain_defense_2",
    []],

  [anyone, "trainer_explain_defense_2",
    [],
    "Now. Defending yourself is easiest if you are equipped with a shield. Just block with your shield. [Hold down the right mouse button to defend yourself with the shield.] In this state, you will be able to deflect all attacks that come from your front. However, you will still be open to strikes from your sides or your back.",
    "trainer_explain_defense_3",
    []],

  [plyr|anyone, "trainer_explain_defense_3",
    [],
    "What if I don't have shield?",
    "trainer_explain_defense_4",
    []],

  [anyone, "trainer_explain_defense_4",
    [],
    "Then you will have to use your weapon to block your opponent. This is a bit more difficult than defending with a shield. Defending with a weapon, you can block against only ONE attack direction. That is, you block against either overhead swings, side swings or thrusts. Therefore you must watch your opponent carefully and start to block AFTER he starts his attack. In this way you will be able to block against the direction of his current attack. If you start to block BEFORE he makes his move, he may just attack in another direction than the one you are blocking against and score a hit.",
    "trainer_combat_pretalk",
    []],

  [anyone, "trainer_explain_attack",
    [],
    "Good question. Attacking is the best defence, they say. A tactic many fighters find useful is taking an offensive stance and readying your weapon for attack, waiting for the right moment for swinging it. [You can ready your weapon for attack by pressing and holding down the left mouse button.]",
    "trainer_explain_attack_2",
    []],

  [plyr|anyone, "trainer_explain_attack_2",
    [],
    "That sounds useful.",
    "trainer_explain_attack_3",
    []],

  [anyone, "trainer_explain_attack_3",
    [],
    "It is a good tactic, but remember that, your opponent may see that and take a defensive stance against the direction you are swinging your weapon. If that happens, you must break your attack and quickly attack from another direction [You may cancel your current attack by quickly tapping the right mouse button].",
    "trainer_explain_attack_4",
    []],

  [plyr|anyone, "trainer_explain_attack_4",
    [],
    "If my opponent is defending against the direction I am attacking from, I will break and use another direction.",
    "trainer_explain_attack_5",
    []],

  [anyone, "trainer_explain_attack_5",
    [],
    "Yes, selecting the direction you swing your weapon is a crucial skill. There are four main directions you may use: right swing, left swing, overhead swing and thrust. You must use each one wisely. [to control your swing direction with default controls, move your mouse in the direction you want to swing from as you press the left mouse button].",
    "trainer_combat_pretalk",
    []],

  [anyone, "trainer_explain_horseback",
    [],
    "Very good question. A horse may be a warrior's most powerful weapon in combat. It gives you speed, height, power and initiative. A lot of deadly weapons will become even deadlier on horseback. However you must pay particular attention to horse-mounted enemies couching their lances, as they may take down any opponent in one hit. [To use the couched lance yourself, wield a lance or similar weapon, and speed up your horse without pressing attack or defense buttons. after you reach a speed, you'll lower your lance. Then try to target your enemies by maneuvering your horse.]",
    "trainer_combat_pretalk",
    []],

  [anyone, "trainer_practice_1",
    [
      (eq, "$training_system_explained", 0),
    ],
    "I train novices in four stages, each tougher than the one before. To finish a stage and advance to the next one, you have to win three fights in a row.",
    "trainer_practice_1",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 3),
      (assign, "$novicemaster_opponent_troop", "trp_novice_fighter"),
      (assign, "$training_system_explained", 1),
    ]],

  [anyone, "trainer_practice_1",
    [
      (ge, "$novice_training_difficulty", 4),
    ],
    "You have passed all stages of training. But if you want you can still practice. Are you ready?",
    "novicemaster_are_you_ready",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 99999),
    ]],

  [anyone, "trainer_practice_1",
    [
      (eq, "$num_opponents_to_beat_in_a_row", 0),
      (eq, "$novice_training_difficulty", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Way to go {reg18?lass:lad}. With this victory, you have advanced to the next training level. From now on your opponents will be regular fighters, not the riff-raff off the street, so be on your toes.",
    "trainer_practice_1",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 3),
      (val_add, "$novice_training_difficulty", 1),
      (add_xp_to_troop, 100),
      (assign, "$novicemaster_opponent_troop", "trp_regular_fighter"),
    ]],

  [anyone, "trainer_practice_1",
    [
      (eq, "$num_opponents_to_beat_in_a_row", 0),
      (eq, "$novice_training_difficulty", 1),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Way to go {reg18?lass:lad}. Welcome to the third training level. From now on your opponents will be veteran fighters; warriors and army regulars and the like. These guys know some dirty tricks, so keep your defense up.",
    "trainer_practice_1",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 3),
      (val_add, "$novice_training_difficulty", 1),
      (add_xp_to_troop, 100),
      (assign, "$novicemaster_opponent_troop", "trp_veteran_fighter"),
    ]],

  [anyone, "trainer_practice_1",
    [
      (eq, "$num_opponents_to_beat_in_a_row", 0),
      (eq, "$novice_training_difficulty", 2),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You've got the heart of a champion, {reg18?lass:lad}, and the Tomahawk arm to match. From now on your opponents will be champion fighters. These are the cream of the crop, the finest warriors I have trained. If you can best three of them in a row, you will join their ranks.",
    "trainer_practice_1",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 3),
      (val_add, "$novice_training_difficulty", 1),
      (add_xp_to_troop, 100),
      (assign, "$novicemaster_opponent_troop", "trp_champion_fighter"),
    ]],

  [anyone, "trainer_practice_1",
    [
      (eq, "$num_opponents_to_beat_in_a_row", 0),
      (eq, "$novice_training_difficulty", 3),
    ],
    "It does my heart good to see such a promising talent. You have passed all tiers of training. You can now tell everyone that you have been trained by the master of the training field.",
    "novicemaster_finish_training",
    [
      (assign, "$num_opponents_to_beat_in_a_row", 3),
      (val_add, "$novice_training_difficulty", 1),
      (add_xp_to_troop, 300),
    ]],

  [plyr|anyone, "novicemaster_finish_training",
    [],
    "Thank you master.",
    "novicemaster_finish_training_2",
    []],

  [anyone, "novicemaster_finish_training_2",
    [],
    "I wish you good luck in you adventures. And, don't forget,  if you want to practice your melee skills anytime, just come and say the word.",
    "close_window",
    []],

  [anyone, "trainer_practice_1",
    [
      (assign, reg8, "$num_opponents_to_beat_in_a_row"),
      (str_store_troop_name, s9, "$novicemaster_opponent_troop"),
    ],
    "Your next opponent will be a {s9}. You need to win {reg8} more fights in a row to advance to the next stage. Are you ready?",
    "novicemaster_are_you_ready",
    []],

  [plyr|anyone, "novicemaster_are_you_ready",
    [],
    "Yes I am.",
    "novicemaster_ready_to_fight",
    []],

  [anyone, "novicemaster_ready_to_fight",
    [],
    "Here you go then. Good luck.",
    "close_window",
    [
      (assign, "$training_fight_won", 0),
      (assign, "$waiting_for_training_fight_result", 1),
      (modify_visitors_at_site, "$g_training_ground_melee_training_scene"),
      (reset_visitors),
      (assign, reg0, 0),
      (assign, reg1, 1),
      (assign, reg2, 2),
      (assign, reg3, 3),
      (shuffle_range, 0, 4),
      (set_visitor, reg0, "trp_player"),
      (set_visitor, reg1, "$novicemaster_opponent_troop"),
      (set_visitor, 4, "$g_talk_troop"),
      (set_jump_mission, "mt_training_ground_trainer_training"),
      (jump_to_scene, "$g_training_ground_melee_training_scene"),
    ]],

  [plyr|anyone, "novicemaster_are_you_ready",
    [],
    "Just a minute. I am not ready yet.",
    "novicemaster_not_ready",
    []],

  [anyone, "novicemaster_not_ready",
    [],
    "Hey, You will never make it if you don't practice.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_town_1_mayor", "trp_village_1_elder"),
      (eq, "$g_talk_troop_met", 0),
      (this_or_next|eq, "$players_kingdom", "$g_encountered_party_faction"),
      (eq, "$g_encountered_party_faction", "fac_player_supporters_faction"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}.",
    "mayor_begin",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_town_1_mayor", "trp_village_1_elder"),
      (eq, "$g_talk_troop_met", 0),
      (str_store_party_name, s9, "$current_town"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Hey there, {reg18?ma'am:sir}. I ain't seen you around here before. I'm the Sheriff of {s9}. You'd best be leaving if you're looking to start trouble.",
    "mayor_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_town_1_mayor", "trp_village_1_elder"),
    ],
    "Good day, {playername}.",
    "mayor_begin",
    [
      (try_begin),
        (eq, "$merchant_offered_quest", "qst_persuade_lords_to_make_peace"),
        (party_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 3),
        (party_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 15),
        (store_relation, ":var2", ":var0", ":var1"),
        (ge, ":var2", 0),
        (assign, "$merchant_quest_last_offerer", -1),
        (assign, "$merchant_offered_quest", -1),
      (try_end),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_persuade_lords_to_make_peace"),
      (quest_slot_eq, "qst_persuade_lords_to_make_peace", 6, "$g_talk_troop"),
      (check_quest_succeeded, "qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 2),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 4),
      (val_mul, ":var0", -1),
      (val_mul, ":var1", -1),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 3),
      (quest_get_slot, ":var3", "qst_persuade_lords_to_make_peace", 15),
      (str_store_troop_name, s12, ":var0"),
      (str_store_troop_name, s13, ":var1"),
      (str_store_faction_name, s14, ":var2"),
      (str_store_faction_name, s15, ":var3"),
      (str_store_party_name, s19, "$current_town"),
    ],
    "{playername}, it was an incredible feat to get {s14} and {s15} make peace, and you made it happen. Your involvement has not only saved our town from disaster, but it has also saved thousands of lives, and put an end to all the grief this bitter war has caused. As the townspeople of {s19}, know that we'll be good on our word, and we are ready to pay the {reg12} cents we promised.",
    "lord_persuade_lords_to_make_peace_completed",
    [
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 3),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 15),
      (assign, "$g_force_peace_faction_1", ":var0"),
      (assign, "$g_force_peace_faction_2", ":var1"),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 22),
      (assign, reg12, ":var2"),
      (add_xp_as_reward, 4000),
    ]],

  [plyr|anyone, "lord_persuade_lords_to_make_peace_completed",
    [],
    "Thank you. Let me have the money.",
    "lord_persuade_lords_to_make_peace_pay",
    []],

  [plyr|anyone, "lord_persuade_lords_to_make_peace_completed",
    [],
    "No need for a payment. I only did what was right.",
    "lord_persuade_lords_to_make_peace_no_pay",
    []],

  [anyone, "lord_persuade_lords_to_make_peace_pay",
    [],
    "Oh, yes, of course. We had already got the money for you. Here, please accept these {reg12} cents together with our most sincere thanks. Me and the people of our town will not forget your help.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 22),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 22),
      (assign, reg12, ":var0"),
    ]],

  [anyone, "lord_persuade_lords_to_make_peace_no_pay",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You are indeed an extraordinary person, {reg18?ma'am:sir}, and it is an honour for me to have known you. You not only did what was impossible and put an end to this terrible war, but you won't even accept a reward for it. Very well, I will not insist on the matter, but please know that you will have our eternal respect and gratitude.",
    "close_window",
    [
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_change_player_relation_with_center", "$current_town", 8),
      (call_script, "script_end_quest", "qst_persuade_lords_to_make_peace"),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_deal_with_night_bandits"),
      (quest_slot_eq, "qst_deal_with_night_bandits", 6, "$g_talk_troop"),
      (check_quest_succeeded, "qst_deal_with_night_bandits"),
    ],
    "Very nice work, {playername}, you made short work of those lawless curs. Thank you kindly for all your help, and please accept this bounty of 150 cents.",
    "lord_deal_with_night_bandits_completed",
    [
      (add_xp_as_reward, 200),
      (call_script, "script_troop_add_gold", "trp_player", 150),
      (call_script, "script_change_player_relation_with_center", "$current_town", 1),
      (call_script, "script_end_quest", "qst_deal_with_night_bandits"),
    ]],

  [plyr|anyone, "lord_deal_with_night_bandits_completed",
    [],
    "It was my pleasure, {s65}.",
    "close_window",
    []],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_hideout"),
      (quest_slot_eq, "qst_hideout", 6, "$g_talk_troop"),
      (check_quest_succeeded, "qst_hideout"),
    ],
    "Good to see you again {playername}. I have heard that you found the outlaw lair and gave 'em their punishment. I will tell the commoners how reliable you are. And here is your reward, {s8}.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_hideout", 21),
      (add_xp_as_reward, ":var0"),
      (call_script, "script_change_troop_renown", "trp_player", 15),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_hideout"),
      (call_script, "script_change_player_relation_with_faction", "fac_commoners", 5),
      (store_random_in_range, ":var1", 1, 100),
      (try_begin),
        (le, ":var1", 50),
        (str_store_string, s8, "@Telescope"),
        (troop_add_item, "trp_player", "itm_telescope"),
      (else_try),
        (str_store_string, s8, "@Compass"),
        (troop_add_item, "trp_player", "itm_compass"),
      (try_end),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_hideout"),
      (quest_slot_eq, "qst_hideout", 6, "$g_talk_troop"),
      (check_quest_failed, "qst_hideout"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I heard that you have lost the fight and the outlaws have escaped their punishment. I will have to find another able gunslinger who can do the job, {reg18?ma'am:sir}. Do you have anything to say?",
    "bust_hideout_failed",
    []],

  [plyr|anyone, "bust_hideout_failed",
    [],
    "I am sorry. But I was attacked on the way.",
    "bust_hideout_failed_2",
    []],

  [plyr|anyone, "bust_hideout_failed",
    [],
    "I found their hideout and want to go back and fnish the job!",
    "bust_hideout_failed_3",
    []],

  [anyone, "bust_hideout_failed_2",
    [],
    "Well, what am I gonna tell the folk who's running the stagecoach business? I appreciate the afford, though.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_hideout", 21),
      (call_script, "script_end_quest", "qst_hideout"),
      (add_xp_as_reward, ":var0"),
    ]],

  [anyone, "bust_hideout_failed_3",
    [
      (store_random_in_range, ":var0", 1, 100),
      (ge, ":var0", 45),
    ],
    "That's the spirit! You better hurry before they puckup and relocate. It won't be easy to find them again.",
    "close_window",
    [
      (party_set_flags, "p_target", 256, 0),
      (party_set_flags, "p_target", 262144, 1),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s13, "$g_encountered_party"),
      (str_store_party_name, s4, "$g_encountered_party"),
      (setup_quest_text, "qst_hideout"),
      (str_store_string, s2, "@The sheriff of {s13} has asked you to locate outlaws hideout."),
      (call_script, "script_start_quest", "qst_hideout", "$g_talk_troop"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "bust_hideout_failed_3",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I am afraid it's a little too late for that, {reg18?missy:son}. I appreciate the afford, though.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_hideout", 21),
      (call_script, "script_end_quest", "qst_hideout"),
      (add_xp_as_reward, ":var0"),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_deal_with_looters"),
      (quest_slot_eq, "qst_deal_with_looters", 6, "$g_talk_troop"),
    ],
    "Ah, {playername}. Have you any progress to report?",
    "mayor_looters_quest_response",
    []],

  [plyr|anyone, "mayor_looters_quest_response",
    [
      (store_num_parties_destroyed_by_player, ":var0", "pt_looters"),
      (party_template_get_slot, ":var1", "pt_looters", 1),
      (val_sub, ":var0", ":var1"),
      (quest_get_slot, ":var2", "qst_deal_with_looters", 11),
      (lt, ":var2", ":var0"),
    ],
    "I've killed some looters.",
    "mayor_looters_quest_destroyed",
    []],

  [plyr|anyone, "mayor_looters_quest_response",
    [
      (eq, 1, 0),
    ],
    "I've brought you some goods.",
    "mayor_looters_quest_goods",
    []],

  [plyr|anyone, "mayor_looters_quest_response",
    [],
    "Nothing to report yet. See you around.",
    "close_window",
    []],

  [anyone, "mayor_looters_quest_destroyed",
    [],
    "Aye, my scouts saw the whole thing. That should make anyone else think twice before turning outlaw! The bounty is 80 cents for every band, so that makes {reg1} in total. Here is your money, as promised.",
    "mayor_looters_quest_destroyed_2",
    [
      (store_num_parties_destroyed_by_player, ":var0", "pt_looters"),
      (party_template_get_slot, ":var1", "pt_looters", 1),
      (val_sub, ":var0", ":var1"),
      (quest_get_slot, ":var2", "qst_deal_with_looters", 11),
      (store_sub, ":var3", ":var0", ":var2"),
      (val_mul, ":var3", 80),
      (assign, reg1, ":var3"),
      (call_script, "script_troop_add_gold", "trp_player", ":var3"),
      (assign, ":var2", ":var0"),
      (quest_set_slot, "qst_deal_with_looters", 11, ":var2"),
    ]],

  [anyone, "mayor_looters_quest_destroyed_2",
    [
      (quest_get_slot, ":var0", "qst_deal_with_looters", 10),
      (quest_slot_ge, "qst_deal_with_looters", 11, ":var0"),
      (quest_get_slot, ":var1", "qst_deal_with_looters", 21),
      (quest_get_slot, ":var2", "qst_deal_with_looters", 22),
      (add_xp_as_reward, ":var1"),
      (call_script, "script_troop_add_gold", "trp_player", ":var2"),
      (call_script, "script_change_troop_renown", "trp_player", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_deal_with_looters"),
      (try_for_parties, ":var3"),
        (party_get_template_id, ":var4", ":var3"),
        (eq, ":var4", "pt_looters"),
        (party_set_flags, ":var3", 262144, 0),
      (try_end),
    ],
    "And that's not the only good news! Thanks to you, the looters have ceased to be a threat. We've not had a single attack reported for some time now.   If there are any of them left, they've either run off or gone deep into hiding. That's good for business,   and what's good for business is good for the town!   I think that concludes our arrangement, {playername}. Please accept this silver as a token of my gratitude. Thank you, and farewell.",
    "close_window",
    []],

  [anyone, "mayor_looters_quest_destroyed_2",
    [],
    "Anything else you need?",
    "mayor_looters_quest_response",
    []],

  [anyone, "mayor_looters_quest_goods",
    [
      (quest_get_slot, reg1, "qst_deal_with_looters", 14),
    ],
    "Hah, I knew I could count on you! Just tell me which item to take from your baggage, and I'll send some men to collect it. I still need {reg1} cents' worth of goods.",
    "mayor_looters_quest_goods_response",
    []],

  [repeat_for_100|plyr|anyone, "mayor_looters_quest_goods_response",
    [
      (store_repeat_object, ":var0"),
      (val_add, ":var0", "itm_smoked_fish"),
      (is_between, ":var0", "itm_smoked_fish", "itm_gold_bar"),
      (player_has_item, ":var0"),
      (str_store_item_name, s5, ":var0"),
    ],
    "{s5}.",
    "mayor_looters_quest_goods_2",
    [
      (store_repeat_object, ":var0"),
      (val_add, ":var0", "itm_smoked_fish"),
      (troop_remove_items, "trp_player", ":var0", 1),
      (assign, ":var1", reg0),
      (call_script, "script_troop_add_gold", "trp_player", ":var1"),
      (quest_get_slot, ":var2", "qst_deal_with_looters", 14),
      (val_sub, ":var2", ":var1"),
      (quest_set_slot, "qst_deal_with_looters", 14, ":var2"),
      (str_store_item_name, s6, ":var0"),
    ]],

  [plyr|anyone, "mayor_looters_quest_goods_response",
    [],
    "Nothing at the moment, I'm afraid.",
    "mayor_looters_quest_goods_3",
    []],

  [anyone, "mayor_looters_quest_goods_3",
    [],
    "Anything else you need?",
    "mayor_looters_quest_response",
    []],

  [anyone, "mayor_looters_quest_goods_2",
    [
      (quest_slot_ge, "qst_deal_with_looters", 14, 1),
      (quest_get_slot, reg1, "qst_deal_with_looters", 14),
    ],
    "Excellent, here is the money for your {s6}. Do you have any more goods to give me? I still need {reg1} cents' worth of goods.",
    "mayor_looters_quest_goods_response",
    []],

  [anyone, "mayor_looters_quest_goods_2",
    [
      (neg|quest_slot_ge, "qst_deal_with_looters", 14, 1),
      (quest_get_slot, ":var0", "qst_deal_with_looters", 21),
      (quest_get_slot, ":var1", "qst_deal_with_looters", 22),
      (add_xp_as_reward, ":var0"),
      (call_script, "script_troop_add_gold", "trp_player", ":var1"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_end_quest", "qst_deal_with_looters"),
      (try_for_parties, ":var2"),
        (party_get_template_id, ":var3", ":var2"),
        (eq, ":var3", "pt_looters"),
        (party_set_flags, ":var2", 262144, 0),
      (try_end),
    ],
    "Well done, {playername}, that's the last of the goods I need. Here is the money for your {s6}, and a small bonus for helping me out. I'm afraid I won't be paying for any more goods, nor bounties on looters, but you're welcome to keep hunting the bastards if any remain. Thank you for your help, I won't forget it.",
    "close_window",
    []],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_move_cattle_herd"),
      (quest_slot_eq, "qst_move_cattle_herd", 6, "$g_talk_troop"),
      (check_quest_succeeded, "qst_move_cattle_herd"),
    ],
    "Good to see you again {playername}. I have heard that you have delivered the cattle successfully. I will tell the merchants how reliable you are. And here is your pay, {reg8} cents.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_move_cattle_herd", 22),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (store_div, ":var1", ":var0", 3),
      (add_xp_as_reward, ":var1"),
      (call_script, "script_change_troop_renown", "trp_player", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_end_quest", "qst_move_cattle_herd"),
      (assign, reg8, ":var0"),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_move_cattle_herd"),
      (quest_slot_eq, "qst_move_cattle_herd", 6, "$g_talk_troop"),
      (check_quest_failed, "qst_move_cattle_herd"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I heard that you have lost the cattle herd on your way to {s9}. I had a very difficult time explaining your failure to the owner of that herd, {reg18?ma'am:sir}. Do you have anything to say?",
    "move_cattle_herd_failed",
    []],

  [plyr|anyone, "move_cattle_herd_failed",
    [],
    "I am sorry. But I was attacked on the way.",
    "move_cattle_herd_failed_2",
    []],

  [plyr|anyone, "move_cattle_herd_failed",
    [],
    "I am sorry. The stupid animals wandered off during the night.",
    "move_cattle_herd_failed_2",
    []],

  [anyone, "move_cattle_herd_failed_2",
    [],
    "Well, it was your responsibility to deliver that herd safely, no matter what. You should know that the owner of the herd demanded to be compensated for his loss, and I had to pay him ten dollars. So you now owe me that money.",
    "merchant_ask_for_debts",
    [
      (assign, "$debt_to_merchants_guild", 1000),
      (call_script, "script_end_quest", "qst_move_cattle_herd"),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_move_horses_herd"),
      (quest_slot_eq, "qst_move_horses_herd", 6, "$g_talk_troop"),
      (check_quest_succeeded, "qst_move_horses_herd"),
    ],
    "Good to see you again {playername}. I have heard that you have delivered the horses successfully. I will tell the merchants how reliable you are. And here is your pay, {reg8} cents.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_move_horses_herd", 22),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (store_div, ":var1", ":var0", 2),
      (add_xp_as_reward, ":var1"),
      (call_script, "script_change_troop_renown", "trp_player", 2),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_end_quest", "qst_move_horses_herd"),
      (assign, reg8, ":var0"),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_move_horses_herd"),
      (quest_slot_eq, "qst_move_horses_herd", 6, "$g_talk_troop"),
      (check_quest_failed, "qst_move_horses_herd"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I heard that you have lost the horses herd on your way to {s9}. I had a very difficult time explaining your failure to the owner of that herd, {reg18?ma'am:sir}. Do you have anything to say?",
    "move_herd_failed",
    []],

  [plyr|anyone, "move_herd_failed",
    [],
    "I am sorry. But I was attacked on the way.",
    "move_herd_failed_2",
    []],

  [plyr|anyone, "move_cattle_herd_failed",
    [],
    "I am sorry. The stupid animals wandered off during the night.",
    "move_herd_failed_2",
    []],

  [anyone, "move_herd_failed_2",
    [],
    "Well, it was your responsibility to deliver that herd safely, no matter what. You should know that the owner of the herd demanded to be compensated for his loss, and I had to pay him eight dollars. So you now owe me that money.",
    "merchant_ask_for_debts",
    [
      (assign, "$debt_to_merchants_guild", 800),
      (call_script, "script_end_quest", "qst_move_horses_herd"),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_kidnapped_girl"),
      (quest_slot_eq, "qst_kidnapped_girl", 11, 4),
      (quest_slot_eq, "qst_kidnapped_girl", 6, "$g_talk_troop"),
    ],
    "Thank you, {playername}. I am in your debt for bringing back my friend's daughter.  Please take these {reg8} cents that I promised you.  My friend wished he could give more but paying that ransom brought him to his knees.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_kidnapped_girl", 22),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (assign, reg8, ":var0"),
      (assign, ":var1", ":var0"),
      (val_mul, ":var1", 2),
      (val_add, ":var1", 100),
      (add_xp_as_reward, ":var1"),
      (call_script, "script_change_troop_renown", "trp_player", 3),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (call_script, "script_end_quest", "qst_kidnapped_girl"),
    ]],

  [anyone, "mayor_begin",
    [
      (check_quest_active, "qst_troublesome_bandits"),
      (check_quest_succeeded, "qst_troublesome_bandits"),
      (quest_slot_eq, "qst_troublesome_bandits", 6, "$g_talk_troop"),
    ],
    "I heard about what you did out there. You gave those god damn bandits the punishment they deserved. You're damn near as good as they say you are. Here's your reward: {reg5} cents. I'd like to give more but those bandits almost brought me to bankruptcy.",
    "mayor_friendly_pretalk",
    [
      (quest_get_slot, ":var0", "qst_troublesome_bandits", 22),
      (call_script, "script_troop_add_gold", "trp_player", ":var0"),
      (assign, ":var1", ":var0"),
      (val_div, ":var1", 2),
      (add_xp_as_reward, ":var1"),
      (call_script, "script_change_player_relation_with_center", "$current_town", 2),
      (call_script, "script_change_troop_renown", "trp_player", 3),
      (call_script, "script_end_quest", "qst_troublesome_bandits"),
      (assign, reg5, ":var0"),
    ]],

  [anyone, "mayor_begin",
    [
      (ge, "$debt_to_merchants_guild", 50),
    ],
    "According to my accounts, you owe the merchants guild {reg1} cents. I'd better collect that now.",
    "merchant_ask_for_debts",
    [
      (assign, reg1, "$debt_to_merchants_guild"),
    ]],

  [plyr|anyone, "merchant_ask_for_debts",
    [
      (store_troop_gold, reg5, "trp_player"),
      (ge, reg5, "$debt_to_merchants_guild"),
    ],
    "Alright. I'll pay my debt to you.",
    "merchant_debts_paid",
    [
      (troop_remove_gold, "trp_player", "$debt_to_merchants_guild"),
      (assign, "$debt_to_merchants_guild", 0),
    ]],

  [anyone, "merchant_debts_paid",
    [],
    "Excellent. I'll let my fellow merchants know that you are clear of any debts.",
    "mayor_pretalk",
    []],

  [plyr|anyone, "merchant_ask_for_debts",
    [],
    "I'm afraid I can't pay that sum now.",
    "merchant_debts_not_paid",
    []],

  [anyone, "merchant_debts_not_paid",
    [
      (assign, reg1, "$debt_to_merchants_guild"),
    ],
    "In that case, I am afraid, I can't deal with you. Guild rules... Come back when you can pay the {reg1} cents. And know that we'll be charging an interest to your debt. So the sooner you pay it, the better.",
    "close_window",
    []],

  [anyone, "mayor_begin",
    [],
    "What can I do for you?",
    "mayor_talk",
    []],

  [anyone, "mayor_friendly_pretalk",
    [],
    "Now... What else may I do for you?",
    "mayor_talk",
    []],

  [anyone, "mayor_pretalk",
    [],
    "Yes?",
    "mayor_talk",
    []],

  [plyr|anyone, "mayor_talk",
    [],
    "Can you tell me about what you do?",
    "mayor_info_begin",
    []],

  [plyr|anyone, "mayor_talk",
    [
      (store_partner_quest, ":var0"),
      (lt, ":var0", 0),
      (neq, "$merchant_quest_last_offerer", "$g_talk_troop"),
    ],
    "Do you happen to have a job for me?",
    "merchant_quest_requested",
    [
      (assign, "$merchant_quest_last_offerer", "$g_talk_troop"),
      (call_script, "script_get_random_quest", "$g_talk_troop"),
      (assign, "$random_merchant_quest_no", reg0),
      (assign, "$merchant_offered_quest", "$random_merchant_quest_no"),
    ]],

  [plyr|anyone, "mayor_talk",
    [
      (store_partner_quest, ":var0"),
      (lt, ":var0", 0),
      (eq, "$merchant_quest_last_offerer", "$g_talk_troop"),
      (ge, "$merchant_offered_quest", 0),
    ],
    "About that job you offered me...",
    "merchant_quest_last_offered_job",
    []],

  [plyr|anyone, "mayor_talk",
    [
      (store_partner_quest, reg2),
      (ge, reg2, 0),
    ],
    "About the job you gave me...",
    "merchant_quest_about_job",
    []],

  [plyr|anyone, "mayor_talk",
    [],
    "[Leave]",
    "close_window",
    []],

  [anyone, "mayor_info_begin",
    [
      (str_store_party_name, s9, "$current_town"),
    ],
    "I am the sheriff of {s9}. You can say I am the leader of the good people of {s9}. I can help you find a job if you are looking for some honest work.",
    "mayor_info_talk",
    [
      (assign, "$mayor_info_lord_told", 0),
    ]],

  [plyr|anyone, "mayor_info_talk",
    [
      (eq, "$mayor_info_lord_told", 0),
    ],
    "Who rules this town?",
    "mayor_info_lord",
    []],

  [anyone, "mayor_info_lord",
    [
      (party_get_slot, ":var0", "$current_town", 7),
      (str_store_troop_name, s10, ":var0"),
    ],
    "Our town's lord and protector is {s10}. He owns the fort and sometimes resides there, and collects taxes from the town. However we regulate ourselves in most of the matters that concern ourselves. As the town's sheriff I have the authority to decide those things.",
    "mayor_info_talk",
    [
      (assign, "$mayor_info_lord_told", 1),
    ]],

  [plyr|anyone, "mayor_info_talk",
    [],
    "That's all I need to know. Thanks.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_about_job",
    [],
    "What about it?",
    "merchant_quest_about_job_2",
    []],

  [plyr|anyone, "merchant_quest_about_job_2",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_hunt_down_fugitive"),
      (check_quest_succeeded, "qst_hunt_down_fugitive"),
      (quest_get_slot, ":var1", "qst_hunt_down_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var1"),
      (str_store_string, s4, s50),
    ],
    "I found {s4} and gave him his punishment.",
    "merchant_hunt_down_fugitive_success",
    [
      (try_begin),
        (quest_slot_eq, "qst_billy_barrett", 11, 2),
        (quest_set_slot, "qst_billy_barrett", 11, 3),
      (try_end),
    ]],

  [plyr|anyone, "merchant_quest_about_job_2",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_hunt_down_fugitive"),
      (check_quest_failed, "qst_hunt_down_fugitive"),
    ],
    "I'm afraid he got away.",
    "merchant_hunt_down_fugitive_fail",
    []],

  [anyone, "merchant_hunt_down_fugitive_success",
    [],
    "And we'll all be a lot better off without him! Thank you, {playername}, for removing this long-festering thorn from my side. 'Tis good to know you can be trusted to handle things with an appropriate level of tactfulness. A bounty I promised, and a bounty you shall have. Exactly ten dollars.",
    "merchant_hunt_down_fugitive_success_2",
    [
      (add_xp_as_reward, 600),
    ]],

  [plyr|anyone, "merchant_hunt_down_fugitive_success_2",
    [],
    "Let me take the money, {s65}. Thank you.",
    "merchant_hunt_down_fugitive_reward_accept",
    []],

  [plyr|anyone, "merchant_hunt_down_fugitive_success_2",
    [],
    "This is blood money. I can't accept it.",
    "merchant_hunt_down_fugitive_reward_reject",
    []],

  [anyone, "merchant_hunt_down_fugitive_reward_accept",
    [],
    "Of course, {playername}. Here you are. Once again, you've my thanks for ridding me of that {s44}.",
    "mayor_friendly_pretalk",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_lord_insult_default"),
      (str_store_string, s44, ":var0"),
      (call_script, "script_troop_add_gold", "trp_player", 1000),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
    ]],

  [anyone, "merchant_hunt_down_fugitive_reward_reject",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "You are a {reg18?woman:man} for whom justice is its own reward, eh? As you wish it, {playername}, as you wish it. An honorable sentiment, to be true. Regardless, you've my thanks for ridding me of that {s44}.",
    "mayor_friendly_pretalk",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_lord_insult_default"),
      (str_store_string, s44, ":var0"),
      (call_script, "script_change_player_honor", 3),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", 2),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
    ]],

  [anyone, "merchant_hunt_down_fugitive_fail",
    [],
    "It's a sad day when that {s44} manages to avoid the hand of justice yet again. I thought you would be able to do this, {playername}. Clearly I was wrong.",
    "mayor_friendly_pretalk",
    [
      (troop_get_slot, ":var0", "$g_talk_troop", 52),
      (val_add, ":var0", "str_lord_insult_default"),
      (str_store_string, s44, ":var0"),
      (call_script, "script_change_player_relation_with_troop", "$g_talk_troop", -1),
      (call_script, "script_end_quest", "qst_hunt_down_fugitive"),
    ]],

  [plyr|anyone, "merchant_quest_about_job_2",
    [],
    "What if I can't finish it?",
    "merchant_quest_what_if_fail",
    []],

  [plyr|anyone, "merchant_quest_about_job_2",
    [],
    "Well, I'm still working on it.",
    "merchant_quest_about_job_working",
    []],

  [anyone, "merchant_quest_about_job_working",
    [],
    "Good. I'm sure you will handle it.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_last_offered_job",
    [],
    "Eh, you want to reconsider that. Good...",
    "merchant_quest_brief",
    [
      (assign, "$random_merchant_quest_no", "$merchant_offered_quest"),
    ]],

  [anyone, "merchant_quest_what_if_fail",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_deliver_wine"),
    ],
    "I hope you don't fail. In that case, I'll have to ask for the price of the cargo you were carrying.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_what_if_fail",
    [],
    "Well, just do your best to finish it.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_taken",
    [],
    "Excellent. I am counting on you then. Good luck.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_stall",
    [],
    "Well, the job will be available for a few more days I guess. Tell me if you decide to take it.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_hideout"),
      (neg|check_quest_active, "qst_hideout2"),
    ],
    "Well, you look able enough. I think I might have something you could do.",
    "merchant_quest_brief",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_hideout"),
    ],
    "There's a group of outlaws that constantly disrupt our stagecoach line. A lot of valuable goods were taken. I need somebody to teach those bastards a lesson. Sound like your kind of work?",
    "merchant_quest_hideout_choice",
    []],

  [plyr|anyone, "merchant_quest_hideout_choice",
    [],
    "Alrighty, I'll do it.",
    "merchant_quest_hideout_brief",
    []],

  [plyr|anyone, "merchant_quest_hideout_choice",
    [],
    "I'm afraid I can't take the job at the moment.",
    "merchant_quest_stall",
    []],

  [anyone, "merchant_quest_hideout_brief",
    [
      (party_set_flags, "p_target", 256, 0),
      (party_set_flags, "p_target", 262144, 1),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s13, "$g_encountered_party"),
      (str_store_party_name, s4, "$g_encountered_party"),
      (setup_quest_text, "qst_hideout"),
      (str_store_string, s2, "@The sheriff of {s13} has asked you to locate outlaws hideout."),
      (call_script, "script_start_quest", "qst_hideout", "$g_talk_troop"),
      (assign, "$g_leave_encounter", 1),
    ],
    "Excellent! You'll find the outlaws in the deep canyon, probably making more raid plans. I've marked the area they are believed to have their hideout located at as Mission Target on the map. Kill or capture the bastards, I don't care what you do with them. I'll reward you with a special item. Now go!",
    "close_window",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_deal_with_looters"),
    ],
    "Well, you look able enough. I think I might have something you could do.",
    "merchant_quest_brief",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_deal_with_looters"),
      (try_begin),
        (party_slot_eq, "$g_encountered_party", 0, 3),
        (str_store_string, s5, "@town"),
      (else_try),
        (party_slot_eq, "$g_encountered_party", 0, 4),
        (str_store_string, s5, "@village"),
      (try_end),
    ],
    "We've had some fighting near the {s5} lately, with all the chaos that comes with it, and that's led some of our less upstanding locals to try and make their fortune out of looting the shops and farms during the confusion. A lot of valuable goods were taken. I need somebody to teach those bastards a lesson. Sound like your kind of work?",
    "merchant_quest_looters_choice",
    []],

  [plyr|anyone, "merchant_quest_looters_choice",
    [],
    "Aye, I'll do it.",
    "merchant_quest_looters_brief",
    []],

  [plyr|anyone, "merchant_quest_looters_choice",
    [],
    "I'm afraid I can't take the job at the moment.",
    "merchant_quest_stall",
    []],

  [anyone, "merchant_quest_looters_brief",
    [
      (try_begin),
        (party_slot_eq, "$g_encountered_party", 0, 3),
        (str_store_string, s5, "@town"),
      (else_try),
        (party_slot_eq, "$g_encountered_party", 0, 4),
        (str_store_string, s5, "@village"),
      (try_end),
      (store_random_in_range, ":var0", 3, 7),
      (quest_set_slot, "qst_deal_with_looters", 10, ":var0"),
      (try_for_range, ":var1", 0, ":var0"),
        (store_random_in_range, ":var2", 5, 14),
        (set_spawn_radius, ":var2"),
        (spawn_around_party, "$g_encountered_party", "pt_looters"),
        (party_set_flags, reg0, 262144, 1),
      (try_end),
      (str_store_troop_name_link, s9, "$g_talk_troop"),
      (str_store_party_name_link, s13, "$g_encountered_party"),
      (str_store_party_name, s4, "$g_encountered_party"),
      (setup_quest_text, "qst_deal_with_looters"),
      (str_store_string, s2, "@The sheriff of {s13} has asked you to deal with looters in the surrounding countryside."),
      (call_script, "script_start_quest", "qst_deal_with_looters", "$g_talk_troop"),
      (assign, "$g_leave_encounter", 1),
    ],
    "Excellent! You'll find the looters roaming around the countryside, probably trying to rob more good people. Kill or capture the bastards, I don't care what you do with them. I'll pay you a bounty of 80 cents on every band of looters you destroy, until all the looters are dealt with.",
    "close_window",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_deliver_wine"),
    ],
    "You're looking for a job? Actually I was looking for someone to deliver some {s4}. Perhaps you can do that...",
    "merchant_quest_brief",
    [
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (str_store_item_name, s4, ":var0"),
    ]],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_deliver_wine"),
    ],
    "I have a cargo of {s6} that needs to be delivered to the saloon in {s4}. If you can take {reg5} units of {s6} to {s4} in 7 days, you may earn {reg8} cents. What do you say?",
    "merchant_quest_brief_deliver_wine",
    [
      (quest_get_slot, reg5, "qst_deliver_wine", 10),
      (quest_get_slot, reg8, "qst_deliver_wine", 22),
      (quest_get_slot, ":var0", "qst_deliver_wine", 14),
      (quest_get_slot, ":var1", "qst_deliver_wine", 1),
      (str_store_troop_name, s9, "$g_talk_troop"),
      (str_store_party_name_link, s3, "$g_encountered_party"),
      (str_store_party_name_link, s4, ":var1"),
      (str_store_item_name, s6, ":var0"),
      (setup_quest_text, "qst_deliver_wine"),
      (str_store_string, s2, "@{s9} of {s3} asked you to deliver {reg5} units of {s6} to the saloon in {s4} in 7 days."),
    ]],

  [plyr|anyone, "merchant_quest_brief_deliver_wine",
    [
      (store_free_inventory_capacity, ":var0"),
      (quest_get_slot, ":var1", "qst_deliver_wine", 10),
      (ge, ":var0", ":var1"),
    ],
    "Alright. I will make the delivery.",
    "merchant_quest_taken",
    [
      (quest_get_slot, ":var0", "qst_deliver_wine", 10),
      (quest_get_slot, ":var1", "qst_deliver_wine", 14),
      (troop_add_items, "trp_player", ":var1", ":var0"),
      (call_script, "script_start_quest", "qst_deliver_wine", "$g_talk_troop"),
    ]],

  [plyr|anyone, "merchant_quest_brief_deliver_wine",
    [],
    "I am afraid I can't carry all that cargo now.",
    "merchant_quest_stall",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_escort_merchant_caravan"),
    ],
    "You're looking for a job? Actually I was looking for someone to escort a stagecoach. Perhaps you can do that...",
    "merchant_quest_brief",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_escort_merchant_caravan"),
    ],
    "I am going to send a stagecoach to {s8}. However with all those bandits and deserters on the roads, I don't want to send them out without an escort. If you can lead that stagecoach to {s8} in 15 days, you will earn {reg8} cents. Of course your party needs to be at least {reg4} strong to offer them any protection.",
    "escort_merchant_caravan_quest_brief",
    [
      (quest_get_slot, reg8, "qst_escort_merchant_caravan", 22),
      (quest_get_slot, reg4, "qst_escort_merchant_caravan", 10),
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 1),
      (str_store_party_name, s8, ":var0"),
    ]],

  [plyr|anyone, "escort_merchant_caravan_quest_brief",
    [
      (store_party_size_wo_prisoners, ":var0", "p_main_party"),
      (quest_get_slot, ":var1", "qst_escort_merchant_caravan", 10),
      (ge, ":var0", ":var1"),
    ],
    "Alright. I will escort the stagecoach.",
    "merchant_quest_taken",
    [
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 1),
      (set_spawn_radius, 1),
      (spawn_around_party, "$g_encountered_party", "pt_merchant_caravan"),
      (assign, ":var1", reg0),
      (party_set_ai_behavior, ":var1", ai_bhvr_attack_party),
      (party_set_ai_object, ":var1", "p_main_party"),
      (party_set_flags, ":var1", 65536, 0),
      (quest_set_slot, "qst_escort_merchant_caravan", 8, ":var1"),
      (quest_set_slot, "qst_escort_merchant_caravan", 11, 0),
      (str_store_party_name_link, s8, ":var0"),
      (setup_quest_text, "qst_escort_merchant_caravan"),
      (str_store_string, s2, "@Escort the stagecoach to the town of {s8}."),
      (call_script, "script_start_quest", "qst_escort_merchant_caravan", "$g_talk_troop"),
    ]],

  [plyr|anyone, "escort_merchant_caravan_quest_brief",
    [
      (store_party_size_wo_prisoners, ":var0", "p_main_party"),
      (quest_get_slot, ":var1", "qst_escort_merchant_caravan", 10),
      (lt, ":var0", ":var1"),
    ],
    "I am afraid I don't have that many soldiers with me.",
    "merchant_quest_stall",
    []],

  [plyr|anyone, "escort_merchant_caravan_quest_brief",
    [
      (store_party_size_wo_prisoners, ":var0", "p_main_party"),
      (quest_get_slot, ":var1", "qst_escort_merchant_caravan", 10),
      (ge, ":var0", ":var1"),
    ],
    "Sorry. I can't do that right now",
    "merchant_quest_stall",
    []],

  [party_tpl|pt_merchant_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 8),
      (eq, "$g_encountered_party", ":var0"),
      (quest_slot_eq, "qst_escort_merchant_caravan", 11, 2),
    ],
    "We can cover the rest of the way ourselves. Thanks.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_merchant_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 8),
      (eq, "$g_encountered_party", ":var0"),
      (quest_get_slot, ":var1", "qst_escort_merchant_caravan", 1),
      (store_distance_to_party_from_party, ":var2", ":var1", ":var0"),
      (lt, ":var2", 4),
      (quest_slot_eq, "qst_escort_merchant_caravan", 11, 1),
    ],
    "Well, we have almost reached {s21}. We can cover the rest of the way ourselves. Here's your pay... {reg14} cents. Thanks for escorting us. Good luck.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 8),
      (quest_get_slot, ":var1", "qst_escort_merchant_caravan", 1),
      (quest_get_slot, ":var2", "qst_escort_merchant_caravan", 12),
      (quest_get_slot, ":var3", "qst_escort_merchant_caravan", 22),
      (party_set_ai_behavior, ":var0", ai_bhvr_travel_to_party),
      (party_set_ai_object, ":var0", ":var1"),
      (party_set_flags, ":var0", 65536, 0),
      (str_store_party_name, s21, ":var1"),
      (call_script, "script_change_player_relation_with_center", ":var2", 1),
      (call_script, "script_end_quest", "qst_escort_merchant_caravan"),
      (quest_set_slot, "qst_escort_merchant_caravan", 11, 2),
      (call_script, "script_troop_add_gold", "trp_player", ":var3"),
      (assign, ":var4", ":var3"),
      (val_div, ":var4", 3),
      (add_xp_as_reward, ":var4"),
      (call_script, "script_change_troop_renown", "trp_player", 2),
      (assign, reg14, ":var3"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_merchant_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 8),
      (eq, "$g_encountered_party", ":var0"),
      (quest_slot_eq, "qst_escort_merchant_caravan", 11, 0),
    ],
    "Greetings. You must be our escort, right?",
    "merchant_caravan_intro_1",
    [
      (quest_set_slot, "qst_escort_merchant_caravan", 11, 1),
    ]],

  [plyr|anyone, "merchant_caravan_intro_1",
    [],
    "Yes. My name is {playername}. I will lead you to {s1}.",
    "merchant_caravan_intro_2",
    [
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 1),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "merchant_caravan_intro_2",
    [],
    "Well, It is good to know we won't travel alone. What do you want us to do now?",
    "escort_merchant_caravan_talk",
    []],

  [party_tpl|pt_merchant_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_merchant_caravan", 8),
      (eq, "$g_encountered_party", ":var0"),
    ],
    "Eh. We've made it this far... What do you want us to do?",
    "escort_merchant_caravan_talk",
    []],

  [plyr|anyone, "escort_merchant_caravan_talk",
    [],
    "You follow my lead. I'll take you through a safe route.",
    "merchant_caravan_follow_lead",
    []],

  [anyone, "merchant_caravan_follow_lead",
    [],
    "Alright. We'll be right behind you.",
    "close_window",
    [
      (assign, "$escort_merchant_caravan_mode", 0),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "escort_merchant_caravan_talk",
    [],
    "You stay here for a while. I'll go ahead and check the road.",
    "merchant_caravan_stay_here",
    []],

  [anyone, "merchant_caravan_stay_here",
    [],
    "Alright. We'll be waiting here for you.",
    "close_window",
    [
      (assign, "$escort_merchant_caravan_mode", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_troublesome_bandits"),
    ],
    "Actually, I was looking for an able gunslinger like you. There's this group of particularly troublesome bandits. They have infested the vicinity of our town and are preying on our stagecoaches and carriages. They have avoided all the soldiers and the militias up to now. If someone doesn't stop them soon, this town is going to be ruined...",
    "merchant_quest_brief",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_troublesome_bandits"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I will pay you {reg8} cents if you hunt down those troublesome bandits. It's dangerous work. But I believe that you are the {reg18?woman:man} for it. What do you say?",
    "troublesome_bandits_quest_brief",
    [
      (quest_get_slot, reg8, "qst_troublesome_bandits", 22),
    ]],

  [plyr|anyone, "troublesome_bandits_quest_brief",
    [],
    "Alright. I will hunt down those bandits.",
    "merchant_quest_taken_bandits",
    [
      (set_spawn_radius, 7),
      (quest_get_slot, ":var0", "qst_troublesome_bandits", 12),
      (spawn_around_party, ":var0", "pt_troublesome_bandits"),
      (quest_set_slot, "qst_troublesome_bandits", 8, reg0),
      (store_num_parties_destroyed, "$qst_troublesome_bandits_eliminated", "pt_troublesome_bandits"),
      (store_num_parties_destroyed_by_player, "$qst_troublesome_bandits_eliminated_by_player", "pt_troublesome_bandits"),
      (str_store_troop_name, s9, "$g_talk_troop"),
      (str_store_party_name_link, s4, "$g_encountered_party"),
      (setup_quest_text, "qst_troublesome_bandits"),
      (str_store_string, s2, "@Merchant {s9} of {s4} asked you to hunt down the troublesome bandits in the vicinity of the town."),
      (call_script, "script_start_quest", "qst_troublesome_bandits", "$g_talk_troop"),
    ]],

  [anyone, "merchant_quest_taken_bandits",
    [],
    "You will? I am so happy to hear that. Good luck to you.",
    "close_window",
    []],

  [plyr|anyone, "troublesome_bandits_quest_brief",
    [],
    "Sorry. I don't have time for this right now.",
    "merchant_quest_stall",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_kidnapped_girl"),
    ],
    "Actually, I was looking for a reliable man that can undertake an important mission. A group of Comanches have kidnapped the daughter of a friend of mine and are holding her for ransom. My friend is ready to pay them, but we still need someone to take the money to those redskins and bring the girl back to safety.",
    "merchant_quest_brief",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_kidnapped_girl"),
    ],
    "The amount the bandits ask as ransom is {reg12} cents. I will give you that money once you accept to take the quest. You have 15 days to take the money to the Comanches who will be waiting near the village of {s4}. Those redskins will take the poor girl with them and raise it as a squaw, if they don't get the money by that time. You will get your pay of {reg8} cents when you bring the girl safely back here.",
    "kidnapped_girl_quest_brief",
    [
      (quest_get_slot, ":var0", "qst_kidnapped_girl", 1),
      (str_store_party_name, s4, ":var0"),
      (quest_get_slot, reg8, "qst_kidnapped_girl", 22),
      (quest_get_slot, reg12, "qst_kidnapped_girl", 10),
    ]],

  [plyr|anyone, "kidnapped_girl_quest_brief",
    [],
    "Alright. I will take the ransom money to the Comanches and bring back the girl.",
    "kidnapped_girl_quest_taken",
    [
      (set_spawn_radius, 4),
      (quest_get_slot, ":var0", "qst_kidnapped_girl", 1),
      (quest_get_slot, ":var1", "qst_kidnapped_girl", 10),
      (spawn_around_party, ":var0", "pt_bandits_awaiting_ransom"),
      (assign, ":var2", reg0),
      (quest_set_slot, "qst_kidnapped_girl", 8, ":var2"),
      (party_set_ai_behavior, ":var2", ai_bhvr_hold),
      (party_set_ai_object, ":var2", "p_main_party"),
      (party_set_flags, ":var2", 65536, 0),
      (call_script, "script_troop_add_gold", "trp_player", ":var1"),
      (assign, reg12, ":var1"),
      (str_store_troop_name, s1, "$g_talk_troop"),
      (str_store_party_name_link, s4, "$g_encountered_party"),
      (str_store_party_name_link, s3, ":var0"),
      (setup_quest_text, "qst_kidnapped_girl"),
      (str_store_string, s2, "@Sheriff of {s4} gave you {reg12} cents to pay the ransom of a girl kidnapped by Comanches. You are to meet the Comanches near {s3} and pay them the ransom fee. After that you are to bring the girl back to {s4}."),
      (call_script, "script_start_quest", "qst_kidnapped_girl", "$g_talk_troop"),
    ]],

  [anyone, "kidnapped_girl_quest_taken",
    [],
    "Good. I knew we could trust you at this. Here is the ransom money, {reg12} cents. Count it before taking it. And please, don't attempt to do anything rash. Keep in mind that the girl's well being is more important than anything else...",
    "close_window",
    []],

  [plyr|anyone, "kidnapped_girl_quest_brief",
    [],
    "Sorry. I don't have time for this right now.",
    "merchant_quest_stall",
    []],

  [trp_kidnapped_girl, "start",
    [
      (eq, "$talk_context", 10),
    ],
    "Thank you so much for bringing me back!  I can't wait to see my family. Good-bye.",
    "close_window",
    [
      (remove_member_from_party, "trp_kidnapped_girl"),
      (quest_set_slot, "qst_kidnapped_girl", 11, 4),
    ]],

  [plyr|trp_kidnapped_girl, "kidnapped_girl_liberated_map",
    [],
    "Yes. Come with me. We are going home.",
    "kidnapped_girl_liberated_map_2a",
    []],

  [trp_kidnapped_girl, "kidnapped_girl_liberated_map_2a",
    [
      (neg|party_can_join),
    ],
    "Unfortunately. You do not have room in your party for me.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [trp_kidnapped_girl, "kidnapped_girl_liberated_map_2a",
    [],
    "Oh really? Thank you so much!",
    "close_window",
    [
      (party_join),
      (quest_set_slot, "qst_kidnapped_girl", 11, 3),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|trp_kidnapped_girl, "kidnapped_girl_liberated_map",
    [],
    "Wait here a while longer. I'll come back for you.",
    "kidnapped_girl_liberated_map_2b",
    []],

  [trp_kidnapped_girl, "kidnapped_girl_liberated_map_2b",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Oh, please {reg18?ma'am:sir}, do not leave me here all alone!",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [trp_kidnapped_girl, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Oh, {reg18?ma'am:sir}. Thank you so much for rescuing me. Will you take me to my family now?",
    "kidnapped_girl_liberated_map",
    []],

  [plyr|trp_kidnapped_girl, "kidnapped_girl_liberated_battle",
    [],
    "Yes. Come with me. We are going home.",
    "kidnapped_girl_liberated_battle_2a",
    []],

  [trp_kidnapped_girl, "kidnapped_girl_liberated_battle_2a",
    [
      (neg|hero_can_join, "p_main_party"),
    ],
    "Unfortunately. You do not have room in your party for me.",
    "kidnapped_girl_liberated_battle_2b",
    []],

  [trp_kidnapped_girl, "kidnapped_girl_liberated_battle_2a",
    [],
    "Oh really? Thank you so much!",
    "close_window",
    [
      (party_add_members, "p_main_party", "trp_kidnapped_girl", 1),
      (quest_set_slot, "qst_kidnapped_girl", 11, 3),
    ]],

  [plyr|trp_kidnapped_girl, "kidnapped_girl_liberated_battle",
    [],
    "Wait here a while longer. I'll come back for you.",
    "kidnapped_girl_liberated_battle_2b",
    []],

  [trp_kidnapped_girl, "kidnapped_girl_liberated_battle_2b",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Oh, please {reg18?ma'am:sir}, do not leave me here all alone!",
    "close_window",
    [
      (add_companion_party, "trp_kidnapped_girl"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [trp_kidnapped_girl, "start",
    [],
    "Can I come with you now?",
    "kidnapped_girl_liberated_map",
    []],

  [party_tpl|pt_bandits_awaiting_ransom, "start",
    [
      (quest_slot_eq, "qst_kidnapped_girl", 11, 0),
    ],
    "Are you the one that brought the ransom? Quick, give us the money now.",
    "bandits_awaiting_ransom_intro_1",
    [
      (quest_set_slot, "qst_kidnapped_girl", 11, 1),
    ]],

  [party_tpl|pt_bandits_awaiting_ransom, "start",
    [
      (quest_slot_eq, "qst_kidnapped_girl", 11, 1),
    ],
    "You came back? Quick, give us the money now.",
    "bandits_awaiting_ransom_intro_1",
    []],

  [plyr|party_tpl|pt_bandits_awaiting_ransom, "bandits_awaiting_ransom_intro_1",
    [
      (store_troop_gold, ":var0"),
      (quest_get_slot, ":var1", "qst_kidnapped_girl", 10),
      (ge, ":var0", ":var1"),
    ],
    "Here, take the money. Just set the girl free.",
    "bandits_awaiting_ransom_pay",
    []],

  [party_tpl|pt_bandits_awaiting_ransom, "bandits_awaiting_ransom_pay",
    [],
    "Heh. You've brought the money alright. You can take the girl now. It was a pleasure doing business with you...",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_kidnapped_girl", 10),
      (quest_get_slot, ":var1", "qst_kidnapped_girl", 8),
      (quest_get_slot, ":var2", "qst_kidnapped_girl", 1),
      (troop_remove_gold, "trp_player", ":var0"),
      (remove_member_from_party, "trp_kidnapped_girl", ":var1"),
      (set_spawn_radius, 1),
      (spawn_around_party, ":var1", "pt_kidnapped_girl"),
      (assign, ":var3", reg0),
      (party_set_ai_behavior, ":var3", ai_bhvr_hold),
      (party_set_flags, ":var3", 65536, 0),
      (quest_set_slot, "qst_kidnapped_girl", 11, 2),
      (party_set_ai_behavior, ":var1", ai_bhvr_travel_to_party),
      (party_set_ai_object, ":var1", ":var2"),
      (party_set_flags, ":var1", 65536, 0),
      (add_gold_to_party, ":var0", ":var1"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "bandits_awaiting_ransom_intro_1",
    [],
    "No way! You release the girl first.",
    "bandits_awaiting_ransom_b",
    []],

  [anyone, "bandits_awaiting_ransom_b",
    [],
    "You fool! Stop playing games and give us the money! ",
    "bandits_awaiting_ransom_b2",
    []],

  [plyr|anyone, "bandits_awaiting_ransom_b2",
    [
      (store_troop_gold, ":var0"),
      (quest_get_slot, ":var1", "qst_kidnapped_girl", 10),
      (ge, ":var0", ":var1"),
    ],
    "Alright. Here's your money. Let the girl go now.",
    "bandits_awaiting_ransom_pay",
    []],

  [plyr|anyone, "bandits_awaiting_ransom_b2",
    [],
    "I left the money in a safe place. Let me go get it.",
    "bandits_awaiting_ransom_no_money",
    []],

  [anyone, "bandits_awaiting_ransom_no_money",
    [],
    "Are you testing our patience or something?  Go and bring that money here quickly.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "bandits_awaiting_ransom_b2",
    [],
    "I have no intention to pay you anything. I demand that you release the girl now!",
    "bandits_awaiting_ransom_fight",
    []],

  [anyone, "bandits_awaiting_ransom_fight",
    [],
    "You won't be demanding anything when you're dead!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_bandits_awaiting_ransom, "start",
    [
      (quest_slot_ge, "qst_kidnapped_girl", 11, 2),
    ],
    "What do you want? You gave us the money, now get lost. We have no more business.",
    "bandits_awaiting_remeet",
    []],

  [plyr|anyone, "bandits_awaiting_remeet",
    [],
    "Sorry to bother you. I'll be on my way now.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "bandits_awaiting_remeet",
    [],
    "We have one more business. You'll give the money back to me.",
    "bandits_awaiting_remeet_2",
    []],

  [anyone, "bandits_awaiting_remeet_2",
    [],
    "Oh, that business! Of course. Let us get down to it.",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_kidnapped_girl, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Oh {reg18?ma'am:sir}! Thank you so much for rescuing me. Will you take me to my family now?",
    "kidnapped_girl_encounter_1",
    []],

  [plyr|anyone, "kidnapped_girl_encounter_1",
    [],
    "Yes. Come with me. I'll take you home.",
    "kidnapped_girl_join",
    []],

  [anyone, "kidnapped_girl_join",
    [
      (neg|party_can_join),
    ],
    "Unfortunately. You do not have room in your party for me.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "kidnapped_girl_join",
    [],
    "Oh, thank you so much!",
    "close_window",
    [
      (party_join),
      (quest_set_slot, "qst_kidnapped_girl", 11, 3),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "kidnapped_girl_encounter_1",
    [],
    "Wait here a while longer. I'll come back for you.",
    "kidnapped_girl_wait",
    []],

  [anyone, "kidnapped_girl_wait",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Oh, please {reg18?ma'am:sir}, do not leave me here all alone!",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "merchant_quest_about_job_2",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_kidnapped_girl"),
      (quest_slot_eq, "qst_kidnapped_girl", 11, 3),
      (neg|main_party_has_troop, "trp_kidnapped_girl"),
    ],
    "Unfortunately I lost the girl on the way here...",
    "lost_kidnapped_girl",
    []],

  [anyone, "lost_kidnapped_girl",
    [],
    "Oh no! How am I going to tell this to my friend?",
    "lost_kidnapped_girl_2",
    []],

  [plyr|anyone, "lost_kidnapped_girl_2",
    [],
    "I'm sorry. I could do nothing about it.",
    "lost_kidnapped_girl_3",
    []],

  [anyone, "lost_kidnapped_girl_3",
    [],
    "You let me down {playername}. I had trusted you. I will let people know of your incompetence at this task. Also, I want back that {reg8} cents I gave you as the ransom fee.",
    "lost_kidnapped_girl_4",
    [
      (quest_get_slot, reg8, "qst_kidnapped_girl", 10),
      (try_for_parties, ":var0"),
        (party_count_members_of_type, ":var1", ":var0", "trp_kidnapped_girl"),
        (gt, ":var1", 0),
        (party_remove_members, ":var0", "trp_kidnapped_girl", 1),
        (party_remove_prisoners, ":var0", "trp_kidnapped_girl", 1),
      (try_end),
      (call_script, "script_end_quest", "qst_kidnapped_girl"),
      (call_script, "script_change_troop_renown", "trp_player", -5),
    ]],

  [plyr|anyone, "lost_kidnapped_girl_4",
    [
      (store_troop_gold, ":var0"),
      (quest_get_slot, ":var1", "qst_kidnapped_girl", 10),
      (ge, ":var0", ":var1"),
    ],
    "Of course. Here you are...",
    "merchant_quest_about_job_5a",
    [
      (quest_get_slot, ":var0", "qst_kidnapped_girl", 10),
      (troop_remove_gold, "trp_player", ":var0"),
    ]],

  [anyone, "merchant_quest_about_job_5a",
    [],
    "At least you have the decency to return the money.",
    "close_window",
    []],

  [plyr|anyone, "lost_kidnapped_girl_4",
    [],
    "Sorry. I don't have that amount with me.",
    "merchant_quest_about_job_5b",
    []],

  [anyone, "merchant_quest_about_job_5b",
    [],
    "Do you expect me to believe that? You are going to pay that ransom fee back! Go and bring the money now!",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_kidnapped_girl", 10),
      (val_add, "$debt_to_merchants_guild", ":var0"),
    ]],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_persuade_lords_to_make_peace"),
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 3),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 4),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 2),
      (str_store_troop_name_link, s12, ":var1"),
      (str_store_troop_name_link, s13, ":var2"),
      (str_store_faction_name_link, s14, ":var0"),
      (str_store_faction_name_link, s15, "$g_encountered_party_faction"),
    ],
    "This war between {s15} and {s14} has brought our town to the verge of ruin. Our caravans get raided before they can reach their destination. Our merchants are afraid to leave the safety of the town walls. And as if those aren't enough, the taxes to maintain the war take away the last bits of our savings. If peace does not come soon, we can not hold on for much longer.",
    "merchant_quest_persuade_peace_1",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_1",
    [],
    "You are right. But who can stop this madness called war?",
    "merchant_quest_brief",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_1",
    [],
    "It is your duty to help the nobles in their war effort. You shouldn't complain about it.",
    "merchant_quest_persuade_peace_reject",
    []],

  [anyone, "merchant_quest_persuade_peace_reject",
    [],
    "Hah. The nobles fight their wars for their greed and their dreams of glory. And it is poor honest folk like us who have to bear the real burden. But you obviously don't want to hear about that.",
    "close_window",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_persuade_lords_to_make_peace"),
    ],
    "There have been attempts to reconcile the two sides and reach a settlement. However, there are powerful lords on both sides whose interests lie in continuing the war. These men urge all others not to heed to the word of sensible men, but to keep fighting. While these leaders remain influential, no peace settlement can be reached.",
    "merchant_quest_persuade_peace_3",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_3",
    [],
    "Who are these warmongers who block the way of peace?",
    "merchant_quest_persuade_peace_4",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_3",
    [],
    "Who are these lords you speak of?",
    "merchant_quest_persuade_peace_4",
    []],

  [anyone, "merchant_quest_persuade_peace_4",
    [],
    "They are {s12} from {s15} and {s13} from {s14}. Until they change their mind or lose their influence, there will be no chance of having peace between the two sides.",
    "merchant_quest_persuade_peace_5",
    [
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 3),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 4),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 2),
      (str_store_troop_name_link, s12, ":var1"),
      (str_store_troop_name_link, s13, ":var2"),
      (str_store_faction_name_link, s14, ":var0"),
      (str_store_faction_name_link, s15, "$g_encountered_party_faction"),
    ]],

  [plyr|anyone, "merchant_quest_persuade_peace_5",
    [],
    "What can be done about this?",
    "merchant_quest_persuade_peace_6",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_5",
    [],
    "Alas, it seems nothing can be done about it.",
    "merchant_quest_persuade_peace_6",
    []],

  [anyone, "merchant_quest_persuade_peace_6",
    [],
    "There is a way to resolve the issue. A particularly determined person can perhaps persuade one or both of these lords to accept making peace. And even if that fails, it can be possible to see that these lords are defeated by force and taken prisoner. If they are captive, they will lose their influence and they can no longer oppose a settlement... What do you think? Can you do it?",
    "merchant_quest_persuade_peace_7",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_7",
    [],
    "It seems difficult. But I will try.",
    "merchant_quest_persuade_peace_8",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_7",
    [],
    "If the price is right, I may.",
    "merchant_quest_persuade_peace_8",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_7",
    [],
    "Forget it. This is not my problem.",
    "merchant_quest_persuade_peace_8",
    []],

  [anyone, "merchant_quest_persuade_peace_8",
    [],
    "Most of the merchants in the town will gladly open up their purses to support such a plan. I think we can collect {reg12} cents between ourselves. We will be happy to reward you with that sum, if you can work this out. Convince {s12} and {s13} to accept a peace settlement, and if either of them proves too stubborn, make sure he falls captive and can not be ransomed until a peace deal is settled.",
    "merchant_quest_persuade_peace_9",
    [
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 4),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 2),
      (str_store_troop_name_link, s12, ":var0"),
      (str_store_troop_name_link, s13, ":var1"),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 22),
      (assign, reg12, ":var2"),
    ]],

  [plyr|anyone, "merchant_quest_persuade_peace_9",
    [],
    "Alright. I will do my best.",
    "merchant_quest_persuade_peace_10",
    []],

  [plyr|anyone, "merchant_quest_persuade_peace_9",
    [],
    "Sorry. I can not do this.",
    "merchant_quest_persuade_peace_no",
    []],

  [anyone, "merchant_quest_persuade_peace_10",
    [],
    "Excellent. You will have our blessings. I hope you can deal with those two old goats. We will be waiting and hoping for the good news.",
    "close_window",
    [
      (str_store_party_name_link, s4, "$g_encountered_party"),
      (quest_get_slot, ":var0", "qst_persuade_lords_to_make_peace", 3),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 4),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 2),
      (quest_get_slot, ":var3", "qst_persuade_lords_to_make_peace", 22),
      (assign, reg12, ":var3"),
      (str_store_troop_name_link, s12, ":var1"),
      (str_store_troop_name_link, s13, ":var2"),
      (str_store_faction_name_link, s14, ":var0"),
      (str_store_faction_name_link, s15, "$g_encountered_party_faction"),
      (setup_quest_text, "qst_persuade_lords_to_make_peace"),
      (str_store_string, s2, "@Sheriff of {s4} promised you {reg12} cents if you can make sure that {s12} and {s13} no longer pose a threat to a peace settlement between {s15} and {s14}. In order to do that, you must either convince them or make sure they fall captive and remain so until a peace agreement is made."),
      (call_script, "script_start_quest", "qst_persuade_lords_to_make_peace", "$g_talk_troop"),
      (quest_get_slot, ":var1", "qst_persuade_lords_to_make_peace", 4),
      (quest_get_slot, ":var2", "qst_persuade_lords_to_make_peace", 2),
      (call_script, "script_report_quest_troop_positions", "qst_persuade_lords_to_make_peace", ":var1", 3),
      (call_script, "script_report_quest_troop_positions", "qst_persuade_lords_to_make_peace", ":var2", 4),
    ]],

  [anyone, "merchant_quest_persuade_peace_no",
    [],
    "Don't say no right away. Think about this for some time. If there is anyone who can manage to do this, it is you.",
    "close_window",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_deal_with_night_bandits"),
    ],
    "Do I indeed! There's a group of bandits infesting the town, and I'm at the end of my rope as to how to deal with them. They've been ambushing and robbing townspeople under the cover of night, and then fading away quick as lightning when the guards finally show up. We've not been able to catch a one of them. They only attack lone people, never daring to show themselves when there's a group about. I need someone who can take on these bandits alone and win. That seems to be the only way of bringing them to justice. Are you up to the task?",
    "merchant_quest_deal_with_night_bandits",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_deal_with_night_bandits"),
    ],
    "There's a group of bandits infesting the town, and I'm at the end of my rope as to how to deal with them. They've been ambushing and robbing townspeople under the cover of night, and then fading away quick as lightning when the guards finally show up. We've not been able to catch a one of them. They only attack lone people, never daring to show themselves when there's a group about. I need someone who can take on these bandits alone and win. That seems to be the only way of bringing them to justice. Are you up to the task?",
    "merchant_quest_deal_with_night_bandits",
    []],

  [plyr|anyone, "merchant_quest_deal_with_night_bandits",
    [],
    "Killing bandits? Well, that's my specialty!",
    "deal_with_night_bandits_quest_taken",
    [
      (str_store_party_name_link, s14, "$g_encountered_party"),
      (setup_quest_text, "qst_deal_with_night_bandits"),
      (str_store_string, s2, "@The sheriff of {s14} has asked you to deal with a group of bandits terrorising the streets of {s14}. They only come out at night, and only attack lone travellers on the streets."),
      (call_script, "script_start_quest", "qst_deal_with_night_bandits", "$g_talk_troop"),
    ]],

  [plyr|anyone, "merchant_quest_deal_with_night_bandits",
    [],
    "Sorry, I'm not interested.",
    "merchant_quest_stall",
    []],

  [anyone, "deal_with_night_bandits_quest_taken",
    [],
    "That takes a weight off my shoulders, {playername}. You can expect a fine reward if you come back successful. Just don't get yourself killed, eh?",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_move_cattle_herd"),
      (quest_get_slot, ":var0", "qst_move_cattle_herd", 1),
      (str_store_party_name, s13, ":var0"),
    ],
    "One of the merchants here is looking for cowboys to take his cattle to the market at {s13}.",
    "merchant_quest_brief",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_move_cattle_herd"),
      (quest_get_slot, reg8, "qst_move_cattle_herd", 22),
      (quest_get_slot, ":var0", "qst_move_cattle_herd", 1),
      (str_store_party_name, s13, ":var0"),
    ],
    "The cattle herd must be at {s13} within 20 days. Sooner is better, much better, but it must be absolutely no later than 20 days. If you can do that, I'd be willing to pay you {reg8} cents for your trouble. Interested?",
    "move_cattle_herd_quest_brief",
    []],

  [plyr|anyone, "move_cattle_herd_quest_brief",
    [],
    "Aye, I can take the herd to {s13}.",
    "move_cattle_herd_quest_taken",
    [
      (call_script, "script_create_cattle_herd", "$g_encountered_party", 0),
      (quest_set_slot, "qst_move_cattle_herd", 8, reg0),
      (str_store_party_name_link, s10, "$g_encountered_party"),
      (quest_get_slot, ":var0", "qst_move_cattle_herd", 1),
      (str_store_party_name_link, s13, ":var0"),
      (quest_get_slot, reg8, "qst_move_cattle_herd", 22),
      (setup_quest_text, "qst_move_cattle_herd"),
      (str_store_string, s2, "@Sheriff of {s10} asked you to move a cattle herd to {s13}. You will earn {reg8} cents in return."),
      (call_script, "script_start_quest", "qst_move_cattle_herd", "$g_talk_troop"),
    ]],

  [plyr|anyone, "move_cattle_herd_quest_brief",
    [],
    "I am sorry, but no.",
    "merchant_quest_stall",
    []],

  [anyone, "move_cattle_herd_quest_taken",
    [],
    "Splendid. You can find the herd right outside the town. After you take the animals to {s13}, return back to me and I will give you your pay.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_requested",
    [
      (eq, "$random_merchant_quest_no", "qst_move_horses_herd"),
      (quest_get_slot, ":var0", "qst_move_horses_herd", 1),
      (str_store_party_name, s13, ":var0"),
    ],
    "One of the merchants here is looking for cowhands to take his horses to the corral at {s13}.",
    "merchant_quest_brief",
    []],

  [anyone, "merchant_quest_brief",
    [
      (eq, "$random_merchant_quest_no", "qst_move_horses_herd"),
      (quest_get_slot, reg8, "qst_move_horses_herd", 22),
      (quest_get_slot, ":var0", "qst_move_horses_herd", 1),
      (str_store_party_name, s13, ":var0"),
    ],
    "The horses must be at {s13} within 14 days. Sooner is better, much better, but it must be absolutely no later than 14 days. If you can do that, I'd be willing to pay you {reg8} cents for your trouble. Interested?",
    "move_horses_herd_quest_brief",
    []],

  [plyr|anyone, "move_horses_herd_quest_brief",
    [],
    "Aye, I can take the horses to {s13}.",
    "move_horses_herd_quest_taken",
    [
      (call_script, "script_create_horses_herd", "$g_encountered_party", 0),
      (quest_set_slot, "qst_move_horses_herd", 8, reg0),
      (str_store_party_name_link, s10, "$g_encountered_party"),
      (quest_get_slot, ":var0", "qst_move_horses_herd", 1),
      (str_store_party_name_link, s13, ":var0"),
      (quest_get_slot, reg8, "qst_move_horses_herd", 22),
      (setup_quest_text, "qst_move_horses_herd"),
      (str_store_string, s2, "@Sheriff of {s10} asked you to move horses to {s13}. You will earn {reg8} cents in return."),
      (call_script, "script_start_quest", "qst_move_horses_herd", "$g_talk_troop"),
    ]],

  [plyr|anyone, "move_horses_herd_quest_brief",
    [],
    "I'm sorry, but no.",
    "merchant_quest_stall",
    []],

  [anyone, "move_horses_herd_quest_taken",
    [],
    "Splendid. You will find the horses right here in town. After you take the animals to {s13}, return back to me and I will give you your pay.",
    "mayor_pretalk",
    []],

  [anyone, "merchant_quest_requested",
    [],
    "I am afraid I can't offer you a job right now.",
    "mayor_pretalk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
      (eq, "$talk_context", 15),
      (str_store_party_name, s9, "$current_town"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}, and welcome to the {s9}. I am the head of this bank.",
    "banker_talk",
    []],

  [plyr|anyone, "banker_talk",
    [],
    "I'd like to deposit some money.",
    "banker_trade",
    []],

  [anyone, "banker_trade",
    [],
    "We are always interested in investors. I will give you a certificate of deposit for your money and I will buy it back with interest whenever you want. The interest rate is 10% per month.",
    "banker_after_trade",
    [
      (call_script, "script_copy_inventory", "trp_temp_troop", "$g_talk_troop"),
      (call_script, "script_copy_inventory", "$g_talk_troop", "trp_debt"),
      (change_screen_trade, "$g_talk_troop"),
    ]],

  [anyone, "banker_after_trade",
    [],
    "Your certificate's value will raise every month. You can sell it back at any time.",
    "banker_after_trade2",
    []],

  [auto_proceed|anyone, "banker_after_trade2",
    [],
    " ",
    "banker_pretalk",
    [
      (call_script, "script_copy_inventory", "trp_debt", "$g_talk_troop"),
      (call_script, "script_copy_inventory", "$g_talk_troop", "trp_temp_troop"),
    ]],

  [plyr|anyone, "banker_talk",
    [],
    "I want to buy some gold and silver bars.",
    "banker_trade_b",
    []],

  [anyone, "banker_trade_b",
    [],
    "Alright. Come with me.",
    "banker_pretalk",
    [
      (change_screen_trade, "$g_talk_troop"),
    ]],

  [plyr|anyone, "banker_talk",
    [],
    "Tell me, how well protected is your bank?",
    "banker_saveness",
    []],

  [anyone, "banker_saveness",
    [],
    "We have a fortified vault and armed guards on duty all day. You can feel safe putting your money here.",
    "banker_pretalk",
    []],

  [anyone, "banker_pretalk",
    [],
    "Anything else?",
    "banker_talk",
    []],

  [plyr|anyone, "banker_talk",
    [],
    "Good bye.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_deliver_cattle"),
      (check_quest_succeeded, ":var0"),
      (quest_get_slot, reg5, "qst_deliver_cattle", 10),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "My good {reg18?woman:man}! Our village is grateful for your help. Thanks to the {reg5} heads of cattle you have brought, we can now raise our own herd.",
    "village_elder_deliver_cattle_thank",
    [
      (add_xp_as_reward, 400),
      (quest_get_slot, ":var0", "qst_deliver_cattle", 10),
      (party_set_slot, "$current_town", 45, ":var0"),
      (call_script, "script_change_center_prosperity", "$current_town", 4),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_deliver_cattle"),
      (call_script, "script_add_log_entry", 4, "trp_player", "$current_town", -1, -1),
    ]],

  [anyone, "village_elder_deliver_cattle_thank",
    [],
    "{playername}, please, is there anything I can do for you?",
    "village_elder_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
      (eq, "$g_talk_troop_met", 0),
      (str_store_party_name, s9, "$current_town"),
    ],
    "Welcome to {s9}. I'm the leader of this village.",
    "village_elder_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
      (eq, "$g_talk_troop_met", 0),
      (str_store_party_name, s9, "$current_town"),
      (party_slot_eq, "$current_town", 7, "trp_player"),
    ],
    "Welcome to {s9}. We were rejoiced by the news that you are the new commander of our humble village. I'm the village elder, and I'll be honored to serve you in any way I can.",
    "village_elder_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
      (party_slot_eq, "$current_town", 7, "trp_player"),
    ],
    "It's nice seeing you here, {playername}.",
    "village_elder_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_village_1_elder", "trp_merchants_end"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}.",
    "village_elder_talk",
    []],

  [anyone, "village_elder_pretalk",
    [],
    "Is there anything else I can do for you?",
    "village_elder_talk",
    []],

  [plyr|anyone, "village_elder_talk",
    [
      (check_quest_active, "qst_hunt_down_fugitive"),
      (neg|check_quest_concluded, "qst_hunt_down_fugitive"),
      (quest_slot_eq, "qst_hunt_down_fugitive", 1, "$current_town"),
      (quest_get_slot, ":var0", "qst_hunt_down_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
    ],
    "I am looking for a fugitive by the name of {s4}. I was told he may be hiding here.",
    "village_elder_ask_fugitive",
    []],

  [plyr|anyone, "village_elder_talk",
    [
      (check_quest_active, "qst_wanted_fugitive"),
      (neg|check_quest_concluded, "qst_wanted_fugitive"),
      (quest_slot_eq, "qst_wanted_fugitive", 1, "$current_town"),
      (quest_get_slot, ":var0", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
    ],
    "I am looking for a wanted man by the name of {s4}. I was told he may be hiding here.",
    "village_elder_ask_fugitive",
    []],

  [anyone, "village_elder_ask_fugitive",
    [
      (is_currently_night),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Strangers come and go to our village, {reg18?ma'am:sir}. But I doubt you'll run into your wanted man at this hour of the night. You would have better luck during the day.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_ask_fugitive",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Strangers come and go to our village, {reg18?ma'am:sir}. If your wanted man is hiding here, you will surely find him if you look around.",
    "close_window",
    []],

  [plyr|anyone, "village_elder_talk",
    [
      (store_partner_quest, ":var0"),
      (ge, ":var0", 0),
    ],
    "About the job you asked of me...",
    "village_elder_active_mission_1",
    []],

  [plyr|anyone, "village_elder_talk",
    [
      (ge, "$g_talk_troop_faction_relation", 0),
      (store_partner_quest, ":var0"),
      (lt, ":var0", 0),
    ],
    "Do you have any jobs I can help you with?",
    "village_elder_request_mission_ask",
    []],

  [plyr|anyone, "village_elder_talk",
    [
      (party_slot_eq, "$current_town", 35, 0),
      (neg|party_slot_ge, "$current_town", 39, 1),
    ],
    "I want to buy some supplies. I will pay with cash.",
    "village_elder_trade_begin",
    []],

  [anyone, "village_elder_trade_begin",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Of course, {reg18?ma'am:sir}. Do you want to buy goods or cattle?",
    "village_elder_trade_talk",
    []],

  [plyr|anyone, "village_elder_trade_talk",
    [],
    "I want to buy food and supplies.",
    "village_elder_trade",
    []],

  [anyone, "village_elder_trade",
    [],
    "We have some food and other supplies in our storehouse. Come have a look.",
    "village_elder_pretalk",
    [
      (change_screen_trade, "$g_talk_troop"),
    ]],

  [plyr|anyone, "village_elder_trade_talk",
    [
      (party_slot_eq, "$current_town", 35, 0),
      (neg|party_slot_ge, "$current_town", 39, 1),
      (assign, ":var0", 0),
      (try_begin),
        (check_quest_active, "qst_deliver_cattle"),
        (quest_slot_eq, "qst_deliver_cattle", 1, "$current_town"),
        (assign, ":var0", 1),
      (try_end),
      (eq, ":var0", 0),
    ],
    "I want to buy some cattle.",
    "village_elder_buy_cattle",
    []],

  [plyr|anyone, "village_elder_trade_talk",
    [],
    "I changed my mind. I don't need to buy anything.",
    "village_elder_pretalk",
    []],

  [plyr|anyone, "village_elder_talk",
    [],
    "Have you seen any enemies around here recently?",
    "village_elder_ask_enemies",
    []],

  [anyone, "village_elder_ask_enemies",
    [
      (assign, ":var0", 0),
      (party_get_slot, ":var1", "$g_encountered_party", 61),
      (store_relation, ":var2", ":var1", "fac_player_supporters_faction"),
      (try_begin),
        (gt, ":var2", 0),
        (party_slot_ge, "$g_encountered_party", 26, 0),
        (assign, ":var0", 1),
      (else_try),
        (party_slot_ge, "$g_encountered_party", 26, 30),
        (assign, ":var0", 1),
      (try_end),
      (eq, ":var0", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I am sorry, {reg18?ma'am:sir}. We have neither seen nor heard of any war parties in this area.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_ask_enemies",
    [],
    "Hmm. Let me think about it...",
    "village_elder_tell_enemies",
    [
      (assign, "$temp", 0),
    ]],

  [anyone, "village_elder_tell_enemies",
    [
      (assign, ":var0", "$temp"),
      (assign, ":var1", "trp_knight_1_1_wife"),
      (try_for_range, ":var2", "trp_kingdom_1_lord", ":var1"),
        (troop_get_slot, ":var3", ":var2", 10),
        (gt, ":var3", 0),
        (store_troop_faction, ":var4", ":var2"),
        (store_relation, ":var5", ":var4", "fac_player_supporters_faction"),
        (lt, ":var5", 0),
        (store_distance_to_party_from_party, ":var6", "$g_encountered_party", ":var3"),
        (lt, ":var6", 10),
        (call_script, "script_get_information_about_troops_position", ":var2", 0),
        (eq, reg0, 1),
        (val_sub, ":var0", 1),
        (lt, ":var0", 0),
        (assign, ":var1", 0),
        (str_store_string, s2, "@He is not commanding any men at the moment."),
        (assign, ":var7", 0),
        (assign, ":var8", 0),
        (party_get_num_companion_stacks, ":var9", ":var3"),
        (try_for_range_backwards, ":var10", 0, ":var9"),
          (party_stack_get_troop_id, ":var11", ":var3", ":var10"),
          (neg|troop_is_hero, ":var11"),
          (party_stack_get_size, ":var12", ":var3", ":var10"),
          (party_stack_get_num_wounded, ":var13", ":var3", ":var10"),
          (val_add, ":var7", ":var12"),
          (val_add, ":var8", ":var13"),
        (try_end),
        (gt, ":var7", 0),
        (call_script, "script_round_value", ":var8"),
        (assign, reg1, reg0),
        (call_script, "script_round_value", ":var7"),
        (str_store_string, s2, "@He currently commands {reg0} men{reg1?, of which around {reg1} are wounded:}."),
      (try_end),
      (eq, ":var1", 0),
    ],
    "{s1} {s2}",
    "village_elder_tell_enemies",
    [
      (val_add, "$temp", 1),
    ]],

  [anyone, "village_elder_tell_enemies",
    [
      (eq, "$temp", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "No, {reg18?ma'am:sir}. We ain't seen any war parties in this area for some time.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_tell_enemies",
    [],
    "Well, I guess that was all.",
    "village_elder_pretalk",
    []],

  [plyr|anyone, "village_elder_talk",
    [
      (call_script, "script_cf_village_recruit_volunteers_cond"),
    ],
    "Are there any lads from this village who might want to seek their fortune in the wars?",
    "village_elder_recruit_start",
    []],

  [plyr|anyone, "village_elder_talk",
    [],
    "[Leave]",
    "close_window",
    []],

  [anyone, "village_elder_buy_cattle",
    [
      (party_get_slot, reg5, "$g_encountered_party", 45),
      (gt, reg5, 0),
      (store_item_value, ":var0", "itm_cattle_meat"),
      (call_script, "script_game_get_item_buy_price_factor", "itm_cattle_meat"),
      (val_mul, ":var0", reg0),
      (val_div, ":var0", 50),
      (assign, "$temp", ":var0"),
      (assign, reg6, ":var0"),
    ],
    "We have {reg5} heads of cattle, each for {reg6} cents. How many do you want to buy?",
    "village_elder_buy_cattle_2",
    []],

  [anyone, "village_elder_buy_cattle",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I am afraid we ain't got no cattle left in the village {reg18?ma'am:sir}.",
    "village_elder_buy_cattle_2",
    []],

  [plyr|anyone, "village_elder_buy_cattle_2",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 45),
      (ge, ":var0", 1),
      (store_troop_gold, ":var1", "trp_player"),
      (ge, ":var1", "$temp"),
    ],
    "One.",
    "village_elder_buy_cattle_complete",
    [
      (call_script, "script_buy_cattle_from_village", "$g_encountered_party", 1, "$temp"),
    ]],

  [plyr|anyone, "village_elder_buy_cattle_2",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 45),
      (ge, ":var0", 2),
      (store_troop_gold, ":var1", "trp_player"),
      (store_mul, ":var2", "$temp", 2),
      (ge, ":var1", ":var2"),
    ],
    "Two.",
    "village_elder_buy_cattle_complete",
    [
      (call_script, "script_buy_cattle_from_village", "$g_encountered_party", 2, "$temp"),
    ]],

  [plyr|anyone, "village_elder_buy_cattle_2",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 45),
      (ge, ":var0", 3),
      (store_troop_gold, ":var1", "trp_player"),
      (store_mul, ":var2", "$temp", 3),
      (ge, ":var1", ":var2"),
    ],
    "Three.",
    "village_elder_buy_cattle_complete",
    [
      (call_script, "script_buy_cattle_from_village", "$g_encountered_party", 3, "$temp"),
    ]],

  [plyr|anyone, "village_elder_buy_cattle_2",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 45),
      (ge, ":var0", 4),
      (store_troop_gold, ":var1", "trp_player"),
      (store_mul, ":var2", "$temp", 4),
      (ge, ":var1", ":var2"),
    ],
    "Four.",
    "village_elder_buy_cattle_complete",
    [
      (call_script, "script_buy_cattle_from_village", "$g_encountered_party", 4, "$temp"),
    ]],

  [plyr|anyone, "village_elder_buy_cattle_2",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 45),
      (ge, ":var0", 5),
      (store_troop_gold, ":var1", "trp_player"),
      (store_mul, ":var2", "$temp", 5),
      (ge, ":var1", ":var2"),
    ],
    "Five.",
    "village_elder_buy_cattle_complete",
    [
      (call_script, "script_buy_cattle_from_village", "$g_encountered_party", 5, "$temp"),
    ]],

  [plyr|anyone, "village_elder_buy_cattle_2",
    [],
    "Forget it.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_buy_cattle_complete",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I will tell the herders to round up the animals and bring them to you, {reg18?ma'am:sir}. I am sure you will be satisfied with your purchase.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_recruit_start",
    [
      (call_script, "script_cf_village_recruit_volunteers_cond"),
      (store_faction_of_party, ":var0", "$current_town"),
      (str_store_faction_name, s1, ":var0"),
      (assign, ":var1", 0),
      (assign, reg0, "$players_kingdom"),
      (display_message, "@pk: {reg0}"),
      (try_begin),
        (this_or_next|eq, "$players_kingdom", 0),
        (neg|faction_slot_eq, "$players_kingdom", 100, 0),
        (faction_slot_eq, ":var0", 100, 1),
        (assign, ":var1", 1),
      (else_try),
        (gt, "$players_kingdom", 0),
        (faction_slot_eq, "$players_kingdom", 100, 0),
        (faction_slot_eq, ":var0", 100, 0),
        (assign, ":var1", 1),
      (try_end),
      (eq, ":var1", 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I apologize, but we have not been given permission to supply you with {s1} recruits, {reg18?ma'am:sir}. Now, is there anything else I can do for you?",
    "village_elder_talk",
    []],

  [anyone, "village_elder_recruit_start",
    [
      (party_slot_eq, "$current_town", 223, 0),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "I don't think anyone would be interested, {reg18?ma'am:sir}. Is there anything else I can do for you?",
    "village_elder_talk",
    []],

  [anyone, "village_elder_recruit_start",
    [
      (party_get_slot, ":var0", "$current_town", 223),
      (party_get_free_companions_capacity, ":var1", "p_main_party"),
      (val_min, ":var0", ":var1"),
      (assign, "$temp", ":var0"),
      (assign, reg5, ":var0"),
      (party_get_slot, ":var2", "$current_town", 222),
      (store_faction_of_party, ":var3", "$current_town"),
      (store_character_level, ":var4", ":var2"),
      (try_begin),
        (ge, ":var4", 13),
        (val_mul, ":var4", 10),
      (try_end),
      (store_add, ":var5", ":var4", 90),
      (try_begin),
        (eq, ":var3", "$players_kingdom"),
        (val_mul, ":var5", 3),
        (val_div, ":var5", 4),
      (try_end),
      (assign, reg0, ":var5"),
      (store_troop_gold, ":var6", "trp_player"),
      (store_div, ":var7", ":var6", ":var5"),
      (val_min, ":var0", ":var7"),
      (assign, reg5, ":var0"),
      (store_add, reg7, ":var0", -1),
    ],
    "I can think of {reg5} whom I suspect would jump at the chance. If you could pay {reg0} cents {reg7?each for their equipment:for his equipment}. Does that suit you?",
    "village_elder_recruit_decision",
    []],

  [plyr|anyone, "village_elder_recruit_decision",
    [
      (party_slot_eq, "$current_town", 223, 0),
    ],
    "So be it.",
    "village_elder_pretalk",
    [
      (party_set_slot, "$current_town", 223, -1),
    ]],

  [plyr|anyone, "village_elder_recruit_decision",
    [
      (assign, ":var0", "$temp"),
      (ge, ":var0", 1),
      (store_add, reg7, ":var0", -1),
    ],
    "Tell {reg7?them:him} to make ready.",
    "village_elder_pretalk",
    [
      (call_script, "script_village_recruit_volunteers_recruit"),
    ]],

  [plyr|anyone, "village_elder_recruit_decision",
    [
      (party_slot_ge, "$current_town", 223, 1),
    ],
    "No, not now.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_active_mission_1",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}, have you made any progress on it?",
    "village_elder_active_mission_2",
    []],

  [plyr|anyone, "village_elder_active_mission_2",
    [
      (store_partner_quest, ":var0"),
      (eq, ":var0", "qst_deliver_grain"),
      (quest_get_slot, ":var1", "qst_deliver_grain", 10),
      (call_script, "script_get_troop_item_amount", "trp_player", "itm_grain"),
      (assign, ":var2", reg0),
      (ge, ":var2", ":var1"),
      (assign, reg5, ":var1"),
    ],
    "Indeed. I brought you {reg5} packs of wheat.",
    "village_elder_deliver_grain_thank",
    []],

  [anyone, "village_elder_deliver_grain_thank",
    [
      (str_store_party_name, s13, "$current_town"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "My good {reg18?woman:man}! You have saved us from hunger and desperation. We cannot thank you enough, but you'll always be in our prayers. The village of {s13} will not forget what you have done for us.",
    "village_elder_deliver_grain_thank_2",
    [
      (quest_get_slot, ":var0", "qst_deliver_grain", 10),
      (troop_remove_items, "trp_player", "itm_grain", ":var0"),
      (add_xp_as_reward, 400),
      (call_script, "script_change_center_prosperity", "$current_town", 4),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_end_quest", "qst_deliver_grain"),
      (call_script, "script_add_log_entry", 4, "trp_player", "$current_town", -1, -1),
    ]],

  [anyone, "village_elder_deliver_grain_thank_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "My good {reg18?woman:man}, please, is there anything I can do for you?",
    "village_elder_talk",
    []],

  [plyr|anyone, "village_elder_active_mission_2",
    [],
    "I am still working on it.",
    "village_elder_active_mission_3",
    []],

  [plyr|anyone, "village_elder_active_mission_2",
    [],
    "I am afraid I won't be able to finish it.",
    "village_elder_mission_failed",
    []],

  [anyone, "village_elder_active_mission_3",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thank you, {reg18?ma'am:sir}. We are praying for your success everyday.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_mission_failed",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Ah, I am sorry to hear that {reg18?ma'am:sir}. I'll try to think of something else.",
    "village_elder_pretalk",
    [
      (store_partner_quest, ":var0"),
      (call_script, "script_abort_quest", ":var0", 1),
    ]],

  [anyone, "village_elder_request_mission_ask",
    [
      (store_partner_quest, ":var0"),
      (ge, ":var0", 0),
    ],
    "Well sir, you are already engaged with a task helping us. We cannot ask more from you.",
    "village_elder_pretalk",
    []],

  [anyone, "village_elder_request_mission_ask",
    [
      (troop_slot_eq, "$g_talk_troop", 20, 1),
    ],
    "No sir, We don't have any other tasks for you.",
    "village_elder_pretalk",
    []],

  [auto_proceed|anyone, "village_elder_request_mission_ask",
    [],
    "A task?",
    "village_elder_tell_mission",
    [
      (call_script, "script_get_random_quest", "$g_talk_troop"),
      (assign, "$random_quest_no", reg0),
    ]],

  [anyone, "village_elder_tell_mission",
    [
      (eq, "$random_quest_no", "qst_deliver_grain"),
    ],
    "{My good sir/My good lady}, our village has been going through such hardships lately. The harvest has been bad, and recently some merciless bandits took away our seed grain that we had reserved for the planting season. If we cannot find some grain soon, we will not be able to plant our fields and then we will have nothing to eat for the coming year. If you can help us, we would be indebted to you forever.",
    "village_elder_tell_deliver_grain_mission",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_party_name_link, s3, ":var0"),
      (quest_get_slot, reg5, "$random_quest_no", 10),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@The elder of the village of {s3} asked you to bring them {reg5} packs of wheat."),
    ]],

  [plyr|anyone, "village_elder_tell_deliver_grain_mission",
    [],
    "Hmmm. How much grain do you need?",
    "village_elder_tell_deliver_grain_mission_2",
    []],

  [plyr|anyone, "village_elder_tell_deliver_grain_mission",
    [],
    "I can't be bothered with this. Ask help from someone else.",
    "village_elder_deliver_grain_mission_reject",
    []],

  [anyone, "village_elder_tell_deliver_grain_mission_2",
    [
      (quest_get_slot, reg5, "$random_quest_no", 10),
    ],
    "I think {reg5} packs of wheat will let us start the planting. Hopefully, we can find charitable people to help us with the rest.",
    "village_elder_tell_deliver_grain_mission_3",
    []],

  [plyr|anyone, "village_elder_tell_deliver_grain_mission_3",
    [],
    "Then I will go and find you the wheat you need.",
    "village_elder_deliver_grain_mission_accept",
    []],

  [plyr|anyone, "village_elder_tell_deliver_grain_mission_3",
    [],
    "I am afraid I don't have time for this. You'll need to find help elsewhere.",
    "village_elder_deliver_grain_mission_reject",
    []],

  [anyone, "village_elder_deliver_grain_mission_accept",
    [],
    "Thank you, sir. We'll be praying for you night and day.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
    ]],

  [anyone, "village_elder_deliver_grain_mission_reject",
    [],
    "Yes sir, of course. I am sorry if I have bothered you with our troubles.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "village_elder_tell_mission",
    [
      (eq, "$random_quest_no", "qst_escort_villagers"),
    ],
    "We have some settlers who want to trade goods to {s8}. However with all those bandits and deserters on the roads, I don't want to send them out without an escort. If you can lead them to {s8} in 15 days, you will earn {reg8} cents. Of course your party needs to be at least {reg4} strong to offer them any protection.",
    "village_elder_tell_escort_villagers_mission",
    [
      (quest_get_slot, reg8, "qst_escort_villagers", 22),
      (quest_get_slot, reg4, "qst_escort_villagers", 10),
      (quest_get_slot, ":var0", "qst_escort_villagers", 1),
      (str_store_party_name, s8, ":var0"),
    ]],

  [plyr|anyone, "village_elder_tell_escort_villagers_mission",
    [
      (store_party_size_wo_prisoners, ":var0", "p_main_party"),
      (quest_get_slot, ":var1", "qst_escort_villagers", 10),
      (ge, ":var0", ":var1"),
    ],
    "Alright. I will escort them.",
    "village_elder_quest_taken",
    [
      (quest_get_slot, ":var0", "qst_escort_villagers", 1),
      (set_spawn_radius, 1),
      (spawn_around_party, "$g_encountered_party", "pt_village_caravan"),
      (assign, ":var1", reg0),
      (party_set_ai_behavior, ":var1", ai_bhvr_attack_party),
      (party_set_ai_object, ":var1", "p_main_party"),
      (party_set_flags, ":var1", 65536, 0),
      (quest_set_slot, "qst_escort_villagers", 8, ":var1"),
      (quest_set_slot, "qst_escort_villagers", 11, 0),
      (str_store_party_name_link, s8, ":var0"),
      (setup_quest_text, "qst_escort_villagers"),
      (str_store_string, s2, "@Escort the settlers to the town of {s8}."),
      (call_script, "script_start_quest", "qst_escort_villagers", "$g_talk_troop"),
    ]],

  [plyr|anyone, "village_elder_tell_escort_villagers_mission",
    [
      (store_party_size_wo_prisoners, ":var0", "p_main_party"),
      (quest_get_slot, ":var1", "qst_escort_villagers", 10),
      (lt, ":var0", ":var1"),
    ],
    "I am afraid I don't have that many soldiers with me.",
    "village_elder_quest_stall",
    []],

  [plyr|anyone, "village_elder_tell_escort_villagers_mission",
    [
      (store_party_size_wo_prisoners, ":var0", "p_main_party"),
      (quest_get_slot, ":var1", "qst_escort_villagers", 10),
      (ge, ":var0", ":var1"),
    ],
    "Sorry. I can't do that right now",
    "village_elder_quest_stall",
    []],

  [party_tpl|pt_village_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_villagers", 8),
      (eq, "$g_encountered_party", ":var0"),
      (quest_slot_eq, "qst_escort_villagers", 11, 2),
    ],
    "We can cover the rest of the way ourselves. Thanks.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_village_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_villagers", 8),
      (eq, "$g_encountered_party", ":var0"),
      (quest_get_slot, ":var1", "qst_escort_villagers", 1),
      (store_distance_to_party_from_party, ":var2", ":var1", ":var0"),
      (lt, ":var2", 4),
      (quest_slot_eq, "qst_escort_villagers", 11, 1),
    ],
    "Well, we have almost reached {s21}. We can cover the rest of the way ourselves. Here's your pay... {reg14} cents. Thanks for escorting us. Good luck.",
    "close_window",
    [
      (quest_get_slot, ":var0", "qst_escort_villagers", 8),
      (quest_get_slot, ":var1", "qst_escort_villagers", 1),
      (quest_get_slot, ":var2", "qst_escort_villagers", 12),
      (quest_get_slot, ":var3", "qst_escort_villagers", 22),
      (party_set_ai_behavior, ":var0", ai_bhvr_travel_to_party),
      (party_set_ai_object, ":var0", ":var1"),
      (party_set_flags, ":var0", 65536, 0),
      (str_store_party_name, s21, ":var1"),
      (call_script, "script_change_player_relation_with_center", ":var2", 1),
      (call_script, "script_end_quest", "qst_escort_villagers"),
      (quest_set_slot, "qst_escort_villagers", 11, 2),
      (call_script, "script_troop_add_gold", "trp_player", ":var3"),
      (assign, ":var4", ":var3"),
      (val_mul, ":var4", 2),
      (val_add, ":var4", 100),
      (add_xp_as_reward, ":var4"),
      (call_script, "script_change_troop_renown", "trp_player", 2),
      (assign, reg14, ":var3"),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_village_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_villagers", 8),
      (eq, "$g_encountered_party", ":var0"),
      (quest_slot_eq, "qst_escort_villagers", 11, 0),
    ],
    "Greetings. You must be our escort, right?",
    "village_caravan_intro_1",
    [
      (quest_set_slot, "qst_escort_villagers", 11, 1),
    ]],

  [plyr|anyone, "village_caravan_intro_1",
    [],
    "Yes. My name is {playername}. I will lead you to {s1}.",
    "village_caravan_intro_2",
    [
      (quest_get_slot, ":var0", "qst_escort_villagers", 1),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "village_caravan_intro_2",
    [],
    "Well, It is good to know we won't travel alone. What do you want us to do now?",
    "escort_village_caravan_talk",
    []],

  [party_tpl|pt_village_caravan, "start",
    [
      (quest_get_slot, ":var0", "qst_escort_villagers", 8),
      (eq, "$g_encountered_party", ":var0"),
    ],
    "Eh. We've made it this far... What do you want us to do?",
    "escort_village_caravan_talk",
    []],

  [plyr|anyone, "escort_village_caravan_talk",
    [],
    "You follow my lead. I'll take you through a safe route.",
    "village_caravan_follow_lead",
    []],

  [anyone, "village_caravan_follow_lead",
    [],
    "Alright. We'll be right behind you.",
    "close_window",
    [
      (assign, "$escort_villagers_mode", 0),
      (assign, "$g_leave_encounter", 1),
    ]],

  [plyr|anyone, "escort_village_caravan_talk",
    [],
    "You stay here for a while. I'll go ahead and check the road.",
    "village_caravan_stay_here",
    []],

  [anyone, "village_caravan_stay_here",
    [],
    "Alright. We'll be waiting here for you.",
    "close_window",
    [
      (assign, "$escort_villagers_mode", 1),
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "village_elder_quest_taken",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Thank you, {reg18?ma'am:sir}. We'll be praying for you night and day.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 5),
    ]],

  [anyone, "village_elder_quest_stall",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}, of course. I am sorry if I have bothered you with our troubles.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "village_elder_tell_mission",
    [
      (eq, "$random_quest_no", "qst_train_peasants_against_bandits"),
    ],
    "We are suffering greatly at the hands of a group of bandits. They take our food and livestock, and kill anyone who doesn't obey them immediately. Our men are angry that we cannot defend ourselves, but we are only simple farmers... However, with some help, I think that some of the people here could be more than that. We just need an experienced warrior to teach us how to fight.",
    "village_elder_tell_train_peasants_against_bandits_mission",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_party_name_link, s13, ":var0"),
      (quest_get_slot, reg5, "$random_quest_no", 10),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@The elder of the village of {s13} asked you to train {reg5} peasants to fight against local bandits."),
    ]],

  [plyr|anyone, "village_elder_tell_train_peasants_against_bandits_mission",
    [],
    "I can teach you how to defend yourself.",
    "village_elder_train_peasants_against_bandits_mission_accept",
    []],

  [plyr|anyone, "village_elder_tell_train_peasants_against_bandits_mission",
    [],
    "You peasants have no business taking up arms. Just pay the bandits and be off with it.",
    "village_elder_train_peasants_against_bandits_mission_reject",
    []],

  [anyone, "village_elder_train_peasants_against_bandits_mission_accept",
    [],
    "You will? Oh, splendid! We would be deeply indebted to you, sir. I'll instruct the village folk to assemble here and receive your training. If you can teach us how to defend ourselves, I promise you'll receive everything we can give you in return for your efforts.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
    ]],

  [anyone, "village_elder_train_peasants_against_bandits_mission_reject",
    [],
    "Yes, of course sir. Thank you for your counsel.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "village_elder_tell_mission",
    [
      (eq, "$random_quest_no", "qst_deliver_cattle"),
    ],
    "Bandits have driven away our cattle. Our pastures are empty. If we had just a few heads of cattle we could start to raise a herd again.",
    "village_elder_tell_deliver_cattle_mission",
    [
      (quest_get_slot, ":var0", "$random_quest_no", 1),
      (str_store_party_name_link, s3, ":var0"),
      (quest_get_slot, reg5, "$random_quest_no", 10),
      (setup_quest_text, "$random_quest_no"),
      (str_store_string, s2, "@The elder of the village of {s3} asked you to bring them {reg5} heads of cattle."),
    ]],

  [plyr|anyone, "village_elder_tell_deliver_cattle_mission",
    [],
    "How many animals do you need?",
    "village_elder_tell_deliver_cattle_mission_2",
    []],

  [plyr|anyone, "village_elder_tell_deliver_cattle_mission",
    [],
    "I don't have time for this. Ask help from someone else.",
    "village_elder_deliver_cattle_mission_reject",
    []],

  [anyone, "village_elder_tell_deliver_cattle_mission_2",
    [
      (quest_get_slot, reg5, "$random_quest_no", 10),
    ],
    "I think {reg5} heads will suffice for a small herd.",
    "village_elder_tell_deliver_cattle_mission_3",
    []],

  [plyr|anyone, "village_elder_tell_deliver_cattle_mission_3",
    [],
    "Then I will bring you the cattle you need.",
    "village_elder_deliver_cattle_mission_accept",
    []],

  [plyr|anyone, "village_elder_tell_deliver_cattle_mission_3",
    [],
    "I am afraid I don't have time for this. You'll need to find help elsewhere.",
    "village_elder_deliver_cattle_mission_reject",
    []],

  [anyone, "village_elder_deliver_cattle_mission_accept",
    [],
    "Thank you, sir. We'll be praying for you night and day.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
      (call_script, "script_change_player_relation_with_center", "$current_town", 3),
      (call_script, "script_start_quest", "$random_quest_no", "$g_talk_troop"),
    ]],

  [anyone, "village_elder_deliver_cattle_mission_reject",
    [],
    "Yes sir, of course. I am sorry if I have bothered you with our troubles.",
    "close_window",
    [
      (troop_set_slot, "$g_talk_troop", 20, 1),
    ]],

  [anyone, "village_elder_tell_mission",
    [],
    "Thank you, sir, but we do not really need anything right now.",
    "village_elder_pretalk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_town_1_merchant", "trp_town_1_horse_merchant"),
      (party_slot_eq, "$current_town", 7, "trp_player"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "{reg18?Ma'am:Sir}, you honour my humble shop with your presence.",
    "goods_merchant_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_town_1_merchant", "trp_town_1_horse_merchant"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Welcome {reg18?ma'am:mister}. What can I do for you?",
    "goods_merchant_talk",
    []],

  [anyone, "goods_merchant_pretalk",
    [],
    "Anything else?",
    "goods_merchant_talk",
    []],

  [plyr|anyone, "goods_merchant_talk",
    [],
    "I want to buy a few items... and perhaps sell some.",
    "goods_trade_requested",
    []],

  [anyone, "goods_trade_requested",
    [],
    "Sure, sure... Here, have a look at my stock...",
    "goods_trade_completed",
    [
      (change_screen_trade),
    ]],

  [anyone, "goods_trade_completed",
    [],
    "Anything else?",
    "goods_merchant_talk",
    []],

  [plyr|anyone, "goods_merchant_talk",
    [],
    "What goods should I buy here to trade with other towns?",
    "trade_info_request",
    []],

  [plyr|anyone, "goods_merchant_talk",
    [],
    "Nothing. Thanks.",
    "close_window",
    []],

  [anyone, "trade_info_request",
    [],
    "That information can be best obtained from caravan masters and travelling merchants. If you want I can send you to the district where foreign merchants stay at when they come to the town. If you spend some time there and listen to the talk, you can learn a lot about what to buy and where to sell it.",
    "trade_info_request_2",
    []],

  [plyr|anyone, "trade_info_request_2",
    [],
    "Then I'll go and spend some time with these merchants.",
    "close_window",
    [
      (jump_to_menu, "mnu_town_trade_assessment_begin"),
      (finish_mission),
    ]],

  [plyr|anyone, "trade_info_request_2",
    [],
    "I have no time for this right now.",
    "goods_merchant_pretalk",
    []],

  [anyone, "start",
    [
      (store_conversation_troop, reg1),
      (is_between, reg1, "trp_town_1_arena_master", "trp_town_1_armorer"),
      (assign, "$arena_reward_asked", 0),
      (assign, "$arena_tournaments_asked", 0),
      (eq, 1, 0),
    ],
    ".",
    "arena_intro_1",
    []],

  [anyone, "start",
    [
      (store_conversation_troop, reg1),
      (is_between, reg1, "trp_town_1_arena_master", "trp_town_1_armorer"),
      (eq, "$arena_master_first_talk", 0),
    ],
    "Good day friend. If you came to watch the tournaments you came in vain. There won't be a tournament here anytime soon.",
    "arena_intro_1",
    [
      (assign, "$arena_master_first_talk", 1),
    ]],

  [plyr|anyone, "arena_intro_1",
    [],
    "Tournaments? So they hold the tournaments here...",
    "arena_intro_2",
    []],

  [anyone, "arena_intro_2",
    [],
    "Yes. You should see this place during one of the tournament fights. Everyone from the town and nearby villages comes here. The crowd becomes mad with excitement. Anyway, as I said, there won't be an event here soon, so there isn't much to see. Except, there is an official duel every now and then, and  of course we have melee fights almost every day.",
    "arena_intro_3",
    []],

  [plyr|anyone, "arena_intro_3",
    [],
    "Tell me about the melee fights.",
    "arena_training_melee_intro",
    []],

  [anyone, "arena_training_melee_intro",
    [],
    "The fighters and knights get bored waiting for the next tournament, so they have invented the training melee. It is a simple idea really. Fighters jump into the arena with a weapon. There are no rules, no teams. Everyone beats at each other until there is only fighter left standing. Sounds like fun, eh?",
    "arena_training_melee_intro_2",
    []],

  [plyr|anyone, "arena_training_melee_intro_2",
    [
      (eq, "$arena_reward_asked", 0),
    ],
    "Is there a reward?",
    "arena_training_melee_intro_reward",
    [
      (assign, "$arena_reward_asked", 1),
    ]],

  [anyone, "arena_training_melee_intro_reward",
    [
      (assign, reg1, 3),
      (assign, reg11, 5),
      (assign, reg2, 6),
      (assign, reg12, 10),
      (assign, reg3, 10),
      (assign, reg13, 25),
      (assign, reg4, 20),
      (assign, reg14, 60),
      (assign, reg15, 250),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "There is, actually. Some of the wealthy townsmen offer prizes for those fighters who show great skill in the fights. If you can beat {reg1} opponents before going down, you'll earn {reg11} cents. You'll get {reg12} cents for striking down at least {reg2} opponents, {reg13} cents if you can defeat {reg3} opponents, and {reg14} cents if you can survive long enough to beat {reg4} opponents. If you can manage to be the last {reg18?fighter:man} standing, you'll earn the great prize of the fights, {reg15} cents. Sounds good, eh?",
    "arena_training_melee_intro_2",
    [
      (assign, "$arena_tournaments_asked", 1),
    ]],

  [anyone, "arena_training_melee_explain_reward",
    [
      (assign, reg1, 3),
      (assign, reg11, 5),
      (assign, reg2, 6),
      (assign, reg12, 10),
      (assign, reg3, 10),
      (assign, reg13, 25),
      (assign, reg4, 20),
      (assign, reg14, 60),
      (assign, reg15, 250),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Some of the wealthy townsmen offer prizes for those fighters who show great skill in the fights. If you can beat {reg1} opponents before going down, you'll earn {reg11} cents. You'll get {reg12} cents for striking down at least {reg2} opponents, {reg13} cents if you can defeat {reg3} opponents, and {reg14} cents if you can survive long enough to beat {reg4} opponents. If you can manage to be the last {reg18?fighter:man} standing, you'll earn the great prize of the fights, {reg15} cents. Sounds good, eh?",
    "arena_master_melee_pretalk",
    []],

  [plyr|anyone, "arena_training_melee_intro_2",
    [],
    "Can I join too?",
    "arena_training_melee_intro_3",
    []],

  [anyone, "arena_training_melee_intro_3",
    [],
    "Ha ha. You would have to be out of your mind not to. Of course. The melee fights are open to all. Actually there is going to be a fight soon. You can go and hop in if you want to.",
    "arena_master_melee_talk",
    []],

  [anyone, "start",
    [
      (store_conversation_troop, reg1),
      (is_between, reg1, "trp_town_1_arena_master", "trp_town_1_armorer"),
      (eq, "$g_talk_troop_met", 0),
    ],
    "Hello. You seem to be new here. Care to share your name?",
    "arena_master_intro_1",
    []],

  [plyr|anyone, "arena_master_intro_1",
    [],
    "I am {playername}.",
    "arena_master_intro_2",
    []],

  [anyone, "arena_master_intro_2",
    [
      (store_encountered_party, reg2),
      (str_store_party_name, s1, reg2),
    ],
    "Well met {playername}. I am the master of the tournaments here at {s1}. Talk to me if you want to join the fights.",
    "arena_master_pre_talk",
    []],

  [auto_proceed|anyone, "start",
    [
      (store_conversation_troop, reg1),
      (is_between, reg1, "trp_town_1_arena_master", "trp_town_1_armorer"),
      (eq, "$last_training_fight_town", "$current_town"),
      (store_current_hours, ":var0"),
      (val_add, ":var0", -4),
      (lt, ":var0", "$training_fight_time"),
    ],
    ".",
    "arena_master_fight_result",
    [
      (assign, "$arena_reward_asked", 0),
    ]],

  [anyone, "arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (eq, "$g_arena_training_kills", 0),
    ],
    "Ha-ha, that's quite the bruise you're sporting. But don't worry; everybody gets trounced once in awhile. The important thing is to pick yourself up, dust yourself off and keep fighting. That's what champions do.",
    "arena_master_pre_talk",
    [
      (assign, "$last_training_fight_town", -1),
    ]],

  [anyone, "arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", 3),
      (assign, reg8, "$g_arena_training_kills"),
    ],
    "Hey, you managed to take down {reg8} opponents. Not bad. But that won't bring you any prize money. Now, if I were you, I would go back there and show everyone what I can do...",
    "arena_master_pre_talk",
    [
      (assign, "$last_training_fight_town", -1),
    ]],

  [anyone, "arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", 6),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, 5),
    ],
    "You put up quite a good fight there. Good moves. You definitely show promise. And you earned a prize of {reg10} cents for knocking down {reg8} opponents.",
    "arena_master_pre_talk",
    [
      (call_script, "script_troop_add_gold", "trp_player", 5),
      (add_xp_to_troop, 5, "trp_player"),
      (assign, "$last_training_fight_town", -1),
    ]],

  [anyone, "arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", 10),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, 10),
      (assign, reg12, 6),
    ],
    "That was a good fight you put up there. You managed to take down no less than {reg8} opponents. And of course, you earned a prize money of {reg10} cents.",
    "arena_master_pre_talk",
    [
      (call_script, "script_troop_add_gold", "trp_player", 10),
      (add_xp_to_troop, 10, "trp_player"),
      (assign, "$last_training_fight_town", -1),
    ]],

  [anyone, "arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (lt, "$g_arena_training_kills", 20),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, 25),
    ],
    "Your performance was amazing! You are without doubt a very skilled fighter. Not everyone can knock down {reg8} people in the fights. Of course you deserve a prize with that performance: {reg10} cents. Nice, eh?",
    "arena_master_pre_talk",
    [
      (call_script, "script_troop_add_gold", "trp_player", 25),
      (add_xp_to_troop, 10, "trp_player"),
      (assign, "$last_training_fight_town", -1),
    ]],

  [anyone, "arena_master_fight_result",
    [
      (eq, "$g_arena_training_won", 0),
      (assign, reg8, "$g_arena_training_kills"),
      (assign, reg10, 60),
    ],
    "That was damned good fighting, {playername}. You have very good moves, excellent tactics. And you earned a prize of {reg10} cents for knocking down {reg8} opponents.",
    "arena_master_pre_talk",
    [
      (call_script, "script_troop_add_gold", "trp_player", 60),
      (add_xp_to_troop, 10, "trp_player"),
      (assign, "$last_training_fight_town", -1),
    ]],

  [anyone, "arena_master_fight_result",
    [
      (assign, reg10, 250),
    ],
    "Congratulations champion! Your fight there was something to remember! You managed to be the last fighter standing beating down everyone else. And of course you won the grand prize of the fights: {reg10} cents.",
    "arena_master_pre_talk",
    [
      (call_script, "script_troop_add_gold", "trp_player", 250),
      (add_xp_to_troop, 200, "trp_player"),
      (assign, "$last_training_fight_town", -1),
    ]],

  [anyone, "start",
    [
      (store_conversation_troop, reg1),
      (is_between, reg1, "trp_town_1_arena_master", "trp_town_1_armorer"),
    ],
    "Hello {playername}. Good to see you again.",
    "arena_master_pre_talk",
    [
      (assign, "$arena_reward_asked", 0),
    ]],

  [anyone, "arena_master_pre_talk",
    [],
    "What would you like to do?",
    "arena_master_talk",
    []],

  [plyr|anyone, "arena_master_talk",
    [],
    "About the melee fights...",
    "arena_master_melee_pretalk",
    []],

  [plyr|anyone, "arena_master_talk",
    [
      (eq, "$arena_tournaments_asked", 0),
    ],
    "Will there be a tournament in nearby towns soon?",
    "arena_master_ask_tournaments",
    [
      (assign, "$arena_tournaments_asked", 1),
    ]],

  [plyr|anyone, "arena_master_talk",
    [],
    "I need to leave now. Good bye.",
    "close_window",
    []],

  [anyone, "arena_master_ask_tournaments",
    [],
    "{reg2?There won't be any tournaments any time soon.:{reg1?Tournaments are:A tournament is} going to be held at {s15}.}",
    "arena_master_talk",
    [
      (assign, ":var0", 0),
      (try_for_range_backwards, ":var1", "p_town_1", "p_castle_1"),
        (party_slot_ge, ":var1", 150, 1),
        (val_add, ":var0", 1),
        (try_begin),
          (eq, ":var0", 1),
          (str_store_party_name, s15, ":var1"),
        (else_try),
          (str_store_party_name, s16, ":var1"),
          (eq, ":var0", 2),
          (str_store_string, s15, "@{s16} and {s15}"),
        (else_try),
          (str_store_string, s15, "@{s16}, {s15}"),
        (try_end),
      (try_end),
      (try_begin),
        (eq, ":var0", 0),
        (assign, reg2, 1),
      (else_try),
        (assign, reg2, 0),
        (store_sub, reg1, ":var0", 1),
      (try_end),
    ]],

  [anyone, "arena_master_melee_pretalk",
    [],
    "There will be a fight here soon. You can go and jump in if you like.",
    "arena_master_melee_talk",
    []],

  [plyr|anyone, "arena_master_melee_talk",
    [],
    "Good. That's what I am going to do.",
    "close_window",
    [
      (assign, "$last_training_fight_town", "$current_town"),
      (store_current_hours, "$training_fight_time"),
      (assign, "$g_mt_mode", 1),
      (party_get_slot, ":var0", "$current_town", 16),
      (modify_visitors_at_site, ":var0"),
      (reset_visitors),
      (store_random_in_range, "$g_player_entry_point", 32, 40),
      (set_visitor, "$g_player_entry_point", "trp_player"),
      (set_jump_mission, "mt_arena_melee_fight"),
      (jump_to_scene, ":var0"),
    ]],

  [plyr|anyone, "arena_master_melee_talk",
    [],
    "Thanks. But I will give my bruises some time to heal.",
    "arena_master_melee_reject",
    []],

  [anyone, "arena_master_melee_reject",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good {reg18?woman:man}. That's clever of you.",
    "arena_master_pre_talk",
    []],

  [plyr|anyone, "arena_master_melee_talk",
    [
      (eq, "$arena_reward_asked", 0),
    ],
    "Actually, can you tell me about the rewards again?",
    "arena_training_melee_explain_reward",
    [
      (assign, "$arena_reward_asked", 1),
    ]],

  [trp_galeas, "start",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Hello {reg18?miss:mister}. If you have any prisoners, I will be happy to buy them from you.",
    "galeas_talk",
    []],

  [plyr|trp_galeas, "galeas_talk",
    [
      (store_num_regular_prisoners, reg0),
      (ge, reg0, 1),
    ],
    "Then you'd better bring your purse. I have got prisoners to sell.",
    "galeas_sell_prisoners",
    []],

  [plyr|trp_galeas, "galeas_talk",
    [],
    "Not this time. Good-bye.",
    "close_window",
    []],

  [trp_galeas, "galeas_sell_prisoners",
    [],
    "Let me see what you have...",
    "galeas_sell_prisoners_2",
    [
      (change_screen_trade_prisoners),
    ]],

  [trp_galeas, "galeas_sell_prisoners_2",
    [],
    "You take more prisoners, bring them to me. I will pay well.",
    "close_window",
    []],

  [party_tpl|pt_troublesome_bandits, "start",
    [
      (quest_slot_eq, "qst_troublesome_bandits", 8, "$g_encountered_party"),
    ],
    "Oh boy, this is gonna be the worst day of your life, and probably the last.",
    "troublesome_bandits_intro_1",
    []],

  [plyr|anyone, "troublesome_bandits_intro_1",
    [],
    "For me, you're nothin' but walking, talking money bags. A man in {s1} offered me good money to see you dead.",
    "troublesome_bandits_intro_2",
    [
      (quest_get_slot, ":var0", "qst_troublesome_bandits", 12),
      (str_store_party_name, s1, ":var0"),
    ]],

  [anyone, "troublesome_bandits_intro_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "A bounty killer! ... I hate bounty killers! Kill {reg18?her:him}! Kill {reg18?her:him} now!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [party_tpl|pt_rescued_prisoners, "start",
    [
      (eq, "$talk_context", 2),
    ],
    "Do you want us to follow you?",
    "disbanded_troop_ask",
    []],

  [plyr|anyone, "disbanded_troop_ask",
    [],
    "Alright. Let's ride together.",
    "disbanded_troop_join",
    []],

  [plyr|anyone, "disbanded_troop_ask",
    [],
    "No. Not at this time.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "disbanded_troop_join",
    [
      (neg|party_can_join),
    ],
    "Unfortunately, you don't have room in your party for us.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "disbanded_troop_join",
    [],
    "We're at your command.",
    "close_window",
    [
      (party_join),
      (assign, "$g_leave_encounter", 1),
    ]],

  [party_tpl|pt_enemy, "start",
    [
      (eq, "$talk_context", 2),
    ],
    "You ain't gonna capture me again. Not this time.",
    "enemy_talk_1",
    []],

  [plyr|party_tpl|pt_enemy, "enemy_talk_1",
    [],
    "You don't have a chance against me. Give up.",
    "enemy_talk_2",
    []],

  [party_tpl|pt_enemy, "enemy_talk_2",
    [],
    "I'll give up when you're dead!",
    "close_window",
    [
      (encounter_attack),
    ]],

  [anyone, "sell_prisoner_outlaws",
    [
      (store_troop_kind_count, 0, "trp_looter_1"),
      (ge, reg0, 1),
      (assign, reg1, reg0),
      (val_mul, reg1, 10),
      (val_mul, reg2, reg0),
      (val_mul, reg2, 10),
    ],
    "Hmmm. 80 cents for each looter band makes {reg1} cents for all {reg0} of them.",
    "sell_prisoner_outlaws",
    [
      (call_script, "script_troop_add_gold", "trp_player", reg1),
      (add_xp_to_troop, reg2),
      (remove_member_from_party, "trp_looter_1"),
    ]],

  [anyone, "sell_prisoner_outlaws",
    [
      (store_troop_kind_count, 0, "trp_looter_2"),
      (ge, reg0, 1),
      (assign, reg1, reg0),
      (val_mul, reg1, 20),
      (assign, reg2, reg0),
      (val_mul, reg2, 20),
    ],
    "Let me see. You've brought {reg0} {reg0?Highwaymen:Highwayman}, so a dollar twenty for each comes up to {reg1} cents.",
    "sell_prisoner_outlaws",
    [
      (call_script, "script_troop_add_gold", "trp_player", reg1),
      (add_xp_to_troop, reg2),
      (remove_member_from_party, "trp_looter_2"),
    ]],

  [anyone, "sell_prisoner_outlaws",
    [
      (store_troop_kind_count, 0, "trp_looter_3"),
      (ge, reg0, 1),
      (assign, reg1, reg0),
      (val_mul, reg1, 30),
      (assign, reg2, reg0),
      (val_mul, reg2, 30),
    ],
    "Well well, you've captured {reg0} {reg0?Road Agents:Road Agent}. Each one is worth 2 dollars, so I'll give you {reg1} for them in total.",
    "sell_prisoner_outlaws",
    [
      (call_script, "script_troop_add_gold", "trp_player", reg1),
      (add_xp_to_troop, reg2),
      (remove_member_from_party, "trp_looter_3"),
    ]],

  [anyone, "sell_prisoner_outlaws",
    [],
    "I suppose that'll be all, then.",
    "sell_prisoner_outlaws_finished",
    []],

  [plyr|anyone, "prisoner_chat",
    [],
    "If you try to escape, I will not hesitate to shoot you down.",
    "prisoner_chat_2",
    []],

  [anyone, "prisoner_chat_2",
    [],
    "I won't.",
    "close_window",
    []],

  [anyone, "start",
    [
      (party_slot_eq, "$current_town", 7, "trp_player"),
      (this_or_next|is_between, "$g_talk_troop", "trp_town_1_weaponsmith", "trp_town_1_tavernkeeper"),
      (this_or_next|is_between, "$g_talk_troop", "trp_town_1_armorer", "trp_town_1_weaponsmith"),
      (is_between, "$g_talk_troop", "trp_town_1_horse_merchant", "trp_town_1_mayor"),
    ],
    "Well hey there, {mister/ma'am}. How can I help you?",
    "town_merchant_talk",
    []],

  [anyone, "start",
    [
      (this_or_next|is_between, "$g_talk_troop", "trp_town_1_weaponsmith", "trp_town_1_tavernkeeper"),
      (this_or_next|is_between, "$g_talk_troop", "trp_town_1_armorer", "trp_town_1_weaponsmith"),
      (is_between, "$g_talk_troop", "trp_town_1_horse_merchant", "trp_town_1_mayor"),
    ],
    "Good day. What can I do for you?",
    "town_merchant_talk",
    []],

  [plyr|anyone, "town_merchant_talk",
    [
      (is_between, "$g_talk_troop", "trp_town_1_weaponsmith", "trp_town_1_tavernkeeper"),
    ],
    "I'm looking to lay down the hurt. What d'you got?",
    "trade_requested_weapons",
    []],

  [plyr|anyone, "town_merchant_talk",
    [
      (is_between, "$g_talk_troop", "trp_town_1_armorer", "trp_town_1_weaponsmith"),
    ],
    "I need some new rags. Got anything good?",
    "trade_requested_armor",
    []],

  [plyr|anyone, "town_merchant_talk",
    [
      (is_between, "$g_talk_troop", "trp_town_1_horse_merchant", "trp_town_1_mayor"),
    ],
    "I'm looking to get a new horse.",
    "trade_requested_horse",
    []],

  [anyone, "trade_requested_weapons",
    [],
    "Anybody needs to get shot or cut up, I'm sellin' the tools.",
    "merchant_trade",
    [
      (change_screen_trade),
    ]],

  [anyone, "trade_requested_armor",
    [],
    "They say I'm the best tailor in the whole West, and they don't lie.",
    "merchant_trade",
    [
      (change_screen_trade),
    ]],

  [anyone, "trade_requested_horse",
    [],
    "You ain't gonna find horses any faster or stronger than what I got in my stables.",
    "merchant_trade",
    [
      (change_screen_trade),
    ]],

  [anyone, "merchant_trade",
    [],
    "Anything else?",
    "town_merchant_talk",
    []],

  [plyr|anyone, "town_merchant_talk",
    [],
    "What's the good word?",
    "merchant_gossip",
    []],

  [plyr|anyone, "town_merchant_talk",
    [],
    "That'll be all.",
    "close_window",
    []],

  [anyone, "merchant_gossip",
    [],
    "Everybody's been whoopin' and hollerin' since the war finally ended. I heard the President got shot. Serves him right for startin' this war.",
    "town_merchant_talkb",
    []],

  [plyr|anyone, "town_merchant_talkb",
    [],
    "Yeah, I heard they burned half the damn South down to the ground.",
    "merchant_gossipb",
    []],

  [anyone, "merchant_gossipb",
    [],
    "It's god damn shameful. I know a whole lot of good men who ain't comin' back to their families, and what's it all even for?",
    "town_merchant_talkc",
    []],

  [plyr|anyone, "town_merchant_talkc",
    [],
    "Whole damned thing's a mess, really.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (this_or_next|eq, "$g_talk_troop", 160),
      (eq, "$g_talk_troop", 148),
    ],
    "Hey, sugar...",
    "town_dweller_talk",
    [
      (assign, "$welfare_inquired", 0),
      (assign, "$rumors_inquired", 0),
      (assign, "$info_inquired", 0),
      (agent_play_sound, "$g_talk_agent", "snd_prostitute_talk"),
    ]],

  [plyr|anyone, "town_dweller_talk",
    [
      (this_or_next|eq, "$g_talk_troop", 160),
      (eq, "$g_talk_troop", 148),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Well, damn you sure look purdy! How much for {reg18?a roll in the hay:a poke}?",
    "town_dweller_prostitute",
    []],

  [anyone, "town_dweller_prostitute",
    [],
    "Only $1 for you. Want to go take a tumble in the hay?",
    "town_dweller_prostitute1",
    []],

  [plyr|anyone, "town_dweller_prostitute1",
    [],
    "Hot Damn! I'll take one of those!",
    "town_dweller_prostitute2a",
    []],

  [plyr|anyone, "town_dweller_prostitute1",
    [],
    "I'll take one for me and one for all of my companions here!",
    "town_dweller_prostitute2b",
    []],

  [plyr|anyone, "town_dweller_prostitute1",
    [],
    "No thanks. I haven't drank enough whiskey today for that.",
    "town_dweller_prostitute2c",
    []],

  [anyone, "town_dweller_prostitute2a",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 100),
    ],
    "Alright...You be sure to hold on now pardner...",
    "close_window",
    [
      (troop_remove_gold, "trp_player", 100),
      (call_script, "script_change_player_party_morale", 10),
    ]],

  [anyone, "town_dweller_prostitute2a",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (lt, ":var0", 100),
    ],
    "Get out of here you damn cheapskate. Come back when you can do more than just talk.",
    "close_window",
    []],

  [anyone, "town_dweller_prostitute2b",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (store_party_size_wo_prisoners, ":var1", "p_main_party"),
      (val_mul, ":var1", 100),
      (ge, ":var0", ":var1"),
    ],
    "I'll set your friends up with some of the other girls. Now you just come with me...",
    "town_dweller_prostitute3",
    [
      (store_party_size_wo_prisoners, ":var0", "p_main_party"),
      (val_mul, ":var0", 100),
      (troop_remove_gold, "trp_player", ":var0"),
      (call_script, "script_change_player_party_morale", 30),
    ]],

  [anyone, "town_dweller_prostitute2b",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (store_party_size_wo_prisoners, ":var1", "p_main_party"),
      (val_mul, ":var1", 100),
      (lt, ":var0", ":var1"),
    ],
    "Maybe you should worry about just paying for me first. Don't talk to me again unless you can pay.",
    "close_window",
    []],

  [anyone, "town_dweller_prostitute2c",
    [],
    "Your loss sugar. If you change your mind, you know where to find me.",
    "close_window",
    []],

  [plyr|anyone, "town_dweller_prostitute3",
    [
      (party_get_free_companions_capacity, ":var0", "p_main_party"),
      (ge, ":var0", 1),
    ],
    "That was great (wink). Reckon you or one of your girls could join me and my partners?",
    "town_dweller_prostitute3a",
    []],

  [plyr|anyone, "town_dweller_prostitute3",
    [],
    "Thanks! Me and my boys sure could use a little boost (chuckle). Until next time, babe... ",
    "close_window",
    []],

  [anyone, "town_dweller_prostitute3a",
    [
      (store_attribute_level, ":var0", "trp_player", ca_charisma),
      (store_random_in_range, ":var1", 1, 100),
      (val_mul, ":var0", 3),
      (le, ":var1", ":var0"),
    ],
    "Sure! If you treat her as well as you pay (giggle) I have one girl in mind who will join your party.",
    "close_window",
    [
      (party_add_members, "p_main_party", "trp_town_walker_5", 1),
      (display_message, "@One Prostitute joined your party"),
    ]],

  [anyone, "town_dweller_prostitute3a",
    [],
    "Maybe another time, sugar...",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (is_between, "$g_talk_troop", "trp_town_walker_1", "trp_tournament_master"),
      (party_slot_eq, "$current_town", 7, "trp_player"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "{reg18?Ma'am:Sir}?",
    "town_dweller_talk",
    [
      (assign, "$welfare_inquired", 0),
      (assign, "$rumors_inquired", 0),
      (assign, "$info_inquired", 0),
    ]],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (is_between, "$g_talk_troop", "trp_town_walker_1", "trp_tournament_master"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}.",
    "town_dweller_talk",
    [
      (assign, "$welfare_inquired", 0),
      (assign, "$rumors_inquired", 0),
      (assign, "$info_inquired", 0),
    ]],

  [plyr|anyone, "town_dweller_talk",
    [
      (check_quest_active, "qst_hunt_down_fugitive"),
      (neg|check_quest_concluded, "qst_hunt_down_fugitive"),
      (quest_slot_eq, "qst_hunt_down_fugitive", 1, "$current_town"),
      (quest_get_slot, ":var0", "qst_hunt_down_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
    ],
    "I'm looking for a fugitive named {s4}. I heard he was last seen here. Do you know anything about him?",
    "town_dweller_ask_fugitive",
    []],

  [plyr|anyone, "town_dweller_talk",
    [
      (check_quest_active, "qst_wanted_fugitive"),
      (neg|check_quest_concluded, "qst_wanted_fugitive"),
      (quest_slot_eq, "qst_wanted_fugitive", 1, "$current_town"),
      (quest_get_slot, ":var0", "qst_wanted_fugitive", 13),
      (call_script, "script_get_name_from_dna_to_s50", ":var0"),
      (str_store_string, s4, s50),
    ],
    "I'm looking for a wanted man named {s4}. I heard he was last seen here. Do you know anything about him?",
    "town_dweller_ask_fugitive",
    []],

  [anyone, "town_dweller_ask_fugitive",
    [],
    "Hell if I know. I guess he might be here if you look around long enough.",
    "close_window",
    []],

  [plyr|anyone, "town_dweller_talk",
    [
      (eq, 1, 0),
      (check_quest_active, "qst_meet_spy_in_enemy_town"),
      (neg|check_quest_succeeded, "qst_meet_spy_in_enemy_town"),
      (quest_slot_eq, "qst_meet_spy_in_enemy_town", 1, "$current_town"),
      (str_store_item_name, s5, "$spy_item_worn"),
    ],
    "Pardon me, but is that a {s5} you're wearing?",
    "town_dweller_quest_meet_spy_in_enemy_town_ask_item",
    []],

  [anyone, "town_dweller_quest_meet_spy_in_enemy_town_ask_item",
    [
      (str_store_item_name, s5, "$spy_item_worn"),
      (try_begin),
        (troop_has_item_equipped, "$g_talk_troop", "$spy_item_worn"),
        (str_store_string, s6, "@A {s5}? Well... yeah, I guess so. That's a weird question."),
      (else_try),
        (str_store_string, s6, "@The hell? No, it ain't a {s5}. I'd start questioning my eyesight if I were you."),
      (try_end),
    ],
    "{s6}",
    "town_dweller_talk",
    []],

  [repeat_for_100|plyr|anyone, "town_dweller_talk",
    [
      (store_repeat_object, ":var0"),
      (lt, ":var0", 4),
      (check_quest_active, "qst_meet_spy_in_enemy_town"),
      (neg|check_quest_succeeded, "qst_meet_spy_in_enemy_town"),
      (quest_slot_eq, "qst_meet_spy_in_enemy_town", 1, "$current_town"),
      (store_add, ":var1", ":var0", "str_secret_sign_1"),
      (str_store_string, s4, ":var1"),
    ],
    "{s4}",
    "town_dweller_quest_meet_spy_in_enemy_town",
    [
      (store_repeat_object, ":var0"),
      (assign, "$temp", ":var0"),
    ]],

  [anyone, "town_dweller_quest_meet_spy_in_enemy_town",
    [
      (call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":var0", reg0),
      (eq, ":var0", 3),
      (quest_get_slot, ":var1", "qst_meet_spy_in_enemy_town", 10),
      (val_sub, ":var1", "str_secret_sign_1"),
      (eq, ":var1", "$temp"),
      (store_add, ":var2", ":var1", "str_countersign_1"),
      (str_store_string, s4, ":var2"),
    ],
    "{s4}",
    "town_dweller_quest_meet_spy_in_enemy_town_know",
    []],

  [anyone, "town_dweller_quest_meet_spy_in_enemy_town",
    [],
    "What in the hell are you talking about?",
    "town_dweller_quest_meet_spy_in_enemy_town_dont_know",
    []],

  [plyr|anyone, "town_dweller_quest_meet_spy_in_enemy_town_dont_know",
    [],
    "Never mind.",
    "close_window",
    []],

  [plyr|anyone, "town_dweller_quest_meet_spy_in_enemy_town_know",
    [
      (quest_get_slot, ":var0", "qst_meet_spy_in_enemy_town", 6),
      (str_store_troop_name, s4, ":var0"),
    ],
    "{s4} sent me to collect your reports. Do you have them with you?",
    "town_dweller_quest_meet_spy_in_enemy_town_chat",
    []],

  [anyone, "town_dweller_quest_meet_spy_in_enemy_town_chat",
    [
      (quest_get_slot, ":var0", "qst_meet_spy_in_enemy_town", 6),
      (str_store_troop_name, s4, ":var0"),
    ],
    "I've been expecting you. Here they are, make sure they reach {s4} intact and without delay.",
    "town_dweller_quest_meet_spy_in_enemy_town_chat_2",
    [
      (call_script, "script_succeed_quest", "qst_meet_spy_in_enemy_town"),
      (call_script, "script_center_remove_walker_type_from_walkers", "$current_town", 3),
    ]],

  [plyr|anyone, "town_dweller_quest_meet_spy_in_enemy_town_chat_2",
    [],
    "Farewell.",
    "close_window",
    []],

  [plyr|anyone, "town_dweller_talk",
    [
      (party_slot_eq, "$current_town", 0, 4),
      (eq, "$info_inquired", 0),
    ],
    "What can you tell me about this village?",
    "town_dweller_ask_info",
    [
      (assign, "$info_inquired", 1),
    ]],

  [plyr|anyone, "town_dweller_talk",
    [
      (party_slot_eq, "$current_town", 0, 3),
      (eq, "$info_inquired", 0),
    ],
    "What can you tell me about this town?",
    "town_dweller_ask_info",
    [
      (assign, "$info_inquired", 1),
    ]],

  [anyone, "town_dweller_ask_info",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (str_store_party_name, s5, "$current_town"),
      (assign, reg4, 0),
      (try_begin),
        (party_slot_eq, "$current_town", 0, 3),
        (assign, reg4, 1),
      (try_end),
      (str_store_string, s6, "@This is the {reg4?town:village} of {s5}, {reg18?ma'am:sir}."),
      (str_clear, s10),
      (try_begin),
        (party_slot_eq, "$current_town", 7, "trp_player"),
        (str_store_string, s10, "@{s6} Our {reg4?town:village} and the surrounding lands belong to you of course, my {reg18?lady:good sir}."),
      (else_try),
        (party_get_slot, ":var0", "$current_town", 7),
        (ge, ":var0", 0),
        (str_store_troop_name, s7, ":var0"),
        (store_troop_faction, ":var1", ":var0"),
        (str_store_faction_name, s8, ":var1"),
        (str_store_string, s10, "@{s6} Our {reg4?town:village} and the surrounding lands belong to {s7} of {s8}."),
      (try_end),
      (str_clear, s5),
      (assign, reg20, 0),
      (try_for_range, ":var2", "itm_smoked_fish", "itm_gold_bar"),
        (store_sub, ":var3", ":var2", "itm_smoked_fish"),
        (val_add, ":var3", 205),
        (party_get_slot, ":var4", "$g_encountered_party", ":var3"),
        (ge, ":var4", 10),
        (str_store_item_name, s3, ":var2"),
        (try_begin),
          (eq, reg20, 0),
          (str_store_string, s5, s3),
        (else_try),
          (eq, reg20, 1),
          (str_store_string, s5, "@{s3} and {s5}"),
        (else_try),
          (str_store_string, s5, "@{s3}, {s5}"),
        (try_end),
        (val_add, reg20, 1),
      (try_end),
      (str_store_string, s11, "@{reg20?We mostly produce {s5} here:We don't produce much here these days}. If you would like to learn more, you can speak with our {reg4?sheriff:village elder}. He is nearby, right over there."),
    ],
    "{s10} {s11}",
    "close_window",
    []],

  [plyr|anyone, "town_dweller_talk",
    [
      (party_slot_eq, "$current_town", 0, 4),
      (eq, "$welfare_inquired", 0),
    ],
    "How is life here?",
    "town_dweller_ask_situation",
    [
      (assign, "$welfare_inquired", 1),
    ]],

  [plyr|anyone, "town_dweller_talk",
    [
      (party_slot_eq, "$current_town", 0, 3),
      (eq, "$welfare_inquired", 0),
    ],
    "How is life here?",
    "town_dweller_ask_situation",
    [
      (assign, "$welfare_inquired", 1),
    ]],

  [anyone, "town_dweller_ask_situation",
    [
      (call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":var0", reg0),
      (eq, ":var0", 1),
      (party_slot_eq, "$current_town", 0, 4),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Disaster has struck my family, {reg18?ma'am:sir}. A pestilence has ruined the crops on our fields, and my poor children lie at home hungry and sick. My neighbors are too poor themselves to help me.",
    "town_dweller_poor",
    []],

  [anyone, "town_dweller_ask_situation",
    [
      (call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":var0", reg0),
      (eq, ":var0", 1),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "My life is miserable, {reg18?ma'am:sir}. I haven't been able to find a job for months, and my poor children go to bed hungry each night. My neighbors are too poor themselves to help me.",
    "town_dweller_poor",
    []],

  [plyr|anyone, "town_dweller_poor",
    [
      (store_troop_gold, ":var0", "trp_player"),
      (ge, ":var0", 300),
    ],
    "Then take these three dollars. I hope this will help you and your family.",
    "town_dweller_poor_paid",
    [
      (troop_remove_gold, "trp_player", 300),
    ]],

  [plyr|anyone, "town_dweller_poor",
    [],
    "Then you must work harder and bear your burden without complaining.",
    "town_dweller_poor_not_paid",
    []],

  [anyone, "town_dweller_poor_not_paid",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}. I will do as you say.",
    "close_window",
    []],

  [anyone, "town_dweller_poor_paid",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "{reg18?My dear Lady:Good Sir}.  You are so good and generous. I will tell everyone how you helped us.",
    "close_window",
    [
      (call_script, "script_change_player_relation_with_center", "$g_encountered_party", 1),
      (call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":var0", reg2),
      (call_script, "script_center_set_walker_to_type", "$g_encountered_party", ":var0", 2),
    ]],

  [anyone, "town_dweller_ask_situation",
    [
      (call_script, "script_agent_get_town_walker_details", "$g_talk_agent"),
      (assign, ":var0", reg0),
      (eq, ":var0", 2),
    ],
    "Thanks for your kindness. With your help our lives will be better. I will pray for you everyday.",
    "close_window",
    []],

  [anyone, "town_dweller_ask_situation",
    [
      (neg|party_slot_ge, "$current_town", 50, 30),
    ],
    "It's a damn hard life out here. We work hard all day and yet we go to sleep hungry most nights.",
    "town_dweller_talk",
    []],

  [anyone, "town_dweller_ask_situation",
    [
      (neg|party_slot_ge, "$current_town", 50, 70),
    ],
    "Every day's shittier than the last, but we gotta count our blessings.",
    "town_dweller_talk",
    []],

  [anyone, "town_dweller_ask_situation",
    [],
    "We're not doin' too badly. Things are startin' to look up.",
    "town_dweller_talk",
    []],

  [plyr|anyone, "town_dweller_talk",
    [
      (eq, "$rumors_inquired", 0),
    ],
    "What is the latest rumor around here?",
    "town_dweller_ask_rumor",
    [
      (assign, "$rumors_inquired", 1),
    ]],

  [anyone, "town_dweller_ask_rumor",
    [
      (neg|party_slot_ge, "$current_town", 26, -5),
    ],
    "I don't know anything that would be of interest to you.",
    "town_dweller_talk",
    []],

  [anyone, "town_dweller_ask_rumor",
    [
      (store_mul, ":var0", "$current_town", 197),
      (val_add, ":var0", "$g_talk_agent"),
      (call_script, "script_get_rumor_to_s61", ":var0"),
      (gt, reg0, 0),
    ],
    "{s61}",
    "town_dweller_talk",
    []],

  [anyone, "town_dweller_ask_rumor",
    [],
    "I haven't heard anything interesting lately.",
    "town_dweller_talk",
    []],

  [plyr|anyone, "town_dweller_talk",
    [
      (this_or_next|is_between, "$g_talk_troop", "trp_saloon_walker_1", "trp_tournament_master"),
      (is_between, "$g_talk_troop", "trp_town_walker_1", "trp_village_walker_1"),
    ],
    "(point your gun at this person)",
    "robbery_conversation_start",
    []],

  [plyr|anyone, "town_dweller_talk",
    [],
    "[Leave]",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (is_between, "$g_talk_troop", "trp_novice_fighter", "trp_tournament_master"),
      (party_slot_eq, "$current_town", 7, "trp_player"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes {reg18?ma'am:sir}?",
    "player_castle_guard_talk",
    []],

  [plyr|anyone, "player_castle_guard_talk",
    [],
    "How goes the watch, soldier?",
    "player_castle_guard_talk_2",
    []],

  [anyone, "player_castle_guard_talk_2",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "All is quiet {reg18?ma'am:sir}. Nothing to report.",
    "player_castle_guard_talk_3",
    []],

  [plyr|anyone, "player_castle_guard_talk_3",
    [],
    "Good. Keep your eyes open.",
    "close_window",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_osage_scout", "trp_town_walker_1"),
      (party_get_slot, ":var0", "$g_encountered_party", 90),
      (party_get_slot, ":var1", "$g_encountered_party", 91),
      (gt, ":var1", 0),
      (store_sub, reg3, ":var1", 1),
      (store_sub, reg4, reg3, 1),
      (call_script, "script_game_get_join_cost", ":var0"),
      (assign, ":var2", reg0),
      (store_mul, reg5, ":var1", reg0),
      (party_get_free_companions_capacity, ":var3", "p_main_party"),
      (val_min, ":var1", ":var3"),
      (store_troop_gold, ":var4", "trp_player"),
      (try_begin),
        (gt, ":var2", 0),
        (val_div, ":var4", ":var2"),
        (val_min, ":var1", ":var4"),
      (try_end),
      (assign, "$temp", ":var1"),
    ],
    "Need any soldiers? {reg3?Me and {reg4?{reg3} of my buddies:one of my buddies} are:I am} lookin' for a job. We're hired if you've got {reg5} cents.",
    "mercenary_tavern_talk",
    []],

  [anyone, "start",
    [
      (is_between, "$g_talk_troop", "trp_osage_scout", "trp_town_walker_1"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Any orders, {reg18?ma'am:sir}?",
    "mercenary_after_recruited",
    []],

  [plyr|anyone, "mercenary_after_recruited",
    [],
    "Get ready. We'll be moving at dawn.",
    "mercenary_after_recruited_2",
    []],

  [plyr|anyone, "mercenary_after_recruited",
    [],
    "Take your time. We'll be staying in this town for a while.",
    "mercenary_after_recruited_2",
    []],

  [anyone, "mercenary_after_recruited_2",
    [],
    "Of course. We'll be ready when you need us to be.",
    "close_window",
    []],

  [plyr|anyone, "mercenary_tavern_talk",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 91),
      (eq, ":var0", "$temp"),
      (party_get_slot, ":var1", "$g_encountered_party", 90),
      (call_script, "script_game_get_join_cost", ":var1"),
      (store_mul, reg5, "$temp", reg0),
    ],
    "Alright. You're all hired. Here's {reg5} cents.",
    "mercenary_tavern_talk_hire",
    []],

  [plyr|anyone, "mercenary_tavern_talk",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 91),
      (lt, "$temp", ":var0"),
      (gt, "$temp", 0),
      (assign, reg6, "$temp"),
      (party_get_slot, ":var1", "$g_encountered_party", 90),
      (call_script, "script_game_get_join_cost", ":var1"),
      (store_mul, reg5, "$temp", reg0),
    ],
    "Alright. But I can only take {reg6} of you. Here's {reg5} cents.",
    "mercenary_tavern_talk_hire",
    []],

  [anyone, "mercenary_tavern_talk_hire",
    [
      (store_random_in_range, ":var0", 0, 4),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
      (try_begin),
        (eq, ":var0", 0),
        (gt, "$temp", 1),
        (str_store_string, s17, "@You chose well, {reg18?ma'am:sir}. We're true to our word and earn our pay."),
      (else_try),
        (eq, ":var0", 1),
        (str_store_string, s17, "@A wise choice, {reg18?ma'am:sir}. Keep the money and tequila coming our way, and you'll need not fear the devil himself."),
      (else_try),
        (eq, ":var0", 2),
        (str_store_string, s17, "@We're at your service, {reg18?ma'am:sir}. Point us in the direction of those who need hurting, and we'll do the rest."),
      (else_try),
        (str_store_string, s17, "@You won't be disappointed, {reg18?ma'am:sir}. You ain't gonna find better fighters in all of the west."),
      (try_end),
    ],
    "{s17}",
    "close_window",
    [
      (party_get_slot, ":var0", "$g_encountered_party", 90),
      (call_script, "script_game_get_join_cost", ":var0"),
      (store_mul, ":var1", "$temp", reg0),
      (troop_remove_gold, "trp_player", ":var1"),
      (party_add_members, "p_main_party", ":var0", "$temp"),
      (party_set_slot, "$g_encountered_party", 91, 0),
    ]],

  [plyr|anyone, "mercenary_tavern_talk",
    [
      (eq, "$temp", 0),
      (party_get_free_companions_capacity, ":var0", "p_main_party"),
      (ge, ":var0", 1),
    ],
    "Well shit, I'd hire you but I'm broke.",
    "tavern_mercenary_cant_lead",
    []],

  [anyone, "tavern_mercenary_cant_lead",
    [],
    "Damn. Well, {reg3?we'll:I'll} be hanging around here for a while, if you need any extra firepower.",
    "close_window",
    []],

  [plyr|anyone, "mercenary_tavern_talk",
    [
      (eq, "$temp", 0),
      (party_get_free_companions_capacity, ":var0", "p_main_party"),
      (eq, ":var0", 0),
    ],
    "Sounds good, but... I can't lead any more men right now.",
    "tavern_mercenary_cant_lead",
    []],

  [plyr|anyone, "mercenary_tavern_talk",
    [],
    "Sorry. Not interested.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (is_between, "$g_talk_troop", "trp_novice_fighter", "trp_tournament_master"),
      (is_between, "$g_encountered_party_faction", "fac_player_supporters_faction", "fac_kingdoms_end"),
      (eq, "$players_kingdom", "$g_encountered_party_faction"),
      (troop_slot_ge, "trp_player", 7, 100),
      (str_store_party_name, s10, "$current_town"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Good day, {reg18?ma'am:sir}. It's nice having you here in {s10}.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 0),
      (is_between, "$g_talk_troop", "trp_novice_fighter", "trp_tournament_master"),
      (is_between, "$g_encountered_party_faction", "fac_player_supporters_faction", "fac_kingdoms_end"),
    ],
    "Don't do anything stupid and we won't have to get to know each other.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 1),
      (is_between, "$g_talk_troop", "trp_novice_fighter", "trp_tournament_master"),
      (is_between, "$g_encountered_party_faction", "fac_player_supporters_faction", "fac_kingdoms_end"),
      (party_slot_eq, "$current_town", 7, "trp_player"),
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Your orders, {reg18?ma'am:sir}?",
    "hall_guard_talk",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 1),
      (is_between, "$g_talk_troop", "trp_novice_fighter", "trp_tournament_master"),
      (is_between, "$g_encountered_party_faction", "fac_player_supporters_faction", "fac_kingdoms_end"),
    ],
    "We aren't supposed to talk while on guard.",
    "close_window",
    []],

  [plyr|anyone, "hall_guard_talk",
    [],
    "Stay on duty and let me know if anyone comes to see me.",
    "hall_guard_duty",
    []],

  [anyone, "hall_guard_duty",
    [
      (call_script, "script_troop_get_gender_to_reg18", "trp_player"),
    ],
    "Yes, {reg18?ma'am:sir}. As you wish.",
    "close_window",
    []],

  [plyr|anyone, "hall_guard_talk",
    [],
    "Guards! Arrest this man immediately!",
    "hall_guard_arrest",
    []],

  [anyone, "hall_guard_arrest",
    [],
    "What? Who do you want arrested?",
    "hall_guard_arrest_2",
    []],

  [plyr|anyone, "hall_guard_arrest_2",
    [],
    "Nevermind.",
    "close_window",
    []],

  [plyr|anyone, "hall_guard_arrest_2",
    [],
    "Forget it. I'll find another way to deal with this.",
    "close_window",
    []],

  [anyone, "enemy_defeated",
    [],
    "God dammit!",
    "close_window",
    []],

  [anyone, "party_relieved",
    [],
    "Thanks for helping us against those assholes.",
    "close_window",
    []],

  [anyone, "member_chat",
    [],
    "Yes?",
    "regular_member_talk",
    []],

  [plyr|anyone, "regular_member_talk",
    [],
    "Tell me about yourself.",
    "view_regular_char_requested",
    []],

  [anyone, "view_regular_char_requested",
    [],
    "Let me tell you all there is to know.",
    "do_regular_member_view_char",
    [
      (change_screen_view_character),
    ]],

  [anyone, "do_regular_member_view_char",
    [],
    "Anything else?",
    "regular_member_talk",
    []],

  [plyr|anyone, "regular_member_talk",
    [],
    "Nothing. Keep moving.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 2),
      (gt, "$encountered_party_hostile", 0),
      (encountered_party_is_attacker),
    ],
    "Looks like the odds are in our favor. Surrender now or the consequences will be... fatal.",
    "party_encounter_hostile_attacker",
    []],

  [plyr|anyone, "party_encounter_hostile_attacker",
    [],
    "Don't attack! We surrender.",
    "close_window",
    [
      (assign, "$g_player_surrenders", 1),
    ]],

  [plyr|anyone, "party_encounter_hostile_attacker",
    [],
    "I'm gonna fight till every one of you's laying six feet under.",
    "close_window",
    []],

  [anyone, "start",
    [
      (eq, "$talk_context", 2),
      (neg|encountered_party_is_attacker),
    ],
    "What do you want?",
    "party_encounter_hostile_defender",
    []],

  [plyr|anyone, "party_encounter_hostile_defender",
    [],
    "To kill you. Slowly.",
    "party_encounter_hostile_ultimatum_surrender",
    []],

  [anyone, "party_encounter_hostile_ultimatum_surrender",
    [],
    "{s43}",
    "close_window",
    [
      (call_script, "script_lord_comment_to_s43", "$g_talk_troop", "str_lord_challenged_default"),
    ]],

  [plyr|anyone, "party_encounter_hostile_defender",
    [],
    "Nothing. We'll leave you in peace.",
    "close_window",
    [
      (assign, "$g_leave_encounter", 1),
    ]],

  [anyone, "start",
    [],
    "Surrender or die! Make your choice!",
    "battle_reason_stated",
    []],

  [plyr|anyone, "battle_reason_stated",
    [],
    "How about I just kick your ass instead?",
    "close_window",
    [
      (encounter_attack),
    ]],

  [anyone, "start",
    [],
    "Hello. What can I do for you?",
    "free",
    []],

  [plyr|anyone, "free",
    [
      (neg|in_meta_mission),
    ],
    "Tell me about yourself",
    "view_char_requested",
    []],

  [anyone, "view_char_requested",
    [],
    "Alright, listen to this...",
    "view_char",
    [
      (change_screen_view_character),
    ]],

  [anyone, "view_char",
    [],
    "Anything else?",
    "free",
    []],

  [plyr|anyone, "end",
    [],
    "[Done]",
    "close_window",
    []],

  [plyr|anyone, "start",
    [],
    "Drop your weapons and surrender if you want to live!",
    "threaten_1",
    []],

  [anyone, "threaten_1",
    [],
    "You'll have to fight us first!",
    "end",
    [
      (encounter_attack),
    ]],

  [plyr|anyone, "free",
    [
      (in_meta_mission),
    ],
    " Goodbye.",
    "close_window",
    []],

  [plyr|anyone, "free",
    [
      (neg|in_meta_mission),
    ],
    " [Leave]",
    "close_window",
    []],

]